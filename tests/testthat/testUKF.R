if(interactive()){
  library(dynamichazard); library(testthat); library(survival); source("R/test_utils.R")
}

set.seed(2972)
sims <- test_sim_func_logit(n_series = 5e2, n_vars = 3, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = -.5, re_draw = T, beta_start = 1,
                            intercept_start = -1, sds = c(.1, rep(1, 3)))
sum(sims$res$event)

test_that("UKF does not fail and both methods give the same",{
  res_new <- ddhazard(formula = survival::Surv(tstart, tstop, event) ~ . - tstart - tstop - event - id,
                  by = 1,
                  data = sims$res,
                  a_0 = rep(0, ncol(sims$res) + 1 - 4),
                  Q_0 = diag(rep(1, ncol(sims$res) + 1 - 4)),
                  verbose = F,
                  control = list(eps = 1e-2, est_Q_0 = F, method = "UKF",
                                 kappa = 0, alpha = 1, beta = 0),
                  id = sims$res$id,
                  max_T = 10)


  res_old <- ddhazard(formula = survival::Surv(tstart, tstop, event) ~ . - tstart - tstop - event - id,
                      by = 1,
                      data = sims$res,
                      a_0 = rep(0, ncol(sims$res) + 1 - 4),
                      Q_0 = diag(rep(1, ncol(sims$res) + 1 - 4)),
                      control = list(est_Q_0 = F, kappa = 0, alpha = 1, beta = 0, eps = 1e-2, method = "UKF_org"),
                      id = sims$res$id,
                      max_T = 10)

  expect_equal(res_new$state_vecs, res_old$state_vecs)
  expect_equal(res_new$state_vars, res_old$state_vars)
})

test_that("Chaning time scale in UKF does no change results when other parems are changed accoridngly",{
  arg_list <- list(formula = survival::Surv(tstart, tstop, event) ~ . - tstart - tstop - event - id,
                   by = 1,
                   data = sims$res,
                   a_0 = rep(0, ncol(sims$res) + 1 - 4),
                   Q_0 = diag(rep(1, ncol(sims$res) + 1 - 4)),
                   Q = diag(rep(1e-2, ncol(sims$res) + 1 - 4)),
                   control = list(kappa = 0, alpha = 1, beta = 0,
                                  est_Q_0 = F, method = "UKF", eps = 1e-2),
                   id = sims$res$id,
                   verbose = F,
                   max_T = 10)

  res <- do.call(ddhazard, arg_list)

  sim_tmp <- sims
  t_mult <- 2.5
  sim_tmp$res$tstart <- sim_tmp$res$tstart * t_mult
  sim_tmp$res$tstop <- sim_tmp$res$tstop * t_mult
  arg_list$data <- sim_tmp$res
  arg_list$by <- t_mult
  arg_list$max_T <- arg_list$max_T * t_mult
  arg_list$Q <- arg_list$Q / t_mult

  res_new_time <- do.call(ddhazard, arg_list)

  expect_equal(res$state_vecs, res_new_time$state_vecs)
  expect_equal(res$state_vars, res_new_time$state_vars)
  expect_equal(res$Q, res_new_time$Q * t_mult)
})

test_that("Testing UKF against prev computed values",{
  arg_list <- list(formula = survival::Surv(tstart, tstop, event) ~ . - tstart - tstop - event - id,
                   by = 1,
                   data = sims$res,
                   a_0 = rep(0, ncol(sims$res) + 1 - 4),
                   Q_0 = diag(rep(1, ncol(sims$res) + 1 - 4)),
                   Q = diag(rep(1e-2, ncol(sims$res) + 1 - 4)),
                   control = list(kappa = 0, alpha = 1, beta = 0,
                                  est_Q_0 = F, method = "UKF", eps = 1e-2),
                   id = sims$res$id,
                   verbose = F,
                   max_T = 10)

  res <- do.call(ddhazard, arg_list)

  # get_expect_equal(res, file = "tmp.txt")

  expect_equal(c(res$state_vecs),
               c(-1.82175475810386667, -1.82816927803518103, -1.52928743885032814, -0.91261339491150095, -0.80937439470323558, -0.71961976642752956, -0.82620200567099988, -0.34877009902600475, -0.67072222998575493, -0.35164715388816170, -0.45884785766393377, 1.74823354160711242, 1.71024425455886631, 1.17718210914339627,  1.82596386069990135, 1.08699694788124024, 1.27146339192872393, 1.73413938914166654, 3.80020270590380083, 4.17246844968774155, 3.45216585247874352,  2.11168367652384426, 0.87689474885067942, 0.83300010699138816, 0.15666462747638921, 1.10010266808821222, 0.58266251559216031, 0.55273990018173580,  1.13709059396185452, 2.25371994499357342, 2.06996560757513004, 0.28431749619368174, -1.73823667840769547, 1.49570540405658758, 1.55818015538102639,  1.99907889129901228, 0.14775095059684612, 0.80607371316883292, 0.61720237530801558, 0.04457011873143307, -2.49894051734825506, -2.14490779262878251, -0.75749721567875250, 1.67257240804977347 ))

  expect_equal(c(res$state_vars),
               c( 0.1833646061097586877, 0.0232351049161488195, -0.0318128400728157068, -0.0789784532342156925, 0.0232351049161476086, 0.4930336699579240811,  0.0157282603100363516, -0.2306446337073753128, -0.0318128400728183575, 0.0157282603100367298, 0.4804470527267734603, -0.2587458745288236384, -0.0789784532342187318, -0.2306446337073755071, -0.2587458745288236384, 0.5433561855029452881, 0.1126882756088086190, 0.0909164543443801987,  0.0637061938088744339, -0.1107553872974808562, 0.0909164543443795325, 0.5440529711191295359, 0.1570546385821474100, -0.4603261480073812528,  0.0637061938088717417, 0.1570546385821489921, 0.5281890320378079817, -0.4970416830587455204, -0.1107553872974856857, -0.4603261480073832512, -0.4970416830587454649, 0.8933492559869526950, 0.0806856943930435722, 0.0805776384598594630, 0.0635811040139241945, -0.0746937606538435328,  0.0805776384598590190, 0.5091446756278807939, 0.1964415880903630784, -0.4534065045719717912, 0.0635811040139234590, 0.1964415880903631617,  0.5328410059403529964, -0.5159707793405902132, -0.0746937606538426585, -0.4534065045719727349, -0.5159707793405903242, 0.8477145688411493740,  0.0676572981381723532, 0.0713986545387564342, 0.0698141853995124517, -0.0635917586655196931, 0.0713986545387576138, 0.4080545873498140352,  0.1508938560522591343, -0.3505495140486254990, 0.0698141853995134926, 0.1508938560522620487, 0.3838368964012836004, -0.3830535792435117437, -0.0635917586655209005, -0.3505495140486272199, -0.3830535792435074693, 0.6666015613288149844, 0.0497615542912576009, 0.0303834273992316592,  0.0257645184261139706, 0.0161330273255860523, 0.0303834273992330817, 0.2272090813718311564, 0.0493493178876202865, -0.1291424779926476640,  0.0257645184261148449, 0.0493493178876207028, 0.2306499147754653423, -0.1635734543880585923, 0.0161330273255859552, -0.1291424779926444444, -0.1635734543880545955, 0.2755178384476562048, 0.0519218659164402963, 0.0395042663500205296, 0.0348143499925336677, 0.0023863114700490157,  0.0395042663500186908, 0.2222476241472097769, 0.0561537197411941386, -0.1457618847680276775, 0.0348143499925318428, 0.0561537197411938402,  0.2121069069191763856, -0.1616338575037951641, 0.0023863114700515067, -0.1457618847680302587, -0.1616338575037977177, 0.2930330717713161004,  0.0516412388469874792, 0.0419426819725856048, 0.0347854357674662676, 0.0002014022736995386, 0.0419426819725825933, 0.2423603262642068101,  0.0635649822790533281, -0.1652837637595204467, 0.0347854357674637349, 0.0635649822790487345, 0.2144100464416551777, -0.1678859314671292957,  0.0002014022737031641, -0.1652837637595201969, -0.1678859314671349023, 0.3148092018941338610, 0.0561875893944335653, 0.0475707483554089205,  0.0314552440514770659, -0.0032283424235968888, 0.0475707483554104610, 0.2851191673215316968, 0.0869861382185206644, -0.2053799073918136653,  0.0314552440514783635, 0.0869861382185214693, 0.2763162947652617607, -0.2175140067817649125, -0.0032283424235991405, -0.2053799073918126106, -0.2175140067817634137, 0.3746982635585577315, 0.0591078744897894776, 0.0508212443943900777, 0.0307642595533897042, 0.0033480570387506570,  0.0508212443943898209, 0.3442642524621976063, 0.1201042444549735577, -0.2402052939823175748, 0.0307642595533898291, 0.1201042444549744737,  0.2860801061231120768, -0.2192321600484086475, 0.0033480570387501170, -0.2402052939823186573, -0.2192321600484083977, 0.3530824161290353480,  0.0625685873042029911, 0.0402427834238226617, 0.0225355172149302868, 0.0125907107689490066, 0.0402427834238228005, 0.4170991741098601935,  0.1272507593715579977, -0.2626415069673372349, 0.0225355172149305227, 0.1272507593715583862, 0.3376217781973919752, -0.2481164754595842625,  0.0125907107689489685, -0.2626415069673371794, -0.2481164754595835964, 0.3824643681831367825, 0.0697745568389629423, 0.0677900421695364908,  0.0534125304243987867, -0.0256178704377758859, 0.0677900421695364908, 0.5429543088458619327, 0.1465352942419799742, -0.3754809308702820037,  0.0534125304243987728, 0.1465352942419793081, 0.3819197511324383676, -0.3389127484829057568, -0.0256178704377760524, -0.3754809308702815596, -0.3389127484829055348, 0.5732127462071732182 ))

  # expect_equal(c(res$lag_one_cor),
  #              c( 4.871779447872124e+293, 2.193614475440825e+293, 3.209660757905688e+293, 4.806166883957096e+293, 2.358964301975204e+293, 1.062170054131070e+293,  1.554149819458110e+293, 2.327194042731588e+293, 3.317579677340855e+293, 1.493805473238703e+293, 2.185711692313428e+293, 3.272898896744804e+293,  4.406560172163602e+293, 1.984140350356192e+293, 2.903161650333168e+293, 4.347213127816637e+293, 4.740362922826458e+293, 2.602496292023533e+293,  3.559673713923266e+293, 4.514537143149831e+293, 2.193189269263895e+293, 1.204078049273454e+293, 1.646928372058544e+293, 2.088708096667385e+293,  3.070033857521643e+293, 1.685472581036656e+293, 2.305375980993074e+293, 2.923780753952289e+293, 4.688982861979125e+293, 2.574288237067395e+293,  3.521090960873426e+293, 4.465604773015126e+293, 4.716521264834387e+293, 2.829042840552353e+293, 3.633099772316870e+293, 4.311110053801182e+293,  2.677353632555843e+293, 1.605918366632214e+293, 2.062344750859918e+293, 2.447220210571425e+293, 3.457850884492571e+293, 2.074072762357157e+293,  2.663555734354728e+293, 3.160629386710647e+293, 4.511561797952357e+293, 2.706104963284795e+293, 3.475221083628409e+293, 4.123767991997105e+293,  5.093707294847870e+293, 2.865713242818071e+293, 3.473528288639318e+293, 4.421777581669654e+293, 3.215181780224735e+293, 1.808857178538091e+293,  2.192514061030648e+293, 2.791055295063842e+293, 3.794737094684200e+293, 2.134914261023370e+293, 2.587727539756133e+293, 3.294159330783843e+293,  4.684293897779332e+293, 2.635377786567344e+293, 3.194338901784697e+293, 4.066371415590191e+293, 5.725617579999433e+293, 3.055996707369436e+293,  3.985395749454510e+293, 4.613267549259961e+293, 3.522990629529785e+293, 1.880364452132597e+293, 2.452226626057248e+293, 2.838558132895471e+293,  3.646894126438387e+293, 1.946496825329670e+293, 2.538471378352098e+293, 2.938390155125698e+293, 5.003451567880111e+293, 2.670547116233630e+293,  3.482722052706998e+293, 4.031401054975360e+293, 6.180775854187295e+293, 3.246460390016874e+293, 4.361680810305739e+293, 5.270060634512209e+293,  4.050097814277050e+293, 2.127319035657417e+293, 2.858093277145093e+293, 3.453330384483253e+293, 3.701145262080296e+293, 1.944031263146693e+293,  2.611842695255334e+293, 3.155794742999213e+293, 4.993122131307797e+293, 2.622643759330896e+293, 3.523571392559703e+293, 4.257403440652183e+293,  6.679726287603915e+293, 3.615408891395456e+293, 5.117702535625310e+293, 5.388975649387590e+293, 5.672612549821889e+293, 3.070307519655004e+293,  4.346097786030250e+293, 4.576470589241197e+293, 3.187473813522803e+293, 1.725223560116010e+293, 2.442097492524114e+293, 2.571545303587076e+293,  5.504171032011231e+293, 2.979138370658145e+293, 4.217045554593174e+293, 4.440577709990731e+293, 8.146297492879453e+293, 4.544191205470328e+293,  6.603254224064209e+293, 4.567737719902673e+293, 1.102641796011552e+294, 6.150788326352435e+293, 8.937832314014134e+293, 6.182659702258098e+293,  1.977364933557401e+293, 1.103019420654729e+293, 1.602819361979145e+293, 1.108734906982931e+293, 5.525425185245084e+293, 3.082208642051433e+293,  4.478818411199936e+293, 3.098179640407795e+293, 1.063038925378250e+294, 1.976040534243303e+293, 5.065285333359586e+293, 7.291906987052362e+293,  2.928754426838076e+294, 5.444144446749495e+293, 1.395525270911062e+294, 2.008976751328475e+294, 2.791580698610527e+293, 5.189157690630040e+292,  1.330163217168202e+293, 1.914882542412600e+293, -1.416173530166983e+293, -2.632468324842064e+292, -6.747940118274109e+292, -9.714230977787409e+292,  1.714390355572542e+161, 5.544830413494099e+199, 7.848758931442511e-85, 4.562956623587279e-144, 1.227974270664481e+295, 5.646192149496897e-62,  6.322759456332708e+233, 3.684214138454974e+180, 4.235093475207102e+175, 3.260424692761878e-311, 3.320923413632382e-311, -2.082611459474571e-309,  5.928787750094959e-323, 7.905050333459945e-323, 1.914040203450182e-311, 6.475189814570930e+170 ))

  expect_equal(c(res$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(res$n_iter),
               c(27 ))

  expect_equal(c(res$Q),
               c( 0.14011877108026924, 0.13402085109470754, 0.06538551832042985, -0.28695364304449644, 0.13402085109470754, 1.29399441215636624, 1.01413854447444840, -1.63275017613479267, 0.06538551832042985, 1.01413854447444840, 1.51761102050455787, -1.80248535474546578, -0.28695364304449644, -1.63275017613479267, -1.80248535474546578, 2.63489164551056554 ))

  expect_equal(c(res$order),
               c(1 ))

  expect_equal(c(res$F_),
               c(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1 ))

  expect_equal(c(res$method),
               c("UKF" ))

  expect_equal(c(res$model),
               c("logit" ))

  expect_equal(c(res$est_Q_0),
               c(FALSE ))

  expect_equal(c(res$LR),
               c(1 ))
})

test_that("Altering UKF alpha, beta and kappa change the results",{
  arg_list <- list(formula = survival::Surv(tstart, tstop, event) ~ . - tstart - tstop - event - id,
                   by = 1,
                   data = sims$res,
                   Q_0 = diag(rep(1, ncol(sims$res) + 1 - 4)),
                   Q = diag(rep(1e-1, ncol(sims$res) + 1 - 4)),
                   control = list(kappa = 0, alpha = 1, beta = 0,
                                  est_Q_0 = F, method = "UKF", eps = 1e-2),
                   id = sims$res$id,
                   verbose = F,
                   max_T = 10)
  suppressMessages(m1 <- do.call(ddhazard, arg_list))

  arg_list$control$beta <- 2

  suppressMessages(m2 <- do.call(ddhazard, arg_list))

  expect_true(class(all.equal(m1$state_vecs, m2$state_vecs)) == "character")
  expect_true(class(all.equal(m1$state_vars, m2$state_vars)) == "character")
  expect_true(class(all.equal(m1$lag_one_cor, m2$lag_one_cor)) == "character")

  arg_list$control$alpha <- .1
  arg_list$control$kappa <- 4 / (.1)^2 + 4

  suppressMessages(m3 <- do.call(ddhazard, arg_list))

  expect_true(class(all.equal(m2$state_vecs, m3$state_vecs)) == "character")
  expect_true(class(all.equal(m2$state_vars, m3$state_vars)) == "character")
  expect_true(class(all.equal(m2$lag_one_cor, m3$lag_one_cor)) == "character")

  arg_list$control$beta <- 0
  arg_list$control$alpha <- 1
  arg_list$control$kappa <- .5

  suppressMessages(m4 <- do.call(ddhazard, arg_list))

  expect_true(class(all.equal(m3$state_vecs, m4$state_vecs)) == "character")
  expect_true(class(all.equal(m3$state_vars, m4$state_vars)) == "character")
  expect_true(class(all.equal(m3$lag_one_cor, m4$lag_one_cor)) == "character")
})

arg_list <- list(formula = survival::Surv(tstart, tstop, event) ~ . - tstart - tstop - event - id,
                 by = 1,
                 data = NULL,
                 Q_0 = diag(rep(1, ncol(sims$res) + 1 - 4)),
                 Q = diag(rep(1e-1, ncol(sims$res) + 1 - 4)),
                 control = list(kappa = 0, alpha = 1, beta = 0,
                                est_Q_0 = F, method = "UKF", eps = 1e-2),
                 id = NULL,
                 verbose = F,
                 max_T = 10)

set.seed(2972)
sims <- test_sim_func_logit(n_series = 2e3, n_vars = 3, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = -.5, re_draw = T, beta_start = 1,
                            intercept_start = -2, sds = c(.1, rep(1, 3)))
sum(sims$res$event)

arg_list$data <- sims$res
arg_list$id <- sims$res$id

arg_list$control$beta <- 0
suppressMessages(fit1 <- do.call(ddhazard, arg_list))

arg_list$control$beta = 2
suppressMessages(fit2 <- do.call(ddhazard, arg_list))

# matplot(sims$betas, type = "l", lty = 1, ylim = range(sims$betas, fit1$state_vecs, fit2$state_vecs))
# matplot(fit1$state_vecs, type = "l", lty = 2, add = T)
# matplot(fit2$state_vecs, type = "l", lty = 4, add = T)

diag(fit1$Q)
diag(fit2$Q)

test_that("UKF on head_neck works with exponential model", {
  # Change by argument
  # tmp <- file("tmp.txt")
  # sink(tmp)
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 1, Q_0 = diag(1, 2), a_0 = c(-3, 0),
    Q = diag(1e-1, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-3,
                   method = "UKF", save_data = F, save_risk_set = F),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential"
  ))
  # sink()
  # close(tmp)
  # matplot(result_exp$state_vecs)
  # get_expect_equal(result_exp, file = "tmp.txt")

  expect_equal(c(result_exp$state_vecs),
               c(-3.1557783138080078, -3.1557230333400685, -3.0962061441835989, -3.0242235288965391, -2.9610314690769148, -2.9003448202130886, -2.9275580146695681, -3.0138761827589708, -3.0876564639100663, -3.1550257132128201, -3.2228314988598514, -3.2966343735226644, -3.3569488609398315, -3.4063486404020171, -3.4329823266285908, -3.4759064559251431, -3.5257532206854596, -3.5718945362550221, -3.6021014017891089, -3.6430129526908415, -3.6714427734804973, -3.7135118650389325, -3.7586529690748751, -3.7946038368341801, -3.8215289014203355, -3.8532431529924680, -3.8766776314642177, -3.8923034593579149, -3.9140157679358731, -3.9284364821171844, -3.9356268582802976, 0.4099564277361265, 0.4100083918461017, 0.4344167162901158, 0.4681528419359097,  0.4843054595323164, 0.5160542913036995, 0.5083225107599908, 0.4739365215694858, 0.4614324210793589,  0.4418449459578161, 0.4198769365001624, 0.3926430947052931, 0.3754733696565922, 0.3673530491754680,  0.3681968061084228, 0.3493215968856320, 0.3274748333392600, 0.3111776847803159, 0.3004258161706556,  0.2853278047826699, 0.2744784116427679, 0.2485643412215487, 0.2254162981782061, 0.2050917432372885,  0.1875296170024237, 0.1724679932914356, 0.1600462991765582, 0.1502133683518932, 0.1427179457362049,  0.1377557156153096, 0.1352893809808380 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.26507192437403859, -0.06954502393314611, -0.06954502393314507, 0.28764427280748472, 0.23923814819567629, -0.07609473240226672, -0.07609473240226558, 0.27132420889994635, 0.22137247529404586, -0.08197034136667897, -0.08197034136667782, 0.25984627344300371, 0.20655926187363965, -0.08693347497997958, -0.08693347497997841,  0.24976862000609579, 0.19383771769139410, -0.09139678032472048, -0.09139678032471935, 0.24088486818522747,  0.18353047189482447, -0.09488825707026183, -0.09488825707026068, 0.23429757747345165, 0.17502997446038054, -0.09824717701228755, -0.09824717701228639, 0.22953074692057870, 0.17185797617832263, -0.10023194976563650, -0.10023194976563532, 0.22952023840218008, 0.17389178376906886, -0.10093282805601318, -0.10093282805601200,  0.23417000532865023, 0.17836728682260339, -0.10164558562632478, -0.10164558562632361, 0.24135626995815723,  0.18435481261237213, -0.10254912896726540, -0.10254912896726423, 0.25049330356868105, 0.19155032566473515, -0.10365552750445613, -0.10365552750445495, 0.26132822482433349, 0.19981711778279770, -0.10512530947556621, -0.10512530947556503, 0.27352021016169015, 0.20868072353627848, -0.10713709818956765, -0.10713709818956646,  0.28666147587907509, 0.21801296267768594, -0.10961804077015375, -0.10961804077015254, 0.30070216334285915,  0.22750320581449274, -0.11258588190559740, -0.11258588190559618, 0.31549209768600073, 0.23783122176710580, -0.11592414440267329, -0.11592414440267207, 0.33125632054575999, 0.24934311394981573, -0.11955625152182024, -0.11955625152181902, 0.34810713542546501, 0.26213128420896104, -0.12341381935874061, -0.12341381935873939,  0.36608457931227661, 0.27608408523900219, -0.12750438689270865, -0.12750438689270743, 0.38510193271939830,  0.29111588059254018, -0.13180047488520036, -0.13180047488519914, 0.40510060694732386, 0.30728728054885818, -0.13627982074556486, -0.13627982074556363, 0.42605992081972444, 0.32536489885461339, -0.14092193470004635, -0.14092193470004513, 0.44809497623765276, 0.34548590405352353, -0.14551315771171150, -0.14551315771171028,  0.47135989799897327, 0.36785254946033574, -0.15000213280245189, -0.15000213280245067, 0.49585688863601207,  0.39273528868453550, -0.15431965523670468, -0.15431965523670346, 0.52160599019703313, 0.42080716611711177, -0.15825593128066004, -0.15825593128065885, 0.54881800893383437, 0.45212778659623548, -0.16164365941254832, -0.16164365941254713, 0.57752944697862518, 0.48715700183037314, -0.16435780710901227, -0.16435780710901107,  0.60779777596591344, 0.52679363352068498, -0.16609347230870533, -0.16609347230870414, 0.63989366655892521,  0.57163332470350547, -0.16667714041089260, -0.16667714041089141, 0.67389199510006037 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(39 ))

  expect_equal(c(result_exp$Q),
               c(0.0501772353506762109, 0.0008047627724870963, 0.0008047627724870963, 0.0353345554737870271 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$n_risk),
               c(96, 95, 91, 84, 78, 65, 53, 49, 46, 43, 39, 37, 36, 36, 33, 31, 30, 30, 25, 25, 23, 21, 21, 21, 20, 19, 19, 18, 18, 18 ))

  expect_equal(c(result_exp$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30 ))

  expect_equal(c(result_exp$risk_set),
               c(NULL ))

  expect_equal(c(result_exp$data),
               c(NULL ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("UKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(1 ))
})

test_that("UKF on simulated data works with exponential model", {
  set.seed(9997)
  sims <- test_sim_func_exp(n_series = 1e3, n_vars = 10, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = 0, re_draw = T, beta_start = (1:10 - 5) / 2.5,
                            intercept_start = -5, sds = c(.1, rep(1, 10)))
  # tmp <- file("tmp.txt")
  # sink(tmp)
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(1, 11),
    Q = diag(1e-1, 11),
    control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^3, method = "UKF",
                   debug = F, beta = 0, save_data = F, save_risk_set = F),
    max_T = 10,
    id = sims$res$id, order = 1,
    verbose = F,
    model = "exponential"))
  # sink()
  # close(tmp)

  # sum(sims$res$event)
  # diag(result_exp$Q)
  # result_exp$LR
  # matplot(sims$betas, type = "l", lty = 1)
  # matplot(result_exp$state_vecs, type = "l", lty = 2, add = T)
  get_expect_equal(result_exp, file = "tmp.txt")

  expect_equal(c(result_exp$state_vecs),
               c(-5.332777769868411788, -5.338387983273727322, -5.280352438568282736, -5.100477135145620622, -5.074430027104600782, -4.818060857262651986, -4.904146387867366563, -4.778778381595115476, -4.517985434324814698, -4.278956055695000593, -3.978080223750885658, -2.731896257992550314, -2.750859083128911475, -2.772028584417567387, -2.741430152736954451, -2.685296475077356249, -2.540779139609654624, -2.454128136346131583, -2.461778933657382762, -2.613924313087947926, -2.718627417252987399, -2.971031382204626592, 0.775260078928940333, 0.853476618558409950,  0.844275149799206259, 0.684024273585193909, 0.533386214977018103, -0.290225405341002607, -0.453182061356221078, -0.995707788113108117, -1.056957720637903497, -0.847392957112619860, -0.055676004228949694, -0.198018398013188185, -0.253030175786261413, -0.268621199821777346, -0.167805723892313075, -0.102870567177703931, 0.531138792495585599, 0.616582017807408400,  1.037103017408051553, 1.167852710781883241, 1.016593502104719882, 0.476048825084896987, -0.453665079880736455, -0.484436225092257700, -0.395535864232815337, -0.112118960037047105, -0.007628331792502552, 0.603705535673179972, 0.521368336320395920, 0.806168920822411317,  1.131460101460572076, 1.396686803840180957, 1.500391183004561313, 0.711080925916330431,  0.600344984448224706, 0.700143104785491577, 0.980023300019923882, 1.543073314467667601,  2.762489306430119917, 2.918083076304207601, 3.418736134917359060, 3.061676566328802807,  2.826769646130126823, 1.787661160547668215, -0.659956237276494551, -0.473753646882154822, -0.726234498296417286, -1.593530338999129325, -2.336503218003431304, -4.889814250418110575, -5.044902582376677103, -6.166343612161043097, -6.349261714480657126, -6.425129445726732058, -5.348967439016956149, 0.564390619397057591, 0.432244970349930258, 0.636885535305461437,  1.187722669111150875, 1.919651891912486752, 3.437394901904484268, 3.372126183997589344,  3.889843184857448399, 3.557337116833946933, 3.279280218615034936, 2.033135198206464711,  1.069395266448463166, 1.061038834148726462, 1.076762771405758157, 1.391390285586335596,  1.263019445644596450, 1.842264148819734881, 1.929686195909206647, 2.316933712564642978,  3.042734546920034866, 3.634843469972453889, 4.276637400155114399, 2.011832326109581626,  2.124547409752292282, 2.073459723772456798, 1.821389161480101659, 1.194883686803912326,  0.082591177752433340, -0.080981942739025009, -0.452252027684955316, 0.158441846331101394,  0.581001708227165459, 1.773758865136670249, 3.759268714777285858, 3.768899144628815812,  3.859918648114469608, 4.001150882555873700, 4.045318609312977820, 4.078184908175494172,  3.906615791175631180, 3.859559115069165269, 3.967862350577143538, 4.077230150348106541,  4.271149724786491575 ))

  expect_equal(c(result_exp$state_vars),
               c( 1.680861118697475e-01, 1.384141563416273e-02, 1.343082262932701e-02, -4.721075253080643e-03,  5.538031873752071e-02, -2.988609455745202e-02, -4.298287187036525e-02, -5.594497675495008e-03,  6.430527607755608e-02, 1.867606146982729e-02, -1.241765311854298e-02, 1.384141563416751e-02,  2.416320683138005e-01, -1.890061724447976e-02, 4.593875319665617e-04, -1.228892742914729e-02,  1.991207504731152e-02, -6.373252395808320e-03, 1.193120862380882e-02, -1.441344300995807e-02, -3.268776711205099e-02, -1.488215481383306e-02, 1.343082262932686e-02, -1.890061724447994e-02,  2.804970578587130e-01, -7.986127928937653e-02, 4.091754323855693e-05, -5.298753315470778e-02,  8.456519056120272e-02, -5.260509079034244e-02, 1.218769458130177e-02, 5.141929903293208e-02,  2.899040655305489e-02, -4.721075253079571e-03, 4.593875319665896e-04, -7.986127928937652e-02,  2.679461674318437e-01, 1.071722488264498e-02, 3.331551215062778e-02, -7.302128420462591e-02,  2.829153271508373e-02, 6.930712610758845e-03, -2.292737067060477e-02, -2.000993202381444e-02,  5.538031873752303e-02, -1.228892742914744e-02, 4.091754323848676e-05, 1.071722488264494e-02,  2.575977987757108e-01, -9.953239434884712e-04, -8.549636567881677e-02, 1.879215556595269e-02,  8.064162341170096e-02, 2.689793155897531e-02, 2.991131842444065e-02, -2.988609455745088e-02,  1.991207504731145e-02, -5.298753315470775e-02, 3.331551215062770e-02, -9.953239434885536e-04,  2.959803372441612e-01, -1.196599750455413e-01, 1.028929663722474e-01, -3.294834141825766e-02, -1.179001506348593e-01, -1.546077926455183e-02, -4.298287187036593e-02, -6.373252395808239e-03,  8.456519056120262e-02, -7.302128420462571e-02, -8.549636567881667e-02, -1.196599750455413e-01,  5.014178358892747e-01, -1.410769590655302e-01, -1.086329446676048e-01, 8.879205532205194e-02, -1.397686496925952e-02, -5.594497675494072e-03, 1.193120862380869e-02, -5.260509079034240e-02,  2.829153271508362e-02, 1.879215556595265e-02, 1.028929663722475e-01, -1.410769590655300e-01,  3.835685795320123e-01, -4.652281359898618e-02, -1.171590904442153e-01, 2.174622548562323e-02,  6.430527607756052e-02, -1.441344300995843e-02, 1.218769458130197e-02, 6.930712610758663e-03,  8.064162341170081e-02, -3.294834141825773e-02, -1.086329446676049e-01, -4.652281359898628e-02,  4.111356469959341e-01, 8.450702590989340e-02, 1.569692405198597e-02, 1.867606146982777e-02, -3.268776711205101e-02, 5.141929903293209e-02, -2.292737067060493e-02, 2.689793155897517e-02, -1.179001506348591e-01, 8.879205532205209e-02, -1.171590904442155e-01, 8.450702590989323e-02,  3.706956329373098e-01, 2.913515896971917e-02, -1.241765311854398e-02, -1.488215481383335e-02,  2.899040655305479e-02, -2.000993202381473e-02, 2.991131842444025e-02, -1.546077926455174e-02, -1.397686496925939e-02, 2.174622548562297e-02, 1.569692405198587e-02, 2.913515896971922e-02,  2.921498963701205e-01, 1.343259979843970e-01, 1.755502300124250e-02, 6.258529547730669e-03, -1.446077102067516e-03, 4.488612478315278e-02, -2.260358910240805e-02, -3.304799515002042e-02, -4.726618511613549e-03, 4.902875919242529e-02, 8.895044633901655e-03, -1.918610416351272e-02,  1.755502300124815e-02, 2.114349615958101e-01, -1.827843108886567e-02, 1.816449612200121e-03, -8.031056575899261e-03, 2.037088157361087e-02, -1.473325763305943e-02, 1.655066651158486e-02, -9.956666167759348e-03, -3.091281397899286e-02, -9.247579679418617e-03, 6.258529547728800e-03, -1.827843108886585e-02, 2.218455973123099e-01, -6.189495695907374e-02, -1.360954555526695e-04, -4.268782426523018e-02, 7.116277325354735e-02, -4.592871477810323e-02, 1.191974565931535e-02,  4.860201151477373e-02, 2.010558540175741e-02, -1.446077102064862e-03, 1.816449612200041e-03, -6.189495695907377e-02, 2.296481489644465e-01, 1.077253209174764e-02, 3.332504659320833e-02, -7.017160733847887e-02, 3.181624013525067e-02, 3.478015575697366e-03, -2.884384899250208e-02, -1.517848696933996e-02, 4.488612478315689e-02, -8.031056575899965e-03, -1.360954555525325e-04,  1.077253209174734e-02, 2.250697895648577e-01, -1.485169294464423e-03, -7.256307026638598e-02,  1.434078483747610e-02, 7.098987162652939e-02, 2.175052049970445e-02, 2.481199114136908e-02, -2.260358910240462e-02, 2.037088157361077e-02, -4.268782426523013e-02, 3.332504659320815e-02, -1.485169294464229e-03, 2.457102552445564e-01, -1.000919461803136e-01, 8.852861874544149e-02, -3.119581731361797e-02, -1.070648308685468e-01, -1.197106999971008e-02, -3.304799515002651e-02, -1.473325763305844e-02, 7.116277325354689e-02, -7.017160733847799e-02, -7.256307026638580e-02, -1.000919461803133e-01, 4.192772841540551e-01, -1.268523691759567e-01, -7.654870873812943e-02,  9.598121659046971e-02, -8.544438536408887e-03, -4.726618511609866e-03, 1.655066651158454e-02, -4.592871477810299e-02, 3.181624013525029e-02, 1.434078483747628e-02, 8.852861874544153e-02, -1.268523691759568e-01, 3.369466507237230e-01, -4.308079928787825e-02, -1.178058106281327e-01,  1.608902694802545e-02, 4.902875919243231e-02, -9.956666167760694e-03, 1.191974565931615e-02,  3.478015575696589e-03, 7.098987162652906e-02, -3.119581731361886e-02, -7.654870873812911e-02, -4.308079928787916e-02, 3.512108721524532e-01, 7.594584687853100e-02, 1.022233717245216e-02,  8.895044633900465e-03, -3.091281397899311e-02, 4.860201151477393e-02, -2.884384899250240e-02,  2.175052049970389e-02, -1.070648308685471e-01, 9.598121659047068e-02, -1.178058106281334e-01,  7.594584687852990e-02, 3.415312441830254e-01, 2.185749722958426e-02, -1.918610416351380e-02, -9.247579679419131e-03, 2.010558540175759e-02, -1.517848696934056e-02, 2.481199114136831e-02, -1.197106999971038e-02, -8.544438536407810e-03, 1.608902694802462e-02, 1.022233717245161e-02,  2.185749722958464e-02, 2.558597580345855e-01, 1.082710269967355e-01, 1.799596293893142e-02,  7.335519348204466e-04, 2.004962512780584e-03, 4.150535341888354e-02, -1.568373619208897e-02, -3.930210133469705e-02, -1.321188564147885e-03, 4.778544352114782e-02, 3.367345296244575e-03, -2.062216980252635e-02, 1.799596293893713e-02, 1.915983654019604e-01, -2.063531338100026e-02,  3.255945433829497e-03, -9.249682237230132e-03, 2.332652484639865e-02, -1.533588995254338e-02,  2.023101042047185e-02, -1.545114291200481e-02, -3.546622056232230e-02, -1.173548753090193e-02,  7.335519348191490e-04, -2.063531338100050e-02, 2.024575546482911e-01, -6.375735106917160e-02, -8.138820131817512e-03, -5.698326942956855e-02, 9.963283402730999e-02, -6.532421260361856e-02,  5.619482665432225e-03, 5.891561983249030e-02, 1.826619290055454e-02, 2.004962512782848e-03,  3.255945433829439e-03, -6.375735106917169e-02, 2.121531590905916e-01, 1.771177159386352e-02,  4.646600583231640e-02, -9.783347500419952e-02, 4.839603181126363e-02, 1.224069457724593e-02, -3.761409624319335e-02, -1.275993166590114e-02, 4.150535341888720e-02, -9.249682237230850e-03, -8.138820131817626e-03, 1.771177159386330e-02, 2.153909291223168e-01, 1.258724557493369e-02, -1.083520055813095e-01, 2.957396239092839e-02, 8.842674272494663e-02, 1.516026140418406e-02,  2.866467869385155e-02, -1.568373619208606e-02, 2.332652484639859e-02, -5.698326942956843e-02,  4.646600583231614e-02, 1.258724557493371e-02, 2.519334366810028e-01, -1.526959756140079e-01,  1.270333746331959e-01, -2.387301601645304e-02, -1.270759029475718e-01,
                  -7.623048308026497e-03, -3.930210133470162e-02, -1.533588995254239e-02, 9.963283402730992e-02, -9.783347500419877e-02, -1.083520055813091e-01, -1.526959756140080e-01, 5.353368761847344e-01, -1.983134538414224e-01, -1.222144423620913e-01, 1.294159075893618e-01, -2.128391434565903e-02, -1.321188564144907e-03,  2.023101042047156e-02, -6.532421260361843e-02, 4.839603181126317e-02, 2.957396239092835e-02,  1.270333746331960e-01, -1.983134538414222e-01, 3.690066533874535e-01, -3.520441255168619e-02, -1.518309221482206e-01, 1.984270839625609e-02, 4.778544352115434e-02, -1.545114291200618e-02,  5.619482665432550e-03, 1.224069457724536e-02, 8.842674272494641e-02, -2.387301601645362e-02, -1.222144423620915e-01, -3.520441255168669e-02, 3.669592711713917e-01, 8.255473817574145e-02,  1.895030487720368e-02, 3.367345296243832e-03, -3.546622056232261e-02, 5.891561983249035e-02, -3.761409624319360e-02, 1.516026140418371e-02, -1.270759029475720e-01, 1.294159075893623e-01, -1.518309221482213e-01, 8.255473817574076e-02, 3.427484742356657e-01, 2.087731937821038e-02, -2.062216980252768e-02, -1.173548753090242e-02, 1.826619290055457e-02, -1.275993166590167e-02,  2.866467869385069e-02, -7.623048308026638e-03, -2.128391434565799e-02, 1.984270839625542e-02,  1.895030487720294e-02, 2.087731937821055e-02, 2.378558652317627e-01, 8.846946301298558e-02,  1.907911040894932e-02, -1.327444284185949e-03, 2.099681912450228e-03, 3.530226784616059e-02, -1.319179060631536e-02, -3.359753980610061e-02, -1.543766143703480e-03, 4.019321865815344e-02, -1.059566512340872e-03, -2.336940321187503e-02, 1.907911040895493e-02, 1.712873800014157e-01, -2.081243337195481e-02, 4.396452358069596e-03, -8.613134855615543e-03, 2.200875500510121e-02, -1.249776719531913e-02, 1.875754118184457e-02, -1.585331823610982e-02, -3.424105017341609e-02, -1.289572551979935e-02, -1.327444284186400e-03, -2.081243337195519e-02, 1.759111084040495e-01, -6.014341669906918e-02, -9.018813977877176e-03, -5.243654330501964e-02, 8.709039647705655e-02, -5.897697946817469e-02, 5.960376239642141e-03, 5.433821181276512e-02, 1.796381058023429e-02,  2.099681912451983e-03, 4.396452358069641e-03, -6.014341669906937e-02, 1.925072432635887e-01,  1.794110545773501e-02, 4.787124054980411e-02, -9.508393454045588e-02, 4.904008681816040e-02,  1.159104278504159e-02, -3.889623762352622e-02, -1.298047327416267e-02, 3.530226784616392e-02, -8.613134855616158e-03, -9.018813977877830e-03, 1.794110545773502e-02, 1.954581048292191e-01,  1.608622765623990e-02, -1.069820029556110e-01, 3.069601549471241e-02, 8.567058975538655e-02,  1.135940850853752e-02, 2.639955413978744e-02, -1.319179060631333e-02, 2.200875500510132e-02, -5.243654330501942e-02, 4.787124054980371e-02, 1.608622765623943e-02, 2.298412636408598e-01, -1.429764076707922e-01, 1.206901955574654e-01, -2.145810091612279e-02, -1.186987687224150e-01, -5.314497159973404e-03, -3.359753980610345e-02, -1.249776719531855e-02, 8.709039647705741e-02, -9.508393454045549e-02, -1.069820029556098e-01, -1.429764076707933e-01, 5.009478683441401e-01, -1.855826931656096e-01, -1.234384617212648e-01, 1.175760735290794e-01, -2.227841462659138e-02, -1.543766143701611e-03, 1.875754118184449e-02, -5.897697946817456e-02, 4.904008681815984e-02,  3.069601549471175e-02, 1.206901955574655e-01, -1.855826931656082e-01, 3.397257626611509e-01, -3.054984693621447e-02, -1.435461859949085e-01, 2.010030067175312e-02, 4.019321865815998e-02, -1.585331823611106e-02, 5.960376239641479e-03, 1.159104278504153e-02, 8.567058975538672e-02, -2.145810091612247e-02, -1.234384617212668e-01, -3.054984693621385e-02, 3.413939515617566e-01,  7.805969090919342e-02, 1.837592287048362e-02, -1.059566512340765e-03, -3.424105017341650e-02,  5.433821181276479e-02, -3.889623762352613e-02, 1.135940850853770e-02, -1.186987687224149e-01,  1.175760735290784e-01, -1.435461859949087e-01, 7.805969090919350e-02, 3.130485926605265e-01,  1.857591363989998e-02, -2.336940321187644e-02, -1.289572551979980e-02, 1.796381058023404e-02, -1.298047327416306e-02, 2.639955413978660e-02, -5.314497159973275e-03, -2.227841462659071e-02,  2.010030067175275e-02, 1.837592287048278e-02, 1.857591363989990e-02, 2.178583347626200e-01,  7.379508814566543e-02, 1.959435507713323e-02, -5.208930719832836e-04, 2.361413047413225e-04,  2.640488532461561e-02, -1.293592952371822e-02, -1.991665275745112e-02, -6.626871628754339e-03,  2.906870872603969e-02, -4.419281014475515e-03, -2.743487501836369e-02, 1.959435507713863e-02,  1.500226447914553e-01, -1.833775008687381e-02, 3.249889759353286e-03, -6.645187713703437e-03,  1.527908732702076e-02, -5.695121968194531e-03, 1.134893094326657e-02, -1.235609820718199e-02, -2.565328642519075e-02, -1.306834871439566e-02, -5.208930719830937e-04, -1.833775008687417e-02,  1.426687157737355e-01, -4.527827728155687e-02, -5.351644455146200e-03, -3.257024839147368e-02,  5.366749451438903e-02, -3.557720934514878e-02, 5.646461452469921e-03, 3.501733749277942e-02,  1.618611679768924e-02, 2.361413047426864e-04, 3.249889759353343e-03, -4.527827728155719e-02,  1.628775278057794e-01, 1.217136488547303e-02, 3.313924448842506e-02, -6.603872267313271e-02,  3.132952795137216e-02, 9.117917125698967e-03, -2.549393014240517e-02, -1.189546015771963e-02,  2.640488532461869e-02, -6.645187713703880e-03, -5.351644455147383e-03, 1.217136488547331e-02,  1.672909243003212e-01, 1.357452183442918e-02, -8.399555020327004e-02, 2.058045668701548e-02,  7.022628845085838e-02, 8.369333098842075e-03, 1.841001885371040e-02, -1.293592952371683e-02,  1.527908732702079e-02, -3.257024839147345e-02, 3.313924448842455e-02, 1.357452183442822e-02,  1.872936286779877e-01, -1.017634175379465e-01, 8.509821358825748e-02, -1.289773011512567e-02, -8.475011613203035e-02, -2.237884360691512e-03, -1.991665275745266e-02, -5.695121968194126e-03,  5.366749451439039e-02, -6.603872267313241e-02, -8.399555020326822e-02, -1.017634175379481e-01,  4.037203219633084e-01, -1.280452616648236e-01, -1.104750313843058e-01, 7.955909109779158e-02, -1.459858191509365e-02, -6.626871628753382e-03, 1.134893094326643e-02, -3.557720934514867e-02,  3.132952795137151e-02, 2.058045668701419e-02, 8.509821358825764e-02, -1.280452616648214e-01,  2.748344154141951e-01, -2.415098924090492e-02, -1.040865611023021e-01, 1.852173060527948e-02,  2.906870872604633e-02, -1.235609820718291e-02, 5.646461452468374e-03, 9.117917125699425e-03,  7.022628845085888e-02, -1.289773011512447e-02, -1.104750313843096e-01, -2.415098924090314e-02,  2.925969267795320e-01, 5.650903048973975e-02, 9.219200548813932e-03, -4.419281014474710e-03, -2.565328642519099e-02, 3.501733749277882e-02, -2.549393014240473e-02, 8.369333098842854e-03, -8.475011613202990e-02, 7.955909109778936e-02, -1.040865611023020e-01, 5.650903048974072e-02,  2.489223863323044e-01, 1.171775995644662e-02, -2.743487501836504e-02, -1.306834871439605e-02,  1.618611679768881e-02, -1.189546015771992e-02, 1.841001885370966e-02, -2.237884360691206e-03, -1.459858191509333e-02, 1.852173060527934e-02, 9.219200548813141e-03, 1.171775995644640e-02,  1.940600181666536e-01, 6.698090189239661e-02, 1.745021553472233e-02, 1.205136399408630e-03, -3.372815322022469e-04, 2.288499560855510e-02, -1.934065342908657e-02, -8.639668355998449e-03, -1.752606212774956e-02, 3.054285022453586e-02,
                  4.357863222908313e-03, -2.732097282672568e-02,  1.745021553472780e-02, 1.351158593846074e-01, -2.033072700777151e-02, 4.739300531973494e-03, -7.723519897528523e-03, 1.883872078498059e-02, -5.351010592486461e-03, 1.431177581095006e-02, -1.923173222531714e-02, -3.127242805812987e-02, -1.668789232368508e-02, 1.205136399408599e-03, -2.033072700777184e-02, 1.388715839743138e-01, -4.910059464701776e-02, -7.227880183917231e-03, -4.734171987142016e-02, 7.209084119480251e-02, -5.420786237999911e-02, 9.530193206314394e-03,  5.279742782051103e-02, 1.438536215999437e-02, -3.372815322007523e-04, 4.739300531973506e-03, -4.910059464701806e-02, 1.509582104536477e-01, 1.340627158248136e-02, 4.108317210071526e-02, -7.722731758784783e-02, 4.233930202919133e-02, 8.314858896018681e-03, -3.508394145325586e-02, -8.888418969256483e-03, 2.288499560855808e-02, -7.723519897529055e-03, -7.227880183918198e-03,  1.340627158248149e-02, 1.511445073111937e-01, 1.265457648519473e-02, -8.006844620216830e-02,  1.713218319010188e-02, 6.957426424528727e-02, 9.355880075394944e-03, 1.657544920244280e-02, -1.934065342908466e-02, 1.883872078498059e-02, -4.734171987141989e-02, 4.108317210071492e-02,  1.265457648519428e-02, 2.048363594582654e-01, -1.312904445930369e-01, 1.133323917705276e-01, -2.351163202530612e-02, -1.119604575983605e-01, -4.379315758302943e-03, -8.639668356000276e-03, -5.351010592485871e-03, 7.209084119480351e-02, -7.722731758784726e-02, -8.006844620216685e-02, -1.312904445930377e-01, 4.284199927972731e-01, -1.576842497755202e-01, -1.017685273276171e-01,  1.055280021116227e-01, -1.348432829598711e-02, -1.752606212774829e-02, 1.431177581094982e-02, -5.420786237999882e-02, 4.233930202919065e-02, 1.713218319010092e-02, 1.133323917705274e-01, -1.576842497755184e-01, 2.871587842169532e-01, -3.304325092476291e-02, -1.298924654398064e-01,  1.311225262883784e-02, 3.054285022454230e-02, -1.923173222531815e-02, 9.530193206313048e-03,  8.314858896018937e-03, 6.957426424528769e-02, -2.351163202530557e-02, -1.017685273276203e-01, -3.304325092476159e-02, 2.791690091768415e-01, 6.705911986583273e-02, 1.551810337321268e-02,  4.357863222908671e-03, -3.127242805813005e-02, 5.279742782051040e-02, -3.508394145325549e-02,  9.355880075395312e-03, -1.119604575983600e-01, 1.055280021116212e-01, -1.298924654398064e-01,  6.705911986583317e-02, 2.558087831630301e-01, 1.666355445512474e-02, -2.732097282672714e-02, -1.668789232368550e-02, 1.438536215999407e-02, -8.888418969256885e-03, 1.657544920244196e-02, -4.379315758302846e-03, -1.348432829598642e-02, 1.311225262883749e-02, 1.551810337321181e-02,  1.666355445512469e-02, 1.761050475727419e-01, 5.492979246653626e-02, 1.764917538831180e-02,  8.696277868148503e-03, -8.317731603727046e-03, 7.262370469375123e-03, -3.299087597511793e-02,  3.352337278831152e-02, -4.063850331519624e-02, 1.119212467312980e-02, 1.518749366275769e-02, -3.236251079864644e-02, 1.764917538831746e-02, 1.140397914318613e-01, -1.547843584950387e-02,  2.227047392182211e-03, -6.651686413576850e-03, 9.565914022675665e-03, 5.589075014168342e-03,  4.040607696479938e-03, -1.606391813789946e-02, -1.977217915977836e-02, -1.636745501702244e-02,  8.696277868148181e-03, -1.547843584950398e-02, 1.180298251771196e-01, -3.751078732900685e-02,  6.812467707086974e-04, -3.448236504518597e-02, 4.458167997763245e-02, -3.819806693424808e-02,  1.719309447840539e-02, 4.245012671271683e-02, 1.394547874183052e-02, -8.317731603725379e-03,  2.227047392182001e-03, -3.751078732900707e-02, 1.224440652734432e-01, 1.795982556633862e-03,  2.582668272379174e-02, -4.086827245534454e-02, 2.318348234736952e-02, -4.411621512355621e-03, -2.433594346669840e-02, -9.165371232216892e-03, 7.262370469377779e-03, -6.651686413577733e-03,  6.812467707086201e-04, 1.795982556633353e-03, 1.144721459663871e-01, -1.748025268283479e-03, -2.443043375233859e-02, -1.002998783916781e-02, 3.599495051202692e-02, 1.636070192696013e-02,  5.669494705067541e-03, -3.299087597511480e-02, 9.565914022675462e-03, -3.448236504518681e-02,  2.582668272379252e-02, -1.748025268281455e-03, 1.656573754453668e-01, -7.475091918151461e-02,  7.408655478832282e-02, -3.435798182365492e-02, -7.731820604834480e-02, -7.496520852892867e-03,  3.352337278830887e-02, 5.589075014169746e-03, 4.458167997763359e-02, -4.086827245534443e-02, -2.443043375234014e-02, -7.475091918151139e-02, 2.660530041115278e-01, -7.372790655610101e-02, -2.992951384064964e-02, 5.423153036789297e-02, 6.201784871617501e-03, -4.063850331519418e-02,  4.040607696479229e-03, -3.819806693424795e-02, 2.318348234736919e-02, -1.002998783916672e-02,  7.408655478832077e-02, -7.372790655609981e-02, 2.116280572753151e-01, -5.056414630586685e-02, -8.372571725406737e-02, 1.683200371516867e-04, 1.119212467313558e-02, -1.606391813790080e-02,  1.719309447840486e-02, -4.411621512356078e-03, 3.599495051202706e-02, -3.435798182365702e-02, -2.992951384064919e-02, -5.056414630586781e-02, 1.937778738824899e-01, 5.813246157437289e-02,  5.888072323601452e-03, 1.518749366275686e-02, -1.977217915977834e-02, 4.245012671271700e-02, -2.433594346669890e-02, 1.636070192695829e-02, -7.731820604834413e-02, 5.423153036789448e-02, -8.372571725406890e-02, 5.813246157437090e-02, 1.889964539004189e-01, 1.841150316062840e-02, -3.236251079864816e-02, -1.636745501702292e-02, 1.394547874183054e-02, -9.165371232217574e-03,  5.669494705066494e-03, -7.496520852893434e-03, 6.201784871619436e-03, 1.683200371506190e-04,  5.888072323600363e-03, 1.841150316062895e-02, 1.498525208260434e-01, 5.583748880552927e-02,  1.758775429679931e-02, 1.086985149402648e-02, -1.056952159621916e-02, 7.688317904757558e-03, -3.843442112042756e-02, 4.245278013184404e-02, -4.456477254619122e-02, 1.108261806368667e-02,  2.245758045417084e-02, -3.063573143508203e-02, 1.758775429680485e-02, 1.098672027125622e-01, -1.755241972654002e-02, 2.572030738445796e-03, -6.216659266782667e-03, 1.187086488799968e-02,  1.764548205114091e-03, 5.588087402773230e-03, -1.343170881571334e-02, -2.459992611720026e-02, -1.688654024693617e-02, 1.086985149402694e-02, -1.755241972654013e-02, 1.145396025904420e-01, -3.859487726895587e-02, 1.825789881745539e-03, -3.839904213820342e-02, 4.867320056147509e-02, -4.364381545174036e-02, 1.587447578662763e-02, 4.771720319362849e-02, 1.269144710916530e-02, -1.056952159621805e-02, 2.572030738445643e-03, -3.859487726895634e-02, 1.183671878968949e-01,  1.750664900687475e-05, 2.788595080278957e-02, -3.958829790603617e-02, 2.593856712321218e-02, -5.790518089538514e-03, -2.946426351036277e-02, -7.465908277769580e-03, 7.688317904759998e-03, -6.216659266783406e-03, 1.825789881744600e-03, 1.750664900693547e-05, 1.097493127588193e-01, -5.030289375432163e-03, -1.971731998443109e-02, -1.290566521521690e-02, 4.129661098634368e-02,  2.308939864819605e-02, 6.569208619122076e-03, -3.843442112042487e-02, 1.187086488799966e-02, -3.839904213820537e-02, 2.788595080279092e-02, -5.030289375430355e-03, 1.688857074852166e-01, -7.586778611872097e-02, 8.272344428874027e-02, -3.670564460163470e-02, -8.505010860336502e-02, -6.117084927406351e-03, 4.245278013184273e-02, 1.764548205115110e-03, 4.867320056147819e-02, -3.958829790603705e-02, -1.971731998443171e-02, -7.586778611871692e-02, 2.641062802010182e-01, -8.396532224345507e-02,
                  -2.998026449509793e-02, 5.403067041086715e-02, 2.459156083516338e-03, -4.456477254618999e-02, 5.588087402772689e-03, -4.364381545174111e-02, 2.593856712321223e-02, -1.290566521521650e-02, 8.272344428873750e-02, -8.396532224345321e-02, 2.193407901361187e-01, -4.632405699423291e-02, -9.201959734644236e-02, 3.948383545982604e-03, 1.108261806369246e-02, -1.343170881571451e-02, 1.587447578662603e-02, -5.790518089538143e-03, 4.129661098634409e-02, -3.670564460163629e-02, -2.998026449509937e-02, -4.632405699423273e-02, 1.927492357732412e-01,  6.559020851063434e-02, 9.231654790094123e-03, 2.245758045417063e-02, -2.459992611720037e-02,  4.771720319362935e-02, -2.946426351036350e-02, 2.308939864819473e-02, -8.505010860336389e-02,  5.403067041086834e-02, -9.201959734644408e-02, 6.559020851063316e-02, 1.933482825258259e-01,  1.862006419484359e-02, -3.063573143508365e-02, -1.688654024693662e-02, 1.269144710916514e-02, -7.465908277770083e-03, 6.569208619121198e-03, -6.117084927406691e-03, 2.459156083517682e-03,  3.948383545981860e-03, 9.231654790093170e-03, 1.862006419484390e-02, 1.431821606696194e-01,  5.643306449548113e-02, 1.782058327660138e-02, 1.350173797187574e-02, -1.325850684711092e-02,  3.560511596412539e-03, -4.357191944331108e-02, 5.706087872108587e-02, -5.046208085317298e-02,  4.749443257039360e-03, 2.679106724325937e-02, -2.987262056296972e-02, 1.782058327660702e-02,  1.115456691923566e-01, -1.823213502792115e-02, 1.003728203943496e-03, -6.465605772288917e-03,  8.912273122224043e-03, 7.149031090994093e-03, 1.409812141284960e-03, -1.568308729896485e-02, -2.216213872247570e-02, -1.813198275171131e-02, 1.350173797187556e-02, -1.823213502792125e-02,  1.099465066916245e-01, -3.874947151334163e-02, -2.165968877754310e-03, -3.751137800014352e-02,  4.689905911799291e-02, -4.383615818154919e-02, 1.344291043828210e-02, 4.547804803605196e-02,  6.175160328794779e-03, -1.325850684710933e-02, 1.003728203943292e-03, -3.874947151334186e-02,  1.207001859897884e-01, 2.702985895717004e-03, 2.864283992621214e-02, -3.723142055591878e-02,  2.553126973130451e-02, -3.716595260275181e-03, -2.733320943627039e-02, -1.815309741642825e-03,  3.560511596415147e-03, -6.465605772289769e-03, -2.165968877754406e-03, 2.702985895716520e-03,  1.051094020624611e-01, -2.052356428485316e-03, -1.599381739867882e-02, -9.046767827087939e-03,  3.470361470603774e-02, 1.905035707474667e-02, 7.229404000841758e-03, -4.357191944330700e-02,  8.912273122224049e-03, -3.751137800014587e-02, 2.864283992621422e-02, -2.052356428481737e-03,  1.703953984104540e-01, -7.251669645426440e-02, 7.912861169787756e-02, -3.368693235750962e-02, -8.288713469901463e-02, 7.017678866852450e-04, 5.706087872108304e-02, 7.149031090995370e-03,  4.689905911799445e-02, -3.723142055591901e-02, -1.599381739868082e-02, -7.251669645425605e-02,  2.561981084403698e-01, -7.603927833235938e-02, -2.511947582279112e-02, 4.617333603845414e-02, -1.110395538342481e-02, -5.046208085317033e-02, 1.409812141284384e-03, -4.383615818154997e-02,  2.553126973130506e-02, -9.046767827085814e-03, 7.912861169787400e-02, -7.603927833236088e-02,  2.072861989854679e-01, -3.937486734219343e-02, -7.973114049201964e-02, 1.354672788798024e-02,  4.749443257044972e-03, -1.568308729896619e-02, 1.344291043828203e-02, -3.716595260275967e-03,  3.470361470603756e-02, -3.368693235751413e-02, -2.511947582278885e-02, -3.937486734219638e-02,  1.795600200111635e-01, 6.008531472213145e-02, 1.303220279841736e-02, 2.679106724325791e-02, -2.216213872247579e-02, 4.547804803605332e-02, -2.733320943627189e-02, 1.905035707474374e-02, -8.288713469901382e-02, 4.617333603845931e-02, -7.973114049202246e-02, 6.008531472212775e-02,  1.857720001372204e-01, 1.435511143445264e-02, -2.987262056297151e-02, -1.813198275171179e-02,  6.175160328795098e-03, -1.815309741643704e-03, 7.229404000840549e-03, 7.017678866841686e-04, -1.110395538342210e-02, 1.354672788797862e-02, 1.303220279841612e-02, 1.435511143445359e-02,  1.418442239686164e-01, 5.598289446792613e-02, 2.162217234030782e-02, 1.265047257993934e-02, -1.397571781757700e-02, -2.574800232176981e-03, -4.021132804184585e-02, 6.892052297763798e-02, -4.648684934646406e-02, -9.901732013445911e-03, 1.589249644216322e-02, -3.323266599618301e-02,  2.162217234031329e-02, 1.216339186473697e-01, -2.137547858985624e-02, 7.065031115636436e-05, -2.853758275908030e-03, 4.884338706108261e-03, 7.611047154728584e-03, -3.942755831194288e-03, -1.187434785632972e-02, -1.533386708321249e-02, -1.947946445427327e-02, 1.265047257994069e-02, -2.137547858985635e-02, 1.053128398524623e-01, -3.648336810503830e-02, -8.832139774711738e-03, -3.006507824817355e-02, 4.608014152952134e-02, -4.185728903118184e-02, 5.482931877853888e-03,  3.556309913124812e-02, 1.309718262325851e-03, -1.397571781757636e-02, 7.065031115619273e-05, -3.648336810503879e-02, 1.297765687894019e-01, 8.564390176259956e-03, 2.459035597105812e-02, -3.477244904552131e-02, 2.372998073031465e-02, 2.149787363438798e-03, -1.939808321906413e-02,  2.462139665731268e-03, -2.574800232174699e-03, -2.853758275908736e-03, -8.832139774713300e-03,  8.564390176260333e-03, 1.132839763578221e-01, 5.949283306286552e-03, -2.274746665676402e-02,  5.423494999803860e-03, 2.931214184349624e-02, 5.289330225213170e-03, 5.977559786095997e-03, -4.021132804184360e-02, 4.884338706108242e-03, -3.006507824817585e-02, 2.459035597105985e-02,  5.949283306288427e-03, 1.679041892892915e-01, -7.428450750382803e-02, 6.524950720218184e-02, -1.670815775323202e-02, -6.737182822849504e-02, 5.270292685225147e-03, 6.892052297763827e-02,  7.611047154729615e-03, 4.608014152952528e-02, -3.477244904552249e-02, -2.274746665676346e-02, -7.428450750382255e-02, 2.790147461197147e-01, -8.146490800210220e-02, -2.949989003026119e-02,  4.931614355585578e-02, -1.731521031146364e-02, -4.648684934646362e-02, -3.942755831194822e-03, -4.185728903118305e-02, 2.372998073031508e-02, 5.423494999803933e-03, 6.524950720217881e-02, -8.146490800210097e-02, 1.959317644864790e-01, -1.222728817975186e-02, -5.470528273931648e-02,  2.173271434125534e-02, -9.901732013440334e-03, -1.187434785633084e-02, 5.482931877851475e-03,  2.149787363439466e-03, 2.931214184349644e-02, -1.670815775323383e-02, -2.949989003026366e-02, -1.222728817975146e-02, 1.716590668472932e-01, 3.109129902011070e-02, 1.388394762570135e-02,  1.589249644216364e-02, -1.533386708321249e-02, 3.556309913124886e-02, -1.939808321906495e-02,  5.289330225212141e-03, -6.737182822849359e-02, 4.931614355585676e-02, -5.470528273931802e-02,  3.109129902010987e-02, 1.687539268724204e-01, 7.242361596178960e-03, -3.323266599618473e-02, -1.947946445427376e-02, 1.309718262326014e-03, 2.462139665730477e-03, 5.977559786094844e-03,  5.270292685224193e-03, -1.731521031146129e-02, 2.173271434125393e-02, 1.388394762570021e-02,  7.242361596179800e-03, 1.503861389408429e-01, 6.657147549940122e-02, 2.123628894287862e-02,  1.744538793472995e-02, -1.773638152883938e-02, -5.549260874590872e-03, -4.859666427008487e-02,  9.104199911588438e-02, -5.486592406770278e-02, -1.765166071831405e-02, 2.100392479357554e-02, -3.704030805307457e-02, 2.123628894288413e-02, 1.515594505994542e-01, -2.896379299341013e-02,  8.507298470978621e-04, -5.954535855182458e-03, 1.058931032282776e-02, 5.981226347286248e-03,
                  -1.238615192031514e-03, -1.915108325968984e-02, -2.500039268533634e-02, -2.829291989375776e-02,  1.744538793473201e-02, -2.896379299341000e-02, 1.178725237372298e-01, -4.174380681036885e-02, -7.056100208856331e-03, -2.716663530655072e-02, 4.902745473931880e-02, -4.364757009031861e-02,  2.234712002894238e-03, 3.292429494365368e-02, -1.496360786597317e-03, -1.773638152883919e-02,  8.507298470975463e-04, -4.174380681036960e-02, 1.607403644811620e-01, 1.179336554623651e-02,  2.625145103724502e-02, -4.604506561068616e-02, 2.626307258523894e-02, 9.939704327883814e-03, -1.889107028272932e-02, 5.033812564399966e-03, -5.549260874588846e-03, -5.954535855183311e-03, -7.056100208858482e-03, 1.179336554623718e-02, 1.403706161322155e-01, 6.695797055887992e-03, -2.352969276932615e-02, 8.117685996446300e-03, 3.325237428993277e-02, 1.037574734247718e-02,  8.406045503151667e-03, -4.859666427008343e-02, 1.058931032282746e-02, -2.716663530655322e-02,  2.625145103724666e-02, 6.695797055889408e-03, 2.077974890227557e-01, -1.004916831386004e-01,  8.563404433791122e-02, -2.377298962630332e-02, -8.401805263952777e-02, 6.026099328449976e-03,  9.104199911588620e-02, 5.981226347287885e-03, 4.902745473932368e-02, -4.604506561068755e-02, -2.352969276932482e-02, -1.004916831385952e-01, 3.507587146003806e-01, -1.121383019641531e-01, -2.920703174792516e-02, 6.647672994208875e-02, -1.870547565037869e-02, -5.486592406770327e-02, -1.238615192032388e-03, -4.364757009032022e-02, 2.626307258523938e-02, 8.117685996445925e-03,  8.563404433790844e-02, -1.121383019641519e-01, 2.536460071357635e-01, -3.219684175963214e-02, -6.791158831448840e-02, 3.466350812029786e-02, -1.765166071830866e-02, -1.915108325969112e-02,  2.234712002891066e-03, 9.939704327884876e-03, 3.325237428993302e-02, -2.377298962630460e-02, -2.920703174792855e-02, -3.219684175963120e-02, 2.292803983062430e-01, 4.867869564606023e-02,  6.996455556469258e-03, 2.100392479357670e-02, -2.500039268533608e-02, 3.292429494365440e-02, -1.889107028272993e-02, 1.037574734247660e-02, -8.401805263952605e-02, 6.647672994208909e-02, -6.791158831448951e-02, 4.867869564605989e-02, 2.144581405646570e-01, 1.376915027709855e-02, -3.704030805307629e-02, -2.829291989375828e-02, -1.496360786597241e-03, 5.033812564399245e-03,  8.406045503150564e-03, 6.026099328449080e-03, -1.870547565037654e-02, 3.466350812029653e-02,  6.996455556468231e-03, 1.376915027709938e-02, 1.838948983026356e-01 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 1.170606062097765e-01, 1.742808097418948e-02, 3.528062818072695e-03, -2.278876299946336e-03,  2.508509041798914e-02, -1.500847087549917e-02, -1.177613948936130e-02, -5.440837040480177e-04,  1.512413517592574e-02, -5.166973696440119e-03, -2.138401435031806e-02, 1.696439447437468e-02,  1.907502187563127e-01, -7.827999401778397e-03, -3.378464314521364e-03, -3.967641645050484e-03,  5.939059122339607e-03, -3.771647958028816e-03, 1.734387455512180e-03, 2.208073570684279e-03, -9.966680451851742e-03, -4.196578737250878e-03, 5.542568132807830e-03, -5.129950695172880e-03,  1.695973935016294e-01, -2.520085683642304e-02, 6.890222949413036e-03, 7.309539574270635e-03, -7.668562239572969e-03, 1.472158642714555e-02, 3.301299067495924e-03, -1.191841976963075e-02,  1.076827064714705e-02, -3.433373805773297e-03, -4.611316611223234e-03, -2.993401632828017e-02,  1.902651638869565e-01, 6.117801315562027e-04, -5.250255893919343e-04, -7.899075854526295e-03, -8.447477272383604e-03, -8.799483515206652e-04, 8.418473677265155e-03, -1.003898589224658e-02,  2.887693257315150e-02, -6.517041748624523e-03, 7.136589774415565e-03, -2.346796925291670e-04,  1.838909272539336e-01, -9.213570989925205e-03, -1.733355631325497e-02, -1.629107360990520e-04,  2.571874934926882e-02, 1.869470306304847e-02, 1.551429767206853e-02, -1.799076796955048e-02,  2.658590490589428e-03, 5.535812005828214e-03, -4.723751688092397e-03, -9.304643846831454e-03,  1.569245449316233e-01, 9.462458891751360e-03, -8.688623179933061e-03, -7.803589222618455e-03, -8.921533971777265e-03, -5.587913301585525e-03, -1.063386617673936e-02, 2.829977217201826e-03, -2.815721467874292e-03, -2.175818521633115e-03, -1.243899147325237e-02, 4.402276355935222e-03,  1.719529317647522e-01, 1.236795865143146e-02, -1.982531173171680e-02, -1.236279468410642e-02, -3.912664723713717e-03, -2.915965177623818e-03, -1.606218450864516e-03, 9.247163478852134e-03, -1.124687985452444e-02, 1.762452725553552e-04, -1.957238385062635e-03, 9.022425832688183e-03,  1.995740133962330e-01, -1.991858492004373e-02, -4.735023815454945e-03, 1.732085944569702e-02,  2.030232795554711e-02, -7.810930808454571e-04, 6.758630760376879e-03, -2.873282960616143e-03,  2.195772814268337e-02, -1.149592691620847e-02, -2.003033570914894e-02, -2.281009425674872e-02,  2.360723451500373e-01, 2.741504805277652e-02, -3.287988740822031e-03, -3.711853589457373e-04, -9.066918756634346e-03, -2.631291051585100e-03, 7.683227315494805e-03, 1.548527445030907e-02, -2.106194371612527e-02, -7.027802020734761e-04, -1.215933092004692e-02, 2.467122734915710e-02,  2.119271891463860e-01, 1.001209730182286e-02, -1.987898070804009e-02, -4.505861405321082e-03,  1.170637237433295e-02, -1.027978365582152e-02, 1.370973053477051e-02, -4.614544249176613e-03, -4.049910041322137e-03, 1.908991586362425e-02, -6.248083099133647e-03, 8.075223603380831e-03,  2.245836820579034e-01, 8.824689919285203e-02, 1.980176325243094e-02, -1.755850954827092e-03,  1.753163891882147e-04, 1.780559790567835e-02, -9.477467067307848e-03, -5.670371452902447e-03,  2.509976815132175e-04, 5.257170789345914e-03, -1.193426323528749e-02, -2.571218969808724e-02,  1.703852926945064e-02, 1.652822621949916e-01, -7.665556031066316e-03, -2.640450891877139e-03, -4.800563159700064e-03, 5.895233174497225e-03, -2.859899009792775e-03, 3.071405454920137e-03, -1.010477007956921e-03, -1.099843177900646e-02, -3.336855228913443e-03, 1.080148395273489e-03, -6.572641448971918e-03, 1.320106429435701e-01, -1.849222426475887e-02, 6.162384471463554e-03,  8.137226182200523e-03, -8.021523568720157e-03, 1.229836667537280e-02, 4.634892947057356e-03, -6.413546029050983e-03, 7.426010231480124e-03, -7.733047265352441e-04, -2.882222749867071e-03, -2.102282617945512e-02, 1.620015094801719e-01, 1.652875320734381e-03, 1.555755766352591e-03, -1.117202814489459e-02, -3.890071995816945e-03, -1.030531664396291e-03, 2.293854631825905e-03, -7.769319990318825e-03, 2.350645453454650e-02, -3.826550508788930e-03, 3.061731222813325e-03,  3.175517665251492e-03, 1.621831632022143e-01, -3.620118639493363e-03, -2.460905078852611e-02,  4.660911846320098e-03, 2.713203791336735e-02, 1.166381880248923e-02, 1.361956295841230e-02, -1.243640288276877e-02, 5.486548342957671e-03, 3.425875876166606e-03, 2.302225225045609e-03, -6.350908496005198e-03, 1.327795703765219e-01, 3.843725696704853e-04, 1.158141718963501e-04, -8.458652471560900e-03, -1.766053269087138e-02, -3.577503748324181e-03, -1.210572540831555e-02, -4.356249450066282e-03, 3.381563094307708e-03, -1.486491156191379e-02, -2.164987608699629e-02, -4.523439365534503e-03, 1.740284884460978e-01, -7.781598942978404e-03, -2.343614935905791e-02,  1.014913638256262e-02, -4.282651441387082e-03, -1.979637192827215e-03, 3.905868347011785e-03,  4.204097018850092e-03, -1.651105319106096e-03, 9.018077389803883e-04, 5.419292734672974e-03, -6.935452746500925e-03, 1.862893597118924e-01, -2.154937086488145e-02, -2.496104812562381e-02,  1.468712254749117e-02, 1.707372456716765e-02, 1.271608770098236e-04, 2.782045242357535e-03,  5.028352051379067e-04, 2.923243620233248e-02, -7.769395184426172e-03, -2.772629223182579e-02, -1.687643670945826e-02, 2.167517486592283e-01, 2.687352578315736e-02, -2.830293582907713e-03, -4.431826776628504e-03, -1.038696218828751e-02, -3.722959565502500e-03, 3.348339083422897e-03,  1.637584641199814e-02, -1.685592683452521e-02, 9.581277331475666e-05, -1.753779421338198e-02,  3.040384691287786e-02, 1.951325948143079e-01, 7.427805487607138e-03, -2.135220447335257e-02, -2.842318680100271e-03, 6.779677638563068e-03, -6.913333839645416e-03, 1.498145936201559e-02, -7.530380570906158e-04, -1.010157586712418e-02, 1.916484821343614e-02, -2.335970438886696e-03,  4.776738737854384e-03, 1.970293862283747e-01, 6.653500217551486e-02, 1.892846723536111e-02, -3.719302120420688e-03, 1.261281253852514e-03, 1.487529072119963e-02, -6.909326075855063e-03, -6.485640438230780e-03, -1.991346144545182e-04, 5.170508479850632e-03, -1.263426359217436e-02, -2.532414100557295e-02, 1.764211103624234e-02, 1.440334962272992e-01, -8.452655329323239e-03, -1.598056385024881e-03, -4.960759979590310e-03, 6.459717097708361e-03, -2.502931334504872e-03,  4.411424956331683e-03, -3.429917646265252e-03, -1.227259035695927e-02, -4.788749039457522e-03, -1.838915159435983e-03, -7.606156246626328e-03, 1.091580985185805e-01, -1.679019704941547e-02,  3.099453800855698e-03, 4.000103339893889e-03, -9.526402381216034e-04, 5.883604665342032e-03,  3.287965911882782e-03, -4.376478962253141e-03, 6.601701482213597e-03, 3.215804212759633e-04, -1.494012633538601e-03, -2.047272863247235e-02, 1.423287331445081e-01, 4.288791532500166e-03,  8.290147326753448e-03, -2.301565064489566e-02, 4.609577362835106e-03, 1.874537115932530e-03, -2.171365075662028e-03, -6.933371012512347e-03, 1.820164398728411e-02, -4.756038550183760e-03,  5.683775687414048e-04, 5.264944164354492e-03, 1.459554311217628e-01, 2.106992437867501e-03, -3.761973769318883e-02, 9.469887007821951e-03, 3.470269686405954e-02, 1.017006021234584e-02,  1.515032594862423e-02, -8.498386120381040e-03, 6.210140401041293e-03, 1.109847096133664e-03,  6.074100983418872e-03, -1.417380190492372e-04, 1.212370432184267e-01, -1.600777409759711e-02,  1.406670497548819e-02, -6.571891740016359e-03, -2.113769687873634e-02,
                  -4.109662083679917e-04, -1.076734106798998e-02, -1.885760394478441e-03, 3.419954451469892e-03, -1.959370109152167e-02, -3.469847168375310e-02, -1.516822470199240e-02, 1.963964927207169e-01, -2.561180270920218e-02, -4.463222574222631e-02, 9.208887789559379e-03, -1.274427423694217e-02, -7.015938614343847e-04,  4.258856068255129e-03, 2.573829685645616e-03, 1.928242499219387e-03, 6.751807614334932e-03,  1.461705248410919e-02, -2.686846461356572e-02, 1.805856038426999e-01, -1.728692868677724e-02, -3.082422333961003e-02, 1.750100355155558e-02, 1.167884572577419e-02, -3.418404978655404e-03,  1.941446163085764e-03, 3.178518532676774e-03, 3.568274149590145e-02, -5.875352870743132e-03, -4.567307096503153e-02, -1.561394152701772e-02, 2.116154432786169e-01, 3.213361184853578e-02,  2.096800813544282e-03, -9.183752081238804e-03, -1.196687918901595e-02, -2.287134786166132e-03,  7.760954889639315e-04, 1.244620403992922e-02, -2.102072816624245e-02, 9.934837367791457e-03, -3.014069343496235e-02, 3.283907445056228e-02, 1.787228230398467e-01, 5.842607867862568e-03, -2.327618752689831e-02, -4.634740149249708e-03, 6.876151092505462e-03, -6.739881323474374e-03,  1.502666991288704e-02, 7.616296903781485e-04, -1.303794854361515e-02, 1.903435399645205e-02,  6.814557113394095e-04, 4.763794858435231e-03, 1.763013383876245e-01, 5.077497104667124e-02,  1.785125676022159e-02, -2.717416075652308e-03, -8.217103663922011e-05, 1.033410086042393e-02, -7.522994216244893e-03, 4.107940251328306e-04, -3.579380764069520e-03, 1.628059458605152e-03, -1.172264643643309e-02, -2.525848605666208e-02, 1.768554555265747e-02, 1.220461607712381e-01, -7.865936518380835e-03, -6.809017171951239e-04, -3.843166341512562e-03, 3.881090965312812e-03,  4.820529144272254e-04, 1.605782904501858e-03, -2.551604353644211e-03, -9.183680222390831e-03, -5.524451621475565e-03, -2.676463913808377e-03, -7.659636604496480e-03, 8.616583009944971e-02, -1.389159455503364e-02, 2.728153319693746e-03, 7.030635331685135e-03, -1.045348861863117e-02,  9.872389083933775e-03, 4.774319579883303e-03, -6.842048241001774e-03, 6.498440637578305e-03,  6.892984531230075e-06, -8.990391215509385e-04, -1.409357079158579e-02, 1.197292961087316e-01,  2.698183792648945e-03, 4.872968533408881e-03, -1.257265010791962e-02, 3.572102490497406e-04,  1.566348288957811e-04, 6.724769188235349e-04, -6.708840581685452e-03, 1.136491897132049e-02, -3.547418354998115e-03, 1.165558874119703e-03, 3.754859654958881e-03, 1.227807828070727e-01,  2.933255320265806e-03, -2.930001001138446e-02, 6.949836279738625e-03, 2.808252721995064e-02,  7.486295139084958e-03, 1.146403411530738e-02, -6.141368276853357e-03, 4.621015119392283e-03,  5.826172354158929e-03, 5.836907806890571e-03, 2.306371924481430e-03, 9.946609956900807e-02, -7.098342577520071e-03, 7.376191242195677e-03, -3.925010392332349e-03, -1.329446776674572e-02,  1.412801462979080e-03, -4.170877271724272e-03, -5.542852735302701e-04, -6.263643102435688e-03, -1.597930441133856e-02, -3.034086049143791e-02, -7.812222604694528e-03, 1.603866604122650e-01, -1.427407826125073e-02, -4.143367705518324e-02, 1.781008166763260e-03, -1.100670559781381e-02, -2.329996231843704e-03, 2.789119629233838e-03, 8.581850484376260e-03, 1.192141208193127e-03,  5.183631233294158e-03, 6.755436017222931e-03, -1.023730238077919e-02, 1.486097848858300e-01, -1.578027423673892e-02, -2.172124321561948e-02, 1.651089599108436e-02, 3.935647529290584e-03, -2.468214664291755e-03, 1.696670478704801e-03, 2.525204482372877e-03, 3.025063844438076e-02, -1.321833179271448e-03, -4.498178460160998e-02, -1.005655920168026e-02, 1.802968013799900e-01,  2.324847886301866e-02, -2.679923336662768e-04, -1.351816099965424e-02, -9.371360550738870e-03, -6.854804075762760e-03, 2.851778176626634e-04, 7.442854388242629e-03, -1.146678405683952e-02,  1.035671442734063e-03, -1.996047734670026e-02, 2.327150384928900e-02, 1.442672704766725e-01,  2.534905005188492e-03, -2.583907011444921e-02, -5.126955947104363e-03, 6.672738116343916e-03, -7.209568120058701e-03, 1.004353407302152e-02, 1.547921674846592e-03, -7.502473459970850e-03,  1.687517433878645e-02, -4.031103200376668e-03, 2.262065726346740e-03, 1.524566646984200e-01,  4.075846751458613e-02, 1.593581195672358e-02, -8.853671248102348e-04, -1.351253589453127e-03,  6.337782132364887e-03, -9.722975918092843e-03, 7.788653609547194e-03, -9.664765653842529e-03,  3.604792034864156e-04, -8.451033578285951e-03, -2.509275591546844e-02, 1.532269708808145e-02,  1.018356813186196e-01, -7.590339820701782e-03, -1.704553787322885e-04, -3.904796571180552e-03,  3.215845199921126e-03, 3.042131268288902e-03, 6.867664367058834e-04, -4.874818643713367e-03, -8.746885989023628e-03, -7.007996580505289e-03, -2.663637152493695e-03, -7.112253808966212e-03,  7.088510365426183e-02, -1.133586642330755e-02, 1.215896231106995e-03, 6.796267937714741e-03, -9.208072729223860e-03, 8.534294968887003e-03, 3.026578616233447e-03, -6.035569438050229e-03,  5.541213613369148e-03, 3.556848890909573e-04, -4.414647886759769e-04, -1.138896989378916e-02,  9.962696151133335e-02, 2.897101076152903e-03, 3.335411685146264e-03, -1.118811243576033e-02, -1.238445876518407e-04, 2.136468696735370e-03, 1.526846785466884e-03, -5.472285998968249e-03,  7.511735843133173e-03, -2.951786862520396e-03, 2.036596627173391e-03, 1.801028958144269e-03,  1.015244498518072e-01, 1.388147867394790e-03, -2.153731884642624e-02, 1.846296593273257e-03,  2.420233926923733e-02, 6.671391198220867e-03, 6.925298427943389e-03, -7.496276333858158e-03,  3.793410144526489e-03, 4.621920903726371e-03, 4.654439458663704e-03, 2.461944914271657e-03,  8.909016833919257e-02, -1.062651190538680e-02, 9.679048748317138e-03, -3.323942715148547e-03, -1.491943611140329e-02, 1.058428054810038e-03, 1.694401917937294e-03, 9.978263456009969e-04, -8.516817301684410e-03, -1.082238366681884e-02, -2.457122005349860e-02, -8.114083792869556e-03,  1.411882863000796e-01, -9.644389292400198e-03, -4.045636700950754e-02, 2.047005834215517e-03, -5.796197233730331e-03, -6.989991876127272e-03, 1.554243500833271e-03, 6.598930706491937e-03,  8.300325851479473e-04, 2.599630697041585e-03, 7.685658997448186e-03, -8.889615504197427e-03,  1.274835675599888e-01, -1.407946398921167e-02, -2.018282405414788e-02, 1.307211700490555e-02,  2.866093317643370e-03, -3.554759285875280e-03, 4.825618403015113e-03, 2.040922387576798e-04,  2.567915289249291e-02, -3.204093104282505e-03, -3.957442888861037e-02, -1.264801946275200e-02,  1.547316391091328e-01, 2.019995540645137e-02, -2.048976389823036e-03, -1.003663099921857e-02, -8.470018818359182e-03, -3.778852224436312e-03, -1.787025015262322e-04, 6.164894644251914e-03, -1.205398179510387e-02, 1.472802986279840e-03, -1.852442439489961e-02, 1.923287652834258e-02,  1.196534447611031e-01, 2.649079567514687e-03, -2.468515141698246e-02, -6.474257194816256e-03,  4.826746407562464e-03, -5.135410093747797e-03, 7.288114858937406e-03, 1.870468602203456e-03, -6.644829963658099e-03, 1.416725127438189e-02, -2.692069693490303e-03, 1.753247935827196e-03,  1.287759168939369e-01, 3.160631755242820e-02, 1.255717798725525e-02, 3.121952858493250e-03, -3.952771154464690e-03, 8.091608404962453e-04, -1.705718747865261e-02, 2.383586105998423e-02, -2.120344026904776e-02, -1.599322799708968e-03,
                  1.516304092778834e-03, -2.299067620332712e-02,  1.370858663179207e-02, 8.043865645043184e-02, -4.438213254072723e-03, -1.057883947815586e-03, -3.569303429494244e-03, -1.104126247657858e-04, 7.913733465932292e-03, -3.167550411696547e-03, -5.331949186727088e-03, -4.920092675622570e-03, -7.361566006903874e-03, -1.392790452516866e-03, -6.740791067425327e-03, 6.022336425366209e-02, -1.131670468742456e-02, 4.781150731080735e-04,  4.593877464832245e-04, -1.532919538348235e-03, 2.052882665675073e-04, 4.481957854377241e-03,  2.310723732088821e-03, 3.600568171194910e-03, -1.445637111177173e-03, 2.517912130693813e-04, -8.959004258509392e-03, 7.908850543595609e-02, 3.361644849899726e-04, 2.327612691213793e-03, -5.857438632998460e-03, -1.717166997937997e-04, -1.250222354362573e-03, -2.945562677878644e-04, -3.767554828094625e-03, 1.184080900407951e-03, -3.037106960621867e-03, 3.547341303030551e-03, -6.691955010976432e-04, 7.685076242281776e-02, -3.080841207669898e-03, -4.043870023356488e-03, -6.712461553093358e-03, 1.438056041241167e-02, 8.497996660279243e-03, 3.269126735337232e-03, -1.111286377247199e-02, 3.253394516156515e-03, 3.921621423992550e-03, 2.633868011204570e-03, -9.616679125929077e-04, 7.845797249386383e-02, -7.641990685664664e-03, 1.016290345648610e-02, -8.553870195385782e-03, -1.595055755455504e-02, 4.590668448732817e-04, 1.454160615919955e-02,  2.772685042641507e-03, -8.674001985098007e-03, -6.660834345657361e-03, -9.331089685319625e-03, -6.734581105521819e-03, 1.017775849797566e-01, -1.897678826350764e-03, -2.048298600856480e-02,  1.053021565191693e-03, -1.964164914611684e-03, -1.556016937759132e-02, 9.179682775112205e-04,  5.548742521664365e-03, -6.276610699230961e-04, -5.840923455047996e-03, 7.286968310916716e-03,  3.982526488229270e-03, 1.011124605777757e-01, -2.091715036431157e-02, -1.670801404672610e-02,  7.631610590285109e-03, -3.109843765032634e-03, -5.436114523999157e-03, 7.115463877132236e-03, -2.371957570779694e-03, 1.384052258896110e-02, -9.158753810706667e-03, -1.463488840423758e-02, -1.892513532671579e-02, 1.131166815860789e-01, 1.896398868525789e-02, -2.033718576583905e-03, -4.652515084720974e-03, -7.612862911060537e-03, -2.310458905798098e-03, 2.671560166331204e-04,  7.457903147630190e-03, -1.014171833377367e-02, -5.249107662159497e-03, -1.166414509464769e-02,  1.761654250608653e-02, 9.116684435894103e-02, 4.186390027138554e-03, -2.471052138100326e-02, -7.592582333632403e-03, 4.553422748232307e-03, -4.564026608485334e-03, 1.800512790393845e-03, -1.626826140493578e-03, 3.742904222618020e-03, 5.173309881491945e-03, -3.840195838175123e-03,  5.519215512354277e-03, 1.025262897013285e-01, 2.588801219018652e-02, 1.034359721127777e-02,  3.033101052708243e-03, -4.158391579615070e-03, -1.078730060761795e-03, -1.649826644666450e-02,  2.503554448480855e-02, -2.183933317898187e-02, -3.629416880145297e-03, 3.725292722790656e-03, -2.000334008282085e-02, 1.103446976162334e-02, 6.230424430771722e-02, -4.478889551208134e-03, -2.818651521942577e-04, -2.043871882904994e-03, 1.016975318885992e-03, 3.558883364179352e-03, -1.671250843674400e-03, -2.371341897898649e-03, -5.403521009254141e-03, -6.751387933575582e-03,  1.598702843957532e-03, -3.931687610863450e-03, 5.192209298311899e-02, -1.039320140864038e-02,  8.542717392635072e-04, -1.255003635231605e-03, 2.161065203700734e-03, -1.225972740876424e-03,  3.817682641407485e-03, 3.305609138109496e-03, 3.636585294021749e-03, -3.702254517196905e-03, -6.055771420986423e-04, -1.033274367345108e-02, 6.289158963021275e-02, -1.383813042514570e-03,  2.499518668872236e-03, -5.195178498703144e-03, 1.076837358363518e-04, -3.208125679415456e-03, -2.288012299900297e-03, -3.942831500202918e-03, -3.863640130879228e-04, -2.962505238268907e-03,  2.197005449173587e-03, -1.488496661627541e-03, 5.908268309611114e-02, -3.537823704301615e-03, -1.000261720022933e-03, -9.817918466492451e-03, 1.077088228148104e-02, 8.997322227886165e-03,  5.807993398957521e-04, -1.529221825580334e-02, 3.466119345419140e-04, -1.291620048063217e-03,  2.299314039516923e-03, -2.567069269163945e-03, 6.786187687753578e-02, -9.371509968827874e-03,  1.041372013884405e-02, -9.422196390282906e-03, -1.341428635853234e-02, -1.429474216733736e-03,  2.301494087541435e-02, 5.553001455753780e-03, 1.081723526086618e-03, -5.547487807135920e-03, -1.577442636286522e-03, -9.324013612282061e-03, 8.521509400439695e-02, -6.048662536511928e-05, -8.922426352070575e-03, -2.578403174845201e-05, 4.294625699257077e-03, -1.932953982702553e-02, -2.449662195212804e-03, -1.845177773603492e-03, 6.858742980174661e-04, -6.757872331443326e-03,  1.197863639765601e-02, -5.161118596753994e-03, 8.554000275075178e-02, -1.747129566316370e-02, -1.415410382497826e-02, 4.101437458347938e-03, -3.531634546782476e-03, -3.130325347017494e-03,  3.711316429427176e-03, -1.705759405128044e-03, 9.780218360959100e-03, -7.372259485864307e-03, -1.165466249217486e-02, -1.739184134497793e-02, 8.415387716676728e-02, 1.344642564307458e-02, -3.592539284132153e-03, 3.069890619610702e-03, -5.010559311632746e-03, 3.686430975789948e-03, -1.871615973444971e-03, 8.390858201268534e-03, -1.265844567347853e-02, -2.186152974997625e-03, -1.231862528660208e-02, 1.691113486889289e-02, 7.056016372705871e-02, 5.852915880770799e-03, -2.007533963169697e-02, -6.594641642455631e-03, 2.921651805350502e-03, -3.052083416663524e-03,  9.114002929840252e-04, 2.850417908446534e-04, 1.274548975295237e-03, 5.382290307166540e-03, -3.107603149118587e-03, 3.872283557678754e-03, 7.982119443736665e-02, 2.117483917605405e-02,  7.178921910835225e-03, 4.543765505469112e-03, -5.062983326509953e-03, -3.940110543131639e-04, -1.692339274530148e-02, 2.478679471732263e-02, -2.010063835464874e-02, -2.077445263190101e-03,  8.241522155207421e-03, -1.386355983854656e-02, 7.088032612326777e-03, 4.810135067896708e-02, -3.780931318504976e-03, -2.206548717020641e-04, -2.795014058813633e-03, 1.570340794746559e-03,  2.784928055649772e-03, -1.034197448107763e-03, -2.611001043697693e-03, -6.554102859248373e-03, -6.106031373448367e-03, 2.980326092513464e-03, -4.105921950861112e-03, 4.483463907250396e-02, -1.199553841251035e-02, 8.422257396699213e-04, -4.219000034705375e-03, 6.650363244798922e-03, -4.925843538765447e-03, 2.422545897167815e-03, 6.111735599043317e-03, 3.605934338166888e-03, -4.009819043754538e-03, 1.090812775156147e-04, -1.220780746442649e-02, 5.165349721392627e-02, -9.682221948472489e-04, 3.607932288681157e-03, -7.168519259899250e-03, 1.987403933005498e-03, -1.325046541699766e-03, -3.837014798484967e-03, -3.620250000228586e-03, -4.064190448181230e-04, -1.919540039452187e-03, 4.134116526225556e-04, -7.579818525040903e-04, 4.488520575854212e-02, -3.017800781289165e-03, -1.098337441969750e-03, -6.418580306337395e-03, 9.831392840843315e-03,  8.149899012227735e-03, 5.309706196315857e-04, -1.527657360453553e-02, 2.319882696026719e-03, -4.198848991926470e-03, 3.599065704981245e-03, -4.085975800321180e-03, 5.923490057126408e-02, -1.218136392648567e-02, 1.577215900350796e-02, -9.927582836428653e-03, -1.880685398713914e-02, -1.510517698384721e-03, 2.221176275289160e-02, 8.439538162721104e-04, 5.191932969197887e-03, -6.080921636476621e-03, -9.958235640540082e-06, -1.101461783811818e-02, 7.138034164103434e-02, -6.699783285274539e-03,
                  -9.393818562386892e-03, 3.376460725268432e-03, 2.976532708081992e-03, -1.794696984348846e-02, -3.931674133484716e-04, -3.855125800062276e-03, 1.435513176818064e-03, -7.408252219866851e-03, 1.401520241446124e-02, -6.423608525458892e-03, 7.280774386552337e-02, -1.652270513876071e-02, -1.639935599712819e-02, 4.988617526318193e-03, -2.376645815666814e-03, -1.511042683998387e-03, 2.547806586159768e-03, -1.643262129712762e-03, 1.034546106858359e-02, -8.929708778818976e-03, -9.616616220099655e-03, -1.637051194355945e-02, 7.038567202659619e-02,  1.655327026796896e-02, -2.547883139957342e-03, 6.924165590234134e-03, -6.957743663944119e-03,  5.416934571178224e-03, -3.358103648639457e-03, 1.018496860200423e-02, -1.709604701156820e-02,  1.351380035909337e-03, -1.627106785957333e-02, 1.831639738951543e-02, 6.273467075223516e-02,  5.930727495600857e-03, -1.335098985216260e-02, -5.713319917760829e-03, 1.838450727962683e-03, -2.049896993674770e-03, 2.331351967595543e-03, 1.178795156889779e-03, -2.989505737441379e-03,  8.132682965942155e-03, -6.790998054858059e-04, 3.468647334304061e-03, 6.086260605634045e-02,  1.302677955053817e-02, 3.559027230795733e-03, 3.813729106017987e-03, -3.841204090485478e-03, -8.057020886983830e-04, -1.142757627127641e-02, 1.750582570941515e-02, -1.290574544405079e-02, -2.201529445129725e-03, 6.489205485318763e-03, -7.024762320713147e-03, 3.644981885593968e-03,  2.953014187764835e-02, -3.118458414787886e-03, 4.151913501634474e-04, -1.294726534824859e-03,  1.733470462714519e-03, -1.954875607334955e-04, -8.176792825680471e-05, -1.090765906790771e-03, -4.698562091591665e-03, -4.042581913790958e-03, 3.702821495479736e-03, -3.058486344550358e-03,  3.187479388274545e-02, -1.109513662741786e-02, -3.080791534845325e-04, -4.722030021395190e-03,  7.140968640741516e-03, -5.169118991459394e-03, 1.811391361352697e-03, 5.197679572475078e-03,  2.627619025162955e-03, -3.605064085156765e-03, 2.322367004441057e-04, -1.108660645179784e-02,  3.479467995093065e-02, 3.069333000552310e-04, 3.025204391370157e-03, -6.117784219307101e-03,  1.748705077788894e-03, -9.185933881144148e-05, -2.068714583863433e-03, -2.484850101459470e-03, -4.788003645331152e-04, -1.311070220903061e-03, -1.107006799939853e-03, 8.085698646444956e-04,  2.714337562034434e-02, -1.774078310043248e-03, -1.989959907032586e-03, -2.436644209394880e-03,  6.246913929694162e-03, 4.887183972127770e-03, 9.414854485060863e-04, -1.091869588528782e-02,  1.698294751380328e-03, -4.611265749540294e-03, 3.443512553972257e-03, -2.164503109527360e-03,  3.982089072131263e-02, -1.132180197852693e-02, 1.202482280501432e-02, -6.391160895108705e-03, -1.507968900570769e-02, -5.008796769190964e-04, 1.645975341135363e-02, 3.282785278040795e-06,  7.697229515581929e-03, -6.834038581477715e-03, -1.014692071386950e-03, -1.111945652499383e-02,  4.930530782208491e-02, -7.080555007049780e-03, -6.534329280107727e-03, 5.197155591014782e-03, -2.178655953656919e-05, -1.181662542404563e-02, -3.647659861161726e-04, -5.050343971642098e-03,  2.413990604960164e-03, -2.300641616622277e-03, 1.137389883198055e-02, -7.823530881598588e-03,  4.609538891988227e-02, -9.625338260454568e-03, -1.104767647607313e-02, 5.396963758011700e-03, -1.694980091413351e-03, -1.328111569380216e-03, 1.328236292202082e-03, -1.581133076669527e-04,  6.130694004018363e-03, -6.790142688078318e-03, -6.333712171716093e-03, -1.157266608497074e-02,  4.499341750076030e-02, 1.181808989420255e-02, -8.822432235938912e-04, 5.542340545525028e-03, -4.598285156162398e-03, 4.811563246932040e-03, -2.573377252353020e-03, 4.588417476652049e-03, -1.518737175659850e-02, 6.631295763818911e-03, -1.247873429997104e-02, 1.025081452805044e-02,  4.196307325529618e-02, 2.991877026957621e-03, -6.675516685210742e-03, -4.084797020234846e-03,  2.398704591286684e-03, -2.253282800681608e-03, 1.485376771324700e-03, -3.745201972024208e-04, -1.207208227141539e-03, 5.399992408692204e-03, -3.526608516775387e-05, 3.405326212546392e-03,  3.686614584941167e-02, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(8 ))

  expect_equal(c(result_exp$Q),
               c( 0.0811992854821780713, -0.0148668281818819213, 0.0099290865036286077, 0.0023131140245354828,  0.0740493074082670122, -0.0256073453329111397, -0.0939248100003835101, -0.0100217815894890934,  0.1303912648411176822, 0.0553664333234564487, 0.0234806372658790397, -0.0148668281818819213,  0.0682758568253712256, -0.0551887276396524976, 0.0334390723056329220, -0.0088703266721802867,  0.0841712043080526523, -0.0888898238788539130, 0.0921499776273114884, -0.0442689223313546959, -0.1045289187933932662, -0.0221905051966314812, 0.0099290865036286077, -0.0551887276396524976,  0.3082280214599897317, -0.1998655443020427303, -0.0684191759192388504, -0.3183567196669809807,  0.5190899432716367112, -0.3765390657265438312, 0.0009554541368762548, 0.3228105125106952022,  0.0405070532056580543, 0.0023131140245354828, 0.0334390723056329220, -0.1998655443020427303,  0.1917165485242241507, 0.0636019223837986508, 0.2204404656359877368, -0.3916171190659756274,  0.2609826711342447814, 0.0297241735666343675, -0.2141027910515223009, -0.0257337528579460670,  0.0740493074082670122, -0.0088703266721802867, -0.0684191759192388504, 0.0636019223837986508,  0.1608537579173855703, 0.0813946645531395535, -0.3095106002303836257, 0.1236344398544931139,  0.1770282788082973568, -0.0335472227764328224, 0.0333338657730489138, -0.0256073453329111397,  0.0841712043080526523, -0.3183567196669809807, 0.2204404656359877368, 0.0813946645531395535,  0.5363570195702834775, -0.7361969896131728142, 0.5889783691159743428, -0.0593001377972292854, -0.5255370236614586021, -0.0377091476759182920, -0.0939248100003835101, -0.0888898238788539130,  0.5190899432716367112, -0.3916171190659756274, -0.3095106002303836257, -0.7361969896131728142,  1.4870045041910768813, -0.9113671781458930754, -0.2594636382706518862, 0.6830105438009645979, -0.0043162867494282052, -0.0100217815894890934, 0.0921499776273114884, -0.3765390657265438312,  0.2609826711342447814, 0.1236344398544931139, 0.5889783691159743428, -0.9113671781458930754,  0.7899794831497310987, -0.0621938420291714145, -0.6178464002256438548, -0.0120629953698368174,  0.1303912648411176822, -0.0442689223313546959, 0.0009554541368762548, 0.0297241735666343675,  0.1770282788082973568, -0.0593001377972292854, -0.2594636382706518862, -0.0621938420291714145,  0.4213441153980430620, 0.1620983025938859123, 0.0519403388721186299, 0.0553664333234564487, -0.1045289187933932662, 0.3228105125106952022, -0.2141027910515223009, -0.0335472227764328224, -0.5255370236614586021, 0.6830105438009645979, -0.6178464002256438548, 0.1620983025938859123,  0.6293213887977419096, 0.0586891250749007470, 0.0234806372658790397, -0.0221905051966314812,  0.0405070532056580543, -0.0257337528579460670, 0.0333338657730489138, -0.0377091476759182920, -0.0043162867494282052, -0.0120629953698368174, 0.0519403388721186299, 0.0586891250749007470,  0.0854930775169358004 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 ))

  expect_equal(c(result_exp$n_risk),
               c(2052, 1893, 1887, 1886, 1877, 1702, 1594, 1438, 1239, 1112 ))

  expect_equal(c(result_exp$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ))

  expect_equal(c(result_exp$risk_set),
               c(NULL ))

  expect_equal(c(result_exp$data),
               c(NULL ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("UKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(1 ))
})
