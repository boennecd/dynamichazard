if(interactive()){
  library(survival); library(dynamichazard); library(testthat)
  source("C:/Users/boennecd/Dropbox/skole_backup/phd/dynamichazard/R/test_utils.R")
} else
  options(warn = -1)

# Test on data set that is one of Farhmiers papers
result = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1, # Use by month intervals
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4),
  a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
  max_T = 45,
  id = head_neck_cancer$id, order = 1
)

# plot(result, cov_index = 1)
# get_expect_equal(result, file = "tmp.txt")

test_that("Testing previous computed values vs. current on head and neck cancer set assuming that the previous is correct", {
  expect_equal(c(result$state_vecs),
               c(-3.5045064165490518, -3.5045656499164295, -3.1329979343435461, -2.7762813620346121, -2.4920444550244687, -2.0475180974079015, -2.1188049966993696, -2.5082342056716649, -2.7400547989246267, -2.8849282879973148, -3.0253327692106984, -3.2406977640747754, -3.3657522145691128, -3.4217728641562681, -3.2739452065172792, -3.3169520925442670, -3.4384370809821552, -3.5426921460127447, -3.5025053437910434, -3.5883353594935170, -3.5579940746115737, -3.6815422153090513, -3.8600459984612017, -3.9790677778298500, -4.0362876817800135, -4.1737949093221500, -4.2663243629831635, -4.3146884533943091, -4.4617089602371571, -4.5811903147914004, -4.6725556962586463, -4.7359352412761311, -4.7714262957243081, -4.7789372894227720, -4.7581748229597807, -4.7086665843191895, -4.6297901735810880, -4.5207994729812713, -4.5209273736810847, -4.6295543473960477, -4.7237081990042649, -4.8005546281779816, -4.8594330723345767, -4.9032101303250126, -4.9320276910045253, -4.9459427144095427, 0.4622523023291275, 0.4622626844924319, 0.4652397589717921,  0.4740783791640956, 0.4672612377158187, 0.4836163262469676, 0.4896990261561225, 0.4863002013615905, 0.5055099547472884, 0.5138992180545477,  0.5195462743890488, 0.5209216389305817, 0.5293995373114516, 0.5447016176064285, 0.5624431287164163, 0.5625250853546695, 0.5619030953182752,  0.5668602203025682, 0.5730242083044264, 0.5781903092189493, 0.5842840398250273, 0.5778996254763145, 0.5761554595155960, 0.5747261154704411,  0.5736150619753867, 0.5773179176988464, 0.5813942440473051, 0.5858804824738809, 0.5952548377211626, 0.6050755551710356, 0.6153047774686421,  0.6259131746245181, 0.6368787546941960, 0.6481852747490043, 0.6598209416049969, 0.6717774284058471, 0.6840491395803701, 0.6966326585520586,  0.7028701970602720, 0.7026435197664337, 0.7024823951448731, 0.7023874356412544, 0.7023576772999551, 0.7023282335255832, 0.7022983939049023,  0.7022677820270420 ))

  expect_equal(c(result$state_vars),
               c( 0.24971481604065104, -0.04845111114383468, -0.04845111114383471, 0.10639152831379761, 0.16311419016912762, -0.05259256270700222, -0.05259256270700224,  0.09789681170500669, 0.15310383223295043, -0.05151399097432499, -0.05151399097432502, 0.09101731796320917, 0.13479229477473645, -0.04918940147026213, -0.04918940147026213, 0.08466734962518582, 0.11552947419685949, -0.04715973326374917, -0.04715973326374917, 0.07906340925166372, 0.10170593315556586, -0.04265467240609434, -0.04265467240609433, 0.07464409218421481, 0.08283283204131768, -0.03958875342966766, -0.03958875342966766, 0.07143014093146663,  0.08574743237753379, -0.03839075515247545, -0.03839075515247545, 0.07064371539854651, 0.09988559962713089, -0.03821046226156710, -0.03821046226156710,  0.07178361577151676, 0.11294823941314228, -0.03883277749515560, -0.03883277749515561, 0.07395046643986163, 0.12372876096303355, -0.03967075418430188, -0.03967075418430188, 0.07678826005975414, 0.13471675164657299, -0.04049594614565687, -0.04049594614565687, 0.08016446211107395, 0.15055875539669883, -0.04160790267880037, -0.04160790267880037, 0.08400586430581332, 0.16472177593961668, -0.04304400781965888, -0.04304400781965888, 0.08808479982944045,  0.17645575575408801, -0.04459796396982182, -0.04459796396982182, 0.09231756249871856, 0.17448916690674271, -0.04613087848951326, -0.04613087848951326,  0.09654727397268645, 0.17718203800291171, -0.04779606323864612, -0.04779606323864612, 0.10106119664367978, 0.18769088622561772, -0.04973601409705623, -0.04973601409705623, 0.10594721243974012, 0.20213723093262348, -0.05184855724861329, -0.05184855724861329, 0.11114422128391810, 0.21041663267921473, -0.05400173185964625, -0.05400173185964624, 0.11649745709426079, 0.22134939039718360, -0.05628334296113834, -0.05628334296113834, 0.12211582796072129,  0.22493462219519089, -0.05859873851338071, -0.05859873851338071, 0.12787957175843259, 0.23551328640885347, -0.06146059220632962, -0.06146059220632962,  0.13398312811521065, 0.25314128225693611, -0.06455439434660187, -0.06455439434660187, 0.14044073932175916, 0.27076904865840157, -0.06781819924878714, -0.06781819924878714, 0.14713904387168714, 0.28433525497363610, -0.07123289371385615, -0.07123289371385615, 0.15400961367578436, 0.30294835012113436, -0.07487234429905440, -0.07487234429905440, 0.16115504760087240, 0.32016040142844482, -0.07848373195886876, -0.07848373195886876, 0.16849145170033528,  0.33314708270447457, -0.08208776164140788, -0.08208776164140788, 0.17597734496306500, 0.35286329198897837, -0.08568163592163081, -0.08568163592163081,  0.18374253693804946, 0.37536940434514132, -0.08926715170003868, -0.08926715170003868, 0.19172907098000486, 0.39873630901420842, -0.09283743440897779, -0.09283743440897779, 0.19989975627046705, 0.42178611638715935, -0.09638204834799534, -0.09638204834799534, 0.20822832732644378, 0.44361733758340671, -0.09988908333111086, -0.09988908333111086, 0.21669518969646151, 0.46339438509377351, -0.10334609693208163, -0.10334609693208163, 0.22528520655358666,  0.48023997913036814, -0.10674058641935472, -0.10674058641935472, 0.23398639917058323, 0.49317130060577541, -0.11006025940374116, -0.11006025940374116,  0.24278911803014888, 0.50105573489729149, -0.11329321873365431, -0.11329321873365431, 0.25168548221153902, 0.50172607734539709, -0.11631830554913909, -0.11631830554913909, 0.26066293360741083, 0.50678929708482690, -0.11934048900315548, -0.11934048900315548, 0.26986042363554874, 0.53530791125108756, -0.12262821748386488, -0.12262821748386488, 0.27950428218778706, 0.58183228951032062, -0.12605788915437280, -0.12605788915437280, 0.28951529241594171,  0.64601004887201596, -0.12955062384606128, -0.12955062384606128, 0.29984925590669426, 0.72461186953629142, -0.13339769709753874, -0.13339769709753874,  0.31041514122822839, 0.82102801119622204, -0.13755295184677210, -0.13755295184677210, 0.32120094422203299, 0.93944483420711966, -0.14198397121295389, -0.14198397121295389, 0.33219697935406944 ))

  expect_equal(c(result$lag_one_cor),
               c( 0.14247809998101518, -0.04562454466206545, -0.05137802355748031, 0.09661104516862873, 0.10431362943324185, -0.04861031163654034, -0.05074624825748811,  0.08896805870054486, 0.09184477343957012, -0.04743564248174101, -0.04837237729819202, 0.08237231450353649, 0.07601053577622742, -0.04523440016109591, -0.04610259157952361, 0.07641902858491645, 0.06272959197830691, -0.04314963214418981, -0.04149989910911214, 0.07143641724934291, 0.04976314071924333, -0.03916616402682748, -0.03796388995851814, 0.06764392356351839, 0.04412181515863559, -0.03676686921781388, -0.03617305844996195, 0.06566569856513924,  0.04957618738263997, -0.03610726607094485, -0.03558333714932022, 0.06583974493543014, 0.05977040559634353, -0.03627850990537859, -0.03594986614217178,  0.06748169847710267, 0.06933620537347324, -0.03710285749548425, -0.03665274888804125, 0.06997113416459577, 0.07835041829150659, -0.03807033153789197, -0.03741195048487035, 0.07306468068633712, 0.08971951983285176, -0.03901663691773311, -0.03845755873594103, 0.07666004173543133, 0.10299946280000147, -0.04022328696742932, -0.03983256037270591, 0.08060952649316513, 0.11472344003258168, -0.04171276859073255, -0.04135647882496760, 0.08475620286942620,  0.11929227532729340, -0.04329940686768807, -0.04286793534146173, 0.08898074017370550, 0.11967540016361046, -0.04488290770616960, -0.04448705764347778,  0.09334307202317987, 0.12568799875170755, -0.04662517968415156, -0.04635577675471133, 0.09803273950070884, 0.13717177867555602, -0.04863182306761198, -0.04841087627937196, 0.10306490538053203, 0.14787275866788996, -0.05078981599588300, -0.05052653767995336, 0.10833293871056307, 0.15688588300380527, -0.05299687476906442, -0.05275883302813247, 0.11381078752011181, 0.16381944021995298, -0.05532004348347869, -0.05503651955148272, 0.11949570041494442,  0.17051149493688239, -0.05773754566103760, -0.05778598536145362, 0.12542132497706640, 0.18385072540899211, -0.06067590518220634, -0.06079972229048869,  0.13169401330722136, 0.20073896438601183, -0.06383554630746020, -0.06399621816514178, 0.13826573627697758, 0.21582321355091066, -0.06715950643846504, -0.06734839553409373, 0.14504508730574223, 0.23131933064088409, -0.07064253158215336, -0.07091460605645269, 0.15204715886760278, 0.24872592002361732, -0.07432234658493433, -0.07448779301050570, 0.15928339919198167, 0.26347881361450842, -0.07797287647187855, -0.07805429107428290, 0.16669060905090019,  0.27935516487531376, -0.08161324395427487, -0.08161445490217697, 0.17431105697061813, 0.29995728123175835, -0.08524123058740807, -0.08517037467433741,  0.18218269157975328, 0.32242897694333783, -0.08885610101288860, -0.08871628145675733, 0.19025769757665478, 0.34523646505841404, -0.09245061048291603, -0.09224163126186219, 0.19850420429615567, 0.36734292418109626, -0.09601464025775200, -0.09573402310310439, 0.20689918554441644, 0.38787792059071813, -0.09953681717678085, -0.09918041114666822, 0.21542520575241722, 0.40598228901295108, -0.10300530125416135, -0.10256766158851258, 0.22406865406081064,  0.42072371232757272, -0.10640821139739171, -0.10588284283039759, 0.23281867490497415, 0.43104305315679342, -0.10973388919853261, -0.10911340663694469,  0.24166647006743927, 0.43529495773743460, -0.11295793488214806, -0.11215243995070286, 0.25060184368002730, 0.43813459195398868, -0.11600224349998906, -0.11515841556353090, 0.25968666926394418, 0.45454851714255162, -0.11908680839297911, -0.11838596957059258, 0.26910284377369931, 0.49138481513646687, -0.12241919814228926, -0.12177557663990653, 0.27892658589834357, 0.54588612234346912, -0.12587850632515779, -0.12524485231908417, 0.28909589138451325,  0.61648577322801246, -0.12942828014459670, -0.12903240981596598, 0.29954356460855475, 0.70313264063392933, -0.13332903190180437, -0.13313154049538278,  0.31021736361643093, 0.80959999753414891, -0.13753564955227368, -0.13750879820300663, 0.32110641441598070 ))

  expect_equal(c(result$order),
               c(1 ))

  expect_equal(c(result$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result$method),
               c("EKF" ))

  expect_equal(c(result$model),
               c("logit" ))

  expect_equal(c(result$est_Q_0),
               c(FALSE ))

  expect_equal(c(result$LR),
               c(1 ))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result$Q_0)), rep(c("(Intercept)", "group1"), 2))
})

suppressMessages(
  result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 1,
    a_0 = rep(0, 2), Q_0 = diag(1, 2),
    Q = diag(1e-3, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential"))

# matplot(result_exp$state_vecs, type = "l")
# plot(result_exp, cov_index = 1)
# get_expect_equal(result_exp, file = "tmp.txt")

test_that("Result of exponential model on head_neck_data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.746423060135996685, -3.746504060013073900, -3.411975048951466860, -3.123640371003203242, -2.982809608911737520, -2.590346163235035526, -2.707462197276075067, -3.063090315919674733, -3.210805574368385873, -3.315742889070746102, -3.426247363612953123, -3.615220620358764236, -3.697315516637163402, -3.694960055771935981, -3.514271049590928619, -3.583085023499657851, -3.710830938614790853, -3.795127010362230990, -3.748048132503383201, -3.815987456462097249, -3.777482704888463161, -3.920316568467759666, -4.088637675068001798, -4.201323487740026508, -4.259461256379053040, -4.367477036724612738, -4.433043652875148233, -4.459456746007150585, -4.550360855046704067, -4.610000022861876268, -4.639325243012230260, 0.267804490680041141, 0.267771787453442156, 0.403121813911384685, 0.520049844804208572,  0.576160248484232418, 0.735892530651090726, 0.689094230510559402, 0.545630086365206601, 0.487798497798527519,  0.446442789310776300, 0.402597030242301868, 0.326664433404419530, 0.294377499738915582, 0.296650845900248650,  0.371113979808708139, 0.343329377363240540, 0.291614728358585928, 0.257804270528158685, 0.277126693289556969,  0.249812884521956741, 0.265542761334367383, 0.206999786494018956, 0.138432166714767713, 0.092322841165753983,  0.068242479179494192, 0.024306252492979658, -0.002487643961411226, -0.013462865355197196, -0.050190793123115238, -0.074287656203643360, -0.086136417649086819 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.220295737757598364, 0.030605438335697444, 0.030605438335697410, 0.107887831584073779, 0.145517332013094386, -0.001660812188336636, -0.001660812188336663, 0.093157593036923003, 0.138465436387046198, -0.005483167613022810, -0.005483167613022810, 0.090459598666057905, 0.121190284462693143, -0.013473739641127053, -0.013473739641127053,  0.086110274476198068, 0.101662279453035381, -0.022908096953915380, -0.022908096953915352, 0.081038208697458758,  0.095867522458459364, -0.023885306692934857, -0.023885306692934843, 0.080689754615085069, 0.077456526357003314, -0.030960843306268769, -0.030960843306268776, 0.077602255823180491, 0.082455078200529969, -0.027693058748322806, -0.027693058748322806, 0.079340402366294610, 0.097620413611103074, -0.019611163477797986, -0.019611163477797990,  0.083536337148846770, 0.108527839469235637, -0.013899742692818465, -0.013899742692818469, 0.086642393140734547,  0.117270064414540853, -0.009209497548788718, -0.009209497548788718, 0.089378028472115539, 0.126593308401248106, -0.004213354226871995, -0.004213354226872004, 0.092352613543143031, 0.142056902973380222, 0.003246515045985453,  0.003246515045985445, 0.096393662153779189, 0.154670481364136941, 0.009174882144043255, 0.009174882144043245,  0.099714166376657809, 0.162243181462978447, 0.012759067407502343, 0.012759067407502333, 0.102003897171627778,  0.154263017275540815, 0.009671257575669605, 0.009671257575669601, 0.101468499748081642, 0.156268829056957770,  0.010708150500953185, 0.010708150500953181, 0.102691939758461775, 0.167351999992699452, 0.015510896273943500,  0.015510896273943500, 0.105530910705355946, 0.180549724125395994, 0.021142568352647155, 0.021142568352647155,  0.108735832386015252, 0.186676114925689196, 0.023696715611691128, 0.023696715611691115, 0.110636132361143863,  0.195132553747604187, 0.027239491848385596, 0.027239491848385589, 0.112988513500728624, 0.195802238977011434,  0.027491757655777889, 0.027491757655777889, 0.113976217186229828, 0.207695680825756651, 0.032192216268221538,  0.032192216268221538, 0.116764105693921788, 0.227752670178947458, 0.040306746418476834, 0.040306746418476841,  0.121009914489442844, 0.249896037576859964, 0.049182391963886199, 0.049182391963886199, 0.125552580822571369,  0.271761552831857933, 0.057783298444313118, 0.057783298444313125, 0.129935708438214170, 0.302118813679059628,  0.069780714362332324, 0.069780714362332324, 0.135696484455231470, 0.338266746322974599, 0.084091957207221874,  0.084091957207221874, 0.142395942290244937, 0.380742938825434474, 0.100879963944609241, 0.100879963944609241,  0.150075305372945611, 0.444466596145961845, 0.126328250804517594, 0.126328250804517594, 0.161299161876744979,  0.531999976361760107, 0.161392148387444728, 0.161392148387444728, 0.176418095681750153 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.1305325959145391401, -0.0052089493607540005, -0.0075031383850821254, 0.0913894897083526447,  0.0978591671701529719, -0.0203818557153340740, -0.0217058587265687997, 0.0840417484078850863,  0.0871027536984031736, -0.0257103145416465728, -0.0270369347110312741, 0.0807535655006016984,  0.0718754960063896775, -0.0328829066769174838, -0.0346988450625990152, 0.0765703420196387208,  0.0627463772255224816, -0.0380957795304226049, -0.0370147748087408940, 0.0744469988478002331,  0.0534583084677090065, -0.0405388837288346293, -0.0403445344437134978, 0.0731890515377511819,  0.0492705124425093788, -0.0419124943754746807, -0.0407381623848610819, 0.0729254967945892063,  0.0550904854250336071, -0.0383720391423312823, -0.0364043474808718667, 0.0751809590749499268,  0.0646818331428645754, -0.0325943697662127510, -0.0311966214735018461, 0.0782561372934883481,  0.0724141563043191466, -0.0281991686317177859, -0.0268963176343049726, 0.0808251541224896952,  0.0797804455158117320, -0.0240883035819247394, -0.0226807861152099471, 0.0833984369065282755,  0.0902067802073275721, -0.0186637920628184469, -0.0172526313929301685, 0.0865748968915695943,  0.1027570922706346063, -0.0123996890580447237, -0.0113394853623166661, 0.0900044737507146586,  0.1120009335986826282, -0.0078479199412655951, -0.0070686026884887627, 0.0926644515694674403,  0.1117860758338085070, -0.0074278045023624222, -0.0069996600687590102, 0.0935353100172285346,  0.1090682377854654689, -0.0083926588204123603, -0.0078661373535679618, 0.0939187007809823837,  0.1149373780978811960, -0.0057987580848425629, -0.0051664548099843565, 0.0958339263893257659,  0.1261263964700668483, -0.0009589618233260475, -0.0003402549749295623, 0.0986949390220481504,  0.1352455177154054111, 0.0030161712941791340, 0.0034358957759992211, 0.1011546983856754234,  0.1420277061961444098, 0.0058339854340718825, 0.0063086834872375895, 0.1031939260325812069,  0.1462827175433172588, 0.0076741504403399670, 0.0080231553129095634, 0.1048109280062911042,  0.1519411620999118750, 0.0099438566889990775, 0.0102138377293466698, 0.1065951511291503562,  0.1666176315574199596, 0.0157746850138400854, 0.0161617988331630089, 0.1098988259206332418,  0.1861105705246031139, 0.0236658863932852279, 0.0239801696551823554, 0.1140313793266586884,  0.2061226601364018196, 0.0316856421716713785, 0.0318505732990983503, 0.1181718022908323784,  0.2291563181873806088, 0.0407703658724542367, 0.0409050349545056896, 0.1227457246785957634,  0.2579916680449954036, 0.0521672187956483610, 0.0522803526400809973, 0.1282610941675531024,  0.2909946363023212523, 0.0652236088850460527, 0.0652628459816799733, 0.1344287983185117885,  0.3343093943042159122, 0.0823757397213063791, 0.0824808492832314333, 0.1422924071107838917,  0.3955358834641173882, 0.1068421339980925033, 0.1069341324460411774, 0.1531238112710233690 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(72 ))

  expect_equal(c(result_exp$Q),
               c(0.11712173734693690, 0.04695251832094549, 0.04695251832094549, 0.01990459209039402 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(0.0877914951989026 ))
})

test_that("exponential model and logit moels hazzard functions differs", {
  expect_true(result_exp$model != result$model)
  expect_true(toString(body(result_exp$hazard_func)) !=
                toString(body(result$hazard_func)))
  expect_true(toString(body(result_exp$hazard_first_deriv)) !=
                toString(body(result$hazard_first_deriv)))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result_exp$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result_exp$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result_exp$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result_exp$Q_0)), rep(c("(Intercept)", "group1"), 2))
})


# Change by argument
suppressMessages(result_exp <- ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 2, Q_0 = diag(1, 2),
  Q = diag(1e-1, 2),
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-3),
  max_T = 30,
  id = head_neck_cancer$id, order = 1,
  verbose = F,
  model = "exponential"
))

# matplot(result_exp$state_vecs, type = "l")
# plot(result_exp, cov_index = 1)
# get_expect_equal(result_exp, file = "tmp.txt")

test_that("Result of exponential model on head_neck_data match previous results with altered by argument", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.87037427961885383, -3.87023087984429326, -1.91221037934947025, -2.43862280740296100, -3.22165530139148526, -3.30681140748686797, -3.89651206337075617, -3.63305833903981856, -3.53490169069086635, -3.92811419830653863, -3.83445633104215533, -4.08572279262521310, -4.38977418588174118, -4.59111421278896614, -4.26627051055878859, -4.65585179523574677, 0.25164279033439135, 0.25144509924460229, 1.37673532204583315, 1.01993204104296042,  0.53459101788916963, 0.54030801834951736, 0.19704401242214445, 0.43237882659576832, 0.45550100210285527,  0.22267296417307317, 0.25618524455277258, 0.00618157586681295, -0.22706286691347843, -0.37988354475124742, -0.23811812709966915, -0.45275960647321628 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.441292543450496955, 0.119914593826589019, 0.119914593826589033, 0.293711418856185458, 0.153610075857844225, -0.028908871706440492, -0.028908871706440492, 0.156586679956091435, 0.173792970426504961, 0.004791443767631409,  0.004791443767631437, 0.141115685933586310, 0.055149694875353913, -0.046529344162667019, -0.046529344162667019,  0.067349697349126936, 0.075678008174908079, -0.038645834720671388, -0.038645834720671381, 0.085822125254475176,  0.132443974179516144, -0.014948731361429442, -0.014948731361429435, 0.129403658956841972, 0.155750605430720168, -0.014692267525394792, -0.014692267525394792, 0.157893280988063045, 0.254860141089101100, 0.034077493139793191,  0.034077493139793191, 0.222756109854566703, 0.238890329496455001, 0.004944733239908717, 0.004944733239908720,  0.232124143223547630, 0.226881610397214217, -0.020933213616808371, -0.020933213616808360, 0.247184584339527252,  0.334349783425151426, 0.024953265993933792, 0.024953265993933771, 0.318490259893117411, 0.340131045559659451,  0.003272646957310301, 0.003272646957310294, 0.348947458402341093, 0.415849736184024044, 0.030333279839828829,  0.030333279839828808, 0.421743984834121899, 0.523382410162643530, 0.072540529768555781, 0.072540529768555739,  0.509325662871255580, 0.641622171871534919, 0.114835421711122015, 0.114835421711121988, 0.599146059513987028,  0.618035296626318953, 0.065811216941824985, 0.065811216941824985, 0.632932302407492875 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.10200382443452685, -0.04571589452880667, -0.05083395148578548, 0.13442239936127454, 0.06035462774283284, -0.04979102175280423, -0.05155823760870992, 0.09270295856323763, 0.03712398729936267, -0.04078366544120141, -0.04690857804759244, 0.05834357792228553, 0.03225048889196058, -0.04068258137312888, -0.03764188588715757,  0.04921007496276691, 0.03774942080843696, -0.04664174346994628, -0.04125586603008025, 0.06532073057893037,  0.05081104228755204, -0.04943994252619141, -0.04680513527685709, 0.09000025813177906, 0.07154819378921567, -0.05108515253310515, -0.04463860675610858, 0.12015084187547252, 0.09629910216893048, -0.04578547530236746, -0.04813716112477871, 0.15067548841267339, 0.09391302444910532, -0.06611524013466885, -0.06657478927713116,  0.16580374647646218, 0.11744037359727003, -0.07184904079874951, -0.06702917474526374, 0.19814277709906072,  0.15664336724252381, -0.06536520591652244, -0.06565715574900269, 0.24087661449129624, 0.18956975446789501, -0.06951695680969300, -0.06103640411174969, 0.28634704100628644, 0.30368102033354683, -0.01795183767719585, -0.00964876074475577, 0.37111142407645392, 0.64812791793174362, 0.16667993986692364, 0.17364424794121208,  0.53733278737797563, 1.55191487037745812, 0.67312143735963870, 0.67754892293272584, 0.89037289933934638 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(16 ))

  expect_equal(c(result_exp$Q),
               c(0.3409762050461504, 0.1803436136440473, 0.1803436136440473, 0.1426526945307628 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(0.1316872427983539 ))
})

# for(s in sample.int(1e6, 100, replace = F)){
# print(s)
# set.seed(s)
set.seed(599479)

sims <- test_sim_func_exp(n_series = 1e3, n_vars = 10, t_0 = 0, t_max = 10,
                          x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                          intercept_start = -5, sds = c(.1, rep(1, 10)))
# tmp_file <- file("exponential.log")
# sink(tmp_file)
suppressMessages(result_exp <- ddhazard(
  formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
  data = sims$res,
  by = (by_ <- 1),
  Q_0 = diag(10, 11),
  Q = diag(1e-2, 11),
  control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^3),
  max_T = 10,
  id = sims$res$id, order = 1,
  verbose = F,
  model = "exponential"))
# sink()
# close(tmp_file)

# matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
# matplot(result_exp$times, result_exp$state_vecs, result_exp$state_vecs, type = "l", lty = 2, add = T)
# get_expect_equal(result_exp, eps = 1e-5, file = "tmp.txt")

if(!interactive())
  test_that("Deal with lag one co-variance in EKF + exponential model!",
            expect_true(F))

test_that("Result of exponential model on simulated data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-5.188203295858222042, -5.192867919169898094, -4.310316958425439715, -4.336320945330846222, -4.064762463526304437, -4.470068713489812495, -4.278183682563193813, -4.738207889373453163, -5.080239744824088355, -4.330098903059813154, -3.512832514783392313, 0.903535714308593918, 0.894331964133800561, 1.816929462718155142, 0.620636215330882868, -1.210916388947183453, -2.124633635549365795, -2.018309280940417949, -2.663985587934378785, -2.388579061828196348, -1.695473603518183658, -0.908981390672407796, -1.764398534960296638, -1.783669340597084485, 0.613675018496285141, -1.259230230844413434, -3.749789731748256916, -5.281844649984472007, -4.760451807749158881, -5.760598422852969414, -4.862687284882237115, -3.721453497357167350, -2.131048877181849210, 0.646734126164619449, 0.645014594742284952,  0.674528187264348711, 0.525849444022213341, 0.419254877067003873, 0.119506867082035007, 0.344312436531998556, -0.151188667141975652, -0.984275580736283739, -0.147218581461528275, 0.643775114143569249, 0.903078090752215124,  0.906729758787989892, 0.869950217759679956, 1.595274505346900407, 2.797467744558432390, 3.253341266223266803,  3.096065389005932644, 3.496517930806801733, 3.662144599252522337, 3.192325862453184726, 2.735585334977329808,  0.678519650708181765, 0.678283654429648220, 0.307016411703131709, 0.022340565125074319, -0.486681248517496334, -0.760715580711739725, -0.664154943419190902, -1.102134793443673821, -1.900241848609568907, -1.240890040051801702, -0.694924949031594075, -0.520770279577914441, -0.521900942890573538, -0.531901667471322948, -0.584528090136232525, -0.547787771140243018, -0.717278086797987546, -0.478133042485134219, -0.786054878228679588, -1.427949733333044646, -0.838069475769509964, -0.265493352688137230, 0.051633853669528731, 0.037845740492234659, 2.924056990572987402,  2.377243559493144698, 2.098266161187867684, 1.786915474205531540, 1.968123287727698845, 2.491452526580773430,  5.761100690828738990, 4.585940059361372612, 3.944717989283841320, 1.113496343379008380, 1.109175268779626355,  1.999820516717627950, 1.860492444907890119, 1.863381980316567210, 1.696891414664366993, 1.769589769007558377,  1.745902104086367590, 2.445779023827046927, 2.361342564113131814, 2.383779024039542449, 1.713304661384221772,  1.717483031231116231, 0.609252124153554675, 0.676695613135207874, 0.634783559424135002, 0.517114549821963809,  0.547429584398183788, -0.011728153257258622, -1.912657666273230195, -0.887684276927991345, -0.007803321122974438, -1.986860410843613423, -1.973053825621926993, -5.027206005632039343, -4.593177841377539039, -4.503053956458455076, -4.187297705728798114, -4.284967037244340027, -4.835946927079818991, -8.222364049774895989, -6.998889221581012343, -6.308863713569206944 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$state_vars),
               c( 0.3564718209647352865, 0.1502042108545438848, 0.3949362494855248595, 0.2124595209322067413, -0.0476819667674404646, 0.1018442896498744504, 0.1609053367419655267, -0.0551357559837619485,  0.0553818409885371565, 0.1688038124507954263, 0.0525114410273263485, 0.1502042108545438848,  0.8663100540189390131, 1.2243281841372029017, 0.1855384361571849883, -0.4604454500014331653,  0.2503434462059512811, 0.0944020402948364534, 0.1617109294087489546, 0.0776916954361121792,  0.0888071993212603689, -0.1143341085457198342, 0.3949362494855247485, 1.2243281841372029017,  2.2197518498388131292, 0.3452033531635448904, -0.6782092839561278952, 0.3280807046148012107,  0.2242126480805420596, 0.5936128917560727913, 0.2212026029497712876, 0.0388679022587088835, -0.5096810431421557874, 0.2124595209322067413, 0.1855384361571850715, 0.3452033531635449459,  0.3066692478863988214, -0.1342364305139721325, 0.1881638378090466635, 0.1847533401768684524, -0.3227674414196349817, -0.0196826386375874331, 0.3038689827745920113, 0.3428542682694438182, -0.0476819667674404438, -0.4604454500014334428, -0.6782092839561280062, -0.1342364305139721325,  0.3831971041731261352, -0.1983124470282424667, -0.0893577393272062814, 0.0735754083882483173,  0.0081059966737519681, -0.1278031294679441432, -0.1368207672945087050, 0.1018442896498744088,  0.2503434462059513921, 0.3280807046148014328, 0.1881638378090466912, -0.1983124470282425222,  0.2648395318915124363, 0.1292535636669398247, -0.3767381053890948017, -0.0608516892457050609,  0.2841805186090277102, 0.4130142849545426764, 0.1609053367419656100, 0.0944020402948365228,  0.2242126480805420874, 0.1847533401768683692, -0.0893577393272062537, 0.1292535636669398247,  0.2069051716891880943, -0.2328161296450839690, -0.0222871352651428378, 0.2155878130752736654,  0.2582611382948359346, -0.0551357559837620109, 0.1617109294087490379, 0.5936128917560725693, -0.3227674414196348707, 0.0735754083882483173, -0.3767381053890944687, -0.2328161296450839690,  1.6980868970208273794, 0.3741475264367888909, -0.8838837043260465709, -1.6803768439410917690,  0.0553818409885371774, 0.0776916954361122347, 0.2212026029497712598, -0.0196826386375874261,  0.0081059966737519508, -0.0608516892457050332, -0.0222871352651428378, 0.3741475264367889464,  0.1742668935710796063, -0.1701766214639477137, -0.3943139678935742021, 0.1688038124507953985,  0.0888071993212603827, 0.0388679022587088488, 0.3038689827745921224, -0.1278031294679440877,  0.2841805186090277102, 0.2155878130752736099, -0.8838837043260469040, -0.1701766214639477137,  0.6422702852407251584, 0.9143797346648711022, 0.0525114410273262791, -0.1143341085457198758, -0.5096810431421558985, 0.3428542682694437627, -0.1368207672945086495, 0.4130142849545427874,  0.2582611382948359346, -1.6803768439410924351, -0.3943139678935742576, 0.9143797346648711022,  1.8316815271254398567, 0.0755229691425798877, 0.0150403026074210494, 0.0638946375928686194,  0.0351240106431329885, -0.0074949398183738331, 0.0161304587455404769, 0.0321454487166744976, -0.0236149149571044485, -0.0005326541614235347, 0.0288320307999519188, 0.0337315221568559587,  0.0150403026074210772, 0.2981174558699241084, 0.3228304959990835332, 0.0344953129534601097, -0.1372271092678233328, 0.0742397421708959060, 0.0063403885773025415, 0.0257094615546330924,  0.0148061443669236445, 0.0227934942289047676, -0.0156411384901818454, 0.0638946375928686056,  0.3228304959990835332, 0.6196144957630375094, 0.0787442000910802686, -0.1973213125090947651,  0.0918764024889000136, 0.0552997613699467011, 0.1333404441914082250, 0.0396603188211801100,  0.0133365015253159927, -0.0964537276866831994, 0.0351240106431329746, 0.0344953129534601305,  0.0787442000910802270, 0.1167558079369673818, -0.0324175248726315673, 0.0455917949012193888,  0.0518455308777304724, -0.0755190431111950611, -0.0029186013783272999, 0.0740225456331340959,  0.0826681140399420644, -0.0074949398183738192, -0.1372271092678234716, -0.1973213125090947095, -0.0324175248726315535, 0.1570409107964362283, -0.0598271800681427837, -0.0246698534529133130,  0.0134623670205698785, 0.0016038981750589776, -0.0262549776604951088, -0.0377437206308154360,  0.0161304587455404561, 0.0742397421708959615, 0.0918764024888999720, 0.0455917949012194026, -0.0598271800681428462, 0.1068986597894454604, 0.0305196659425098875, -0.0876868596859152333, -0.0122322386717625166, 0.0650188680241305939, 0.0981344954545152054, 0.0321454487166745045,  0.0063403885773026056, 0.0552997613699466387, 0.0518455308777304724, -0.0246698534529133269,  0.0305196659425098771, 0.1002929312876404966, -0.0483455202810034387, -0.0073587678894963364,  0.0486543949853659591, 0.0628465635259846528, -0.0236149149571045144, 0.0257094615546331479,  0.1333404441914080862, -0.0755190431111950056, 0.0134623670205699097, -0.0876868596859150529, -0.0483455202810034665, 0.4360614675624030490, 0.0827916630661595376, -0.2075790895970882621, -0.3815261487635674409, -0.0005326541614235208, 0.0148061443669236913, 0.0396603188211800475, -0.0029186013783272999, 0.0016038981750589585, -0.0122322386717624854, -0.0073587678894963347,  0.0827916630661596348, 0.0831112694054743084, -0.0411941736733142522, -0.0879718009141046281,  0.0288320307999518910, 0.0227934942289047607, 0.0133365015253159580, 0.0740225456331341652, -0.0262549776604951088, 0.0650188680241305939, 0.0486543949853659036, -0.2075790895970884287, -0.0411941736733142660, 0.1975923635156064950, 0.2113725903873455714, 0.0337315221568559032, -0.0156411384901818731, -0.0964537276866832965, 0.0826681140399420922, -0.0377437206308153875,  0.0981344954545153719, 0.0628465635259846389, -0.3815261487635673854, -0.0879718009141046836,  0.2113725903873457934, 0.4687297824200610252, 0.0665838676620906927, 0.0240103450712270232,  0.0746656777222383800, 0.0282308130902155091, -0.0051185976596646657, 0.0094948760719356928,  0.0243112416867661482, -0.0026784586780963411, 0.0044776706025215496, 0.0167117216883624770,  0.0074111032529636384, 0.0240103450712270787, 0.2489805992497309828, 0.2792342874294141408,  0.0352925732627961258, -0.1116865708517331829, 0.0616576534203468959, 0.0107238408595546047,  0.0252818072700318856, 0.0155288944648528764, 0.0239352257045015657, -0.0169383416224280631,  0.0746656777222383106, 0.2792342874294141963, 0.5457013104021826155, 0.0710797885264684570, -0.1596615662333365770, 0.0753270916459616163, 0.0471606005163159175, 0.1269335911760236524,  0.0416553978110258405, 0.0117662412202026011, -0.1011621899216662845, 0.0282308130902155230,  0.0352925732627961120, 0.0710797885264684570, 0.0973045213967378420, -0.0258504753440704643,  0.0369075701271407083, 0.0392020325930455410, -0.0629085512103193523, -0.0020002748968701756,  0.0615695376033766062, 0.0653518757391182564, -0.0051185976596646587, -0.1116865708517332523, -0.1596615662333364383, -0.0258504753440704643, 0.1317747947928820107, -0.0496034473063971526, -0.0194817105913085396, 0.0156667791416738936, 0.0025825977493157300, -0.0247686155021507072, -0.0357288773607840962, 0.0094948760719356790, 0.0616576534203469376, 0.0753270916459615747,  0.0369075701271407083, -0.0496034473063971873, 0.0909167520549178931, 0.0242280965298835374, -0.0776568961796967328, -0.0117692317898151471, 0.0562548774313715860,
                  0.0859002947722688481,  0.0243112416867661621, 0.0107238408595546706, 0.0471606005163158967, 0.0392020325930455271, -0.0194817105913085674, 0.0242280965298835235, 0.0804287367937793762, -0.0400308560799835303, -0.0061515315563477509, 0.0389614648486074841, 0.0489123732356284563, -0.0026784586780963706,  0.0252818072700319481, 0.1269335911760236524, -0.0629085512103194078, 0.0156667791416739074, -0.0776568961796966356, -0.0400308560799835789, 0.3943233067047047791, 0.0772406354016890589, -0.1817669108846280968, -0.3466324496471754890, 0.0044776706025215496, 0.0155288944648528937,  0.0416553978110258127, -0.0020002748968701791, 0.0025825977493157109, -0.0117692317898151367, -0.0061515315563477457, 0.0772406354016890728, 0.0745871937166110444, -0.0364307345835694490, -0.0827150111574497526, 0.0167117216883624492, 0.0239352257045015622, 0.0117662412202026220,  0.0615695376033766062, -0.0247686155021507107, 0.0562548774313715652, 0.0389614648486074841, -0.1817669108846281523, -0.0364307345835694629, 0.1692955873293200408, 0.1833135347313854524,  0.0074111032529636106, -0.0169383416224280908, -0.1011621899216662568, 0.0653518757391182564, -0.0357288773607840893, 0.0859002947722689730, 0.0489123732356284563, -0.3466324496471752670, -0.0827150111574497665, 0.1833135347313855079, 0.4246053340460555492, 0.0387760537796417587, -0.0169909441548118760, -0.0108903117950929010, 0.0126151821746198281, 0.0055828161765003933,  0.0055212367982150788, 0.0164488589531234797, -0.0436413042593582767, -0.0111317107817416189,  0.0179372277994738864, 0.0516466798429706386, -0.0169909441548118829, 0.1016353197702104666,  0.0557487799532663392, -0.0025779208616847253, -0.0317791563702843338, 0.0146390304127108940, -0.0107841584214783560, 0.0036688151491958282, 0.0020603573299375543, 0.0005012566281814260, -0.0034079142573841524, -0.0108903117950929062, 0.0557487799532663114, 0.1312436997521687354,  0.0068040207087430877, -0.0395310559406196957, 0.0182932096446945525, 0.0043814103352542684,  0.0119650727182096708, -0.0002520202103322416, 0.0028134915770576243, -0.0015179151982664578,  0.0126151821746198350, -0.0025779208616847340, 0.0068040207087430946, 0.0595230826098082366, -0.0005725541268576887, 0.0103250523360019220, 0.0175939507145214773, -0.0282903096332548232,  0.0004773131897977337, 0.0228984450989259784, 0.0285693089245477039, 0.0055828161765003933, -0.0317791563702844587, -0.0395310559406196055, -0.0005725541268576939, 0.0678419237157850963, -0.0124898786676012584, -0.0020743604155622113, -0.0030020884209542749, -0.0003626007562095371,  0.0015026692516011799, -0.0057701281841637964, 0.0055212367982150632, 0.0146390304127109096,  0.0182932096446945212, 0.0103250523360019462, -0.0124898786676012653, 0.0501054804335923504,  0.0076045511780133881, -0.0183544494140746965, -0.0001569035540571299, 0.0120466860646081062,  0.0215666604177226044, 0.0164488589531234936, -0.0107841584214782953, 0.0043814103352542207,  0.0175939507145214495, -0.0020743604155622338, 0.0076045511780133924, 0.0582271172780115254, -0.0192536594580668373, -0.0034087466249594738, 0.0148771308535675141, 0.0246499686328153812, -0.0436413042593583114, 0.0036688151491958403, 0.0119650727182096864, -0.0282903096332548579, -0.0030020884209542437, -0.0183544494140747451, -0.0192536594580668859, 0.1304588548177526564,  0.0115987641058708339, -0.0502104241362456294, -0.0854887643475530923, -0.0111317107817416328,  0.0020603573299375821, -0.0002520202103322936, 0.0004773131897977380, -0.0003626007562095666, -0.0001569035540571247, -0.0034087466249594538, 0.0115987641058708374, 0.0488695504086170129, -0.0074487659253321872, -0.0145562571281026235, 0.0179372277994738899, 0.0005012566281814308,  0.0028134915770576083, 0.0228984450989259541, 0.0015026692516011803, 0.0120466860646080958,  0.0148771308535675002, -0.0502104241362456571, -0.0074487659253322114, 0.0772272661656021736,  0.0495324927796831349, 0.0516466798429706317, -0.0034079142573841346, -0.0015179151982664700,  0.0285693089245476796, -0.0057701281841637765, 0.0215666604177226842, 0.0246499686328153604, -0.0854887643475529951, -0.0145562571281025854, 0.0495324927796830794, 0.1494750451722671181,  0.0449125881803093333, -0.0030385082500555237, 0.0139286378958670652, 0.0239739645869568724, -0.0045576509389877234, 0.0151656623765085326, 0.0229157926056221817, -0.0495213509964089194, -0.0090577126970655640, 0.0302096181987065206, 0.0597696222430394788, -0.0030385082500555306,  0.1061499393687249521, 0.0829287925900541179, 0.0047357891108694644, -0.0388432401123416302,  0.0171459078343101923, -0.0026658336814929079, 0.0100625218715885874, 0.0044413893099511425,  0.0029441976336309511, -0.0088145215248827888, 0.0139286378958670617, 0.0829287925900541179,  0.1846128284416309606, 0.0205393151016052163, -0.0565037081699213128, 0.0269114816591800414,  0.0153518788845132485, 0.0220704764103038797, 0.0062539912132161847, 0.0083052144992038814, -0.0112908196409780143, 0.0239739645869568654, 0.0047357891108694471, 0.0205393151016052336,  0.0647839367261213162, -0.0050599702561067517, 0.0179240320455897745, 0.0236659665020361384, -0.0402579180197564224, -0.0003044684020162051, 0.0354351789432449590, 0.0417863787628319563, -0.0045576509389877113, -0.0388432401123417620, -0.0565037081699212296, -0.0050599702561067448,  0.0672219051925454364, -0.0138825854884999707, -0.0062348492923361646, -0.0049855027861619196, -0.0016680874050857978, -0.0012941558306047672, -0.0024417686964614506, 0.0151656623765085066,  0.0171459078343101992, 0.0269114816591800067, 0.0179240320455898092, -0.0138825854884999638,  0.0513652380257036412, 0.0140522856235701758, -0.0290250223724292482, -0.0017910230560133004,  0.0227373130637037249, 0.0328229583980094233, 0.0229157926056221956, -0.0026658336814928802,  0.0153518788845132068, 0.0236659665020361107, -0.0062348492923361828, 0.0140522856235701758,  0.0576647292146984930, -0.0287666929366160937, -0.0037828878626689172, 0.0243758281946999007,  0.0344393477392495873, -0.0495213509964089610, 0.0100625218715885700, 0.0220704764103039214, -0.0402579180197564501, -0.0049855027861618832, -0.0290250223724292308, -0.0287666929366161353,  0.1581845565934768549, 0.0184763901823935123, -0.0718232154534486633, -0.1197582357586476076, -0.0090577126970655605, 0.0044413893099511745, 0.0062539912132161483, -0.0003044684020162137, -0.0016680874050858207, -0.0017910230560133082, -0.0037828878626688933, 0.0184763901823935574,  0.0462288017090857761, -0.0100726097387695279, -0.0214583838696109364, 0.0302096181987065240,  0.0029441976336309428, 0.0083052144992038814, 0.0354351789432449660, -0.0012941558306047750,  0.0227373130637037145, 0.0243758281946998764, -0.0718232154534487049, -0.0100726097387695279,  0.0906246749818859498, 0.0730208200767004795, 0.0597696222430394719, -0.0088145215248828044, -0.0112908196409779449, 0.0417863787628319494, -0.0024417686964614020, 0.0328229583980094788,  0.0344393477392496011, -0.1197582357586473162, -0.0214583838696109329, 0.0730208200767005211,  0.1799473863134831986, 0.0357443279952537746, 0.0187838606012037806, 0.0429387234030273734,  0.0176261251563734032, -0.0152229792294686639, 0.0148675101822077667, 0.0154857440867157276, -0.0214966430470702255, -0.0039883535192434287,
                  0.0167431246471781807, 0.0337369367591755787,  0.0187838606012037737, 0.0778269706904730074, 0.0639727861054083802, 0.0121053309485097474, -0.0209035442074435550, 0.0131764627558757525, 0.0032907472068902498, 0.0069057127808981791,  0.0076793272659196488, 0.0058762489017053672, -0.0084163615552328847, 0.0429387234030273734,  0.0639727861054083802, 0.1722244061171773755, 0.0293641126190522968, -0.0395127891929698549,  0.0264900947059089724, 0.0197471666578530360, 0.0185794862660447618, 0.0111964928886216994,  0.0110525994641521991, -0.0110945105152440472, 0.0176261251563733859, 0.0121053309485097300,  0.0293641126190522864, 0.0539825174130073582, -0.0080821076069339526, 0.0144164251877730402,  0.0162099762684597866, -0.0199932020225936438, 0.0016952407749798119, 0.0225998085838039972,  0.0228788705903524084, -0.0152229792294686569, -0.0209035442074436487, -0.0395127891929697647, -0.0080821076069339179, 0.0527449124104252473, -0.0100701985237535221, -0.0082638667666436356, -0.0004251798846757322, -0.0020504191531696115, -0.0031356275968381113, -0.0044641679468201863,  0.0148675101822077407, 0.0131764627558757993, 0.0264900947059089342, 0.0144164251877730264, -0.0100701985237535048, 0.0434876165023446865, 0.0110795395513434980, -0.0138034733974985030,  0.0003691350455453791, 0.0140917377927293752, 0.0174727983491972869, 0.0154857440867157258,  0.0032907472068902602, 0.0197471666578530151, 0.0162099762684597797, -0.0082638667666436391,  0.0110795395513434893, 0.0475514107479612716, -0.0131897259083799331, -0.0021450981864993427,  0.0137072788441822725, 0.0189682050066888562, -0.0214966430470702741, 0.0069057127808981955,  0.0185794862660447341, -0.0199932020225936577, -0.0004251798846757217, -0.0138034733974984319, -0.0131897259083799366, 0.1022591302306897487, 0.0145265441095187731, -0.0376552774647530009, -0.0696458432188979959, -0.0039883535192434304, 0.0076793272659196887, 0.0111964928886216473,  0.0016952407749798127, -0.0020504191531696301, 0.0003691350455453856, -0.0021450981864993236,  0.0145265441095187818, 0.0431195361999233417, -0.0065732146495725207, -0.0177284828576516028,  0.0167431246471781876, 0.0058762489017053941, 0.0110525994641521956, 0.0225998085838039764, -0.0031356275968381004, 0.0140917377927293752, 0.0137072788441822760, -0.0376552774647530564, -0.0065732146495724843, 0.0650572070005597108, 0.0404232744589142975, 0.0337369367591755370, -0.0084163615552328985, -0.0110945105152440177, 0.0228788705903524223, -0.0044641679468201950,  0.0174727983491973909, 0.0189682050066888423, -0.0696458432188979126, -0.0177284828576515924,  0.0404232744589142906, 0.1274342391849143941, 0.0497400297125233926, 0.0382984275745206701,  0.0801492865809485533, 0.0284247973040912816, -0.0271750958208217541, 0.0229845952308154293,  0.0243625131936422747, -0.0231204015153166839, -0.0021464265410875228, 0.0253945806924136090,  0.0356007329299677516, 0.0382984275745206770, 0.0971274741667843416, 0.1048669943089465678,  0.0261777500289367172, -0.0352139561689320674, 0.0234990129122488664, 0.0158696582501341964, -0.0012096087523571224, 0.0072264499781316792, 0.0214663120851960772, 0.0054235132468679744,  0.0801492865809485810, 0.1048669943089464984, 0.2522832155567822920, 0.0549290399534205290, -0.0664555906246877964, 0.0452552697796260311, 0.0414235253253083038, 0.0106586294503339084,  0.0134554620125994298, 0.0350856437250726752, 0.0052294218705090552, 0.0284247973040912850,  0.0261777500289367103, 0.0549290399534205220, 0.0602558703421073177, -0.0175984463566082432,  0.0212140046791610901, 0.0239267039890196792, -0.0249378870779304006, 0.0012275705119672714,  0.0317326753476671469, 0.0291254991919986800, -0.0271750958208217541, -0.0352139561689321159, -0.0664555906246877548, -0.0175984463566082154, 0.0620988573207224975, -0.0174458529282456865, -0.0166724704574235973, 0.0067889854847903172, -0.0010808825310675151, -0.0151257042295398648, -0.0152582267720093694, 0.0229845952308154119, 0.0234990129122488664, 0.0452552697796260381,  0.0212140046791610797, -0.0174458529282456691, 0.0485393530482083127, 0.0177422974484859018, -0.0214509139884192339, -0.0010710819191225996, 0.0241022236121148752, 0.0269471201462424051,  0.0243625131936422677, 0.0158696582501342276, 0.0414235253253082691, 0.0239267039890196688, -0.0166724704574236077, 0.0177422974484858949, 0.0531406847836403892, -0.0199050104736150021, -0.0023105808603491175, 0.0228326972498529707, 0.0261889344272682109, -0.0231204015153166909, -0.0012096087523571311, 0.0106586294503338806, -0.0249378870779303624, 0.0067889854847903146, -0.0214509139884192131, -0.0199050104736149917, 0.1167504717061011443, 0.0182128523560799449, -0.0522358404560015130, -0.0844543233631050438, -0.0021464265410875271, 0.0072264499781316991,  0.0134554620125994125, 0.0012275705119672818, -0.0010808825310675029, -0.0010710819191226278, -0.0023105808603491131, 0.0182128523560799623, 0.0426833910607821027, -0.0092556409354034100, -0.0212507168754150939, 0.0253945806924135882, 0.0214663120851960737, 0.0350856437250726474,  0.0317326753476671330, -0.0151257042295398700, 0.0241022236121149168, 0.0228326972498529637, -0.0522358404560016101, -0.0092556409354034412, 0.0789966867983174503, 0.0559683730612211827,  0.0356007329299677239, 0.0054235132468679345, 0.0052294218705089997, 0.0291254991919987251, -0.0152582267720093902, 0.0269471201462425231, 0.0261889344272682179, -0.0844543233631051271, -0.0212507168754151286, 0.0559683730612212937, 0.1399643616555109049, 0.0451437418893641043,  0.0326318397410594457, 0.0684000498721793887, 0.0240896939469048450, -0.0227255911547396584,  0.0192546239499636548, 0.0200906714261645733, -0.0223369042272443599, -0.0020985296160529769,  0.0230229495833586678, 0.0332510946699020732, 0.0326318397410594457, 0.0934571242913634082,  0.0942065945909704994, 0.0235071725473032164, -0.0311809299044993639, 0.0188066002376489627,  0.0108028774040850716, -0.0054980982823094968, 0.0077626645285846698, 0.0195400123518532851,  0.0050494496084822101, 0.0684000498721793887, 0.0942065945909704994, 0.2252920638151445498,  0.0482242200516460051, -0.0566107946466561443, 0.0355564125993234961, 0.0312206625408393730,  0.0065742515754418467, 0.0142639800920347712, 0.0313604283975427722, 0.0014717104168424557,  0.0240896939469048554, 0.0235071725473032095, 0.0482242200516459982, 0.0558814428730744286, -0.0149192001132770809, 0.0176230906710198067, 0.0199495695635317737, -0.0203706454557164747,  0.0023709225709005123, 0.0268207443729898652, 0.0233438325469937993, -0.0227255911547396688, -0.0311809299044993639, -0.0566107946466561304, -0.0149192001132770532, 0.0588219393797917017, -0.0132503780415975086, -0.0125795553955866512, 0.0084007337752726036, -0.0016386826503587593, -0.0118970067326525236, -0.0137484822995656078, 0.0192546239499636548, 0.0188066002376489801,  0.0355564125993235308, 0.0176230906710198171, -0.0132503780415974878, 0.0447464136289789302,  0.0137044632099095794, -0.0208691518866550609, -0.0003351876550806579, 0.0197249898334622698,  0.0244653511684393629, 0.0200906714261645768, 0.0108028774040850768, 0.0312206625408393730,  0.0199495695635317737, -0.0125795553955866390, 0.0137044632099095707, 0.0495453973227227909, -0.0163513275789484436,
                  -0.0013668044862034541, 0.0185377409173931584, 0.0214656466387778341, -0.0223369042272443669, -0.0054980982823095350, 0.0065742515754418389, -0.0203706454557164539,  0.0084007337752725845, -0.0208691518866549811, -0.0163513275789484262, 0.1130425580251438189,  0.0159314171185934370, -0.0439592640494345932, -0.0808675176050524525, -0.0020985296160529916,  0.0077626645285846707, 0.0142639800920347521, 0.0023709225709005349, -0.0016386826503587467, -0.0003351876550806853, -0.0013668044862034578, 0.0159314171185934821, 0.0417977343078681993, -0.0062325499870330477, -0.0190691896297905707, 0.0230229495833586678, 0.0195400123518532885,  0.0313604283975427861, 0.0268207443729898722, -0.0118970067326525254, 0.0197249898334623079,  0.0185377409173931515, -0.0439592640494346001, -0.0062325499870331223, 0.0704678776215234143,  0.0463790794522256980, 0.0332510946699020732, 0.0050494496084821632, 0.0014717104168424592,  0.0233438325469938063, -0.0137484822995655852, 0.0244653511684394115, 0.0214656466387778272, -0.0808675176050523969, -0.0190691896297905845, 0.0463790794522257258, 0.1360065608489532951,  0.0546304576605902772, 0.0375990972669060647, 0.0773890196976368822, 0.0275921328714588097, -0.0231151790698990028, 0.0211968910349300023, 0.0219537288345612105, -0.0217424950019131577,  0.0003252094864008436, 0.0246105712160570242, 0.0313300336885899006, 0.0375990972669060577,  0.0991648097254292094, 0.1052716628417586786, 0.0200130654324451353, -0.0297937235232060942,  0.0177773428938630094, 0.0115756097306406267, 0.0137342462633987718, 0.0134734891898095187,  0.0095512012060260977, -0.0117226070704510941, 0.0773890196976368822, 0.1052716628417587202,  0.2493899491700051207, 0.0434510043161501006, -0.0563113301401353059, 0.0334255564219990628,  0.0326705047814391109, 0.0434169425367603445, 0.0257554174328705407, 0.0132122321292613594, -0.0311583171679900954, 0.0275921328714588202, 0.0200130654324451318, 0.0434510043161501075,  0.0558350738692290557, -0.0103828514857253942, 0.0159568382130105026, 0.0190939871428896027, -0.0156906283260182210, 0.0041908609297218596, 0.0244197030172092107, 0.0169980081066557764, -0.0231151790698990098, -0.0297937235232060595, -0.0563113301401352989, -0.0103828514857253855,  0.0566762732768699290, -0.0103466628234912157, -0.0107463874032897293, -0.0061710017887048876, -0.0049964889027750989, -0.0028722597681187880, -0.0007669299453107984, 0.0211968910349300023,  0.0177773428938629886, 0.0334255564219990767, 0.0159568382130105130, -0.0103466628234912001,  0.0452857216521891995, 0.0121307342114292810, -0.0170487487125394362, 0.0004488318131049318,  0.0173737932728488809, 0.0205568527461882401, 0.0219537288345612001, 0.0115756097306406215,  0.0326705047814391109, 0.0190939871428896027, -0.0107463874032897172, 0.0121307342114292775,  0.0493688396915473587, -0.0086172114503176508, 0.0007923897701246776, 0.0149617999056284728,  0.0126993571324633247, -0.0217424950019131612, 0.0137342462633987389, 0.0434169425367603862, -0.0156906283260181967, -0.0061710017887049171, -0.0170487487125393980, -0.0086172114503176300,  0.1282277581213895068, 0.0214068131916759601, -0.0476940878659793746, -0.0878079432145598693,  0.0003252094864008388, 0.0134734891898095101, 0.0257554174328705372, 0.0041908609297218770, -0.0049964889027750755, 0.0004488318131049150, 0.0007923897701246703, 0.0214068131916759843,  0.0453304576095742429, -0.0078075588518525391, -0.0234959873372279048, 0.0246105712160570242,  0.0095512012060260942, 0.0132122321292613802, 0.0244197030172092037, -0.0028722597681187928,  0.0173737932728488982, 0.0149617999056284728, -0.0476940878659793815, -0.0078075588518525599,  0.0720955628644402019, 0.0465315145341253927, 0.0313300336885898936, -0.0117226070704511080, -0.0311583171679900364, 0.0169980081066557764, -0.0007669299453108066, 0.0205568527461882436,  0.0126993571324633178, -0.0878079432145599248, -0.0234959873372279221, 0.0465315145341253927,  0.1396375397445625832, 0.0569367895939884711, 0.0174689402170341290, 0.0382330446149549141,  0.0266378206169947500, -0.0163347273436484225, 0.0224945577728042564, 0.0229520719665545943, -0.0589409742542580176, -0.0099898633893295875, 0.0385909340507015475, 0.0689923382417200054,  0.0174689402170341047, 0.0784903820779159628, 0.0544139600311685095, 0.0064385969297837391, -0.0234419321500171467, 0.0139889956667383734, 0.0019371868565814740, -0.0052275423520415903, -0.0014446138870840462, 0.0100526238561383010, 0.0090274770376521773, 0.0382330446149549349,  0.0544139600311685442, 0.1377988393366177122, 0.0197283417538101045, -0.0401280234301886335,  0.0268183675121233638, 0.0152863241943317751, -0.0060241844226272068, -0.0039067615469152005,  0.0199479984756369307, 0.0206774990194668919, 0.0266378206169947396, 0.0064385969297837365,  0.0197283417538100837, 0.0540927516688727780, -0.0063650788609105049, 0.0136027444098753975,  0.0181984493772286045, -0.0296294849898162023, -0.0014484438038021054, 0.0270160628777588070,  0.0315795256012037576, -0.0163347273436484156, -0.0234419321500171397, -0.0401280234301886335, -0.0063650788609105067, 0.0595474596330574368, -0.0103764752947543143, -0.0079486495078420361,  0.0029892748058380370, 0.0024417626361938429, -0.0043657208720186708, -0.0125312859611460999,  0.0224945577728042495, 0.0139889956667383613, 0.0268183675121233568, 0.0136027444098753801, -0.0103764752947543143, 0.0461707196087741065, 0.0114242775934772535, -0.0201469165562363495, -0.0025436526835248890, 0.0169198340694329506, 0.0252379897436075043, 0.0229520719665545839,  0.0019371868565814865, 0.0152863241943317681, 0.0181984493772286079, -0.0079486495078420431,  0.0114242775934772639, 0.0521509134780148015, -0.0217992590011559413, -0.0034348966761655495,  0.0190429109707159726, 0.0268472586397622663, -0.0589409742542580245, -0.0052275423520416198, -0.0060241844226271947, -0.0296294849898162335, 0.0029892748058380613, -0.0201469165562363356, -0.0217992590011559170, 0.1241984013668689657, 0.0129999632958218963, -0.0514718072573056434, -0.0833352641681031625, -0.0099898633893295910, -0.0014446138870840692, -0.0039067615469151936, -0.0014484438038020902, 0.0024417626361938520, -0.0025436526835248929, -0.0034348966761655504,  0.0129999632958219067, 0.0434664114016911352, -0.0078747661449358498, -0.0163822882492316163,  0.0385909340507015267, 0.0100526238561382958, 0.0199479984756369237, 0.0270160628777587758, -0.0043657208720186778, 0.0169198340694329541, 0.0190429109707159760, -0.0514718072573055949, -0.0078747661449358637, 0.0766323868334336522, 0.0520212793196010923, 0.0689923382417200193,  0.0090274770376521929, 0.0206774990194668676, 0.0315795256012037714, -0.0125312859611460790,  0.0252379897436075182, 0.0268472586397622767, -0.0833352641681032041, -0.0163822882492315990,  0.0520212793196011269, 0.1434278137140076737, 0.0562909939056830122, 0.0196663590513499464,  0.0365332437981971750, 0.0271506882958320352, -0.0168763304829981087, 0.0231124162849584043,  0.0222997108781906629, -0.0583612412946969417, -0.0101530861598573847, 0.0379354565877788596,  0.0707553843576516073, 0.0196663590513499464, 0.1017112119894928168, 0.0795687975430821592,  0.0081953837428163298, -0.0269527730858873070, 0.0175866617942643244, -0.0010941151318956980,
                  0.0065521472484384811, 0.0043731579532861565, 0.0044012358779850014, -0.0101689829586428786,  0.0365332437981971750, 0.0795687975430821592, 0.1872142996140080951, 0.0245391939852342700, -0.0482650899122376645, 0.0283976147986434342, 0.0149623116031402173, 0.0237915888172961498,  0.0047596095615986536, 0.0073906541210240709, -0.0155599710364917546, 0.0271506882958320352,  0.0081953837428163298, 0.0245391939852342700, 0.0658047495978103109, -0.0084975032496015391,  0.0178350797448629701, 0.0245144205406488472, -0.0310658881851061559, 0.0003205423296087423,  0.0314003366563680442, 0.0340264235320264855, -0.0168763304829981087, -0.0269527730858873070, -0.0482650899122376645, -0.0084975032496015391, 0.0671370355301118271, -0.0133459334092883870, -0.0097719986686769303, -0.0004388986167159171, 0.0004188327584560874, -0.0015451742021388309, -0.0071619184719495799, 0.0231124162849584043, 0.0175866617942643244, 0.0283976147986434342,  0.0178350797448629701, -0.0133459334092883870, 0.0568120985881462592, 0.0145558338959935109, -0.0286358621712550845, -0.0028228286439883994, 0.0220799505755982506, 0.0332377340302991986,  0.0222997108781906629, -0.0010941151318956980, 0.0149623116031402173, 0.0245144205406488472, -0.0097719986686769303, 0.0145558338959935109, 0.0638420634464143266, -0.0269300306168051735, -0.0044865282866332181, 0.0236656127244495654, 0.0347592340953502485, -0.0583612412946969417,  0.0065521472484384811, 0.0237915888172961498, -0.0310658881851061559, -0.0004388986167159171, -0.0286358621712550845, -0.0269300306168051735, 0.1578884480830564097, 0.0178936816312022691, -0.0658708421953520251, -0.1135061588811079880, -0.0101530861598573847, 0.0043731579532861565,  0.0047596095615986536, 0.0003205423296087423, 0.0004188327584560874, -0.0028228286439883994, -0.0044865282866332181, 0.0178936816312022691, 0.0501116442373916934, -0.0095945293396901155, -0.0215225790245768822, 0.0379354565877788596, 0.0044012358779850014, 0.0073906541210240709,  0.0314003366563680442, -0.0015451742021388309, 0.0220799505755982506, 0.0236656127244495654, -0.0658708421953520251, -0.0095945293396901155, 0.0912626318996398456, 0.0665733520328917194,  0.0707553843576516073, -0.0101689829586428786, -0.0155599710364917546, 0.0340264235320264855, -0.0071619184719495799, 0.0332377340302991986, 0.0347592340953502485, -0.1135061588811079880, -0.0215225790245768822, 0.0665733520328917194, 0.1822712216538368291 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$n_iter),
               c(12 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$Q),
               c( 0.358020556865647044, 0.259277173053352517, 0.561431827494945024, 0.262678695715435395, -0.111608800820350337,  0.148313568851910438, 0.188390145679481924, -0.059464114894498564, 0.069090794969369901, 0.212797394618069624,  0.053432596110293065, 0.259277173053352517, 1.022218180634146822, 1.663235846535923157, 0.251973417735177507, -0.561194077846880246, 0.280168380200381928, 0.133206617639874125, 0.377351007992750731, 0.152108349530929471,  0.059406211648745461, -0.326753089205042757, 0.561431827494945024, 1.663235846535923157, 2.943349440062594358,  0.414909400161958875, -0.854700683215706691, 0.366496970214028162, 0.233543050172938638, 1.053958669454810870,  0.380261325410562567, -0.078231365026017019, -0.994465343013327563, 0.262678695715435395, 0.251973417735177507,  0.414909400161958875, 0.322843318749494568, -0.187692172879099617, 0.259446100470225538, 0.227966751856685718, -0.507652701336491541, -0.056671890881222847, 0.429488120284109209, 0.537496705144619336, -0.111608800820350337, -0.561194077846880246, -0.854700683215706691, -0.187692172879099617, 0.368451462304787480, -0.230173203879265209, -0.112506030994800776, 0.069178516825374320, -0.009813727189810207, -0.175727919508135905, -0.122728178504065116,  0.148313568851910438, 0.280168380200381928, 0.366496970214028162, 0.259446100470225538, -0.230173203879265209,  0.272970722846386515, 0.179112344318567457, -0.556693576898948495, -0.095571959045730417, 0.412149609311622811,  0.601087569471188798, 0.188390145679481924, 0.133206617639874125, 0.233543050172938638, 0.227966751856685718, -0.112506030994800776, 0.179112344318567457, 0.176676662245769028, -0.391759689168048486, -0.049062060866470310,  0.316700214402321656, 0.414341619870716993, -0.059464114894498564, 0.377351007992750731, 1.053958669454810870, -0.507652701336491541, 0.069178516825374320, -0.556693576898948495, -0.391759689168048486, 2.558747603178308516,  0.589878032665847152, -1.368983686466504146, -2.644646444659957574, 0.069090794969369901, 0.152108349530929471,  0.380261325410562567, -0.056671890881222847, -0.009813727189810207, -0.095571959045730417, -0.049062060866470310,  0.589878032665847152, 0.164899055594413479, -0.273921949705384915, -0.614841324051712657, 0.212797394618069624,  0.059406211648745461, -0.078231365026017019, 0.429488120284109209, -0.175727919508135905, 0.412149609311622811,  0.316700214402321656, -1.368983686466504146, -0.273921949705384915, 0.861064444866115664, 1.427900335394751696,  0.053432596110293065, -0.326753089205042757, -0.994465343013327563, 0.537496705144619336, -0.122728178504065116,  0.601087569471188798, 0.414341619870716993, -2.644646444659957574, -0.614841324051712657, 1.427900335394751696,  2.761453393666073008 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$method),
               c("EKF" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$model),
               c("exponential" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$LR),
               c(0.05852766346593507 )
               , tolerance = 1e-05)
})

test_that("Unmacthed control variable throw error",
          expect_error({
            result = ddhazard(
              formula = survival::Surv(start, stop, event) ~ group,
              data = head_neck_cancer,
              by = 1, # Use by month intervals
              a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
              max_T = 45,
              id = head_neck_cancer$id, order = 1,
              control = list("None_existing_parem" = 1)
            )}, regexp = "These control parameters are not recognized"))

test_that("Using alternated inverse covariance matrix in EKF with exponential model yields previously computed values", {
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(10, 11),
    Q = diag(1e-2, 11),
    control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^3,
                   EKF_inv_Cov_method = "not org"),
    max_T = 10,
    id = sims$res$id, order = 1,
    verbose = F,
    model = "exponential"))

  # get_expect_equal(result_exp, eps = 1e-5, file = "tmp.txt")
  # matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
  # matplot(result_exp$times, result_exp$state_vecs, result_exp$state_vecs, type = "l", lty = 2, add = T)

  expect_equal(c(result_exp$state_vecs),
               c(-5.37491499453456711, -5.37838561956256189, -4.82120214005348124, -4.57774126114250723, -4.37250249850003758, -4.36263736954901749, -4.37576778478690009, -4.30796374816606686, -3.96478025282279178, -4.05884163933298581, -4.06139385848421863, 0.62136248372161029, 0.62493458521790513, 0.74299025525156615, -0.39825497767733964, -1.45633073143722536, -2.22559221312591493, -2.06822623767243163, -2.23007683229433917, -1.61701543132215342, -1.53649477936356083, -1.05616071482902862, -1.97749961606802049, -1.97881595587375569, -0.57669067545861985, -2.44822473362939075, -4.13040023170904291, -5.51716864433489995, -4.95402996774829329, -4.95447727752580747, -2.85942847533379929, -3.08189629183477276, -2.23547613479184593, 1.00606836485592921, 1.00849103278899666,  0.75210260342984592, 0.52387510804844872, 0.31800579639583876, 0.19955092367601179, 0.18928931604373625,  0.08735798545854222, -0.04791068228869577, 0.08318004669572661, 0.20389970557152162, 1.54727598954221035,  1.54470660503176260, 1.63482883510482080, 2.28203085502065584, 2.87229618106439766, 3.24987579696851236,  3.13222630689859072, 3.22218833251401549, 2.98440816190581604, 2.93712750847187554, 2.71757049535431960,  0.59058706612362832, 0.59567850250647014, -0.17273648191381219, -0.35954944340969364, -0.54176236481989193, -0.56444649712038220, -0.68368263961922482, -0.86762310541703425, -1.45613685779407054, -1.22641122282940129, -1.16940644097553026, -0.28072525083253491, -0.27944565496356610, -0.45802462223737783, -0.52684459252313376, -0.58014174739532576, -0.59861885567120932, -0.60309878583613863, -0.64693742798975917, -0.78143413541395512, -0.71396365104266191, -0.67560957514061215, 0.79000280334054462, 0.77728444342701419, 3.37211417702639249,  2.74282635801478003, 2.22770624639737225, 1.47810731419400221, 2.09981672313806778, 2.50088432044739539,  5.10103955217750560, 4.44271150512847957, 4.76700198785209395, 1.60243169246471040, 1.60044167530069581,  2.06637056127744057, 1.91842821228627214, 1.79095011951254390, 1.62022624217503308, 1.71565560527511840,  1.75045295235447540, 2.22247147093365394, 2.14085607244094867, 2.23424197427617077, 1.95984215314049925,  1.96869661532479379, 0.44792822962526402, 0.47222385663508121, 0.46641360407964061, 0.67810386562519609,  0.34856655477029530, 0.04460437790988175, -1.34395601438959700, -0.90551110507820032, -0.89425338157076428, -3.37953113305516251, -3.36866884948570311, -5.63146480649819470, -5.10169842348046476, -4.65192237475799164, -3.97254029809158205, -4.47722333050160959, -4.80247779250813167, -7.04845819725316147, -6.51649582508983016, -6.83522567448175256 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$state_vars),
               c( 1.685901075026752e-01, -1.070897760618673e-01, -3.096885226292929e-02, -5.372608171222829e-02,  7.979358310940199e-02, -1.052626824792337e-01, -2.397106648280096e-02, 1.908216832079230e-01,  2.386001664806245e-02, -1.658557147727988e-01, -1.468423540042886e-01, -1.070897760618673e-01,  7.844097705192272e-01, 1.004684839983574e+00, 1.454836518920367e-01, -3.522779569953190e-01,  1.342475149889229e-01, 4.431982326283665e-02, 2.578848485834337e-01, 8.484287847779956e-02,  5.123261640441776e-02, -2.393766247234175e-01, -3.096885226292926e-02, 1.004684839983574e+00,  2.072643731309848e+00, 1.456268288764662e-01, -5.232919952498224e-01, -1.288318797103063e-02,  2.849564824246953e-02, 1.144318904519704e+00, 2.424522842144922e-01, -3.713408427398605e-01, -9.812517375898829e-01, -5.372608171222829e-02, 1.454836518920368e-01, 1.456268288764662e-01,  1.696992320892381e-01, -7.849290648742006e-02, 8.819559813567263e-02, 3.403672747253363e-02, -1.157008258792878e-01, -9.250868836579741e-04, 1.292320715287860e-01, 8.881982438425001e-02,  7.979358310940206e-02, -3.522779569953190e-01, -5.232919952498225e-01, -7.849290648742011e-02,  3.338812234088540e-01, -8.747723842289300e-02, -3.369571099278635e-02, -9.589811561618734e-02, -3.258675345141932e-02, -4.186074846865413e-02, 7.603913700119790e-02, -1.052626824792337e-01,  1.342475149889228e-01, -1.288318797103061e-02, 8.819559813567263e-02, -8.747723842289302e-02,  2.788929347846167e-01, 4.741320576347153e-02, -4.006223724554726e-01, -5.218634728136070e-02,  2.894526357013904e-01, 3.367817704749629e-01, -2.397106648280097e-02, 4.431982326283664e-02,  2.849564824246955e-02, 3.403672747253363e-02, -3.369571099278632e-02, 4.741320576347154e-02,  1.282843499377613e-01, -8.260102188306576e-02, -9.543496908737308e-03, 6.956442930851590e-02,  7.280182634376008e-02, 1.908216832079231e-01, 2.578848485834336e-01, 1.144318904519704e+00, -1.157008258792878e-01, -9.589811561618722e-02, -4.006223724554724e-01, -8.260102188306576e-02,  1.734724108756547e+00, 2.721705015041420e-01, -8.914575824320063e-01, -1.356060016365836e+00,  2.386001664806244e-02, 8.484287847779946e-02, 2.424522842144921e-01, -9.250868836579561e-04, -3.258675345141933e-02, -5.218634728136073e-02, -9.543496908737287e-03, 2.721705015041420e-01,  1.804548238238315e-01, -1.403476694854059e-01, -2.403608596725863e-01, -1.658557147727988e-01,  5.123261640441755e-02, -3.713408427398603e-01, 1.292320715287860e-01, -4.186074846865408e-02,  2.894526357013904e-01, 6.956442930851583e-02, -8.914575824320066e-01, -1.403476694854061e-01,  6.889558392869706e-01, 7.433871846784467e-01, -1.468423540042886e-01, -2.393766247234175e-01, -9.812517375898828e-01, 8.881982438425011e-02, 7.603913700119806e-02, 3.367817704749629e-01,  7.280182634376009e-02, -1.356060016365836e+00, -2.403608596725864e-01, 7.433871846784467e-01,  1.338017294545901e+00, 9.690191945344850e-02, -4.583123740922494e-02, -1.197520394034390e-02, -2.227966864888903e-02, 2.915855870452427e-02, -3.912628012313843e-02, -6.213425953422821e-03,  4.816484172684374e-02, -2.299851312471235e-03, -6.212556731535446e-02, -1.842055221818883e-02, -4.583123740922494e-02, 4.884720350876424e-01, 5.562224096845618e-01, 8.290904954469970e-02, -1.926799792939866e-01, 7.532561596918545e-02, 2.467855815757088e-02, 1.406489148755807e-01,  5.316591543148933e-02, 3.278973877083900e-02, -1.372109692602434e-01, -1.197520394034385e-02,  5.562224096845619e-01, 1.177910946603299e+00, 8.936926289144657e-02, -2.911353779129118e-01,  1.333786887269189e-02, 2.339787232337603e-02, 5.806833259255153e-01, 1.285992259075608e-01, -1.718886475684160e-01, -4.975560630409994e-01, -2.227966864888903e-02, 8.290904954469971e-02,  8.936926289144657e-02, 1.363828192564465e-01, -3.998394548603386e-02, 4.708594890171072e-02,  2.120949780300203e-02, -5.245136767415751e-02, 6.122526644713147e-03, 6.923641129295180e-02,  3.587375607215007e-02, 2.915855870452433e-02, -1.926799792939866e-01, -2.911353779129119e-01, -3.998394548603391e-02, 2.316694853185419e-01, -4.209180433459969e-02, -1.922177441513148e-02, -6.873461472828646e-02, -2.352230969743023e-02, -1.058191004755765e-02, 5.566160955777328e-02, -3.912628012313839e-02, 7.532561596918548e-02, 1.333786887269192e-02, 4.708594890171075e-02, -4.209180433459969e-02, 1.832110838077972e-01, 2.485341741553613e-02, -1.798736353376979e-01, -1.648966357896878e-02, 1.374896099958066e-01, 1.473114258235336e-01, -6.213425953422821e-03,  2.467855815757085e-02, 2.339787232337606e-02, 2.120949780300203e-02, -1.922177441513144e-02,  2.485341741553614e-02, 1.141690676359568e-01, -3.325728867430938e-02, -2.014409109851747e-03,  3.234186448445747e-02, 3.023600737220884e-02, 4.816484172684385e-02, 1.406489148755807e-01,  5.806833259255155e-01, -5.245136767415751e-02, -6.873461472828629e-02, -1.798736353376978e-01, -3.325728867430940e-02, 8.915465251937515e-01, 1.228825757620731e-01, -4.216772385746402e-01, -6.387994758423348e-01, -2.299851312471235e-03, 5.316591543148928e-02, 1.285992259075606e-01,  6.122526644713161e-03, -2.352230969743023e-02, -1.648966357896882e-02, -2.014409109851734e-03,  1.228825757620733e-01, 1.444988371628115e-01, -6.056937951377378e-02, -1.104460499655087e-01, -6.212556731535451e-02, 3.278973877083875e-02, -1.718886475684158e-01, 6.923641129295181e-02, -1.058191004755758e-02, 1.374896099958066e-01, 3.234186448445742e-02, -4.216772385746405e-01, -6.056937951377389e-02, 3.884985073741318e-01, 3.420715684605565e-01, -1.842055221818895e-02, -1.372109692602435e-01, -4.975560630409992e-01, 3.587375607215014e-02, 5.566160955777343e-02,  1.473114258235335e-01, 3.023600737220887e-02, -6.387994758423348e-01, -1.104460499655087e-01,  3.420715684605564e-01, 7.116123272812724e-01, 9.023915367818508e-02, -3.627129709324349e-02,  1.225627587149147e-02, -2.164602391429679e-02, 2.377927469567089e-02, -4.256382299351980e-02, -5.922028084789380e-03, 7.053633038050786e-02, 1.550170418629843e-03, -7.225709209592024e-02, -3.788513649099234e-02, -3.627129709324346e-02, 3.966556874784861e-01, 4.358737548053662e-01,  6.135203923759994e-02, -1.521016092070644e-01, 5.512144172985689e-02, 1.755976322015259e-02,  1.201531154952952e-01, 4.245084210753531e-02, 1.787280746620745e-02, -1.115251741142906e-01,  1.225627587149136e-02, 4.358737548053662e-01, 9.885958991508905e-01, 5.793445928355281e-02, -2.272481061190689e-01, -1.431986657399739e-02, 1.090844522922277e-02, 5.445180364466223e-01,  1.141707504729593e-01, -1.897862434214138e-01, -4.594447077059274e-01, -2.164602391429675e-02,  6.135203923759991e-02, 5.793445928355276e-02, 1.217249961540223e-01, -3.085990481192290e-02,  4.124578449173176e-02, 1.762342083761274e-02, -5.712334476181165e-02, 2.156825717184761e-03,  6.270857902186716e-02, 4.316544391657860e-02, 2.377927469567086e-02, -1.521016092070644e-01, -2.272481061190688e-01, -3.085990481192292e-02, 2.041417032902351e-01, -3.545622333885899e-02, -1.602522051677136e-02, -4.716870873103646e-02, -1.690285756858569e-02, -1.151829084878083e-02,  3.444863127307192e-02, -4.256382299351974e-02, 5.512144172985694e-02, -1.431986657399729e-02,  4.124578449173175e-02, -3.545622333885903e-02, 1.724531985880584e-01, 2.313013108162026e-02, -1.867286893709721e-01, -2.059335679168446e-02, 1.339056038457407e-01,
                  1.573236310566851e-01, -5.922028084789387e-03, 1.755976322015257e-02, 1.090844522922281e-02, 1.762342083761276e-02, -1.602522051677133e-02, 2.313013108162026e-02, 1.057752300046884e-01, -3.658124308890400e-02, -3.603183420223838e-03, 3.067618730227845e-02, 3.406021259133293e-02, 7.053633038050787e-02,  1.201531154952951e-01, 5.445180364466226e-01, -5.712334476181161e-02, -4.716870873103633e-02, -1.867286893709721e-01, -3.658124308890400e-02, 8.799881838100678e-01, 1.231666294547683e-01, -4.215880030201155e-01, -6.404771223220270e-01, 1.550170418629787e-03, 4.245084210753527e-02,  1.141707504729592e-01, 2.156825717184768e-03, -1.690285756858569e-02, -2.059335679168448e-02, -3.603183420223824e-03, 1.231666294547684e-01, 1.363927983270632e-01, -6.392595378476607e-02, -1.104754818040109e-01, -7.225709209592021e-02, 1.787280746620733e-02, -1.897862434214136e-01,  6.270857902186716e-02, -1.151829084878078e-02, 1.339056038457407e-01, 3.067618730227840e-02, -4.215880030201155e-01, -6.392595378476618e-02, 3.718312051175547e-01, 3.488305590648131e-01, -3.788513649099234e-02, -1.115251741142907e-01, -4.594447077059273e-01, 4.316544391657862e-02,  3.444863127307207e-02, 1.573236310566850e-01, 3.406021259133293e-02, -6.404771223220271e-01, -1.104754818040109e-01, 3.488305590648130e-01, 7.088176969835316e-01, 6.284488190864063e-02, -4.346028066257978e-02, -4.958521587454019e-02, -1.040683384812420e-02, 1.872177048541566e-02, -9.019771005222558e-03, 3.106493988726602e-03, -3.748224015312074e-02, -1.745692827497511e-02, -8.576658440203722e-03, 5.663422223084877e-02, -4.346028066257979e-02, 2.405019095789133e-01,  1.705147996569965e-01, 3.474526591672408e-02, -7.446057853758492e-02, 4.375803620898468e-02,  1.002440046387483e-02, -6.592179911688135e-03, 1.048618405571969e-02, 4.540803556443695e-02, -1.719696151469621e-03, -4.958521587454018e-02, 1.705147996569965e-01, 3.710682336946131e-01,  3.989723568079527e-02, -9.799265081611760e-02, 4.938867595039753e-02, 1.516599867996928e-02,  5.422721159423164e-02, 1.441396534424246e-02, 1.880462571912284e-02, -4.277513412958124e-02, -1.040683384812419e-02, 3.474526591672408e-02, 3.989723568079528e-02, 1.011380148144388e-01, -1.468922507563955e-02, 1.918772635357807e-02, 9.966117621068213e-03, -1.869954580901882e-02,  5.575769582164039e-03, 2.839228677223379e-02, 1.193448138348496e-02, 1.872177048541564e-02, -7.446057853758495e-02, -9.799265081611752e-02, -1.468922507563956e-02, 1.530007479406484e-01, -2.209687106619714e-02, -9.740210220810064e-03, -1.396711552442746e-03, -4.624433402535402e-03, -1.477867059695759e-02, -3.043595451545849e-03, -9.019771005222534e-03, 4.375803620898472e-02,  4.938867595039752e-02, 1.918772635357805e-02, -2.209687106619715e-02, 1.118326712704898e-01,  9.541422291274779e-03, -3.028979395094942e-02, 4.292569311585663e-03, 3.440739120073311e-02,  2.555311218089385e-02, 3.106493988726595e-03, 1.002440046387481e-02, 1.516599867996929e-02,  9.966117621068216e-03, -9.740210220810040e-03, 9.541422291274793e-03, 9.481053471821954e-02, -3.994526852966994e-03, 1.158084838159136e-03, 7.237569230068040e-03, 6.410162920769173e-03, -3.748224015312071e-02, -6.592179911688135e-03, 5.422721159423174e-02, -1.869954580901879e-02, -1.396711552442659e-03, -3.028979395094949e-02, -3.994526852967011e-03, 2.444365821399023e-01,  9.980804857206392e-03, -7.882738572197349e-02, -1.089826582324918e-01, -1.745692827497512e-02,  1.048618405571964e-02, 1.441396534424245e-02, 5.575769582164028e-03, -4.624433402535398e-03,  4.292569311585649e-03, 1.158084838159136e-03, 9.980804857206441e-03, 1.079119015534790e-01, -5.636172487602529e-03, -1.371757942220821e-02, -8.576658440203749e-03, 4.540803556443693e-02,  1.880462571912284e-02, 2.839228677223379e-02, -1.477867059695756e-02, 3.440739120073318e-02,  7.237569230068023e-03, -7.882738572197338e-02, -5.636172487602594e-03, 1.620470079363034e-01,  6.104037893981269e-02, 5.663422223084880e-02, -1.719696151469680e-03, -4.277513412958113e-02,  1.193448138348496e-02, -3.043595451545748e-03, 2.555311218089375e-02, 6.410162920769184e-03, -1.089826582324918e-01, -1.371757942220823e-02, 6.104037893981271e-02, 2.508068100394863e-01,  5.086478825882694e-02, -1.437615545880939e-02, -2.300326692847278e-03, -3.402063458148292e-03, -1.355300819270551e-03, -2.650444763573521e-03, 4.802191089902208e-03, -2.248100905697147e-02, -1.274300321540488e-02, -6.662852050356001e-03, 4.637303845994811e-02, -1.437615545880937e-02,  2.179132558964162e-01, 1.911219202326146e-01, 2.315223807540719e-02, -6.341066793286605e-02,  1.323690172605644e-02, 4.695216570335713e-03, 6.453367453362580e-02, 2.198951782082502e-02, -2.505580585372902e-03, -6.484186112220791e-02, -2.300326692847278e-03, 1.911219202326146e-01,  4.785778550893807e-01, 2.974558234305861e-02, -1.072680432057470e-01, 4.605460132691624e-03,  6.010646987408712e-03, 2.017892847998093e-01, 4.440215610707591e-02, -6.311074842739788e-02, -1.746780893009750e-01, -3.402063458148287e-03, 2.315223807540718e-02, 2.974558234305861e-02,  8.998143079995224e-02, -7.472001767747184e-03, 1.132490382732963e-02, 7.347065234801266e-03, -7.776784980322526e-03, 5.562693458021429e-03, 1.657333550942141e-02, 2.795572771253824e-03, -1.355300819270554e-03, -6.341066793286611e-02, -1.072680432057469e-01, -7.472001767747191e-03,  1.383886926517321e-01, -3.085409099260106e-03, -6.157014220843624e-03, -4.306739831373707e-02, -1.172325667837122e-02, 1.328208793887380e-02, 3.601985130228216e-02, -2.650444763573508e-03,  1.323690172605649e-02, 4.605460132691579e-03, 1.132490382732961e-02, -3.085409099260125e-03,  9.943086604647350e-02, 7.978485045359135e-03, -3.889665989638745e-02, -7.458248967881047e-04,  2.905738108601006e-02, 3.276727276149460e-02, 4.802191089902208e-03, 4.695216570335704e-03,  6.010646987408715e-03, 7.347065234801269e-03, -6.157014220843610e-03, 7.978485045359158e-03,  8.875188793680472e-02, -5.568004041340193e-03, 6.626579863793294e-05, 5.413304955916355e-03,  7.610054710372859e-03, -2.248100905697147e-02, 6.453367453362577e-02, 2.017892847998093e-01, -7.776784980322507e-03, -4.306739831373698e-02, -3.889665989638755e-02, -5.568004041340205e-03,  3.289457901727370e-01, 3.534010174370142e-02, -1.062979114837182e-01, -1.893127178943667e-01, -1.274300321540488e-02, 2.198951782082497e-02, 4.440215610707596e-02, 5.562693458021416e-03, -1.172325667837121e-02, -7.458248967881324e-04, 6.626579863793641e-05, 3.534010174370143e-02,  1.077708996114889e-01, -1.656136220223262e-02, -3.547394264640374e-02, -6.662852050356036e-03, -2.505580585372895e-03, -6.311074842739786e-02, 1.657333550942144e-02, 1.328208793887381e-02,  2.905738108601014e-02, 5.413304955916333e-03, -1.062979114837180e-01, -1.656136220223271e-02,  1.542737672233780e-01, 8.628986298142829e-02, 4.637303845994808e-02, -6.484186112220805e-02, -1.746780893009749e-01, 2.795572771253831e-03, 3.601985130228229e-02, 3.276727276149451e-02,  7.610054710372866e-03, -1.893127178943668e-01, -3.547394264640375e-02, 8.628986298142824e-02,  3.147064343337095e-01, 4.547779196864692e-02, 1.008266630767820e-02, 3.430682683042556e-02, -1.753194380871332e-03, -1.413315169959449e-02, -3.034244790183944e-04, 4.990270864346584e-03, -6.763366060044931e-03, -8.176754725460141e-03,
                  -9.241884399160041e-03, 3.363821885462505e-02,  1.008266630767823e-02, 1.615801216705255e-01, 1.350043159073474e-01, 1.535438840490314e-02, -3.413659614083737e-02, 9.068910806383302e-04, 6.056229108982805e-04, 6.011762951755725e-02,  2.088425950846293e-02, -1.658058183748023e-02, -6.226931101169472e-02, 3.430682683042557e-02,  1.350043159073473e-01, 4.060505321096562e-01, 2.121913357079791e-02, -7.149838104549260e-02, -6.113897216784643e-04, -7.953409310319185e-05, 1.735944579102276e-01, 4.319283759732996e-02, -6.928639389670876e-02, -1.539625133293840e-01, -1.753194380871329e-03, 1.535438840490315e-02,  2.121913357079792e-02, 8.439711159640470e-02, -4.878160582752701e-03, 1.032191049777292e-02,  6.416482973251969e-03, -9.784356223219125e-03, 3.669010345864823e-03, 1.486193931994331e-02,  5.468462072421288e-03, -1.413315169959450e-02, -3.413659614083745e-02, -7.149838104549254e-02, -4.878160582752686e-03, 1.177218932807444e-01, 1.624248150614111e-03, -4.589659409489755e-03, -3.173609833274622e-02, -9.593052818820651e-03, 1.492968040637786e-02, 2.808372028647985e-02, -3.034244790184051e-04, 9.068910806383874e-04, -6.113897216785246e-04, 1.032191049777292e-02,  1.624248150614073e-03, 8.853179343434250e-02, 7.425303384412418e-03, -2.562296775818041e-02, -9.410177329120563e-04, 1.941983137371869e-02, 2.205306561910651e-02, 4.990270864346580e-03,  6.056229108982771e-04, -7.953409310318318e-05, 6.416482973251975e-03, -4.589659409489749e-03,  7.425303384412442e-03, 8.398860358180357e-02, -7.041010423633897e-03, -8.345532045147038e-04,  4.664613948771211e-03, 9.005798961866547e-03, -6.763366060044997e-03, 6.011762951755722e-02,  1.735944579102276e-01, -9.784356223219083e-03, -3.173609833274617e-02, -2.562296775818041e-02, -7.041010423633910e-03, 2.738012449789924e-01, 3.383416088765002e-02, -8.371868408126254e-02, -1.495632056543593e-01, -8.176754725460127e-03, 2.088425950846289e-02, 4.319283759733000e-02,  3.669010345864808e-03, -9.593052818820644e-03, -9.410177329120840e-04, -8.345532045146969e-04,  3.383416088765005e-02, 1.037917092406473e-01, -1.738067226977359e-02, -3.450485968126255e-02, -9.241884399160072e-03, -1.658058183748016e-02, -6.928639389670885e-02, 1.486193931994335e-02,  1.492968040637783e-02, 1.941983137371879e-02, 4.664613948771202e-03, -8.371868408126248e-02, -1.738067226977365e-02, 1.345174673820434e-01, 6.947301898952658e-02, 3.363821885462501e-02, -6.226931101169479e-02, -1.539625133293839e-01, 5.468462072421321e-03, 2.808372028647993e-02,  2.205306561910647e-02, 9.005798961866547e-03, -1.495632056543594e-01, -3.450485968126253e-02,  6.947301898952660e-02, 2.777012374046995e-01, 4.555956729160522e-02, 1.895516400118608e-02,  5.625934866396406e-02, -8.359636590631841e-04, -1.850716469985116e-02, -2.677672111993481e-03,  3.124564529103667e-03, 9.596264067002980e-03, -4.227041442935562e-03, -2.040626586407272e-02,  1.622127748024907e-02, 1.895516400118608e-02, 1.435005881927894e-01, 1.030703323640214e-01,  1.416503964085328e-02, -2.902687735647931e-02, 2.280916333912313e-03, 4.036146214537135e-03,  3.060947587792805e-02, 1.376394848307518e-02, 7.346530022958511e-04, -2.652147826348760e-02,  5.625934866396401e-02, 1.030703323640215e-01, 3.460855235853132e-01, 1.752589272433902e-02, -5.703630335593512e-02, -3.780313743740447e-03, 2.832821316110391e-04, 1.336906062198319e-01,  3.508896676297782e-02, -5.530141816413602e-02, -1.055353576257707e-01, -8.359636590631841e-04,  1.416503964085328e-02, 1.752589272433899e-02, 7.965672420824056e-02, -5.512003281350856e-03,  1.024742560699880e-02, 7.099713691077669e-03, -1.222264854374552e-02, 1.854908617283320e-03,  1.770399374774033e-02, 1.080905629168226e-02, -1.850716469985115e-02, -2.902687735647933e-02, -5.703630335593502e-02, -5.512003281350854e-03, 1.135415153108286e-01, -4.058637205292916e-04, -7.039364635175938e-03, -1.466566191778554e-02, -5.702924146615891e-03, 2.278717171180726e-03,  7.964353471919068e-03, -2.677672111993487e-03, 2.280916333912326e-03, -3.780313743740552e-03,  1.024742560699881e-02, -4.058637205293025e-04, 8.907819859838474e-02, 9.992192171770756e-03, -3.339917844852685e-02, -3.720662008459879e-03, 2.946710101315868e-02, 3.217198703133761e-02,  3.124564529103663e-03, 4.036146214537126e-03, 2.832821316110425e-04, 7.099713691077673e-03, -7.039364635175928e-03, 9.992192171770782e-03, 8.214797817783824e-02, -1.269797686137365e-02, -1.881580881368437e-03, 9.795884131100340e-03, 1.481628588139815e-02, 9.596264067002966e-03,  3.060947587792800e-02, 1.336906062198318e-01, -1.222264854374551e-02, -1.466566191778548e-02, -3.339917844852684e-02, -1.269797686137367e-02, 2.526697437317296e-01, 3.197409267414156e-02, -9.302650347809790e-02, -1.329605048044912e-01, -4.227041442935566e-03, 1.376394848307516e-02,  3.508896676297786e-02, 1.854908617283311e-03, -5.702924146615884e-03, -3.720662008459883e-03, -1.881580881368434e-03, 3.197409267414155e-02, 1.003534760077043e-01, -2.050035681792485e-02, -3.220588466903609e-02, -2.040626586407273e-02, 7.346530022958511e-04, -5.530141816413624e-02,  1.770399374774036e-02, 2.278717171180728e-03, 2.946710101315875e-02, 9.795884131100328e-03, -9.302650347809775e-02, -2.050035681792493e-02, 1.496654217393636e-01, 8.071425368086978e-02,  1.622127748024903e-02, -2.652147826348766e-02, -1.055353576257707e-01, 1.080905629168229e-02,  7.964353471919114e-03, 3.217198703133761e-02, 1.481628588139813e-02, -1.329605048044910e-01, -3.220588466903610e-02, 8.071425368086980e-02, 2.590781816684786e-01, 4.621980915850431e-02,  1.482727833806387e-02, 4.530908100310799e-02, -8.092742277761092e-04, -1.591098653765263e-02, -2.139184153848446e-04, 3.783199673691402e-03, 8.252270523331773e-04, -7.097376465901008e-03, -1.220070347636039e-02, 2.498781313144967e-02, 1.482727833806386e-02, 1.538794491986182e-01,  1.218753556400776e-01, 1.840513954506590e-02, -3.529482893916241e-02, -1.954498736526196e-03,  3.837000259261433e-03, 3.445675980933324e-02, 1.791835336934562e-02, -1.960896883188242e-03, -3.845568482906991e-02, 4.530908100310799e-02, 1.218753556400776e-01, 3.698321980489345e-01,  2.711411178725595e-02, -6.566231446541480e-02, -9.465209821436069e-03, -4.821153388783958e-05,  1.406965319289329e-01, 4.016228669210127e-02, -5.143408209274919e-02, -1.253401083782470e-01, -8.092742277761135e-04, 1.840513954506590e-02, 2.711411178725592e-02, 7.772864582615793e-02, -8.692401982816180e-03, 8.040515627902997e-03, 6.278563459027012e-03, -4.767636590945057e-03,  4.102454008032377e-03, 1.184022724709655e-02, 3.087659701359145e-03, -1.591098653765261e-02, -3.529482893916244e-02, -6.566231446541473e-02, -8.692401982816175e-03, 1.159796159796281e-01,  1.156784846848341e-03, -6.886306741842667e-03, -1.365554939783357e-02, -7.784230153185946e-03,  2.525784821832889e-03, 1.232176553662346e-02, -2.139184153848489e-04, -1.954498736526197e-03, -9.465209821436109e-03, 8.040515627902999e-03, 1.156784846848338e-03, 8.618507411006718e-02,  8.613363637181482e-03, -3.751704240595290e-02, -2.921438717550642e-03, 2.430097085319246e-02,  3.423456489071743e-02, 3.783199673691401e-03, 3.837000259261422e-03, -4.821153388784218e-05,  6.278563459027013e-03, -6.886306741842654e-03, 8.613363637181501e-03, 8.019279682170360e-02, -1.109945282748732e-02,
                  -9.106909087092559e-04, 7.148070785490689e-03, 1.297698943133808e-02,  8.252270523331478e-04, 3.445675980933320e-02, 1.406965319289328e-01, -4.767636590945053e-03, -1.365554939783354e-02, -3.751704240595294e-02, -1.109945282748733e-02, 2.646312968589406e-01,  3.167106791070420e-02, -8.252682202562503e-02, -1.474172338412466e-01, -7.097376465901009e-03,  1.791835336934561e-02, 4.016228669210130e-02, 4.102454008032367e-03, -7.784230153185941e-03, -2.921438717550653e-03, -9.106909087092567e-04, 3.167106791070422e-02, 9.890238353083725e-02, -1.622899605738831e-02, -3.282722209073995e-02, -1.220070347636044e-02, -1.960896883188254e-03, -5.143408209274930e-02, 1.184022724709657e-02, 2.525784821832905e-03, 2.430097085319250e-02,  7.148070785490679e-03, -8.252682202562490e-02, -1.622899605738836e-02, 1.300012714900114e-01,  7.152555659065553e-02, 2.498781313144967e-02, -3.845568482906998e-02, -1.253401083782470e-01,  3.087659701359153e-03, 1.232176553662351e-02, 3.423456489071742e-02, 1.297698943133807e-02, -1.474172338412465e-01, -3.282722209073995e-02, 7.152555659065553e-02, 2.742651577415615e-01,  4.824086150194780e-02, 1.851135177309875e-02, 4.919445282763738e-02, 2.026343608529330e-03, -1.931904551997846e-02, 9.567961972648418e-04, 5.586295194090445e-03, -6.021924335562422e-03, -6.508053299023071e-03, -8.460044324054087e-03, 2.958283058369288e-02, 1.851135177309876e-02,  1.530211774429552e-01, 1.306503444528651e-01, 8.565386817628735e-03, -3.294697107164529e-02, -6.983941246038889e-03, 4.541889871427866e-03, 6.651219774041864e-02, 2.240812507035436e-02, -2.168119876121058e-02, -5.841534261623262e-02, 4.919445282763746e-02, 1.306503444528650e-01,  4.009968270422022e-01, 1.546755692650689e-02, -6.987140501986530e-02, -1.712986944456319e-02,  5.208914493073358e-03, 2.031835751339987e-01, 5.286393340247356e-02, -8.726529675140678e-02, -1.630731587972041e-01, 2.026343608529316e-03, 8.565386817628732e-03, 1.546755692650689e-02,  7.221806174111212e-02, -2.956625824138957e-03, 3.964969155321290e-03, 4.455517277886846e-03,  1.962730076385800e-03, 4.143781052237766e-03, 5.156052977788983e-03, -1.968318796819364e-03, -1.931904551997846e-02, -3.294697107164530e-02, -6.987140501986536e-02, -2.956625824138952e-03,  1.128862842732083e-01, 5.834439526125107e-03, -6.122318664896888e-03, -3.676804281683675e-02, -1.114271849306042e-02, 1.674509039579066e-02, 2.803535965627334e-02, 9.567961972648431e-04, -6.983941246038875e-03, -1.712986944456315e-02, 3.964969155321289e-03, 5.834439526125094e-03,  8.503433081649769e-02, 5.123921436402184e-03, -3.532575850175484e-02, -4.945370927768528e-03,  2.195756829848736e-02, 3.209350408514255e-02, 5.586295194090444e-03, 4.541889871427857e-03,  5.208914493073378e-03, 4.455517277886845e-03, -6.122318664896884e-03, 5.123921436402191e-03,  7.861785808925978e-02, 1.250641839785160e-03, 1.037969409675231e-03, 1.075848447909490e-04,  2.221353785030102e-03, -6.021924335562440e-03, 6.651219774041860e-02, 2.031835751339988e-01,  1.962730076385770e-03, -3.676804281683670e-02, -3.532575850175487e-02, 1.250641839785148e-03,  3.018194082508843e-01, 4.454252039582007e-02, -9.613563827741606e-02, -1.662603645558211e-01, -6.508053299023061e-03, 2.240812507035436e-02, 5.286393340247352e-02, 4.143781052237760e-03, -1.114271849306042e-02, -4.945370927768534e-03, 1.037969409675228e-03, 4.454252039582009e-02,  1.021864924449853e-01, -2.303064630620258e-02, -4.158291262103771e-02, -8.460044324054143e-03, -2.168119876121056e-02, -8.726529675140686e-02, 5.156052977788996e-03, 1.674509039579065e-02,  2.195756829848743e-02, 1.075848447909603e-04, -9.613563827741592e-02, -2.303064630620261e-02,  1.329392602904001e-01, 7.843700158703966e-02, 2.958283058369286e-02, -5.841534261623266e-02, -1.630731587972040e-01, -1.968318796819375e-03, 2.803535965627342e-02, 3.209350408514251e-02,  2.221353785030089e-03, -1.662603645558212e-01, -4.158291262103771e-02, 7.843700158703966e-02,  2.826946749206500e-01, 4.789743388848910e-02, 5.022361246522075e-03, 1.002153436320021e-02,  1.896346533360564e-03, -1.167979305628103e-02, 8.662379429434760e-03, 6.755834045531347e-03, -4.712910721179382e-02, -1.186670925647884e-02, 1.119597955684073e-02, 6.217453923458157e-02,  5.022361246522074e-03, 1.252461819913556e-01, 5.394796664055224e-02, 2.924148894385824e-03, -2.318123705364925e-02, 4.465297406100079e-03, 1.152224878720113e-03, 1.119811620759379e-02, -1.385770710675961e-03, 6.424621582570348e-03, -7.063313736800847e-03, 1.002153436320020e-02,  5.394796664055224e-02, 1.888337340835190e-01, 6.253609192063760e-03, -3.879795959386224e-02,  1.826141536829474e-02, -1.481109092385058e-03, 3.926398236740268e-02, -6.572198877471333e-04, -3.916254756103621e-03, -1.811865972202656e-02, 1.896346533360559e-03, 2.924148894385825e-03,  6.253609192063748e-03, 7.228921745774934e-02, -2.369583853768190e-03, 3.963246012894412e-03,  4.470110205076099e-03, -3.310945969490978e-03, 8.647105508165584e-04, 7.028574018687697e-03,  3.672071127273125e-03, -1.167979305628102e-02, -2.318123705364922e-02, -3.879795959386224e-02, -2.369583853768181e-03, 1.118096326996528e-01, -8.031503324605132e-04, -4.679042572868520e-03, -1.163819758968773e-02, 2.163601608566522e-04, 2.394741759387394e-03, 4.084560925757518e-03,  8.662379429434748e-03, 4.465297406100088e-03, 1.826141536829472e-02, 3.963246012894410e-03, -8.031503324605182e-04, 7.898339683533412e-02, 4.967396671384395e-03, -2.368286320066361e-03, -3.670949812920956e-04, 5.151914855139515e-03, 6.023060896646894e-03, 6.755834045531347e-03,  1.152224878720107e-03, -1.481109092385054e-03, 4.470110205076097e-03, -4.679042572868515e-03,  4.967396671384395e-03, 7.993244064723898e-02, -2.747843064232616e-03, 1.324774852304459e-04,  1.756451867057228e-03, 6.240875724027183e-03, -4.712910721179387e-02, 1.119811620759383e-02,  3.926398236740260e-02, -3.310945969490991e-03, -1.163819758968774e-02, -2.368286320066373e-03, -2.747843064232614e-03, 1.691990765058825e-01, 9.166053045845233e-03, -2.546094851573300e-02, -5.159184401030641e-02, -1.186670925647884e-02, -1.385770710675954e-03, -6.572198877471298e-04,  8.647105508165591e-04, 2.163601608566520e-04, -3.670949812921032e-04, 1.324774852304433e-04,  9.166053045845226e-03, 9.443400999348293e-02, -8.022481546586855e-03, -1.125211627477077e-02,  1.119597955684071e-02, 6.424621582570346e-03, -3.916254756103677e-03, 7.028574018687696e-03,  2.394741759387396e-03, 5.151914855139505e-03, 1.756451867057228e-03, -2.546094851573290e-02, -8.022481546586859e-03, 9.811468965818401e-02, 2.015830417931792e-02, 6.217453923458156e-02, -7.063313736800851e-03, -1.811865972202653e-02, 3.672071127273115e-03, 4.084560925757545e-03,  6.023060896646880e-03, 6.240875724027184e-03, -5.159184401030636e-02, -1.125211627477078e-02,  2.015830417931798e-02, 1.905564600888125e-01, 5.713600911939040e-02, 6.499161351604606e-03,  7.766394940110624e-03, 2.527731240385220e-03, -9.012890218966738e-03, 6.949656297538765e-03,  4.568708128856097e-03, -5.141992501894355e-02, -1.309942974773104e-02, 1.489128606970862e-02,  6.662603721662934e-02, 6.499161351604606e-03, 1.866439453909846e-01, 1.572469160149176e-01,  1.353826946481763e-02, -4.687675981588776e-02, 8.221092535367087e-03, 1.704094247595567e-03,
                  6.833467601482637e-02, 1.615934319476086e-02, -1.254415311765016e-02, -6.685420825447476e-02,  7.766394940110624e-03, 1.572469160149176e-01, 4.044522987248722e-01, 2.355332599094641e-02, -8.540714793134269e-02, 1.087058676536043e-02, -3.995860137763657e-03, 1.753795359445343e-01,  3.115307825075266e-02, -5.630696997460040e-02, -1.480108776599309e-01, 2.527731240385220e-03,  1.353826946481763e-02, 2.355332599094641e-02, 8.184537458138239e-02, -6.972965822049454e-03,  7.965705586882893e-03, 7.664576608709173e-03, 1.922270386483471e-03, 4.994564783320641e-03,  8.807249106040631e-03, -4.302802473614574e-03, -9.012890218966738e-03, -4.687675981588776e-02, -8.540714793134269e-02, -6.972965822049454e-03, 1.297660941933373e-01, -3.107382441678720e-03, -5.527035493541979e-03, -3.874422984693320e-02, -7.598436974156865e-03, 1.364945434483522e-02,  3.155904166994288e-02, 6.949656297538765e-03, 8.221092535367087e-03, 1.087058676536043e-02,  7.965705586882893e-03, -3.107382441678720e-03, 9.556422962750245e-02, 9.230571400805677e-03, -2.398497881085540e-02, -7.320558538295129e-04, 1.921534319331807e-02, 2.115345512787638e-02,  4.568708128856097e-03, 1.704094247595567e-03, -3.995860137763657e-03, 7.664576608709173e-03, -5.527035493541979e-03, 9.230571400805677e-03, 8.762922892534317e-02, -1.214975389414722e-02, -7.001404409247565e-04, 8.134689705863144e-03, 1.353791849066216e-02, -5.141992501894355e-02,  6.833467601482637e-02, 1.753795359445343e-01, 1.922270386483471e-03, -3.874422984693320e-02, -2.398497881085540e-02, -1.214975389414722e-02, 2.817380276981974e-01, 2.473262779188702e-02, -7.430124439442239e-02, -1.416035686230538e-01, -1.309942974773104e-02, 1.615934319476086e-02,  3.115307825075266e-02, 4.994564783320641e-03, -7.598436974156865e-03, -7.320558538295129e-04, -7.001404409247565e-04, 2.473262779188702e-02, 1.034931635755103e-01, -1.206142626025931e-02, -2.546537027357219e-02, 1.489128606970862e-02, -1.254415311765016e-02, -5.630696997460040e-02,  8.807249106040631e-03, 1.364945434483522e-02, 1.921534319331807e-02, 8.134689705863144e-03, -7.430124439442239e-02, -1.206142626025931e-02, 1.294249924096733e-01, 5.700429717908129e-02,  6.662603721662934e-02, -6.685420825447476e-02, -1.480108776599309e-01, -4.302802473614574e-03,  3.155904166994288e-02, 2.115345512787638e-02, 1.353791849066216e-02, -1.416035686230538e-01, -2.546537027357219e-02, 5.700429717908129e-02, 2.747854767565665e-01 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$method),
               c("EKF" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$model),
               c("exponential" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$LR),
               c(0.0877914951989026 )
               , tolerance = 1e-05)
})

#############
# Test ukf for exponential model
test_that("UKF and exp models give previous computed results",{
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 2,
    Q_0 = diag(1, 2),
    Q = diag(1e-1, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4,
                   method = "UKF", beta = 0),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential"))

  # plot(result_exp, cov_index = 1)
  # get_expect_equal(result_exp, file = "tmp.txt")

  expect_equal(c(result_exp$state_vecs),
               c(-3.16199430337179610, -3.16198708395727657, -2.78623108042084278, -2.56228292273211444, -2.90743359326256678, -3.10062205387759704, -3.33580310975087357, -3.41234771827994621, -3.50366626137125037, -3.61502277333748134, -3.71132284679002078, -3.86517945282306741, -3.99546432056050627, -4.11531585921853704, -4.16729804960914407, -4.22736821201123458, 0.34780900532241971, 0.34782203045614879, 0.53790347839878894, 0.65159168262057665,  0.48426982848327976, 0.40068722743400220, 0.29094955110058607, 0.26817382135840329, 0.22393430569403019,  0.17344861804905146, 0.12896626453875240, 0.04600508273813272, -0.02235584515736795, -0.08227043740544628, -0.11044552866380872, -0.13860082016259184 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.269555544328238694, 0.026053935667783364, 0.026053935667782850, 0.193628418752367693, 0.189222021374983201, -0.009396627040680491, -0.009396627040681116, 0.162628606510636431, 0.156118029209446646, -0.022502041952993601, -0.022502041952994198, 0.148079732969919220, 0.123705022690981645, -0.038400411078905142, -0.038400411078905711,  0.132512916183176344, 0.102748043634898478, -0.049426126997736353, -0.049426126997736922, 0.123647999137540807,  0.118978722738251219, -0.039049123113550174, -0.039049123113550716, 0.135129455056223535, 0.134218698294669592, -0.030612683576736435, -0.030612683576736941, 0.148917706117519338, 0.152659261292579063, -0.022223551634789708, -0.022223551634790166, 0.164857575528181255, 0.166458776107462680, -0.017420368823043715, -0.017420368823044183,  0.180267872077609470, 0.181166440528194944, -0.013449992856644648, -0.013449992856645099, 0.196436411097436592,  0.201254244947800420, -0.007688597414792879, -0.007688597414793330, 0.214795860751088696, 0.222552900375636631, -0.001987382846240879, -0.001987382846241302, 0.234140046027276227, 0.253469020819906077, 0.007275751591854895,  0.007275751591854479, 0.256079353103652874, 0.296620730159250279, 0.021571901071078238, 0.021571901071077815,  0.281204310053986162, 0.360564506272234631, 0.045209866274483854, 0.045209866274483416, 0.311561685452059312,  0.452044767091079380, 0.081162275036824189, 0.081162275036823744, 0.348238947290205103 ))

  expect_equal(c(result_exp$lag_one_cor),
               c(  1.546028800904405e-01, 2.643773741444061e-03, 1.169249661951227e-03, 1.245778982038979e-01,   1.050543901998079e-01, -1.655917429047343e-02, -1.719710999529248e-02, 1.026139917535743e-01,   7.554198335706871e-02, -2.602359682915641e-02, -2.794858815007396e-02, 8.673697407134492e-02,   5.438800569150745e-02, -3.322513277130497e-02, -3.443003592323718e-02, 7.375373218911752e-02,   5.101782831570285e-02, -3.191469661661157e-02, -2.977190467349472e-02, 6.948520980271258e-02,   6.083184006371047e-02, -2.161845003089291e-02, -1.962545646923080e-02, 7.160794039676963e-02,   7.260140182267005e-02, -1.077871262801296e-02, -9.274368340218830e-03, 7.393606214500026e-02,   8.439525715025871e-02, -3.071771750401756e-04, 7.326760943436178e-04, 7.523106671678172e-02,   9.372454318288817e-02, 8.798639562029274e-03, 9.443252040565342e-03, 7.450457501629963e-02,   1.036297627557526e-01, 1.824101507461600e-02, 1.866538665411709e-02, 7.241992284659790e-02,   1.118157834696941e-01, 2.724228952823509e-02, 2.751503443646169e-02, 6.835958925090949e-02,   1.143121374456680e-01, 3.400752277215534e-02, 3.412217418750479e-02, 6.119213227737630e-02,   1.058441687580752e-01, 3.607384046902287e-02, 3.611114241528623e-02, 4.958332318599007e-02,   7.410912277223547e-02, 2.774312296528218e-02, 2.775283221259562e-02, 3.066642786743218e-02,   0.000000000000000e+00, 0.000000000000000e+00, 1.770731274695028e-320, 1.978423033621121e-316 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(67 ))

  expect_equal(c(result_exp$Q),
               c(0.07160509933767206, 0.02994612473266408, 0.02994612473266408, 0.02413655616270586 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("UKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(1 ))




  set.seed(44334)
  sims <- test_sim_func_exp(n_series = 1e4, n_vars = 10, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                            intercept_start = -5, sds = c(.1, rep(1, 10)))
  # sum(sims$res$event)

  arg_list <- list(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(1, 11),
    Q = diag(1e-2, 11),
    control = list(est_Q_0 = F, n_max = 10^2, eps = 10^-2,
                   method = "UKF", beta = 2, save_risk_set = F,
                   save_data = F),
    max_T = 10,
    id = sims$res$id, order = 1,
    model = "exponential")

  suppressMessages(fit <- do.call(ddhazard, arg_list))

  matplot(fit$state_vecs, lty = 2, type = "l", ylim = range(fit$state_vecs, sims$betas))
  matplot(sims$betas, lty = 1, add = T, type = "l")
  # get_expect_equal(fit, eps = 1e-6, file = "tmp.txt")

  expect_equal(c(fit$state_vecs),
               c(-5.60260901723738414, -5.58219021358408796, -5.50704212540294247, -5.38502432764837291, -5.21244373338562639, -5.11429914528859086, -5.04081278841498026, -5.03725477863289317, -4.98616733427990688, -4.97561082287763146, -4.93639132037096839, 1.20184570995173590, 1.19463832261102465, 1.22314322266643116, 1.22007615439078831,  0.98796605104418533, 1.24151520396720327, 1.27642085812923001, 1.65248367159669285, 2.47925332578005175,  2.61955293915081278, 2.50034126345124053, 0.23391207976106010, 0.37155294948919526, 0.84567392420358933,  1.52413482056141225, 2.65776618909066542, 3.39371090577821954, 3.97644978604687216, 4.15887418809556753,  4.50006633732661321, 4.67889602888509604, 5.14355724690827376, -0.16669723849371604, -0.25893160758332617, -0.68869731897519493, -1.16615394621058077, -2.70520093449867316, -2.36415370750489773, -1.14810496117325589,  0.29894591559041656, 1.53979576550021813, 1.71032531926062958, 1.46315557195991608, 0.74173923688923027,  0.58500243964120813, 0.25038528321732562, -0.81104099848318378, -2.20119009777991437, -2.38171004253188379, -3.73871058485305863, -3.23134953988446005, -1.69141800578290180, -1.10302238641197681, -1.24105467824048743,  1.44875215905644072, 1.40693901778507136, 1.16133556352667400, 0.17584749187099757, -0.14737003008478683, -0.08106666982237473, 0.05368223297659599, 0.77117479498165753, 0.51361576716149226, 1.30127424973598416,  2.69692136984777964, -0.59287912451607883, -0.57798373127868097, -0.40081198239162896, -0.39705404485355589, -0.34286607507642886, 0.11767810533366690, -0.18315231935896761, 0.20378563480576964, 1.37082803459364344,  1.74609469262671246, 1.84968198072806467, -0.92097985334128063, -1.01498970388279619, -1.21623223300947236, -1.75044969719583898, -2.41351959805473770, -2.79549279862708788, -3.87985620452557400, -4.06755655969779895, -3.70039660474361476, -3.59216665294213078, -3.87448455638639189, 0.13443853737439385, 0.06942045028220789, -0.41838079402789163, -0.71354848526116132, -1.40545742650509098, -2.08838849718451769, -1.09491061997462902, -1.16853756471138182, -2.86238702382859111, -3.38183571379903158, -3.48356215921957357, 0.28819921475003435,  0.31725802630565014, 0.65698726494905169, 0.71576856387364096, 1.11105347926500708, 1.56391267235498033,  0.53598841961753030, 0.63299078098494721, 2.02301947147168892, 2.50668779038551204, 2.65969205691084110,  0.46495234186919998, 0.45828560770102122, 0.26358400216237010, 0.03614001567724773, -0.21841006701410176, -0.17533922633058241, 0.74900605059101055, 1.23939626411130810, 0.76449469519359203, 0.82945833672167257,  1.28373336082173539 )
               , tolerance = 1e-06)

  expect_equal(c(fit$state_vars),
               c( 2.827089961409568e-02, 3.856801862613982e-03, 3.504282597137599e-02, -3.283147814299231e-03, -2.754788891173025e-02, -8.570619644456231e-03, 1.163560792718954e-02, -1.903490904446030e-02, -1.940560106765220e-02, 1.038368441344826e-02, -1.328888272315054e-03, 3.856801862570888e-03,  7.979379198900649e-02, 3.234409920511671e-02, 1.246174561968566e-01, 5.564980442916261e-02, -3.627993613005028e-02, 5.699944018914323e-02, -1.048166956480496e-02, -6.472093537888449e-02,  4.756102578183005e-02, -4.776673538070863e-03, 3.504282597135835e-02, 3.234409920511616e-02,  2.775912400800890e-01, -4.969814819532891e-03, -1.706809247356402e-01, 2.671602328889916e-02,  7.600043949124934e-02, -1.530803950249059e-01, -1.341243124175427e-01, 7.549516092778778e-02,  3.156029521948354e-02, -3.283147814280014e-03, 1.246174561968572e-01, -4.969814819532658e-03,  5.282553211547574e-01, 1.202904816901873e-01, 5.859396786445327e-03, 7.703473043947880e-02, -4.133836682225628e-02, 3.784382024743924e-02, -4.235233428883818e-02, 1.053895385811934e-01, -2.754788891178308e-02, 5.564980442916173e-02, -1.706809247356410e-01, 1.202904816901869e-01,  3.991683723751598e-01, 8.020103688394196e-02, 6.874868781643551e-02, 1.835451277534819e-01, -7.218832231258547e-02, 1.022344187172704e-01, -5.181974732747933e-02, -8.570619644477960e-03, -3.627993613004886e-02, 2.671602328889992e-02, 5.859396786444412e-03, 8.020103688394387e-02,  4.968376157450382e-01, 1.491965380907400e-02, -8.388030285123424e-03, 3.088625668529891e-02,  1.085654590684509e-02, 1.433114125270055e-01, 1.163560792718783e-02, 5.699944018914269e-02,  7.600043949124898e-02, 7.703473043947964e-02, 6.874868781643449e-02, 1.491965380907377e-02,  1.444475906683238e-01, -6.404474582137441e-03, -1.397514785344334e-01, 1.086940635738623e-01, -1.805240051600799e-02, -1.903490904445009e-02, -1.048166956480546e-02, -1.530803950249066e-01, -4.133836682225581e-02, 1.835451277534805e-01, -8.388030285123265e-03, -6.404474582138168e-03,  2.042522453317790e-01, -3.042068638863811e-03, 2.978985206288199e-02, -6.858938135098447e-02, -1.940560106765333e-02, -6.472093537888432e-02, -1.341243124175425e-01, 3.784382024743921e-02, -7.218832231258551e-02, 3.088625668529862e-02, -1.397514785344336e-01, -3.042068638863931e-03,  3.186142466224547e-01, -2.070138280628478e-01, 8.801572837373081e-02, 1.038368441344425e-02,  4.756102578182977e-02, 7.549516092778791e-02, -4.235233428883822e-02, 1.022344187172713e-01,  1.085654590684536e-02, 1.086940635738626e-01, 2.978985206288191e-02, -2.070138280628479e-01,  2.325967864941713e-01, -6.941210904504373e-02, -1.328888272347243e-03, -4.776673538071635e-03,  3.156029521948325e-02, 1.053895385811934e-01, -5.181974732747905e-02, 1.433114125270046e-01, -1.805240051600743e-02, -6.858938135098422e-02, 8.801572837373059e-02, -6.941210904504329e-02,  1.600623980667696e-01, 2.474957981068476e-02, 2.501701859226744e-03, 2.220476775116006e-02, -1.510314720705237e-03, -1.686578232110426e-02, -7.293444298168861e-03, 8.298249271268494e-03, -1.062841482679709e-02, -1.262567139268330e-02, 6.858569092983969e-03, -2.076688326132693e-03,  2.501701859170917e-03, 5.466424867913389e-02, 2.096972156992727e-02, 6.733872334237023e-02,  2.860578557454653e-02, -2.886192130483523e-02, 3.283462637284210e-02, -7.629021576873245e-03, -3.984601225206785e-02, 2.946922641296804e-02, -6.147091223244437e-03, 2.220476775114670e-02,  2.096972156993115e-02, 1.739939507592309e-01, -2.144404103248537e-03, -9.570126125344487e-02,  1.802473819187745e-02, 4.698624128016501e-02, -8.933655769496210e-02, -8.172638923217815e-02,  4.755034078087975e-02, 1.765735198798297e-02, -1.510314720713630e-03, 6.733872334236984e-02, -2.144404103249780e-03, 2.891139622851876e-01, 5.846050229837749e-02, -3.486626927933922e-03,  3.911999633116746e-02, -2.272441700744308e-02, 2.087305899082417e-02, -2.456194687805090e-02,  5.437137107968067e-02, -1.686578232120535e-02, 2.860578557454044e-02, -9.570126125345679e-02,  5.846050229837741e-02, 2.222658049958750e-01, 4.240410055746929e-02, 3.276762314328266e-02,  9.984184872875347e-02, -3.274016404335672e-02, 5.115173172884019e-02, -2.819764280247614e-02, -7.293444298222297e-03, -2.886192130483396e-02, 1.802473819187374e-02, -3.486626927933542e-03,  4.240410055747642e-02, 3.477697520507022e-01, 4.556182365399576e-03, -9.200376798913694e-03,  2.780291450304395e-02, 4.999853149246936e-04, 9.992470118865381e-02, 8.298249271246592e-03,  3.283462637284198e-02, 4.698624128016231e-02, 3.911999633116917e-02, 3.276762314328555e-02,  4.556182365399633e-03, 1.014404347378999e-01, -5.313408748031514e-03, -8.361993277450032e-02,  6.488228537076449e-02, -1.277098492812542e-02, -1.062841482680176e-02, -7.629021576877462e-03, -8.933655769496474e-02, -2.272441700744383e-02, 9.984184872874498e-02, -9.200376798917227e-03, -5.313408748034443e-03, 1.398038775823517e-01, 1.677232112939083e-03, 1.383763820858264e-02, -4.059714844771430e-02, -1.262567139266210e-02, -3.984601225206916e-02, -8.172638923217557e-02,  2.087305899082309e-02, -3.274016404336405e-02, 2.780291450304180e-02, -8.361993277450162e-02,  1.677232112935826e-03, 2.054339933658649e-01, -1.221284468149595e-01, 5.433031612431482e-02,  6.858569092956407e-03, 2.946922641296838e-02, 4.755034078087672e-02, -2.456194687804980e-02,  5.115173172884721e-02, 4.999853149259513e-04, 6.488228537076560e-02, 1.383763820858602e-02, -1.221284468149591e-01, 1.566310576660743e-01, -4.147103252401220e-02, -2.076688326167010e-03, -6.147091223244512e-03, 1.765735198798054e-02, 5.437137107968165e-02, -2.819764280247201e-02,  9.992470118865343e-02, -1.277098492812507e-02, -4.059714844771233e-02, 5.433031612431510e-02, -4.147103252401152e-02, 1.158502794425795e-01, 2.337550582723835e-02, 2.406216565236260e-03,  2.437307745505613e-02, -3.377111378530782e-03, -2.005261236493334e-02, -1.006306492514045e-02,  8.656885527593233e-03, -1.202821298226732e-02, -1.447928440758338e-02, 7.568523236246663e-03, -2.834876351410569e-03, 2.406216565182064e-03, 5.672191792195691e-02, 2.104357262411373e-02,  8.072890481421352e-02, 3.773587701705378e-02, -2.729114263993702e-02, 3.941693031750931e-02, -5.657799952658053e-03, -4.663612997441854e-02, 3.463401697250436e-02, -6.126019369060653e-03,  2.437307745504428e-02, 2.104357262411737e-02, 1.847060896057002e-01, -1.116494366142848e-02, -1.124535366923201e-01, 9.965362825653608e-03, 5.051851953709992e-02, -9.961280463944390e-02, -9.308836535292192e-02, 5.325083886133375e-02, 1.555237212804250e-02, -3.377111378538999e-03,  8.072890481421299e-02, -1.116494366142978e-02, 3.468714524973997e-01, 9.138522028906740e-02,  1.326642568381668e-02, 5.035832044861353e-02, -1.869900184587524e-02, 2.552246071867881e-02, -2.642875368158997e-02, 6.832463884012620e-02, -2.005261236503058e-02, 3.773587701704811e-02, -1.124535366923293e-01, 9.138522028906716e-02, 2.564858626423900e-01, 5.118442474828214e-02,  4.245488962326943e-02, 1.163256754317819e-01, -3.713709860803219e-02, 5.892921258293164e-02, -2.845493686356062e-02, -1.006306492519458e-02, -2.729114263993588e-02, 9.965362825649393e-03,  1.326642568381691e-02, 5.118442474828896e-02, 3.588423413639068e-01, 3.184354016580397e-03, -7.647598876463835e-03, 3.932853783316015e-02, -6.042069461235883e-03,
                  1.094606845302827e-01,  8.656885527574560e-03, 3.941693031750926e-02, 5.051851953709820e-02, 5.035832044861531e-02,  4.245488962327107e-02, 3.184354016580869e-03, 1.079733132478299e-01, -4.206067379591047e-03, -9.877685371572327e-02, 7.659557957354757e-02, -1.575370502079157e-02, -1.202821298227071e-02, -5.657799952662045e-03, -9.961280463944538e-02, -1.869900184587624e-02, 1.163256754317743e-01, -7.647598876467499e-03, -4.206067379593170e-03, 1.463364967906664e-01, 9.366114189766632e-04,  1.736891126861021e-02, -4.416755071441088e-02, -1.447928440756794e-02, -4.663612997442000e-02, -9.308836535292096e-02, 2.552246071867765e-02, -3.713709860803711e-02, 3.932853783315736e-02, -9.877685371572437e-02, 9.366114189749779e-04, 2.340673737378130e-01, -1.464185161191305e-01,  6.707226299106889e-02, 7.568523236223861e-03, 3.463401697250488e-02, 5.325083886133219e-02, -2.642875368158894e-02, 5.892921258293711e-02, -6.042069461234257e-03, 7.659557957354879e-02,  1.736891126861248e-02, -1.464185161191307e-01, 1.703726954537674e-01, -5.161407653278186e-02, -2.834876351447165e-03, -6.126019369060934e-03, 1.555237212803875e-02, 6.832463884012729e-02, -2.845493686355609e-02, 1.094606845302822e-01, -1.575370502079172e-02, -4.416755071440826e-02,  6.707226299107018e-02, -5.161407653278169e-02, 1.221320581974408e-01, 2.160502996024427e-02,  2.144179322653240e-03, 2.395241599449666e-02, -3.144092617529624e-03, -2.086152203032340e-02, -1.102546831426984e-02, 8.227447936454323e-03, -1.200908730798337e-02, -1.372894907998156e-02,  6.773314031038010e-03, -2.690574622435838e-03, 2.144179322599866e-03, 5.208635508865375e-02,  2.020315559421385e-02, 7.797762299796759e-02, 3.497385827304417e-02, -2.492629489388321e-02,  3.770586552744899e-02, -5.722592902856488e-03, -4.421707416219724e-02, 3.258945363323858e-02, -5.126672380121315e-03, 2.395241599448309e-02, 2.020315559421675e-02, 1.805841129606028e-01, -1.378526909355228e-02, -1.161672353309570e-01, 2.506286081287364e-03, 4.993981644957145e-02, -9.978743494559185e-02, -9.315012860206610e-02, 5.304711710282066e-02, 1.305679789283920e-02, -3.144092617536858e-03, 7.797762299796748e-02, -1.378526909355290e-02, 3.369077592626131e-01,  9.390150862613923e-02, 1.571696865212174e-02, 4.847699213117168e-02, -1.556463257918250e-02,  2.564250727977113e-02, -2.556318576552922e-02, 6.683422196238643e-02, -2.086152203041615e-02,  3.497385827303924e-02, -1.161672353309628e-01, 9.390150862613816e-02, 2.489077548232367e-01,  5.412187031097920e-02, 3.699780019298479e-02, 1.148436496207270e-01, -2.726686527469867e-02,  5.101415264246172e-02, -2.365457625366006e-02, -1.102546831432430e-02, -2.492629489388212e-02,  2.506286081282857e-03, 1.571696865212190e-02, 5.412187031098570e-02, 3.383137707736664e-01,  1.321087016601901e-03, -3.608480574569197e-03, 4.104959400674276e-02, -7.431790042301076e-03,  1.038468219891188e-01, 8.227447936436899e-03, 3.770586552744884e-02, 4.993981644957139e-02,  4.847699213117258e-02, 3.699780019298427e-02, 1.321087016602786e-03, 1.021493221378667e-01, -6.133196426974200e-03, -9.560167978894701e-02, 7.372577267333175e-02, -1.489936461726265e-02, -1.200908730798433e-02, -5.722592902860043e-03, -9.978743494559177e-02, -1.556463257918387e-02,  1.148436496207200e-01, -3.608480574572863e-03, -6.133196426975050e-03, 1.409101297303076e-01,  5.124875494407948e-03, 1.419998147180182e-02, -4.056470803792495e-02, -1.372894907996800e-02, -4.421707416219833e-02, -9.315012860206774e-02, 2.564250727977156e-02, -2.726686527469986e-02,  4.104959400673933e-02, -9.560167978894786e-02, 5.124875494408434e-03, 2.253150466698102e-01, -1.416622773707457e-01, 6.443688474030737e-02, 6.773314031017184e-03, 3.258945363323899e-02,  5.304711710282146e-02, -2.556318576552948e-02, 5.101415264246452e-02, -7.431790042298842e-03,  7.372577267333308e-02, 1.419998147180236e-02, -1.416622773707465e-01, 1.610861229723221e-01, -4.946934526845457e-02, -2.690574622473873e-03, -5.126672380121640e-03, 1.305679789283404e-02,  6.683422196238809e-02, -2.365457625365459e-02, 1.038468219891181e-01, -1.489936461726322e-02, -4.056470803792157e-02, 6.443688474030952e-02, -4.946934526845487e-02, 1.147011772981584e-01,  1.941717760867127e-02, 1.156578190793903e-03, 2.055647966274567e-02, -2.625769448142611e-03, -1.884816467909240e-02, -8.934637664314894e-03, 6.666165081184002e-03, -9.939047108094031e-03, -1.043714350919568e-02, 4.609012890523184e-03, -1.727733736826339e-03, 1.156578190740297e-03,  3.766214204137552e-02, 1.596047404772767e-02, 5.234011921262254e-02, 1.954384501488738e-02, -1.795179052682260e-02, 2.506995193292907e-02, -6.252642164385662e-03, -2.956987443985521e-02,  2.130599740094750e-02, -2.952391649275949e-03, 2.055647966273148e-02, 1.596047404773127e-02,  1.556853425429886e-01, -1.324751181828530e-02, -1.081124113556810e-01, -1.077712542039874e-02,  4.001302931303824e-02, -8.714598528546902e-02, -7.564599291255673e-02, 4.084320975318557e-02,  9.300557087188669e-03, -2.625769448151329e-03, 5.234011921262219e-02, -1.324751181828950e-02,  2.382358322717553e-01, 6.462209771038742e-02, 7.404817892813961e-03, 3.050964639630759e-02, -9.073942831085948e-03, 2.173720044827940e-02, -2.106426214487037e-02, 4.548398351344167e-02, -1.884816467918419e-02, 1.954384501488166e-02, -1.081124113556861e-01, 6.462209771038281e-02,  1.981741716411684e-01, 4.923755537043357e-02, 1.591762969009615e-02, 9.561382331905957e-02, -1.522307074456997e-03, 2.622022610245140e-02, -1.511508079808752e-02, -8.934637664369503e-03, -1.795179052682201e-02, -1.077712542040380e-02, 7.404817892813139e-03, 4.923755537043943e-02,  2.422979761620117e-01, -1.908342667272506e-03, 6.850254273343129e-03, 3.165939954043437e-02, -5.673300147075236e-03, 6.896659801428008e-02, 6.666165081166596e-03, 2.506995193292913e-02,  4.001302931303818e-02, 3.050964639630950e-02, 1.591762969009582e-02, -1.908342667270752e-03,  7.981113640031623e-02, -8.830884977890294e-03, -6.798626131097425e-02, 5.114317335203176e-02, -1.003725455224987e-02, -9.939047108094090e-03, -6.252642164389669e-03, -8.714598528546802e-02, -9.073942831089903e-03, 9.561382331905241e-02, 6.850254273339240e-03, -8.830884977890981e-03,  1.214291246627148e-01, 1.266752464130422e-02, 5.960241959456848e-03, -2.815888977490025e-02, -1.043714350918257e-02, -2.956987443985669e-02, -7.564599291255902e-02, 2.173720044827778e-02, -1.522307074457871e-03, 3.165939954042965e-02, -6.798626131097536e-02, 1.266752464130550e-02,  1.693522198193105e-01, -9.930816900243404e-02, 4.363473200525893e-02, 4.609012890502918e-03,  2.130599740094818e-02, 4.084320975318721e-02, -2.106426214486953e-02, 2.622022610245389e-02, -5.673300147072016e-03, 5.114317335203338e-02, 5.960241959456684e-03, -9.930816900243503e-02,  1.211444303662406e-01, -3.356474452324035e-02, -1.727733736865194e-03, -2.952391649276393e-03,  9.300557087181912e-03, 4.548398351344370e-02, -1.511508079808123e-02, 6.896659801427939e-02, -1.003725455225103e-02, -2.815888977489598e-02, 4.363473200526226e-02, -3.356474452324137e-02,  8.732072619987050e-02, 1.716322996640526e-02, 4.677028653577286e-04, 1.949302934225618e-02, -2.222058773075259e-03, -1.773691140922758e-02, -6.228140569584813e-03, 5.895306898912210e-03, -8.619157433255687e-03, -8.418326548970597e-03,
                  3.140478586046529e-03, -5.602076251494149e-04,  4.677028653019884e-04, 2.790598001154474e-02, 1.108235998416113e-02, 3.968389268040510e-02,  1.341851546118910e-02, -9.115452771989373e-03, 1.644067234543016e-02, -5.168015201669583e-03, -1.764390037148491e-02, 1.259503926600644e-02, 1.250706293633481e-04, 1.949302934224211e-02,  1.108235998417024e-02, 1.809850673538202e-01, -3.319598595505975e-02, -1.388603243799372e-01, -1.206581132382192e-02, 4.080202404562935e-02, -1.017938150114523e-01, -8.244374736581607e-02,  4.172011738599380e-02, 1.084519148655710e-02, -2.222058773090752e-03, 3.968389268040445e-02, -3.319598595508554e-02, 2.100977741677408e-01, 6.814852583188258e-02, 1.583805289461701e-02,  1.618633632405295e-02, 1.956688113747195e-03, 3.725669730805826e-02, -2.938311688917876e-02,  4.179613355234144e-02, -1.773691140932517e-02, 1.341851546117771e-02, -1.388603243799577e-01,  6.814852583185824e-02, 2.003515110773721e-01, 3.646587067321171e-02, -3.136231514236199e-03,  1.032832077299776e-01, 3.020572572016467e-02, 3.194673933009110e-03, -1.421295171442755e-02, -6.228140569642682e-03, -9.115452771989810e-03, -1.206581132383773e-02, 1.583805289461672e-02,  3.646587067322450e-02, 1.605271699094011e-01, -2.051505620036636e-03, 4.631497111414324e-03,  2.508707183901647e-02, -7.040381765362155e-03, 4.554449587027975e-02, 5.895306898891955e-03,  1.644067234543112e-02, 4.080202404562203e-02, 1.618633632405924e-02, -3.136231514226373e-03, -2.051505620031029e-03, 6.454426428199161e-02, -1.455061895724503e-02, -5.104778610496389e-02,  3.635943229019962e-02, -5.568526523727201e-03, -8.619157433257212e-03, -5.168015201677442e-03, -1.017938150114554e-01, 1.956688113729304e-03, 1.032832077299640e-01, 4.631497111404596e-03, -1.455061895725146e-02, 1.210824181877574e-01, 2.516120339469149e-02, -2.281261945182428e-03, -2.532593068119873e-02, -8.418326548954634e-03, -1.764390037148834e-02, -8.244374736581073e-02,  3.725669730804698e-02, 3.020572572014951e-02, 2.508707183900371e-02, -5.104778610496645e-02,  2.516120339468566e-02, 1.400788370118477e-01, -7.591186383221971e-02, 3.144109943327877e-02,  3.140478586023574e-03, 1.259503926600791e-02, 4.172011738598844e-02, -2.938311688917316e-02,  3.194673933021728e-03, -7.040381765353868e-03, 3.635943229020126e-02, -2.281261945176946e-03, -7.591186383221932e-02, 9.608160412627270e-02, -2.554328656605472e-02, -5.602076251891362e-04,  1.250706293637110e-04, 1.084519148654638e-02, 4.179613355234764e-02, -1.421295171441594e-02,  4.554449587027964e-02, -5.568526523728334e-03, -2.532593068119170e-02, 3.144109943328365e-02, -2.554328656605631e-02, 7.191250405014012e-02, 1.436137802678238e-02, -6.467404533876033e-05,  1.218852441325863e-02, 5.518609646919630e-04, -1.092988623182012e-02, -4.189909720506863e-03,  3.525009553539813e-03, -3.459154242004304e-03, -3.219856138249231e-03, 8.480838049007306e-05, -1.369993102334977e-05, -6.467404539437557e-05, 1.964194922544640e-02, 8.381426468025761e-03,  2.527497017229651e-02, 6.203867725956728e-03, -7.249823638187814e-03, 1.001831648239257e-02, -4.465291874597783e-03, -1.098366831266584e-02, 7.489927228658667e-03, 2.923658422360371e-05,  1.218852441324394e-02, 8.381426468037256e-03, 1.652056089485826e-01, -2.885757825105102e-02, -1.271534081902364e-01, -6.431466098280016e-03, 3.326143878703558e-02, -9.089545961479435e-02, -6.767557462740159e-02, 3.192961210517754e-02, 1.338126630160544e-02, 5.518609646801356e-04,  2.527497017229363e-02, -2.885757825106530e-02, 1.567812227582305e-01, 4.404014518861993e-02,  1.130905449860705e-02, 7.061706096566782e-03, -4.616997090278957e-04, 3.551626750317385e-02, -2.793796727664180e-02, 3.263957419680879e-02, -1.092988623191430e-02, 6.203867725945057e-03, -1.271534081902498e-01, 4.404014518860588e-02, 1.701384426448929e-01, 2.449773639597249e-02, -7.570502288082872e-03, 8.977665157124450e-02, 2.860314850530329e-02, 1.266712638145791e-03, -1.663951221048769e-02, -4.189909720558268e-03, -7.249823638186850e-03, -6.431466098265835e-03,  1.130905449859375e-02, 2.449773639596504e-02, 1.334453163928705e-01, -1.963712779530140e-03, -3.564151153310619e-04, 2.045640675152043e-02, -6.579271710987678e-03, 3.817257846844342e-02,  3.525009553520667e-03, 1.001831648239476e-02, 3.326143878703097e-02, 7.061706096570364e-03, -7.570502288078323e-03, -1.963712779535629e-03, 5.259131742557897e-02, -1.205312662880825e-02, -3.759440173253363e-02, 2.588861617987667e-02, -4.016884394028042e-03, -3.459154242005264e-03, -4.465291874606413e-03, -9.089545961479854e-02, -4.616997090377993e-04, 8.977665157123599e-02, -3.564151153257835e-04, -1.205312662881300e-02, 1.078329005584645e-01, 1.947503031848154e-02,  6.915521106183164e-05, -2.453043263839289e-02, -3.219856138232166e-03, -1.098366831267211e-02, -6.767557462738717e-02, 3.551626750316205e-02, 2.860314850528503e-02, 2.045640675152980e-02, -3.759440173253268e-02, 1.947503031847014e-02, 1.138196772703352e-01, -5.782294573363699e-02,  2.492171282729505e-02, 8.480838046693619e-05, 7.489927228662488e-03, 3.192961210516764e-02, -2.793796727663516e-02, 1.266712638160196e-03, -6.579271710993817e-03, 2.588861617987706e-02,  6.915521107028755e-05, -5.782294573363776e-02, 7.825498316490936e-02, -2.094750056417793e-02, -1.369993106055639e-05, 2.923658422375160e-05, 1.338126630160810e-02, 3.263957419680818e-02, -1.663951221048608e-02, 3.817257846844517e-02, -4.016884394025000e-03, -2.453043263839278e-02,  2.492171282729099e-02, -2.094750056417368e-02, 6.354293686440730e-02, 1.139236427536075e-02, -6.102873176254808e-04, -2.304981768922586e-04, 2.026148564516226e-03, 2.359456801339579e-03, -2.411710259727455e-03, 1.388096469207744e-03, 6.289148336509913e-03, 1.087396523191496e-03, -9.055360800668440e-04, -2.064755548992031e-03, -6.102873176831816e-04, 1.421411691648364e-02,  4.045962457890390e-03, 1.506410278457244e-02, 5.790972489331630e-03, -4.629962881583981e-03,  5.749332444359078e-03, -1.583512151855478e-03, -6.570026168888584e-03, 4.486245631634068e-03, -6.802087899313199e-04, -2.304981769115661e-04, 4.045962457919371e-03, 1.058349897278202e-01, -2.043707828159758e-02, -7.263099392283406e-02, -1.199325915990776e-03, 1.970778367634134e-02, -4.911876426335392e-02, -4.108414701546886e-02, 2.138700997936388e-02, 5.766541214697329e-03,  2.026148564504554e-03, 1.506410278456525e-02, -2.043707828163169e-02, 8.554925533045568e-02,  2.830039436844408e-02, -4.214838067758244e-03, 3.912723297852852e-03, 4.700042930954845e-03,  1.411689690480976e-02, -1.183966899235077e-02, 1.011615533924764e-02, 2.359456801246393e-03,  5.790972489301927e-03, -7.263099392288244e-02, 2.830039436841635e-02, 1.184750678133785e-01,  2.411829002978899e-02, 2.290125368982618e-03, 5.142975293967147e-02, 6.597862717844072e-03,  8.643407339913527e-03, -8.893954314570659e-03, -2.411710259776706e-03, -4.629962881583606e-03, -1.199325915971276e-03, -4.214838067773388e-03, 2.411829002977736e-02, 1.017351629387908e-01,  3.477802636784973e-03, 4.704434465916557e-03, 9.746743180398209e-04, 7.051412452818549e-03,  1.936492415662948e-02, 1.388096469185728e-03, 5.749332444363544e-03, 1.970778367631718e-02,  3.912723297862275e-03, 2.290125369011465e-03, 3.477802636777738e-03, 4.422575881461620e-02, -3.494273316178746e-03,
                  -2.620382179592809e-02, 1.887007920361760e-02, -3.411875474622704e-03,  6.289148336510238e-03, -1.583512151876521e-03, -4.911876426337364e-02, 4.700042930934505e-03,  5.142975293965389e-02, 4.704434465925785e-03, -3.494273316199466e-03, 7.309886578742285e-02,  7.716940553432805e-03, 1.676953579575441e-03, -1.155282895888069e-02, 1.087396523214839e-03, -6.570026168900427e-03, -4.108414701542032e-02, 1.411689690478512e-02, 6.597862717780957e-03,  9.746743180516308e-04, -2.620382179592804e-02, 7.716940553392221e-03, 8.223475807735631e-02, -3.821931341115883e-02, 1.298570746713067e-02, -9.055360800946590e-04, 4.486245631639824e-03,  2.138700997932347e-02, -1.183966899233549e-02, 8.643407339962338e-03, 7.051412452811755e-03,  1.887007920361556e-02, 1.676953579607267e-03, -3.821931341115350e-02, 6.152735936812723e-02, -1.033018710530678e-02, -2.064755549027546e-03, -6.802087899284545e-04, 5.766541214712884e-03,  1.011615533924785e-02, -8.893954314575382e-03, 1.936492415663088e-02, -3.411875474613908e-03, -1.155282895888726e-02, 1.298570746711651e-02, -1.033018710529606e-02, 4.430706213641324e-02,  1.099514558587259e-02, -1.133577011247063e-03, -1.449023762017625e-03, -1.282259116890018e-03,  2.879395804362660e-03, -3.859586830866907e-03, 6.280748990913162e-04, 7.551080294188273e-03,  6.802390414274080e-04, -4.003370286615019e-04, -3.777559329229541e-03, -1.133577011302818e-03,  1.273695358837853e-02, 2.395968554576538e-03, 1.444181787032301e-02, 5.451398950938787e-03, -4.256058604216520e-03, 4.762931072515570e-03, -1.356422830226383e-03, -4.714262954443734e-03,  3.445122898418457e-03, -3.012022045782976e-04, -1.449023762035387e-03, 2.395968554591200e-03,  1.024759766866493e-01, -2.847175133122166e-02, -7.339959731075828e-02, -4.813451095932590e-03,  1.728739436094420e-02, -4.827139817909255e-02, -4.242154295580980e-02, 2.268348431077449e-02,  1.723571054266168e-03, -1.282259116895532e-03, 1.444181787032220e-02, -2.847175133120695e-02,  9.113043789786844e-02, 3.482780750654822e-02, 3.470589279316536e-03, 1.304545231363101e-03,  7.695012904936186e-03, 2.322717518203437e-02, -1.644699771982713e-02, 1.477815206509494e-02,  2.879395804271537e-03, 5.451398950922524e-03, -7.339959731077837e-02, 3.482780750655359e-02,  1.146411373035798e-01, 2.482761126669051e-02, 5.959828343846244e-04, 5.022001702038129e-02,  1.516793935321911e-02, 1.805104592400505e-03, -3.539205927309370e-03, -3.859586830914549e-03, -4.256058604214728e-03, -4.813451095897908e-03, 3.470589279300110e-03, 2.482761126666799e-02,  1.069500564566660e-01, 1.443014236383915e-03, 4.778950396981571e-03, 8.726616910828367e-03,  1.391978313700351e-03, 2.463455410014556e-02, 6.280748990714428e-04, 4.762931072517428e-03,  1.728739436093476e-02, 1.304545231356614e-03, 5.959828343947262e-04, 1.443014236372186e-03,  4.161692120026171e-02, -3.097178539896960e-03, -2.342164297208204e-02, 1.683544833848669e-02, -3.826030752230658e-03, 7.551080294187490e-03, -1.356422830238257e-03, -4.827139817911170e-02,  7.695012904946856e-03, 5.022001702038141e-02, 4.778950397000445e-03, -3.097178539908358e-03,  7.253681246414981e-02, 1.007986979167652e-02, -6.122271534828897e-04, -9.461606687641087e-03,  6.802390414490200e-04, -4.714262954448325e-03, -4.242154295577038e-02, 2.322717518203833e-02,  1.516793935317927e-02, 8.726616910848656e-03, -2.342164297207563e-02, 1.007986979164234e-02,  8.200289321720072e-02, -3.718619031638602e-02, 1.582344654406198e-02, -4.003370286881679e-04,  3.445122898420523e-03, 2.268348431074175e-02, -1.644699771982810e-02, 1.805104592434843e-03,  1.391978313688740e-03, 1.683544833848194e-02, -6.122271534560822e-04, -3.718619031638266e-02,  5.924523158698283e-02, -1.151254790722927e-02, -3.777559329263535e-03, -3.012022045756966e-04,  1.723571054291892e-03, 1.477815206509053e-02, -3.539205927324328e-03, 2.463455410014572e-02, -3.826030752220126e-03, -9.461606687654514e-03, 1.582344654404366e-02, -1.151254790721645e-02,  4.578969823285543e-02, 1.102916854289522e-02, -2.764598187372523e-03, -6.442315787425388e-03, -3.686159952974256e-03, 3.313145235108068e-03, -2.801282022883183e-03, -2.861095691356575e-03,  9.122298560335709e-03, 6.135031509448249e-03, -4.207063127864979e-03, -3.083763570400317e-03, -2.764598187431123e-03, 1.609594259275264e-02, -7.717345609879685e-04, 2.234628178705642e-02,  1.422874215993377e-02, -3.087575933247431e-03, 7.364154523232148e-03, 1.711143549804944e-03, -7.064056324603179e-03, 5.957891457353063e-03, -5.422245705619290e-04, -6.442315787442922e-03, -7.717345609538408e-04, 5.084297861920132e-02, -1.573017610459437e-02, -3.491940188443556e-02,  4.575844908055104e-03, 2.042213280943545e-03, -2.174471869504958e-02, -1.005872777321925e-02,  3.704676318798611e-03, 4.654845748561265e-03, -3.686159952987079e-03, 2.234628178704824e-02, -1.573017610463059e-02, 9.311714085728236e-02, 3.930482060805536e-02, -1.267812768601032e-03,  1.221079945476328e-02, 7.505761790121347e-03, 2.758208059564899e-03, -9.710562386668685e-04,  8.795284084278461e-03, 3.313145235010673e-03, 1.422874215989683e-02, -3.491940188449528e-02,  3.930482060802549e-02, 9.101365608384636e-02, 8.137563102267584e-03, 1.496161545075692e-02,  3.071089048245560e-02, -1.164346264460799e-02, 1.704752987972767e-02, -7.099823972327440e-03, -2.801282022932418e-03, -3.087575933250326e-03, 4.575844908079798e-03, -1.267812768619794e-03,  8.137563102242080e-03, 8.955049996503275e-02, 9.719619936951387e-04, -3.483396224108214e-03,  6.120619968469126e-03, 1.568443479061117e-04, 2.147563663914979e-02, -2.861095691379668e-03,  7.364154523236750e-03, 2.042213280912574e-03, 1.221079945477336e-02, 1.496161545079602e-02,  9.719619936921316e-04, 3.995675874655623e-02, 5.315505818214950e-03, -1.580542372099353e-02,  1.230732279719716e-02, -3.389484166075423e-03, 9.122298560333694e-03, 1.711143549779662e-03, -2.174471869507496e-02, 7.505761790100408e-03, 3.071089048243611e-02, -3.483396224091536e-03,  5.315505818188093e-03, 5.921117759026972e-02, -5.743453114467959e-03, 7.895953221630694e-03, -1.066034353739344e-02, 6.135031509473243e-03, -7.064056324615677e-03, -1.005872777315771e-02,  2.758208059537996e-03, -1.164346264468996e-02, 6.120619968474082e-03, -1.580542372099325e-02, -5.743453114520127e-03, 6.336282525779122e-02, -2.481342769699236e-02, 1.285599120534132e-02, -4.207063127894620e-03, 5.957891457358193e-03, 3.704676318746898e-03, -9.710562386505362e-04,  1.704752987979032e-02, 1.568443479061421e-04, 1.230732279719333e-02, 7.895953221671420e-03, -2.481342769698429e-02, 5.216405834948194e-02, -9.503330838241375e-03, -3.083763570434462e-03, -5.422245705586810e-04, 4.654845748584916e-03, 8.795284084277412e-03, -7.099823972341712e-03,  2.147563663914701e-02, -3.389484166065469e-03, -1.066034353740635e-02, 1.285599120532491e-02, -9.503330838230338e-03, 4.440687296096044e-02, 1.211705751453981e-02, -3.532134913412589e-03, -6.797592386856816e-03, -5.956691489803843e-03, 1.070842174420147e-03, -5.030635154052110e-03, -4.334811119452633e-03, 8.671396762149161e-03, 7.866844532307654e-03, -5.765756493862035e-03, -3.576919699498169e-03, -3.532134913474110e-03, 1.535625846008856e-02, -2.354778924196770e-03,  2.158051936343514e-02, 1.371060062155408e-02, -5.669564322794748e-04, 6.395513081394605e-03,
                  1.121279443914533e-03, -5.340048472044251e-03, 5.003248812177424e-03, 7.646549338850527e-04, -6.797592386875731e-03, -2.354778924143798e-03, 5.272612849057079e-02, -1.937917367703605e-02, -3.783057689046077e-02, 3.052450312787556e-03, 2.137590814439982e-04, -2.292920388940772e-02, -7.487964114851753e-03, 1.369921829824011e-03, 4.735275181208261e-03, -5.956691489821832e-03,  2.158051936342686e-02, -1.937917367710895e-02, 9.607110725734036e-02, 4.030790142824181e-02,  1.358603835485694e-03, 1.321872130611587e-02, 7.881416336925995e-03, 2.576902666129512e-03, -1.040247203007508e-04, 9.870215057138865e-03, 1.070842174316244e-03, 1.371060062149501e-02, -3.783057689057112e-02, 4.030790142817342e-02, 9.869417398752378e-02, 1.671935274347966e-02,  1.598283272063244e-02, 3.246631563738289e-02, -1.309288098322525e-02, 1.983373027765400e-02, -6.122952884956595e-03, -5.030635154103638e-03, -5.669564322819138e-04, 3.052450312797099e-03,  1.358603835474287e-03, 1.671935274346861e-02, 1.035282153555772e-01, 3.729289679942210e-03, -1.172825760024019e-03, 4.306632288199483e-03, 3.672267865106356e-03, 2.235616711493155e-02, -4.334811119480121e-03, 6.395513081400322e-03, 2.137590813863222e-04, 1.321872130612964e-02,  1.598283272070655e-02, 3.729289679941829e-03, 4.197816140371724e-02, 5.373081674216108e-03, -1.423255952505309e-02, 1.142806448681977e-02, -2.045997980901160e-03, 8.671396762145844e-03,  1.121279443873278e-03, -2.292920388944741e-02, 7.881416336875646e-03, 3.246631563733859e-02, -1.172825760017024e-03, 5.373081674165933e-03, 6.295795730222159e-02, -6.029565716754934e-03,  8.316263781857625e-03, -1.064642258567014e-02, 7.866844532338581e-03, -5.340048472058739e-03, -7.487964114756052e-03, 2.576902666096365e-03, -1.309288098335554e-02, 4.306632288197026e-03, -1.423255952505414e-02, -6.029565716837992e-03, 6.338813325604176e-02, -2.272193619313401e-02,  1.185529004044883e-02, -5.765756493896809e-03, 5.003248812180811e-03, 1.369921829741189e-03, -1.040247202852077e-04, 1.983373027775065e-02, 3.672267865110140e-03, 1.142806448681188e-02,  8.316263781923516e-03, -2.272193619311891e-02, 5.476359839480016e-02, -8.166323102116180e-03, -3.576919699531798e-03, 7.646549338939969e-04, 4.735275181235815e-03, 9.870215057149800e-03, -6.122952884963451e-03, 2.235616711492949e-02, -2.045997980884062e-03, -1.064642258568349e-02,  1.185529004042396e-02, -8.166323102098472e-03, 4.654924874704924e-02 )
               , tolerance = 1e-06)

  expect_equal(c(fit$lag_one_cor),
               c(  1.566249590759439e-02, 1.784452743005493e-03, 8.976784174956832e-03, 6.681183732123769e-04,  -6.445761335600011e-03, -3.108541882309464e-03, 3.503310833782185e-03, -6.210875299100086e-03,  -5.098140808538075e-03, 2.953099442914825e-03, -1.172005822712784e-03, 1.768634862656538e-03,   3.290385689721709e-02, 1.035600795879275e-02, 2.832708951512525e-02, 5.954366814113891e-03,  -2.010251552119334e-02, 9.836285444855748e-03, -8.107110165012693e-03, -1.240030066903570e-02,   8.333777651963305e-03, -1.922454769639758e-03, 8.345435606882664e-03, 9.738428188847209e-03,   8.221124251864975e-02, 5.841846808995371e-03, -3.440241046167267e-02, 1.584646049551049e-02,   1.945927886261051e-02, -3.496094831197835e-02, -3.073750783699847e-02, 1.661619355195579e-02,   1.044331735612033e-02, 1.047869394617333e-03, 2.789673604736298e-02, 6.295809245676886e-03,   1.268906545700323e-01, 5.686220966157604e-03, -2.635342064640758e-02, 1.407872603273434e-02,  -1.672481608019660e-02, 7.903716040431037e-03, -1.353327760863018e-02, 1.708823592547876e-02,  -5.741668946673472e-03, 5.175280631386305e-03, -3.382095357272903e-02, 6.393206706137244e-03,   8.066593998788318e-02, 1.558848954147955e-02, 2.430010106643760e-03, 3.036110035403594e-02,  -1.822255161085098e-03, 9.004588833022825e-03, -8.342559001988950e-03, -2.475751651419503e-03,  -1.995253415226911e-02, 1.578030672648648e-02, -2.178908605796371e-02, 1.559119372227361e-02,   1.952659308210621e-01, 2.029487094758072e-03, -6.103168015560289e-03, 8.951210247108614e-03,   4.362258257962081e-03, 4.956017791632553e-02, 3.450303454152231e-03, 9.695378267273975e-03,   2.050201188978882e-02, 1.397154729013951e-02, 4.124556703428612e-03, 2.790224257876774e-03,   5.069764664723853e-02, -5.157915875605790e-03, -2.764663027306446e-02, 1.944712520202201e-02,  -2.464492410825876e-03, -6.078354041300537e-03, -8.162625391055721e-03, -3.667856636209396e-02,  -1.718513861588872e-02, 3.367359537013030e-02, -4.947992862572879e-03, -5.349207333228813e-03,   6.919705711744017e-02, 4.562109579801847e-03, 5.353535902287414e-04, -1.671719967314585e-02,  -4.750607358076446e-03, -1.174415099513300e-02, -3.215152549047768e-02, 9.485548218186084e-03,  -4.141099636106104e-03, 5.859894823362605e-03, -2.690120569153659e-02, 4.446088335323979e-03,   8.457848502688883e-02, -3.560697650857587e-02, 1.579901696486300e-02, 2.862898414396353e-03,   8.159685744471387e-03, 1.807188475842861e-02, -1.470856080882962e-02, 1.192694777748420e-02,   6.861888583861347e-03, 1.948935397343834e-02, 5.483821680510263e-04, -3.674446378265797e-02,   7.318242398447128e-02, -8.969502841454809e-03, -9.569692821318385e-04, -1.748416290654256e-03,   1.044956855079396e-02, 1.968635978732119e-02, -1.005936144726579e-02, 4.817374684652020e-02,  -2.515652405689527e-03, -1.693449758389993e-02, 1.693784816654701e-02, -9.562736891586748e-03,   6.091976102750296e-02, 1.354983671989224e-02, 1.277820803763000e-03, 6.318269818439442e-03,   4.157457265311030e-04, -5.005796536470986e-03, -3.762913712952558e-03, 2.549943872689680e-03,  -4.641715028566399e-03, -3.611638139725861e-03, 2.029431668891574e-03, -1.462044354959729e-03,   1.226859014042202e-03, 2.627851725944630e-02, 6.771064132986370e-03, 1.800569305318159e-02,   4.108871268364036e-03, -1.484879665265066e-02, 6.534065675788358e-03, -5.578716309040497e-03,  -8.690464124576448e-03, 6.389014871067781e-03, -1.978393024929706e-03, 6.088698859058170e-03,   6.480949184507975e-03, 5.770561564216976e-02, 2.822278448453715e-03, -2.248056617790685e-02,   9.277459758396151e-03, 1.218160895382184e-02, -2.344634741257709e-02, -1.935840505145528e-02,   1.033125098494218e-02, 6.316415682245448e-03, 3.275830668646156e-04, 1.904491811481645e-02,   2.397923496920835e-03, 8.602613687106692e-02, 6.792484523103357e-03, -1.546121504020104e-02,   9.686570737986549e-03, -8.839186032317096e-03, 4.273536446356550e-03, -7.931021818817999e-03,   1.077604569670248e-02, -4.611041213425985e-03, 3.672238077710763e-03, -2.271471022981073e-02,   5.332618296862230e-03, 5.349863454045715e-02, 9.933111712227029e-03, 1.135511624932029e-04,   1.953048830717138e-02, 2.424069640619947e-03, 3.278874747607061e-03, -4.245001565242230e-03,  -2.988918268963900e-03, -1.568720339480903e-02, 9.115488692793824e-03, -1.593410158086426e-02,   9.620110122794472e-03, 1.488589325488967e-01, -5.025729264235339e-04, -4.336571374423994e-03,   1.027716559783188e-02, 1.264217545901550e-05, 3.829524615454140e-02, 2.703504641869241e-03,   6.853403864411517e-03, 1.355466655055931e-02, 9.030166298127782e-03, 1.306980630395090e-03,   3.928831622153106e-04, 4.148151757942037e-02, -3.242296197817520e-03, -1.974230439160912e-02,   1.428458698630743e-02, -2.689848553544235e-03, -4.502490461935573e-03, -5.728059427811003e-03,  -2.392700193871862e-02, -9.674247462429513e-03, 2.019795187294884e-02, -4.370006981241108e-03,  -3.204299454029281e-03, 5.447153664755516e-02, 3.405873122475735e-03, -2.795644191065914e-04,  -1.145575452099507e-02, -3.915707768777020e-03, -9.120753079287565e-03, -2.246627156480411e-02,   6.035281839728039e-03, 8.958136033221584e-04, 9.642024112380524e-03, -1.995106401663207e-02,   3.790531292610448e-03, 6.627314580037924e-02, -2.599394744233409e-02, 1.324253075637270e-02,   2.300457731467085e-03, 6.414709288768277e-03, 1.225988262620739e-02, -9.727801659930622e-03,   4.792346353764375e-03, 1.088928313181095e-03, 1.410794354944559e-02, -3.703149736582278e-04,  -2.552054772236621e-02, 5.898183375118499e-02, -7.010828432877779e-03, -1.354339188411061e-03,  -2.119321499125183e-03, 5.870654139549162e-03, 1.136914682759647e-02, -4.981214066141975e-03,   3.848979190676946e-02, -2.840810004703516e-03, -1.141073766051107e-02, 1.317514734882786e-02,  -7.117538344666807e-03, 4.993948973872142e-02, 1.183188256007298e-02, 1.158492040829410e-03,   6.623742768517540e-03, 2.061502052878236e-04, -5.968648157605148e-03, -4.467944909514979e-03,   2.499123998712393e-03, -4.947707333777687e-03, -3.870427687985482e-03, 1.933187892897745e-03,  -1.394499952078207e-03, 1.172670378762942e-03, 2.409525258917189e-02, 6.781606999963317e-03,   2.070254876157834e-02, 4.837493275275624e-03, -1.383466414258652e-02, 7.877089023443338e-03,  -5.295272401686677e-03, -9.854846936074168e-03, 6.896604653840169e-03, -1.623806212629300e-03,   6.699708455353950e-03, 6.558230827274374e-03, 5.814020190294668e-02, 2.497449812800512e-04,  -2.811933682841304e-02, 4.853671242616533e-03, 1.352167673304285e-02, -2.663718479523802e-02,  -2.367308720370466e-02, 1.252516005057503e-02, 5.170733834333117e-03, -4.747193643418919e-05,   2.137672267464681e-02, 6.709678828400656e-04, 9.734276843173389e-02, 1.416228628127292e-02,  -1.079029630968492e-02, 1.210817481704107e-02, -8.364526760172434e-03, 6.133479973592447e-03,  -9.037717858147176e-03, 1.456870095028359e-02, -5.666735496155810e-03, 4.892435668378574e-03,  -2.795539668018724e-02, 1.408574444758739e-02, 5.808327295778650e-02, 1.224094019933632e-02,   1.384392681891909e-03, 2.366848529438606e-02, 3.753588516392993e-03, 3.388579132310450e-03,  -3.542067976794301e-03, -4.172683768820622e-03, -1.451648211615552e-02, 4.670687811249984e-03,  -1.075762217799637e-02, 1.292189309315638e-02, 1.443444928840766e-01, -1.302549272626325e-03,  -2.568156872717185e-03, 1.421702455988852e-02, -2.044539933574905e-03,
                   3.935245290655726e-02,   2.842653760649513e-03, 8.205445546021643e-03, 1.485499648920279e-02, 1.125299065352168e-02,   1.432108273434415e-03, -1.407175107408650e-03, 3.996808021340625e-02, -4.066277657882623e-03,  -2.376283092359067e-02, 1.700659899300765e-02, -3.493817919045367e-03, -4.812095664288914e-03,  -5.181516521130512e-03, -2.668256372836556e-02, -8.375957494673507e-03, 2.403886087892344e-02,  -3.180190921109822e-03, -3.649323775473976e-03, 5.259627168787551e-02, 4.512370055565941e-03,  -5.294450710798112e-05, -1.167746318183996e-02, -4.477958662384871e-03, -1.039274242613937e-02,  -2.547032165530085e-02, 7.203610790180609e-03, 3.083316283026015e-03, 1.427112978764135e-02,  -2.348657080673924e-02, 4.978129290428669e-03, 7.080068869246500e-02, -3.194132113015308e-02,   1.629198200198262e-02, 2.485954565346046e-03, 7.278497081267453e-03, 1.405973857786309e-02,  -9.939623463930135e-03, 4.074135225390327e-03, -1.857357440715111e-03, 1.694671983652953e-02,  -4.219245884618870e-04, -3.213435070443089e-02, 5.832154377830523e-02, -9.679160757334160e-03,  -1.573930022668210e-03, -1.875565503943132e-03, 4.715137401781592e-03, 1.496141485501398e-02,  -3.486544457114899e-03, 3.982863295664225e-02, -3.353697014715240e-03, -1.132924589978539e-02,   1.623417048630477e-02, -9.612098595160913e-03, 4.787821850708762e-02, 9.893577845746057e-03,   6.253113314965628e-04, 5.554696003829900e-03, -1.295592979465680e-04, -5.526272703979828e-03,  -3.353599452794113e-03, 1.940490355751879e-03, -4.250764579091439e-03, -2.914226538193618e-03,   1.313465579793834e-03, -9.514380051696878e-04, 8.273017986656500e-04, 1.782815032362692e-02,   5.339674356250580e-03, 1.319533766101622e-02, 1.100951213236699e-03, -9.513421797651569e-03,   4.668954598289813e-03, -4.836226756658359e-03, -6.073057156899752e-03, 4.094091889881159e-03,  -6.475958749146016e-04, 5.762814617363644e-03, 5.074308156649982e-03, 4.928671549859698e-02,  -1.202409077490237e-03, -2.812661861221034e-02, -1.625572417911428e-03, 1.087359193321021e-02,  -2.383478341812366e-02, -1.976010901771661e-02, 9.791070924148413e-03, 3.084672360899040e-03,   3.158522721633597e-04, 1.420759723980198e-02, 4.907358729244857e-04, 6.885141862183092e-02,   8.761890563174278e-03, -9.213353202950822e-03, 7.538081575398244e-03, -5.844260112052763e-03,   4.731094813029758e-03, -6.999165162154383e-03, 9.632659949676773e-03, -5.478270878767500e-03,   1.989696092605493e-03, -2.678224071656496e-02, 1.040419842400204e-02, 4.673268679761294e-02,   1.211990227162568e-02, -2.431772883623042e-03, 2.034961785143351e-02, 8.699329069406667e-03,  -1.247042492036009e-03, -1.239946202795038e-03, -4.182081059163165e-03, -9.999888346137213e-03,  -2.611052839378994e-03, -9.012927509542667e-03, 1.387834626578579e-02, 1.026725101472119e-01,  -2.018311788244737e-03, 2.554360586302684e-03, 1.109620240079588e-02, -1.332203632935526e-03,   2.573280165895319e-02, 2.283731534607298e-03, 5.261955729153084e-03, 1.217299618119847e-02,   7.133124188634891e-03, -3.530695305751137e-03, -2.653472671359334e-03, 3.185395441518046e-02,  -4.751950063174409e-03, -1.764847801486615e-02, 1.213344081699700e-02, -2.517195564576346e-03,  -4.249621904677733e-03, -4.333857465610529e-03, -2.303606315206022e-02, -4.522153787314980e-03,   2.071809435929842e-02, 8.497551262515038e-04, -3.715870770572204e-03, 4.424373112749833e-02,   5.917674104685713e-03, -1.474553593509636e-03, -7.732934325759597e-03, -3.376202756878980e-03,  -6.763262904274812e-03, -2.093858607581491e-02, 5.357877009112393e-03, 9.640052443484242e-03,   1.180451499765914e-02, -1.726857336842390e-02, 7.052952244020472e-03, 5.479962601392743e-02,  -2.251737055377211e-02, 1.104305431754117e-02, 1.605465908602830e-03, 4.659582564070498e-03,   1.077894946930281e-02, -7.244863910136915e-03, -1.798802083230643e-03, -2.132970040792667e-03,   1.205064261951852e-02, -2.233859053783566e-03, -2.272099849987511e-02, 4.530330087902171e-02,  -6.163282047272083e-03, -1.227516811826835e-03, -9.641539689180380e-04, 2.590416209613091e-03,   9.333173525971496e-03, -8.551418600222741e-04, 2.665347016697095e-02, -2.459563433675214e-03,  -7.186933868555075e-03, 1.098557175477862e-02, -5.979823634409897e-03, 3.629593125726652e-02,   7.804689190807811e-03, 2.683774313253177e-04, 3.190326632005330e-03, 8.512531386199226e-04,  -3.388452442672660e-03, -1.947667060042530e-03, 1.235588049185997e-03, -2.610220220468753e-03,  -1.182332948530982e-03, 2.770087722703384e-04, -3.812219525827891e-04, 1.787748650289925e-04,   1.155113023913291e-02, 2.787571738370302e-03, 5.837321172734028e-03, -4.801371042585762e-04,  -3.726670760021237e-03, 1.477987970444633e-03, -3.163147662317874e-03, -1.949542842806386e-03,   1.398979912613214e-03, 3.906156477706276e-04, 5.619524767075104e-03, 3.063593099779357e-03,   4.853435757396046e-02, -5.902904280046578e-03, -3.352099209320781e-02, -4.738360597931974e-03,   9.562248310106013e-03, -2.510921980080844e-02, -1.886010248653036e-02, 8.643354463307801e-03,   2.446431440738689e-03, -3.441482071620677e-04, 6.821526610936557e-03, -3.095049961406879e-03,   4.405129246587404e-02, 7.083704094351229e-03, -3.558985577765658e-03, 2.723641953708784e-03,  -1.496759054642577e-03, 5.934744892503301e-03, -6.273043604950330e-03, 6.291524178464455e-03,  -5.345825581166619e-03, -1.258651866221767e-04, -3.040480280122817e-02, 8.462040988695414e-03,   4.107265648248937e-02, 8.962072910733178e-03, -6.386740277817323e-03, 2.029396923461784e-02,   1.423632346637684e-02, -5.924998586766098e-03, -8.839777077424837e-04, -2.449353710454219e-03,  -4.070978415996495e-03, -5.073943116987899e-03, -4.526043300883695e-03, 8.747519087477472e-03,   5.228042185377346e-02, -2.014313493862760e-03, 3.227120137160286e-03, 6.438348652100428e-03,  -1.386912665234313e-03, 1.116905818363627e-02, 1.843048310366378e-03, 1.648240117736984e-03,   1.067820606772628e-02, 1.527269905100792e-03, -9.074285671798549e-03, -2.149859843685106e-03,   2.340773913379283e-02, -5.865171373907936e-03, -1.092663587712651e-02, 6.708490327033891e-03,  -9.029081021603757e-04, -3.621525849734073e-03, -3.179189088658615e-03, -2.160368779432898e-02,  -9.317921102432883e-04, 1.892122936202635e-02, 2.186692756577862e-03, -4.041783010990866e-03,   3.713943067439383e-02, 7.325433254031517e-03, -2.796956267959305e-03, -5.173870790322301e-03,  -2.585019342190314e-03, -2.111701493850615e-03, -1.863337347777763e-02, 6.931712297591468e-03,   1.702789335869020e-02, 6.939430722583861e-03, -1.042614647252860e-02, 9.641522660183728e-03,   3.846804033668778e-02, -1.264886200734683e-02, 5.193684497534792e-03, 9.609630022238559e-04,   1.415838894909514e-03, 7.875381167002432e-03, -6.553545115536031e-03, -7.241123240962197e-03,  -1.601045865764419e-03, 6.405693201081075e-03, -3.714938536760871e-03, -1.242642551334950e-02,   3.167635291352522e-02, -2.557487999027883e-03, -5.924068399423090e-04, 2.649456579713789e-04,   2.040593160046010e-03, 5.082452371449130e-03, -6.891177106572999e-04, 1.144541248686596e-02,  -1.277733503205920e-03, -4.671303298628985e-03, 5.431437496582082e-03, -2.673387265555091e-03,   2.489905797166422e-02, 5.699147163503861e-03, -9.562196921469087e-05, 1.591990816070267e-03,   1.187048733230656e-03, -1.772005923794269e-03, -9.027708867132929e-04, 6.284028547680468e-04,  -1.119242671578667e-03, 1.136222237078637e-04,
                   -5.702883880187581e-04, -4.001303796646166e-05,  -3.576711932577400e-05, 7.255194485703994e-03, 1.152397479558758e-03, 2.079835283848775e-03,  -1.167620291059150e-03, -1.007975340498742e-03, -5.509051478105181e-04, -2.029004236694320e-03,   7.601968415834812e-04, -5.313950379037622e-04, 7.800560893505997e-04, 3.843689468882432e-03,   1.462064127668949e-03, 5.041134002995066e-02, -7.882065923430114e-03, -3.689504015725929e-02,  -3.309802835411914e-03, 9.642622090770339e-03, -2.543986351157531e-02, -1.861428032371489e-02,   7.504317388254058e-03, 3.334697218891084e-03, 3.626838391333799e-04, 2.717898195493477e-03,  -7.745389314249541e-03, 3.071954228670431e-02, 7.369897229666000e-03, -1.438104659734819e-03,  -9.333486017597363e-04, 1.136817453441484e-03, 8.055068827560713e-03, -6.570336109999329e-03,   3.877079983908936e-03, -3.452891982657318e-03, -4.801244708952909e-04, -3.487402938789624e-02,   7.209226303954708e-03, 3.964769550116280e-02, 4.691962885190091e-03, -8.897294137169750e-03,   2.041323474721708e-02, 1.674967523477068e-02, -7.223444769354163e-03, -2.321807878406465e-03,  -1.239680179861386e-03, -1.430538094646378e-03, -3.719540579187447e-03, -8.726819411676968e-04,   5.001335908486517e-03, 2.986895171575009e-02, -1.527553317457221e-03, 1.226806770445976e-03,   4.429929006167883e-03, -1.506753377568792e-03, 5.918344069388886e-03, 1.126538720065010e-03,   1.062724408137554e-04, 9.288804466832612e-03, -1.099682531373368e-04, -9.260932001605835e-03,  -1.428769178325955e-03, 1.733561997273582e-02, -5.152743782713081e-03, -6.843632634876803e-03,   3.525049156041135e-03, -1.425083564224705e-04, -2.165964501557619e-03, -1.772596254603949e-03,  -2.276073513164473e-02, 5.669946339216976e-04, 1.942811029074189e-02, 6.057431835286386e-04,  -4.494423149907400e-03, 3.153377549922684e-02, 7.661419246675580e-03, -2.587381925151952e-03,  -4.848956584610572e-03, -1.137563258024040e-03, -2.542502455916331e-04, -1.807956073605993e-02,   7.024318439084136e-03, 1.737626791305900e-02, 4.083319594927065e-03, -7.287754102452568e-03,   9.020910149863880e-03, 2.869675373180319e-02, -7.759943689608966e-03, 2.554643231834854e-03,   6.166700765812116e-05, 2.115387564756476e-04, 6.734019093048981e-03, -5.442835008409288e-03,  -7.351472794521710e-03, -1.320635944827174e-03, 3.696640997949949e-03, -3.167559877936847e-03,  -7.311310565865120e-03, 2.259302038613065e-02, -1.131369555110688e-03, -1.256772559208149e-04,   4.395675685767639e-04, 2.728851713548907e-03, 3.806731346755658e-03, -1.875441141664851e-03,   5.911483220701680e-03, -5.060317892827753e-04, -4.408414113897688e-03, 2.967445343850837e-03,  -1.449685854430603e-03, 1.847531318724463e-02, 3.615961082657503e-03, -2.379504930110146e-04,  -1.587953362813255e-03, 1.102374249111450e-03, 2.001775574706544e-03, -3.696123659803006e-04,   4.759338434259569e-05, 1.739932872744526e-03, 9.317902855920310e-04, -6.305005894569676e-04,  -6.624018174137265e-04, -2.894401660811429e-04, 4.384800169137767e-03, -3.071316115761434e-04,   7.127423014662562e-04, -9.427180204405550e-04, -6.307069857639817e-04, -1.327363331713291e-03,  -8.787077505895810e-04, 1.925061981058685e-03, -1.383311081789194e-03, 6.371464135190672e-04,  -1.277899824744331e-04, 1.154388917553363e-04, 3.101155465744568e-02, -5.170227807153744e-03,  -1.937561219709386e-02, -1.099262851512458e-03, 5.457330307647528e-03, -1.174017683327832e-02,  -1.036648362409255e-02, 3.654282006738440e-03, 1.416456237026041e-03, 1.153077045971045e-03,  -6.025530620801245e-05, -5.281876211408954e-03, 1.375828079284130e-02, 3.128466912139109e-03,  -3.250293539355565e-03, -8.381583300328694e-04, 1.225638101100324e-03, 2.937017880366272e-03,  -2.210934202184262e-03, -3.081999020373843e-04, 1.453819961239316e-04, -1.613687990639095e-04,  -1.964943799708067e-02, 3.400660849092731e-03, 2.298281019906830e-02, 2.717554245629189e-03,  -4.772082859802196e-03, 9.107459092524927e-03, 8.198589877020591e-03, -2.788416683833801e-03,  -1.211857137978496e-03, -4.780285909318624e-04, -3.018011325654638e-04, -1.711937520147885e-03,  -2.403687715167262e-03, 3.533304509903944e-03, 1.947861341427721e-02, -2.308307267485646e-04,   7.354654565886605e-04, 6.916104578437973e-04, 7.052146089959711e-04, 2.617048797003688e-03,   3.939928768141455e-05, -8.896033603422492e-04, 4.889352966717989e-03, -7.510975526391203e-04,  -5.113089383731687e-03, -6.536108039928205e-04, 1.210819182561610e-02, -1.844052829204500e-03,  -3.768307242749333e-03, 1.726120666119779e-03, -3.793074821893675e-04, 4.986453452332645e-04,  -6.276137493474653e-04, -1.111965403887440e-02, 9.906434467530012e-04, 8.119523041368298e-03,   6.229254105239995e-04, -1.923212412912364e-03, 1.770513055043213e-02, 3.293274661000605e-03,  -8.730621155787616e-04, -1.931936603232585e-03, 9.330772412741752e-04, 8.578032592118446e-04,  -9.639292313037624e-03, 2.863526257157518e-03, 8.853947309611785e-03, 1.022719981682464e-03,  -3.842642427680715e-03, 3.337541498089201e-03, 1.779120802435560e-02, -3.096227208304507e-03,   9.771532667181217e-04, -8.498538582982391e-04, -5.967840966836961e-04, 3.444535001751496e-03,  -2.514710538231183e-03, -4.181311819801060e-03, 2.540066000476515e-04, 1.614602001965411e-03,  -1.243674510942626e-03, -2.950716171932838e-03, 1.488457894840520e-02, 1.815453418468138e-04,  -2.102533265541634e-04, 2.514980327136414e-04, 1.031109275768207e-03, 2.496949118382889e-04,  -4.190626136062591e-04, 2.470988735837539e-03, -3.173747853289326e-04, -1.827605353975672e-03,   1.084415425007448e-03, 2.555939322149018e-05, 1.192155699596888e-02, 2.256129721529037e-03,  -3.103267182730188e-04, -1.642698574169266e-03, 2.878734797518608e-04, 1.831391498178797e-03,  -4.864074885959470e-04, -1.745386190014479e-04, 1.737739616427501e-03, 7.751746681830722e-04,  -3.957051331607013e-04, -8.010055007307542e-04, -2.284017134972531e-04, 2.806289391392942e-03,  -4.509838957779159e-04, 1.933329929037259e-04, -2.073199085097458e-04, -1.910071414947690e-04,  -1.018290982456667e-03, -3.592033192721916e-04, 1.409869337203915e-03, -1.029612651743348e-03,   4.050455401576690e-04, -1.367716110276224e-03, -5.383643568876791e-04, 1.997665157561489e-02,  -4.450204427077312e-03, -1.200506144214170e-02, -8.755809510159925e-04, 3.148817638405752e-03,  -6.297136103120042e-03, -6.489067586561300e-03, 2.498560720220881e-03, 1.681289362179987e-04,   6.801397381057056e-04, 2.796330483213249e-04, -4.229633011093747e-03, 8.056245224857310e-03,   2.581894352537104e-03, -2.677470347530006e-03, -8.032638048178060e-04, 1.352027083607308e-03,   1.866964636597201e-03, -1.575213359128946e-03, -6.250543736457167e-04, 1.633540999623064e-03,  -2.194860102322739e-04, -1.194668906939621e-02, 2.637479037429777e-03, 1.570105206930864e-02,   3.257078906574951e-03, -2.701963415971741e-03, 4.863812460413215e-03, 4.892127673708797e-03,  -1.967477869532280e-03, -1.677620898566604e-05, -2.971751583456173e-04, -4.481392854079488e-04,  -7.043210703086863e-04, -2.276951331669304e-03, 3.069297358439242e-03, 1.573403133747829e-02,  -6.659792644169490e-06, 8.104860926719192e-04, 1.894401476382272e-04, 8.643646036723318e-04,   2.097547207146810e-03, -1.018286806439660e-04, -9.897171935482198e-04, 3.115180393280572e-03,  -8.454535836498601e-04, -2.459545680881721e-03, 4.092158474491218e-05, 8.248258396359946e-03,  -6.526143300279175e-04,
                   -2.643091607770431e-03, 1.227634921804005e-03, -4.659578897078426e-04,   1.439707521997440e-03, -3.702419629529555e-04, -6.467960017322095e-03, 1.327109339842804e-03,   5.083574276494054e-03, 1.161269791764966e-03, -8.012483617230604e-04, 1.090746723627029e-02,   1.739009798246286e-03, -6.382620538458201e-04, -6.475450377402775e-04, 7.366103904241144e-04,   1.421221210727081e-03, -6.813906718410399e-03, 2.362026658744314e-03, 5.074730996807351e-03,   8.108599549408333e-05, -2.623302677353148e-03, 1.815216791771837e-03, 1.232292411087237e-02,  -2.194048468152803e-03, 8.868539973755883e-04, -4.120806608205853e-04, -9.689049687637958e-04,   2.755435366196928e-03, -1.589326150670023e-03, -1.991210385147255e-03, 1.056660229678810e-03,   1.249129007967937e-03, -7.673364025421125e-04, -2.196311223319327e-03, 1.029110459323317e-02,   2.142201612318011e-04, -6.046122290576141e-04, 3.668966351335371e-04, 5.239501428044814e-05,  -2.712450587260239e-04, 1.579759335087684e-04, 1.968788515176458e-03, -3.963668851200225e-04,  -5.658490424072303e-04, 8.948199422670021e-04, 1.304693384266017e-04, 7.936115000495528e-03,   1.191195424201194e-03, -3.481575164297692e-04, -7.880393703545412e-04, -4.133739785132086e-04,   4.442602419476999e-04, -3.433559555990646e-04, -3.523552447897075e-04, 7.240628764427683e-04,   6.036547836437926e-04, -3.956948603835364e-04, -4.374429436809842e-04, -1.368673602090119e-04,   1.940129088085971e-03, -2.063515864612737e-04, 1.236849242477604e-03, 4.955094285983110e-04,  -4.303709265802728e-04, -7.285128017739243e-05, -1.705148935568252e-04, 2.969236765912868e-04,  -1.490622504075004e-04, 1.764200552432614e-04, -1.207459155664937e-03, -8.843390869940534e-04,   8.161016345051557e-03, -2.623694947158191e-03, -4.982235143914569e-03, 2.389035323267947e-04,   5.878437098728136e-04, -2.022628976965723e-03, -1.758023648721986e-03, 2.937147858030975e-04,   7.945199024864016e-05, 5.965347126590977e-05, 1.138262277592704e-03, -2.650561267909933e-03,   7.633883379698460e-03, 2.947208330023659e-03, -1.815192408874827e-03, 3.504277418762856e-04,   9.040893627651034e-04, 9.746672194411318e-04, -6.543563007689068e-04, 7.225900737992466e-05,   1.122630743090925e-03, 5.747890587689880e-04, -5.016842945664840e-03, 2.354537719722924e-03,   8.559772659045090e-03, 1.810344877394293e-03, -2.484202876371893e-04, 2.185520113367612e-03,   1.161996161979508e-03, 7.125336773242986e-05, 8.002786316613089e-05, -2.089766202172177e-04,  -7.554063104379329e-04, 5.847993260214539e-04, -2.183862212905680e-03, 9.116916255912997e-04,   1.295201813928359e-02, -1.829931237599597e-04, -3.250863842951175e-04, 7.225086645158736e-04,   2.332303109908318e-04, 2.834156438031948e-03, -2.509865475046412e-04, -5.358826941945839e-04,   7.369118241417091e-04, -1.594901416879933e-04, -3.842398984105731e-04, 4.760559241773535e-05,   4.296116588019500e-03, 3.351455618222392e-04, -1.151881189631123e-03, 6.057191151815043e-04,  -3.874217716344221e-04, 9.591768325604936e-04, 1.193330723656375e-04, -2.794414276992896e-03,   9.624647770751420e-04, 2.810727741133218e-03, 1.602679824605327e-04, 2.120818172510835e-04,   5.679387104747635e-03, 4.039855249281070e-05, 2.684794038535277e-04, -5.595738408827196e-04,   5.765234213017936e-04, 9.789916908282178e-04, -2.208326348700876e-03, 1.799556042159102e-03,   1.568784375001546e-03, 4.814541983081725e-04, -1.125983281423681e-03, -1.576152764717361e-04,   6.382777999755986e-03, -1.184498747681195e-03, 1.095144012660836e-03, -2.865563979615503e-04,  -6.650355285789723e-04, 7.315543911859221e-04, -1.427344942740802e-03, -4.310704742690238e-04,   5.088987076089146e-04, 5.621688228878807e-04, 2.330141256359669e-04, -1.199752277789477e-03,   5.675763961861483e-03, -2.329672653903670e-04, -4.259728384023360e-04, 1.608251978242724e-04,   3.627419137209407e-04, 2.621054493992256e-04, -1.630330059965374e-04, 2.690910714330314e-03,  -2.849929079289542e-04, -7.579096870102896e-04, 9.400694812727053e-04, -1.831571601166541e-04,   5.027156902824074e-03, 5.183186920218184e-310, 5.189340708012823e-310, 5.200375086127226e-310,  5.212046062980203e-310, 5.227748831836014e-310, 5.231356224684360e-310, 5.239207609112710e-310,  5.242815001958191e-310, 5.249180989332618e-310, 5.267854552295633e-310, 5.279949928306803e-310,  5.287589113157044e-310, 5.295652697164639e-310, 5.303504081593039e-310, 5.311355466022179e-310,  5.320267848346259e-310, 5.325785037403807e-310, 5.329604629828878e-310, 5.338092612993381e-310,  5.347004995317412e-310, 5.349126991110502e-310, 5.349551390268942e-310, 5.354431980588261e-310,  5.367376154914581e-310, 5.383503322932143e-310, 5.390718108623154e-310, 5.410877068639844e-310,  5.419789450964368e-310, 5.424245642127470e-310, 5.438463013928123e-310, 5.445253400462473e-310,  5.447163196675972e-310, 5.455438980262664e-310, 5.464563562165791e-310, 5.476871137756304e-310,  5.483873723868120e-310, 5.490451910821644e-310, 5.499788692303917e-310, 5.508913274207241e-310,  5.523979444326553e-310, 5.532467427491057e-310, 5.539682213182315e-310, 5.542440807712299e-310,  5.552838587088671e-310, 5.571512150053414e-310, 5.579575734061553e-310, 5.591883309652215e-310,  5.603554286504203e-310, 5.624774244418797e-310, 5.636445221271971e-310, 5.647691798968682e-310,  5.655118784238642e-310, 5.668487357723650e-310, 5.677187540469819e-310, 5.681855931210782e-310,  5.684614525740173e-310, 5.693102508906011e-310, 5.699892895438631e-310, 5.700953893334608e-310,  5.701378292492900e-310, 1.327801423198350e-319, 0.000000000000000e+00, 2.854290994713458e-307,  5.393768963344679e-315, 5.434526138055946e-315, 7.295235936717051e-315, 7.295235936717051e-315,  2.470328229206233e-323, 6.879612110275384e-315, 5.905038765479151e-315, 0.000000000000000e+00,  1.558334034557942e-315, 0.000000000000000e+00, 5.905038291176131e-315, 2.262048159065940e-311,  2.529616106707182e-321, 6.907477817834660e-315, 7.295237359626111e-315, 0.000000000000000e+00,  6.458969594647200e-318, 2.075075712533235e-322, 0.000000000000000e+00, 0.000000000000000e+00,   0.000000000000000e+00, 7.295236183749874e-315, 7.295238150131144e-315, 0.000000000000000e+00,   0.000000000000000e+00, 0.000000000000000e+00, 8.891162364144491e-312, 0.000000000000000e+00,   0.000000000000000e+00, 0.000000000000000e+00, 7.295237043424098e-315, 7.295237043424098e-315,  6.916919041777452e-323, 7.295207004232830e-315, 7.345516093354183e-315, 4.940656458412465e-324,  7.295235936717051e-315, 0.000000000000000e+00, 7.295237359626111e-315, 7.295237043424098e-315,  6.916919041777452e-323, 7.295207004232830e-315, 7.344902582397803e-315, 4.973427684481422e-316,  7.295235936717051e-315, 7.295236173868561e-315, 1.558317433952242e-315, 0.000000000000000e+00,  7.295236529595826e-315, 1.061004354452231e-312, 2.544438076082420e-321, 0.000000000000000e+00,  7.295235936717051e-315, 0.000000000000000e+00, 6.458969594647200e-318, 7.295237685709437e-315,   0.000000000000000e+00, 0.000000000000000e+00 )
               , tolerance = 1e-06)

  expect_equal(c(fit$fixed_effects),
               c(numeric(0) )
               , tolerance = 1e-06)

  expect_equal(c(fit$n_iter),
               c(32 )
               , tolerance = 1e-06)

  expect_equal(c(fit$Q),
               c( 0.012434815543722817, 0.005244225275545354, 0.071976006339097717, -0.024189184407588889, -0.065125731657270702, -0.019460571960354771, 0.018174610159167850, -0.046769880336067035, -0.043375315954286592, 0.023368949726172032, -0.002662571157004590, 0.005244225275545354, 0.133929481225432023, 0.044165514109124455, 0.286589481453515593,  0.217561465090314987, -0.009374911920971330, 0.162489330560516954, 0.027773393971988483, -0.190527598755109495,  0.154830867553479162, -0.019511065025037414, 0.071976006339097717, 0.044165514109124455, 0.515762515385436826, -0.102379770451590996, -0.421372881412773737, -0.018521898357053007, 0.141757629711838418, -0.336177845420870869, -0.291602848837894113, 0.160666702640552939, 0.034391306787440422, -0.024189184407588889, 0.286589481453515593, -0.102379770451590996, 1.140895555510252013, 0.496670609998695500, 0.203064258742873371, 0.213487947113595755,  0.010407784161420009, 0.051093470276207476, -0.029514925007892615, 0.247344254453607637, -0.065125731657270702,  0.217561465090314987, -0.421372881412773737, 0.496670609998695500, 1.090292241175528698, 0.224748276786640999,  0.283022947042624595, 0.517211359915282665, -0.305321419600155131, 0.366331647100172630, -0.143907689553188667, -0.019460571960354771, -0.009374911920971330, -0.018521898357053007, 0.203064258742873371, 0.224748276786640999,  0.714921849176276658, 0.039492630631724458, 0.008367114006189660, 0.090572167398496634, -0.010894124530160785,  0.258971600270039459, 0.018174610159167850, 0.162489330560516954, 0.141757629711838418, 0.213487947113595755,  0.283022947042624595, 0.039492630631724458, 0.268161727472492561, 0.039318514372574082, -0.392251717664492294,  0.321703849375479134, -0.075104368548121150, -0.046769880336067035, 0.027773393971988483, -0.336177845420870869,  0.010407784161420009, 0.517211359915282665, 0.008367114006189660, 0.039318514372574082, 0.350149719485183974, -0.067719130660870097, 0.125992351516937356, -0.151344542916280606, -0.043375315954286592, -0.190527598755109495, -0.291602848837894113, 0.051093470276207476, -0.305321419600155131, 0.090572167398496634, -0.392251717664492294, -0.067719130660870097, 0.739199298339762723, -0.590245329181589895, 0.257041582884738884, 0.023368949726172032,  0.154830867553479162, 0.160666702640552939, -0.029514925007892615, 0.366331647100172630, -0.010894124530160785,  0.321703849375479134, 0.125992351516937356, -0.590245329181589895, 0.501392004404737968, -0.214905059489780614, -0.002662571157004590, -0.019511065025037414, 0.034391306787440422, 0.247344254453607637, -0.143907689553188667,  0.258971600270039459, -0.075104368548121150, -0.151344542916280606, 0.257041582884738884, -0.214905059489780614,  0.247067267237199240 )
               , tolerance = 1e-06)

  expect_equal(c(fit$Q_0),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$n_risk),
               c(20068, 19664, 19622, 19483, 19083, 18587, 18000, 17161, 16411, 15624 )
               , tolerance = 1e-06)

  expect_equal(c(fit$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 )
               , tolerance = 1e-06)

  expect_equal(c(fit$risk_set),
               c(NULL )
               , tolerance = 1e-06)

  expect_equal(c(fit$data),
               c(NULL )
               , tolerance = 1e-06)

  expect_equal(c(fit$order),
               c(1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$F_),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$method),
               c("UKF" )
               , tolerance = 1e-06)

  expect_equal(c(fit$model),
               c("exponential" )
               , tolerance = 1e-06)

  expect_equal(c(fit$est_Q_0),
               c(FALSE )
               , tolerance = 1e-06)

  expect_equal(c(fit$LR),
               c(1 )
               , tolerance = 1e-06)
})


