library(survival)

test_that("The head_neck_cancer must be defined for the ddhazard tests",
          expect_true(exists("head_neck_cancer")))

# Test on data set that is one of Farhmiers papers
result = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1, # Use by month intervals
  n_max = 10^4, eps = 10^-4,
  a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
  est_Q_0 = T,
  max_T = 45,
  id = head_neck_cancer$id, order_ = 1
)

test_that("Testing previous computed values vs. current on head and neck cancer set assuming that the previous is correct", {
  expect_equal(c(result$a_t_d_s),
               c(-3.5084644693000375, -3.5148844600373153, -3.1891314791814929, -2.8181185126716946, -2.5133150253138181, -2.0686431883814391, -2.1337664829927272, -2.5088816216986980, -2.7261252524003838, -2.8656346839715456, -3.0022690651419150, -3.2103909019454631, -3.3296886621454438, -3.3797024676574670, -3.2387762301797576, -3.2832268974011902, -3.4010378429506498, -3.4996364628495664, -3.4640927580381167, -3.5454306632739097, -3.5193437650355053, -3.6429455602328522, -3.8148529400485618, -3.9315760725295390, -3.9912270162929087, -4.1221212755199144, -4.2111505273306804, -4.2593181086540230, -4.3955501412991156, -4.5056360495292482, -4.5891834181979796, -4.6463491829253352, -4.6772452961075963, -4.6818100380470060, -4.6597979866888570, -4.6108005184078964, -4.5342715329240795, -4.4295511232451679, -4.4288880723551687, -4.5320293776581728, -4.6212298063525905, -4.6940739120459574, -4.7499759978712248, -4.7915369057959181, -4.8188789577153992, -4.8320508432930724, 0.4360755600018228, 0.4376620032308990,  0.4489331535887380, 0.4629877155198045, 0.4717967889720516, 0.4892432325019014, 0.4906015100905337, 0.4811672226212869, 0.4812410655726153, 0.4807008058089728,  0.4795022646846021, 0.4752694673136330, 0.4750540102025831, 0.4782488768524199, 0.4871715112202827, 0.4868843094919623, 0.4843562325887174, 0.4835935130835331,  0.4867226287750569, 0.4863614783282632, 0.4891031221907462, 0.4848002061937289, 0.4802281967614200, 0.4772168219924643, 0.4758176353352087, 0.4735558899381061,  0.4724962572592801, 0.4726240459881104, 0.4714467634180154, 0.4710489177360688, 0.4714390992094060, 0.4726106938155138, 0.4745588596923577, 0.4772841101671843,  0.4807925107278950, 0.4850950220887917, 0.4902067111479924, 0.4961460340659207, 0.4977474633246664, 0.4949782740709857, 0.4925889375015259, 0.4906451477362695,  0.4891628332671372, 0.4880589755764653, 0.4873303205106824, 0.4869755787235325 ))

  expect_equal(c(result$V_t_d_s),
               c( 0.0011007577913296656, -0.0001733451115550633, -0.0001733451115550633, 0.0004392322044566420, 0.0682991240249047060, 0.0003834452042018443,  0.0003834452042018442, 0.0029230271218272539, 0.0912395007549733350, -0.0003397914632747466, -0.0003397914632747466, 0.0052119615712443315,  0.0932049749695377378, -0.0016092541197089715, -0.0016092541197089711, 0.0073429567284740965, 0.0849686813506122934, -0.0030571106681653009, -0.0030571106681653005, 0.0093460739808944281, 0.0774928836229536178, -0.0044064881508436658, -0.0044064881508436658, 0.0112576788942480542,  0.0625786071371585012, -0.0058040178177705924, -0.0058040178177705924, 0.0131038581718835520, 0.0663037854506360463, -0.0066152078662832037, -0.0066152078662832037, 0.0149859903532218054, 0.0802636516361565355, -0.0072606054091964422, -0.0072606054091964422, 0.0169064138433351260,  0.0925945303565963995, -0.0077694160284284882, -0.0077694160284284891, 0.0188521666403896025, 0.1028653949187706279, -0.0082893243691400179, -0.0082893243691400196, 0.0208108298970566402, 0.1134521022635953669, -0.0087341231657698665, -0.0087341231657698665, 0.0227878464846351519,  0.1282127482321499812, -0.0091281359070864241, -0.0091281359070864224, 0.0247818173504978020, 0.1412262999503804406, -0.0096021138204995977, -0.0096021138204995960, 0.0267801536095240260, 0.1518039844431364749, -0.0100679733114127437, -0.0100679733114127437, 0.0287860644548110257,  0.1503781552817381462, -0.0107654864975719258, -0.0107654864975719258, 0.0307850681462566306, 0.1529892913432942814, -0.0114268209514253039, -0.0114268209514253039, 0.0328022104304094425, 0.1623989951758836869, -0.0119988254560485837, -0.0119988254560485837, 0.0348470071785677502,  0.1751405465177472420, -0.0124767948762201323, -0.0124767948762201323, 0.0369196593146410082, 0.1826262222670714253, -0.0130763410888457762, -0.0130763410888457762, 0.0390042849193854013, 0.1921213871302026865, -0.0136031573461606395, -0.0136031573461606395, 0.0411148217076838310,  0.1952137792451406062, -0.0142700820537257390, -0.0142700820537257390, 0.0432374522277687856, 0.2045009115946196943, -0.0150037228119862687, -0.0150037228119862670, 0.0453817496599724785, 0.2197992615605408318, -0.0156403530269492337, -0.0156403530269492302, 0.0475580384562985375,  0.2351742387248771660, -0.0163387197002041323, -0.0163387197002041323, 0.0497535112080704153, 0.2471786691448959739, -0.0171983898818672161, -0.0171983898818672196, 0.0519599789846230259, 0.2633406508519972045, -0.0179758501250396573, -0.0179758501250396607, 0.0541928396098181331,  0.2783570585162779554, -0.0187578421049752302, -0.0187578421049752336, 0.0564447233177911220, 0.2898617445280329274, -0.0196256986326030711, -0.0196256986326030711, 0.0587095922537396175, 0.3070089074201384216, -0.0202566671302706752, -0.0202566671302706752, 0.0610078966170546910,  0.3265517822464923947, -0.0207566923998554545, -0.0207566923998554545, 0.0633316746524540397, 0.3468613597848555496, -0.0211777326575118136, -0.0211777326575118136, 0.0656762424587988280, 0.3669330349624608245, -0.0215496836790728778, -0.0215496836790728778, 0.0680384930107222063,  0.3859999570458617635, -0.0218930814893318545, -0.0218930814893318545, 0.0704161786213701735, 0.4033580584084034970, -0.0222249753911356145, -0.0222249753911356145, 0.0728075543038044365, 0.4182756228156945255, -0.0225620115551172298, -0.0225620115551172298, 0.0752111771525787870,  0.4299395711487184468, -0.0229222709068044872, -0.0229222709068044872, 0.0776257813361121429, 0.4374185315654753881, -0.0233265169857653290, -0.0233265169857653290, 0.0800501930267311507, 0.4389396398028437285, -0.0237873509608388274, -0.0237873509608388274, 0.0824839842388029043,  0.4444370473634537966, -0.0241089985969926528, -0.0241089985969926528, 0.0849399776770060483, 0.4705099679725334716, -0.0239711015900734327, -0.0239711015900734327, 0.0874386019174675511, 0.5127677482774826156, -0.0234537793009185619, -0.0234537793009185619, 0.0899729190136854540,  0.5710035270105234817, -0.0225390051857156867, -0.0225390051857156867, 0.0925406272428825755, 0.6422966612793774566, -0.0213827332568293886, -0.0213827332568293886, 0.0951287192064125264, 0.7296350793987446126, -0.0198916154467032036, -0.0198916154467032036, 0.0977389611802057523,  0.8366982297826955906, -0.0179580979280018482, -0.0179580979280018482, 0.1003735699436583140 ))

  expect_equal(c(result$lag_one_cor),
               c( 0.0006319914823851234, -0.0001813450353835426, -0.0002126117899357636, 0.0004231047677557611, 0.0374926594959537965, -0.0005380017294018889, -0.0005485720017780360, 0.0027985731084827336, 0.0481658093802995874, -0.0016000013589881627, -0.0015949751696787691, 0.0050048137282718962,  0.0456878855983472026, -0.0029587363809467785, -0.0029189483751894322, 0.0070703673493283329, 0.0396604087798715019, -0.0043033008270456190, -0.0042589644753056816, 0.0090269214295090917, 0.0312294200116858406, -0.0056445383104769611, -0.0055052058435728288, 0.0109053718415916372,  0.0277604858121243067, -0.0066868592103896726, -0.0065493515470886115, 0.0127664150516888786, 0.0339237983194087267, -0.0074374459108181770, -0.0074140515313897131, 0.0146609784134950454, 0.0440622779829562689, -0.0081876860923845354, -0.0080158162771978795, 0.0165879425442369867,  0.0532613145041970354, -0.0087846810550449832, -0.0085842409359943670, 0.0185356890963747287, 0.0620030758351880484, -0.0093425048092310777, -0.0091025684196418474, 0.0204997891156617623, 0.0728513701255290580, -0.0097823345080032802, -0.0096128728534951753, 0.0224819052110776137,  0.0852163441699832769, -0.0102462632327539986, -0.0101088730406997656, 0.0244754314202132520, 0.0959330788853532263, -0.0107781511795978276, -0.0105860202161019556, 0.0264754322364910526, 0.1002061921916009707, -0.0114127390024465029, -0.0111391949292140822, 0.0284766937737128793,  0.1007636418466745787, -0.0120573912090688583, -0.0118570640836160000, 0.0304836792486671525, 0.1062366995263799574, -0.0126455551196479089, -0.0125325810037256995, 0.0325131894616143557, 0.1164479435890595910, -0.0131968007123752003, -0.0130824399573795571, 0.0345702739070011394,  0.1259739156939710947, -0.0137649784666452300, -0.0136274381705102868, 0.0366477215003125287, 0.1339397670426479281, -0.0143510749271825982, -0.0141996145156178810, 0.0387441154191005901, 0.1399397952275374390, -0.0149739632061277085, -0.0147895226744024933, 0.0408598614778161312,  0.1457693177465160805, -0.0155839512939056103, -0.0155955638120855878, 0.0429925035951635587, 0.1573951226983123508, -0.0162626012661845898, -0.0163227628857992857, 0.0451516935211992362, 0.1720884528462469087, -0.0169267713220890778, -0.0170279042024082637, 0.0473366336214868441,  0.1853207193021612631, -0.0176966192481461081, -0.0178397971217273306, 0.0495369101392598918, 0.1988822844190729910, -0.0185218493681163360, -0.0186795043672042492, 0.0517557651622434362, 0.2140265293846420891, -0.0193324169287155505, -0.0194536391053007109, 0.0539974391987324484,  0.2269743551126637005, -0.0201775348081844191, -0.0202760450098242243, 0.0562552827877792691, 0.2408827346519127055, -0.0209761004349988504, -0.0210013621236798051, 0.0585361402693362204, 0.2587873461391665963, -0.0215840832784766519, -0.0215509137876134238, 0.0608464935722820149,  0.2783108156512931197, -0.0220822328593056443, -0.0219982908028953338, 0.0631800531920647668, 0.2981521380750243311, -0.0225129962129074074, -0.0223819658897505894, 0.0655329263193361600, 0.3174279954979510876, -0.0229027366724126047, -0.0227258619326826256, 0.0679024304099249548,  0.3354014001863034333, -0.0232710946107934427, -0.0230480112171346438, 0.0702865626215162104, 0.3513521643906739600, -0.0236355450370131226, -0.0233647677843556098, 0.0726837231452698296, 0.3645059125021066215, -0.0240139196073090484, -0.0236931428694739724, 0.0750925529047788837,  0.3739890959881940757, -0.0244259932862989082, -0.0240522839920852098, 0.0775118285517998884, 0.3784535347735979438, -0.0249012435710693411, -0.0244462789870596130, 0.0799407418619832999, 0.3819151740934059180, -0.0253026050600785556, -0.0248317275156184590, 0.0823853873046871965,  0.3973498624532323387, -0.0253572058863496402, -0.0249807749061207209, 0.0848621500522364069, 0.4309121681052292541, -0.0250169074096886247, -0.0246995171538831222, 0.0873779395067437042, 0.4804161596009360879, -0.0243022568530614422, -0.0240233709749064703, 0.0899281997898045693,  0.5444877914482062486, -0.0232369005433537522, -0.0230542772574000854, 0.0925054925093105329, 0.6230475261289992739, -0.0218919395921305972, -0.0217917741796725788, 0.0951040211830674886, 0.7194167882990079033, -0.0201652844689610457, -0.0201377013624211842, 0.0977257666720493107 ))

  # expect_equal(c(result$n_iter),
  #              c(274 ))

  expect_equal(c(result$Q),
               c(0.129221898731263357, 0.002475034806031055, 0.002475034806031055, 0.002645631948634509 ))

  expect_equal(c(result$Q_0),
               c( 0.0011007577913296656, -0.0001733451115550633, -0.0001733451115550633, 0.0004392322044566420 ))

  expect_equal(c(result$n_risk),
               c(96, 95, 91, 84, 78, 65, 53, 49, 46, 43, 39, 37, 36, 36, 33, 31, 30, 30, 25, 25, 23, 21, 21, 21, 20, 19, 19, 18, 18, 18, 18, 18, 18, 18, 18, 18, 17, 15, 14, 14, 14, 12, 12, 12, 11 ))

  expect_equal(c(result$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45 ))

  # expect_equal(c(result$hazard_func),
  #              c([[1]]function (eta) {    exp_ = exp(eta)    exp_/(1 + exp_)}<environment: 0x000000001fb07d38> ))
  #
  # expect_equal(c(result$hazard_first_deriv),
  #              c([[1]]function (beta, x_) {    exp_ = exp(beta %*% x_)    x_ * exp_/(exp_ + 1)^2}<environment: 0x000000001fb07d38> ))

  expect_equal(c(result$risk_set),
               c(NA ))

  expect_equal(c(result$order),
               c(1 ))

  expect_equal(c(result$F_),
               c(1, 0, 0, 1 ))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result$a_t_d_s), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result$V_t_d_s)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result$Q_0)), rep(c("(Intercept)", "group1"), 2))
})

result_exp = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1,
  n_max = 10^4, eps = 10^-4,
  a_0 = rep(0, 2), Q_0 = diag(1, 2),
  Q = diag(1e-3, 2),
  est_Q_0 = F,
  max_T = 30,
  id = head_neck_cancer$id, order_ = 1,
  verbose = F,
  model = "exponential"
)

# matplot(result_exp$a_t_d_s, type = "l")
# get_expect_equal(result_exp)

test_that("Result of exponential model on head_neck_data match previous results", {
  expect_equal(c(result_exp$a_t_d_s),
               c(-3.97670917333694840, -3.97674594528922842, -3.67822723844953225, -3.38186160670887448, -3.20803125783379928, -2.81150733914823459, -2.86991583304613229, -3.19339409542700414, -3.33884572499217747, -3.44488663489353897, -3.55468195135890896, -3.74276473988639058, -3.83879589030475188, -3.85491280083719179, -3.69206869970224005, -3.74688315457354149, -3.86422464743509453, -3.94733561401569233, -3.90529955776537419, -3.96708964150362231, -3.92627936981884496, -4.05352095843694382, -4.21056855197516100, -4.31870528617516136, -4.37554856865496156, -4.48030141196976395, -4.54582342572652021, -4.57305289422576866, -4.66140004517541939, -4.72082090785410191, -4.75069382389330297, 0.23643942429448270, 0.23642538963461671, 0.35119909608991445, 0.46549545046933199, 0.53138482409557175,  0.68486304659599784, 0.66299911692218005, 0.53892413086915458, 0.48510875095794093, 0.44552674674974957, 0.40424312760390879,  0.33246258946182772, 0.29654462841347456, 0.29181540205284756, 0.35597679374548952, 0.33497520088953925, 0.28981802576768462,  0.25819314969811624, 0.27468066357009663, 0.25112029063171620, 0.26699776975209677, 0.21721608197843270, 0.15629576896568312,  0.11412921530635921, 0.09164410510332197, 0.05109346037346890, 0.02559506518920458, 0.01479926108810842, -0.01912463326287420, -0.04194359001789783, -0.05341608209319967 ))

  expect_equal(c(result_exp$V_t_d_s),
               c( 0.1832051868721281673, 0.0278848469490704347, 0.0278848469490704381, 0.0803177213322829875, 0.1132034251783800571, -0.0002825347413270007, -0.0002825347413270007, 0.0681138636429205468, 0.1057893643022574104, -0.0037108490430141639, -0.0037108490430141639, 0.0657813363200184242, 0.0933234388646140278, -0.0089983708866558654, -0.0089983708866558654,  0.0628183664969049760, 0.0788715600332714067, -0.0155162728380365406, -0.0155162728380365128, 0.0592778241516741244,  0.0734428605985888855, -0.0165822472363131579, -0.0165822472363131579, 0.0587135297616458440, 0.0591657019120934505, -0.0217911346933305147, -0.0217911346933305217, 0.0563985065119824158, 0.0614045817202078167, -0.0201269492208758713, -0.0201269492208758713, 0.0571887451287438134, 0.0723425094484046460, -0.0145208873097363092, -0.0145208873097363092,  0.0599501350321204399, 0.0803567973399948177, -0.0104885005098428984, -0.0104885005098429001, 0.0620705206328553000,  0.0869387047105238953, -0.0071134417298352650, -0.0071134417298352659, 0.0640036899753111677, 0.0939937589466598167, -0.0034894844498765754, -0.0034894844498765763, 0.0661485628168010653, 0.1056352965671321503, 0.0018561382382013911,  0.0018561382382013894, 0.0690194618275779270, 0.1154879277980833396, 0.0062299728951861078, 0.0062299728951861026,  0.0714630155033750963, 0.1222252055365240092, 0.0092166054186206374, 0.0092166054186206409, 0.0733443351545733369,  0.1171870821646983502, 0.0074167417118372499, 0.0074167417118372429, 0.0733164859929927581, 0.1186200073373010061,  0.0080962739829031592, 0.0080962739829031558, 0.0742920260983656322, 0.1267252242886504343, 0.0113714342440382615,  0.0113714342440382511, 0.0763302459132520761, 0.1368320431509568169, 0.0154106707763921706, 0.0154106707763921637,  0.0787023904830222026, 0.1418229945213846377, 0.0173294366900338045, 0.0173294366900338011, 0.0802302232935526993,  0.1484277775914494280, 0.0199114476530654755, 0.0199114476530654685, 0.0820632817930946612, 0.1488018943776022174,  0.0200040322972981702, 0.0200040322972981771, 0.0829277355347014244, 0.1570037340272072146, 0.0229661973712110210,  0.0229661973712110210, 0.0848786434078876301, 0.1710859655268716084, 0.0282664666087455024, 0.0282664666087455094,  0.0877901216774502752, 0.1865428085371889089, 0.0340275035065738946, 0.0340275035065738946, 0.0908764893254096623,  0.2014834476666247376, 0.0394535520998959832, 0.0394535520998959902, 0.0938003636583288197, 0.2229019052396607470,  0.0473425660283096975, 0.0473425660283097044, 0.0976811265666991113, 0.2487790398587779450, 0.0569349094050815366,  0.0569349094050815435, 0.1022282780020242754, 0.2799374204675383337, 0.0684956253291079536, 0.0684956253291079675,  0.1075214163665750289, 0.3289519028931106037, 0.0869897747611888261, 0.0869897747611888261, 0.1155225124818885507,  0.3996377264490825754, 0.1138172549902054936, 0.1138172549902054936, 0.1267411842245389220 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.1031151556577854234, -0.0025673007890856248, -0.0041177019347565513, 0.0671738953591519139, 0.0729285502330940805, -0.0153665974737224043, -0.0163223793842787457, 0.0611807158610895852, 0.0644065921154819421, -0.0192288355867880623, -0.0200771554947000441, 0.0587459567274195293, 0.0535427330021189529, -0.0239158942554452691, -0.0251883169614478958,  0.0558824984363825716, 0.0464796572600867930, -0.0275860737664426203, -0.0268684891017166583, 0.0542637414978720672,  0.0392122788902791175, -0.0294064481771485198, -0.0293297471017429506, 0.0532084301672932219, 0.0356480065351482064, -0.0305448770356387816, -0.0298416548856658831, 0.0528117325314924682, 0.0391007556490918923, -0.0284712115615889730, -0.0270759696825927688, 0.0541164525517244047, 0.0455860098549121379, -0.0246247696130386419, -0.0236000239726060282,  0.0561089074393790813, 0.0509999785363083741, -0.0216239631152422562, -0.0206527528940453828, 0.0578530091473455632,  0.0562916820073403254, -0.0187677945664524483, -0.0176931041764787911, 0.0596626970982066657, 0.0638551422142593222, -0.0149661074687492766, -0.0139066474561677852, 0.0619031698774247519, 0.0731667066769392804, -0.0105326229049919270, -0.0097298238679709072, 0.0643460593649873014, 0.0805695408224628151, -0.0071133009784132770, -0.0064778750491979904,  0.0663753078027907867, 0.0813318588316555291, -0.0064375392389208665, -0.0060344261003749443, 0.0672889043995953118,  0.0797084297205427755, -0.0069327416786996027, -0.0065228958987601513, 0.0677886978908447263, 0.0839155137757939540, -0.0051944934955948895, -0.0047410661895154194, 0.0692114369860178241, 0.0921739318284499620, -0.0018678257622304888, -0.0014075992625329978, 0.0712902662011879601, 0.0992140159350134720, 0.0009836567781669348, 0.0013068741186968123,  0.0731646605524272076, 0.1045839525483038546, 0.0030432240366696992, 0.0034174257987806232, 0.0747811495072748106,  0.1078806901256837703, 0.0043465972131570517, 0.0046400514000073771, 0.0761011970976562674, 0.1118466302783495819,  0.0058133786026677743, 0.0059801473520385215, 0.0774610865836157098, 0.1222694919469353436, 0.0096261272420231150,  0.0098751951619719461, 0.0797852602660696492, 0.1363267096938496348, 0.0149120552743186169, 0.0151021452356542747,  0.0826785580752974619, 0.1509511601798297353, 0.0203473430664968327, 0.0204124280247277787, 0.0855987685722870567,  0.1683981812721982996, 0.0267338143382507831, 0.0267771885593782767, 0.0888925354534749884, 0.1913172634181187770,  0.0351973298712989283, 0.0352340798926058796, 0.0929984973894393968, 0.2191117948941448679, 0.0455237478712123000,  0.0455043952847125482, 0.0978116210372377975, 0.2579818125849921984, 0.0600511874735620288, 0.0600949580273164030,  0.1042783059265411510, 0.3163625819533421035, 0.0821479346489345230, 0.0821887053999010020, 0.1136704668433825699 ))

  expect_equal(c(result_exp$n_iter),
               c(66 ))

  expect_equal(c(result_exp$Q),
               c(0.09946932732012863, 0.03783300224988726, 0.03783300224988726, 0.01543663831742442 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))
})

test_that("poisson model and logit moels hazzard functions differs", {
  expect_true(result_exp$model != result$model)
  expect_true(toString(body(result_exp$hazard_func)) !=
                toString(body(result$hazard_func)))
  expect_true(toString(body(result_exp$hazard_first_deriv)) !=
                toString(body(result$hazard_first_deriv)))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result_exp$a_t_d_s), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result_exp$V_t_d_s)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result_exp$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result_exp$Q_0)), rep(c("(Intercept)", "group1"), 2))
})


# Change by argument
result_exp = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 2,
  n_max = 10^4, eps = 10^-4,
  a_0 = rep(0, 2), Q_0 = diag(1, 2),
  Q = diag(1e-3, 2),
  est_Q_0 = F,
  max_T = 30,
  id = head_neck_cancer$id, order_ = 1,
  verbose = F,
  model = "exponential"
)

# matplot(result_exp$a_t_d_s, type = "l")
# get_expect_equal(result_exp)

test_that("Result of exponential model on head_neck_data match previous results with altered by argument", {
  expect_equal(c(result_exp$a_t_d_s),
               c(-3.66470254910492965, -3.66474706370252523, -2.76810021608623336, -2.37016905577829462, -2.88527701004363868, -3.09784986345455149, -3.48266257367868359, -3.53409599869474356, -3.50452999032306378, -3.68733386046285716, -3.75440297910365439, -3.92931420996290637, -4.13536817561038994, -4.31353242824072147, -4.29415086207046315, -4.44742781342733640, 0.14460881063442274, 0.14458966333745016,  0.54220314703993744, 0.71686313456859296, 0.48814165025303158, 0.39660025957471889, 0.22674612731683766, 0.20698865962895394,  0.22015367692421495, 0.13937097843449658, 0.10943794134073426, 0.02931587668643268, -0.06355936873028328, -0.14352365432290462, -0.13606103184196280, -0.20391357029043852 ))

  expect_equal(c(result_exp$V_t_d_s),
               c( 0.2239954769849443750, 0.0655923866343257334, 0.0655923866343257472, 0.0856850342803099352, 0.0701094856476841277, -0.0038922715688509135, -0.0038922715688509135, 0.0523721592627481858, 0.0755056468311222084, -0.0019795481071096244, -0.0019795481071096105, 0.0514742546248752875, 0.0459893287640510268, -0.0168002899428832814, -0.0168002899428832814,  0.0428520247345924449, 0.0395383065657095717, -0.0176668807846101159, -0.0176668807846101159, 0.0427380304585478071,  0.0554849050799214386, -0.0083268844417649975, -0.0083268844417650027, 0.0482405628816991311, 0.0685881166264916964, -0.0008915346260135876, -0.0008915346260135910, 0.0530967481749607603, 0.0917314760624167724, 0.0105768571207504984,  0.0105768571207505019, 0.0598970756325017256, 0.1029505276277184328, 0.0162964559289216979, 0.0162964559289216944,  0.0641352931380022306, 0.1037258639501149188, 0.0164485880804922657, 0.0164485880804922657, 0.0656497098810895630,  0.1265921801941821134, 0.0268701800644146269, 0.0268701800644146269, 0.0721116488290027280, 0.1394313143521199172,  0.0328068306908046725, 0.0328068306908046725, 0.0766830420360093551, 0.1583797329998488101, 0.0408462387555405329,  0.0408462387555405260, 0.0820262021138331576, 0.1897619001198406763, 0.0541928541421161369, 0.0541928541421161369,  0.0897223868891949550, 0.2404909896530670887, 0.0760800199433048219, 0.0760800199433048219, 0.1012582172983322176,  0.3106678049553517895, 0.1062117278334599041, 0.1062117278334599041, 0.1163272984336688326 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.0581028385172765310, -0.0072444734259627663, -0.0091541950837004671, 0.0507854295613683060, 0.0305719789171202405, -0.0205541704126560032, -0.0217954718525925212, 0.0429534684036514680, 0.0256335909301954809, -0.0232916444899874189, -0.0256021168272291474, 0.0396164859822722010, 0.0217562109295342289, -0.0268049576003472970, -0.0251706803089071125,  0.0380668354484768462, 0.0208436994532727946, -0.0254916865534527692, -0.0231220640448812874, 0.0396078590805537395,  0.0243612892264773936, -0.0218239875294321505, -0.0198641722726530523, 0.0425826594850195056, 0.0314033017870680442, -0.0171719045857336335, -0.0155045036084438571, 0.0462019832669743127, 0.0410358093169969629, -0.0117507577680532344, -0.0104671739924645686, 0.0502204627419419736, 0.0447135283650619969, -0.0094214520125273163, -0.0089886987863954937,  0.0526366994782183420, 0.0519460678887981378, -0.0064314589218757625, -0.0054966721024843051, 0.0557115478144272411,  0.0648237411726153845, -0.0004605667099179742, 0.0004626102810896780, 0.0602421445696742427, 0.0767237353479582607,  0.0050357523477366044, 0.0053979315269180438, 0.0644122809169798000, 0.0966036776555502241, 0.0134711383782364705,  0.0136579634961798840, 0.0698906297153868428, 0.1309471159607265567, 0.0281201853999506271, 0.0282851940496364022,  0.0781842396764870357, 0.1847772952660913237, 0.0513669286489622026, 0.0511865485567550155, 0.0901853413511809893 ))

  expect_equal(c(result_exp$n_iter),
               c(24 ))

  expect_equal(c(result_exp$Q),
               c(0.11112544355142200, 0.04881121798770979, 0.04881121798770979, 0.02253873603135799 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))
})

set.seed(3787)
sims <- test_sim_func_logit(n_series = 5e2, n_vars = 3, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = -.5, re_draw = T, beta_start = 0,
                            intercept_start = -4, sds = c(.1, rep(1, 3)))

test_that("Chaning time scale in EKF does no change results when other parems are changed accoridngly",{
  for(m in c("logit")){
    arg_list <- list(formula = survival::Surv(tstart, tstop, event) ~ . - tstart - tstop - event - id,
                     by = 1,
                     data = sims$res,
                     a_0 = rep(0, ncol(sims$res) + 1 - 4),
                     Q_0 = diag(rep(1e2, ncol(sims$res) + 1 - 4)),
                     Q = diag(rep(1e-3, ncol(sims$res) + 1 - 4)),
                     est_Q_0 = F, method = "EKF",
                     model = m,
                     eps = 1e-2, id = sims$res$id,
                     verbose = F,
                     max_T = 10)

    res <- do.call(ddhazard, arg_list)

    sim_tmp <- sims
    t_mult <- 2.5
    sim_tmp$res$tstart <- sim_tmp$res$tstart * t_mult
    sim_tmp$res$tstop <- sim_tmp$res$tstop * t_mult
    arg_list$data <- sim_tmp$res
    arg_list$by <- t_mult
    arg_list$max_T <- arg_list$max_T * t_mult
    arg_list$Q <- arg_list$Q / t_mult

    res_new_time <- do.call(ddhazard, arg_list)

    expect_equal(res$a_t_d_s, res_new_time$a_t_d_s)
    expect_equal(res$V_t_d_s, res_new_time$V_t_d_s)
    expect_equal(res$Q, res_new_time$Q * t_mult)
  }
})

set.seed(93143)
sims <- test_sim_func_exp(n_series = 1e4, n_vars = 10, t_0 = 0, t_max = 10,
                          x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                          intercept_start = -5, sds = c(.1, rep(1, 10)))
# sum(sims$res$event)

# tmp_file <- file("exponential.log")
# sink(tmp_file)
result_exp = ddhazard(
  formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
  data = sims$res,
  by = (by_ <- 1),
  n_max = 10^4, eps = 10^-2,
  a_0 = rep(0, 11),
  Q_0 = diag(100, 11),
  Q = diag(1e-3, 11),
  est_Q_0 = F,
  max_T = 10,
  id = sims$res$id, order_ = 1,
  verbose = F,
  model = "exponential"
)
# sink()
# close(tmp_file)

# matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
# matplot(result_exp$times, result_exp$a_t_d_s, result_exp$a_t_d_s, type = "l", lty = 2, add = T)

# get_expect_equal(result_exp, eps = 1e-2)

test_that("Result of exponential model on simulated data match previous results", {
  expect_equal(c(result_exp$a_t_d_s),
               c(-4.640389561297818766, -4.640372053416507825, -4.551113396137982825, -4.614504877286796258, -4.591307270088806014, -4.483138845338028311, -4.620248013744454596, -4.769409812869153775, -4.834273514939916971, -4.421253957212337937, -4.522885883652651096, 0.108263284694744916, 0.108389744895007079, -0.574814633565251754, 0.790638588471162529,  0.462696283974146749, 0.741241565039367778, 1.661749335514558501, 1.218517434733938032, 0.520158970649274410,  1.520821079589505631, 1.342313175866733488, -0.980949528489607370, -0.980944356893045377, -1.363269374844132686, -1.943490715777736799, -0.897106419174770298, -0.796387153698268957, -1.112454031732068582, -0.841595091437387421, -0.550537641929842780, -0.642684236399165831, -0.618076024779796618, -0.754327975344539325, -0.754303738579435001, -0.788925133689345692, -0.556983901929427594, 0.415447541736361725, 0.321229692331533478, 1.461498576291594853,  0.484390257810329350, -0.192976331427697267, -0.653709772542990342, -0.382682869407410087, 0.153737748972001542,  0.153874463548286988, -0.445248296153021139, 0.006281426456582077, -0.568742573296753817, -2.274879275977197413, -2.093579816896574020, -2.648931951360375514, -2.805827375201529694, -2.279068217628998028, -2.186682860926254524, -0.410116318122065227, -0.409990302585544752, -1.147923789786657878, 0.438902160360007787, 0.988561865864888478,  1.612681410736467091, 1.853393242463278856, 1.764910384033362423, 1.396812621046922498, 2.527868127243575902,  2.916036469168556078, 0.455520375867613125, 0.455689845522972981, -0.344532684332410299, 0.432732655703431224, -0.851799251063997787, -2.126690196770947061, -1.160798319459742434, -2.030330365308042229, -2.659510525971277684, -1.698163295967877406, -2.300794197869096891, 1.214113285032536904, 1.213871551285567785, 2.785604168593066809,  3.080311089613731124, 3.825255720184083774, 6.857449515458577061, 6.641088090871432925, 7.317830918817845642,  7.225436540557292453, 6.279995092372190335, 6.783466395197530474, 1.055057422250583521, 1.055193563959448522,  1.243012055676435246, 2.274985873990892138, 1.093273651839304916, -2.089065748517700438, -2.179652470022900967, -3.374294928952124906, -3.547051136068212873, -3.417487151573107784, -2.345276089204406222, 1.579988848725427664,  1.579950557568746916, 2.679857154867170799, 3.982261963143182371, 3.298115423921112566, 2.812289501025222904,  2.542177635814500736, 2.202024298464258401, 2.042765941884586489, 1.750224189466000890, 3.033571435466383193,  0.466954852668091946, 0.467008016126768455, 0.478717758372128821, 0.173823843640724673, -0.192360033115987761, -2.241480657006144739, -2.053070240858765771, -2.886749451737085970, -2.926322164920651225, -3.318474092412773135, -3.077775246915434693 )
               , tolerance = 0.01)

  expect_equal(c(result_exp$V_t_d_s),
               c( 5.037724991319692e-02, 5.940427601366993e-02, -5.291003056599425e-03, -9.063455990845007e-03, 1.249973340461447e-02,  5.491670737854584e-02, 5.623169010092594e-02, -3.110608424936980e-02, -3.141162855691559e-02, -4.125226649391327e-02, -3.268090111536442e-02, 5.940427601366992e-02, 4.977580196989635e-01, -8.961550807495403e-02, 2.119191827451179e-01,  1.916033591658273e-01, 4.617803142287881e-01, 4.082377884983802e-01, -1.924840252943666e-01, 1.428528968240958e-01,  2.979233986722480e-02, -4.844718141906481e-02, -5.291003056599429e-03, -8.961550807495409e-02, 1.595153799306672e-01, -2.043873898141822e-02, -9.996552325546620e-02, 1.853687563663696e-02, -1.907904209653145e-01, 6.762649951864841e-02, -2.729146766811159e-01, -1.895871858508682e-01, -1.096111655881972e-01, -9.063455990845010e-03, 2.119191827451180e-01, -2.043873898141822e-02, 4.868646124421190e-01, 5.881785438843330e-02, 1.319715041813860e-01, 1.614437031733219e-01, -2.332367986827955e-03, 1.142962413776523e-01, 3.821513528521254e-02, 1.313103045477927e-01, 1.249973340461448e-02,  1.916033591658273e-01, -9.996552325546616e-02, 5.881785438843331e-02, 5.256356682650107e-01, 7.342950129357957e-02,  5.599883036698777e-01, -8.569474804643297e-01, 8.511643418697986e-01, 1.252470060308764e-01, 4.575053334484472e-01,  5.491670737854582e-02, 4.617803142287882e-01, 1.853687563663695e-02, 1.319715041813860e-01, 7.342950129357960e-02,  6.706406863720105e-01, 1.373354938747869e-01, 6.901936752142135e-02, -1.795113261106668e-02, 1.029860071607401e-01, -2.450977707148013e-01, 5.623169010092594e-02, 4.082377884983801e-01, -1.907904209653145e-01, 1.614437031733219e-01,  5.599883036698775e-01, 1.373354938747869e-01, 8.266633649195398e-01, -9.375426037728204e-01, 7.746926171506625e-01,  7.738348174269097e-03, 4.338511958069286e-01, -3.110608424936979e-02, -1.924840252943666e-01, 6.762649951864837e-02, -2.332367986827951e-03, -8.569474804643298e-01, 6.901936752142133e-02, -9.375426037728203e-01, 1.657670320848680e+00, -1.206757077622760e+00, 1.344237718337666e-01, -7.836000343342930e-01, -3.141162855691559e-02, 1.428528968240959e-01, -2.729146766811159e-01, 1.142962413776523e-01, 8.511643418697988e-01, -1.795113261106668e-02, 7.746926171506627e-01, -1.206757077622761e+00, 1.792855493388345e+00, 6.486028300211715e-01, 9.171750332340729e-01, -4.125226649391327e-02,  2.979233986722481e-02, -1.895871858508681e-01, 3.821513528521254e-02, 1.252470060308764e-01, 1.029860071607401e-01,  7.738348174269085e-03, 1.344237718337666e-01, 6.486028300211715e-01, 6.610158584441024e-01, 1.718599526856268e-01, -3.268090111536445e-02, -4.844718141906480e-02, -1.096111655881972e-01, 1.313103045477927e-01, 4.575053334484472e-01, -2.450977707148013e-01, 4.338511958069287e-01, -7.836000343342930e-01, 9.171750332340729e-01, 1.718599526856268e-01,  6.267144576700332e-01, 5.814886922767859e-03, 1.278875710809074e-04, 3.595151294472170e-03, 1.541718877299982e-03, -2.689642406682910e-04, 1.779108010894104e-03, -1.743188254157771e-04, -3.414626945602248e-03, -4.530961265910606e-03, -6.764271314583584e-03, -1.119582945585606e-03, 1.278875710809046e-04, 2.273733036053278e-02, -6.136086408681962e-03,  6.373345117113757e-03, 2.854665089641980e-03, 1.357256681491777e-02, 1.396920140836710e-02, 3.870079223242943e-04, -3.170902500558724e-03, 7.380055440521548e-04, -6.516603429684226e-03, 3.595151294472169e-03, -6.136086408681989e-03,  1.947487856046592e-02, 3.181042811915851e-03, 2.008554899113915e-03, 8.310153087641851e-03, -1.211195716009794e-02, -6.554840800837046e-03, -1.169098828004470e-03, -8.136884943762147e-03, 4.177230451941901e-04, 1.541718877299982e-03,  6.373345117113756e-03, 3.181042811915852e-03, 4.303372457143983e-02, -1.853363225008427e-03, 1.107472697487585e-03,  1.889318246691415e-03, 5.377087767098656e-03, -5.753669673533377e-04, -2.508532966204688e-03, 1.003805664161531e-02, -2.689642406682864e-04, 2.854665089641999e-03, 2.008554899113916e-03, -1.853363225008411e-03, 1.211068968732757e-02,  4.069837140314822e-03, 4.874946657660093e-03, -1.132866553035736e-02, 9.435885742085277e-03, 2.688664229950049e-04,  2.976818589751610e-03, 1.779108010894104e-03, 1.357256681491778e-02, 8.310153087641846e-03, 1.107472697487581e-03,  4.069837140314855e-03, 3.713125087285209e-02, -2.764375411891405e-03, -1.206825104250899e-03, 2.161655122168470e-03,  3.591714254917366e-03, -9.804123526488512e-03, -1.743188254157749e-04, 1.396920140836708e-02, -1.211195716009796e-02,  1.889318246691419e-03, 4.874946657660118e-03, -2.764375411891401e-03, 2.815220028013984e-02, -7.657017419285144e-03,  5.773987725096564e-04, -5.636090768385677e-03, 1.843846338792769e-03, -3.414626945602244e-03, 3.870079223242760e-04, -6.554840800837058e-03, 5.377087767098666e-03, -1.132866553035737e-02, -1.206825104250914e-03, -7.657017419285128e-03,  3.642721084033806e-02, -7.681702403503304e-03, 1.199514387097462e-02, -6.995256563788331e-03, -4.530961265910604e-03, -3.170902500558733e-03, -1.169098828004493e-03, -5.753669673533397e-04, 9.435885742085245e-03, 2.161655122168474e-03,  5.773987725096434e-04, -7.681702403503344e-03, 3.214498985555894e-02, 1.671445562248123e-02, 1.147971542491042e-02, -6.764271314583584e-03, 7.380055440521635e-04, -8.136884943762140e-03, -2.508532966204687e-03, 2.688664229950367e-04,  3.591714254917373e-03, -5.636090768385695e-03, 1.199514387097463e-02, 1.671445562248123e-02, 3.186796621358874e-02,  1.792860116556474e-04, -1.119582945585606e-03, -6.516603429684209e-03, 4.177230451942048e-04, 1.003805664161533e-02,  2.976818589751646e-03, -9.804123526488536e-03, 1.843846338792789e-03, -6.995256563788272e-03, 1.147971542491046e-02,  1.792860116556132e-04, 1.784372260670167e-02, 4.862999721981046e-03, 2.954998224166399e-04, 2.776149301253444e-03,  9.670274078344712e-04, -2.214550234217077e-04, 1.123558807021110e-03, 2.510846799850176e-04, -2.521892433579765e-03, -3.650097816758118e-03, -5.708967179865194e-03, -1.161409395542431e-03, 2.954998224166420e-04, 2.007626989707722e-02, -4.904829522700370e-03, 5.951918491268809e-03, 2.702656050380235e-03, 1.260065174261469e-02, 1.227319371204059e-02, -2.304356467121467e-05, -2.561732009148385e-03, 2.471941300933750e-04, -5.628336523129317e-03, 2.776149301253448e-03, -4.904829522700365e-03, 1.592644967547297e-02, 2.032625962673383e-03, 1.525958084874254e-03, 7.063974738423457e-03, -9.926602737659674e-03, -5.262147810407454e-03, -1.143200467371295e-03, -6.417840972677679e-03, 6.154056213798634e-05,  9.670274078344709e-04, 5.951918491268797e-03, 2.032625962673385e-03, 3.774897160804989e-02, -1.430828431600389e-03,  1.075553050477618e-03, 2.158452795755838e-03, 5.176175352390769e-03, 5.705865394225023e-04, -1.026583591038896e-03,  9.137987413162268e-03, -2.214550234217015e-04, 2.702656050380248e-03, 1.525958084874236e-03, -1.430828431600365e-03,  1.061183905415565e-02, 3.772604037321478e-03, 4.641402231713725e-03, -1.022823418902954e-02, 8.526138728090117e-03,  3.119227250837069e-04, 2.882922346581758e-03, 1.123558807021106e-03, 1.260065174261467e-02, 7.063974738423448e-03,  1.075553050477612e-03, 3.772604037321494e-03, 3.295040652505182e-02, -2.112247583839343e-03, -7.946386619220223e-04,  1.996031609634758e-03, 3.635738692603410e-03,
                  -9.002897213440268e-03, 2.510846799850165e-04, 1.227319371204055e-02, -9.926602737659700e-03, 2.158452795755846e-03, 4.641402231713763e-03, -2.112247583839329e-03, 2.458164400247491e-02, -7.763890572919431e-03, 5.978352637233736e-04, -5.681414538108203e-03, 1.846703604670964e-03, -2.521892433579758e-03, -2.304356467121581e-05, -5.262147810407470e-03, 5.176175352390785e-03, -1.022823418902949e-02, -7.946386619220440e-04, -7.763890572919426e-03, 3.218212500689353e-02, -6.753530477941408e-03, 1.100886218755620e-02, -6.306309567467880e-03, -3.650097816758122e-03, -2.561732009148411e-03, -1.143200467371308e-03, 5.705865394224970e-04, 8.526138728090148e-03,  1.996031609634769e-03, 5.978352637234017e-04, -6.753530477941426e-03, 2.894954298726972e-02, 1.546451905831419e-02,  1.059782313511441e-02, -5.708967179865195e-03, 2.471941300933774e-04, -6.417840972677646e-03, -1.026583591038893e-03,  3.119227250836879e-04, 3.635738692603412e-03, -5.681414538108195e-03, 1.100886218755621e-02, 1.546451905831416e-02,  2.844526494722725e-02, 6.487565244075618e-04, -1.161409395542430e-03, -5.628336523129298e-03, 6.154056213799827e-05,  9.137987413162279e-03, 2.882922346581800e-03, -9.002897213440294e-03, 1.846703604670976e-03, -6.306309567467826e-03,  1.059782313511439e-02, 6.487565244075794e-04, 1.600313332258339e-02, 4.910594129426276e-03, 1.504675234094800e-03,  2.262608851990879e-03, 5.514959211943223e-04, 1.056171592920545e-03, 2.241225475687301e-03, 2.082446155528887e-03, -5.039676089697034e-03, -2.474229435563841e-03, -5.892845269463150e-03, -6.353419827623765e-04, 1.504675234094804e-03,  1.274781082854452e-02, -3.403213889328403e-03, 3.361469733483990e-03, 1.467578241349795e-03, 7.105486093083360e-03,  7.526191686334567e-03, 3.517404908160124e-04, -1.347931890711802e-03, 5.126900468091438e-04, -3.267551543449520e-03,  2.262608851990879e-03, -3.403213889328405e-03, 1.092296523644802e-02, 1.275323342926643e-03, 9.431786920593359e-04,  4.259977209427469e-03, -6.379252661591564e-03, -3.249354654029291e-03, -3.895722336037494e-04, -3.987814421882963e-03,  2.072792280128748e-04, 5.514959211943218e-04, 3.361469733483978e-03, 1.275323342926642e-03, 2.346924473866723e-02, -1.081587485289138e-03, 5.681686518335240e-04, 8.696384883758838e-04, 3.686986373621488e-03, 3.225253249092174e-04, -3.577955744955102e-04, 5.336636640644604e-03, 1.056171592920545e-03, 1.467578241349806e-03, 9.431786920593311e-04, -1.081587485289124e-03, 7.544675212103056e-03, 2.166691904127487e-03, 2.917425145009188e-03, -6.496348162340709e-03,  5.688270600191008e-03, 3.589705767217128e-04, 1.880006524541638e-03, 2.241225475687300e-03, 7.105486093083371e-03,  4.259977209427468e-03, 5.681686518335209e-04, 2.166691904127483e-03, 2.074822577894260e-02, -1.439933300900533e-03, -3.192862791889023e-04, 1.720274338077846e-03, 2.442851703662817e-03, -5.090056528980497e-03, 2.082446155528883e-03,  7.526191686334580e-03, -6.379252661591561e-03, 8.696384883758697e-04, 2.917425145009208e-03, -1.439933300900530e-03,  1.650350327561003e-02, -5.183615258225613e-03, 5.247363198027401e-04, -3.764894090303909e-03, 1.199329367256455e-03, -5.039676089697033e-03, 3.517404908160216e-04, -3.249354654029303e-03, 3.686986373621514e-03, -6.496348162340715e-03, -3.192862791889086e-04, -5.183615258225632e-03, 2.251281731157628e-02, -4.853211088962418e-03, 7.025220976449916e-03, -4.169079227928592e-03, -2.474229435563843e-03, -1.347931890711824e-03, -3.895722336037649e-04, 3.225253249092232e-04,  5.688270600191019e-03, 1.720274338077856e-03, 5.247363198027533e-04, -4.853211088962419e-03, 1.913381045653352e-02,  9.521655838710003e-03, 6.534070748572738e-03, -5.892845269463150e-03, 5.126900468091422e-04, -3.987814421882950e-03, -3.577955744955259e-04, 3.589705767217064e-04, 2.442851703662817e-03, -3.764894090303904e-03, 7.025220976449920e-03,  9.521655838710022e-03, 1.932475344038717e-02, 2.440901863007640e-04, -6.353419827623737e-04, -3.267551543449484e-03,  2.072792280128803e-04, 5.336636640644615e-03, 1.880006524541658e-03, -5.090056528980521e-03, 1.199329367256419e-03, -4.169079227928573e-03, 6.534070748572731e-03, 2.440901863007789e-04, 1.048142318063047e-02, 5.099427679012110e-03, -9.588051259721935e-04, 2.861628542252854e-03, 2.171214050151711e-04, -3.064092788612355e-05, -4.636039596215771e-04,  3.510413804249370e-04, -4.418740454280634e-03, -3.802567062161870e-03, -7.057409602473635e-03, -1.581034345756472e-04, -9.588051259721884e-04, 9.584512678665540e-03, -2.521180568328686e-03, 2.618968913336463e-03, 1.194365207254490e-03,  4.773446363428892e-03, 5.307377166791460e-03, 1.587599445505123e-04, -8.367475442042809e-04, 5.661192680880268e-04, -2.049443515456972e-03, 2.861628542252854e-03, -2.521180568328685e-03, 9.162802912201094e-03, 1.073288263656947e-03,  6.597181230224164e-04, 3.646322153205781e-03, -4.976232623696990e-03, -2.746384449288957e-03, -7.669544107648701e-04, -3.820395994000421e-03, -4.989730451705145e-05, 2.171214050151696e-04, 2.618968913336459e-03, 1.073288263656943e-03,  1.789005292289314e-02, -6.278874252271483e-04, 2.929611556177743e-04, 7.592801282376858e-04, 2.394666852479801e-03, -8.009360324326688e-05, -7.486364283671115e-04, 3.919275964107484e-03, -3.064092788612556e-05, 1.194365207254503e-03,  6.597181230224339e-04, -6.278874252271516e-04, 6.062429887834293e-03, 1.885138613457804e-03, 1.972124010734430e-03, -4.652785851411665e-03, 4.602229907682660e-03, 7.835725938302594e-04, 1.472198127103202e-03, -4.636039596215771e-04,  4.773446363428900e-03, 3.646322153205784e-03, 2.929611556177698e-04, 1.885138613457813e-03, 1.538843005103011e-02, -1.688938514318604e-03, -7.392007861936056e-04, 1.668369651713217e-03, 1.901796839029367e-03, -3.289494076576754e-03,  3.510413804249319e-04, 5.307377166791448e-03, -4.976232623696988e-03, 7.592801282376758e-04, 1.972124010734424e-03, -1.688938514318580e-03, 1.245724707139643e-02, -3.551261547420395e-03, 1.754388694809501e-04, -2.756403372875865e-03,  1.022165248899517e-03, -4.418740454280636e-03, 1.587599445505138e-04, -2.746384449288957e-03, 2.394666852479806e-03, -4.652785851411616e-03, -7.392007861936235e-04, -3.551261547420414e-03, 1.740580260542826e-02, -3.265241692099663e-03,  5.626209155590861e-03, -2.876559597972630e-03, -3.802567062161869e-03, -8.367475442042963e-04, -7.669544107648990e-04, -8.009360324327004e-05, 4.602229907682636e-03, 1.668369651713233e-03, 1.754388694809593e-04, -3.265241692099680e-03,  1.608247811836922e-02, 8.994355877062984e-03, 5.054714058860316e-03, -7.057409602473638e-03, 5.661192680880462e-04, -3.820395994000411e-03, -7.486364283671128e-04, 7.835725938302908e-04, 1.901796839029371e-03, -2.756403372875876e-03,  5.626209155590883e-03, 8.994355877062970e-03, 1.743848240654595e-02, 5.792735708178618e-04, -1.581034345756467e-04, -2.049443515456961e-03, -4.989730451702512e-05, 3.919275964107479e-03, 1.472198127103209e-03, -3.289494076576767e-03,  1.022165248899499e-03, -2.876559597972599e-03, 5.054714058860295e-03, 5.792735708178532e-04, 7.928923223357632e-03,  5.300769921772752e-03, -4.188147860103828e-04, 1.469346455917063e-03, -1.065689306284764e-03, 1.053147729657509e-03, -1.326373344387619e-03, 2.632622334936536e-03, -6.440756357808232e-03, -2.115833304724582e-03,
                  -6.607796587691549e-03,  5.887766234955687e-04, -4.188147860103775e-04, 1.047076752278903e-02, -2.765974597707382e-03, 2.871519392574036e-03,  1.376733472437275e-03, 5.909787268863368e-03, 6.342552886808785e-03, -6.548856122419775e-05, -8.471764846689895e-04,  3.850562856962970e-04, -2.406826134941769e-03, 1.469346455917062e-03, -2.765974597707370e-03, 9.591301432397224e-03,  1.533907678838599e-03, 6.114993977856579e-04, 4.089295831965854e-03, -5.906570804077405e-03, -3.115588913532527e-03, -1.146191162063513e-03, -4.131735290392302e-03, -7.170716157510155e-05, -1.065689306284764e-03, 2.871519392574027e-03,  1.533907678838597e-03, 1.934067704119115e-02, -6.089252258477515e-04, 5.402145023760419e-04, 6.675568782271382e-04,  2.399883297768923e-03, -9.937735951052447e-05, -1.040978399117418e-03, 4.484258658659411e-03, 1.053147729657509e-03,  1.376733472437300e-03, 6.114993977856437e-04, -6.089252258477441e-04, 5.851399710937250e-03, 2.212276722392393e-03,  2.397821046670272e-03, -5.299810868983585e-03, 4.606559493840223e-03, 4.791602781282165e-04, 1.516557460158071e-03, -1.326373344387619e-03, 5.909787268863381e-03, 4.089295831965865e-03, 5.402145023760372e-04, 2.212276722392401e-03,  1.719244729399478e-02, -1.796104872541907e-03, -9.830150490869691e-04, 1.661405074149940e-03, 2.064914048385216e-03, -4.111603502150082e-03, 2.632622334936533e-03, 6.342552886808767e-03, -5.906570804077415e-03, 6.675568782271454e-04,  2.397821046670319e-03, -1.796104872541899e-03, 1.432871519575855e-02, -4.577980419586333e-03, 4.464219372877738e-04, -3.038261231504917e-03, 1.145964818511432e-03, -6.440756357808229e-03, -6.548856122417807e-05, -3.115588913532534e-03,  2.399883297768940e-03, -5.299810868983590e-03, -9.830150490869908e-04, -4.577980419586347e-03, 1.928431713408561e-02, -3.278904788575720e-03, 6.938420023176930e-03, -3.154908764691077e-03, -2.115833304724581e-03, -8.471764846690001e-04, -1.146191162063521e-03, -9.937735951052498e-05, 4.606559493840207e-03, 1.661405074149939e-03, 4.464219372877780e-04, -3.278904788575758e-03, 1.625573385507326e-02, 9.478114154945951e-03, 5.199565267747253e-03, -6.607796587691553e-03,  3.850562856962869e-04, -4.131735290392293e-03, -1.040978399117414e-03, 4.791602781282567e-04, 2.064914048385214e-03, -3.038261231504908e-03, 6.938420023176958e-03, 9.478114154945944e-03, 1.787691375011198e-02, 4.669294927394218e-04,  5.887766234955704e-04, -2.406826134941742e-03, -7.170716157509969e-05, 4.484258658659411e-03, 1.516557460158083e-03, -4.111603502150087e-03, 1.145964818511439e-03, -3.154908764691026e-03, 5.199565267747252e-03, 4.669294927394296e-04,  8.209378876575624e-03, 3.848253111523919e-03, -5.674132072549475e-04, 6.790589810369386e-04, -3.771374561200133e-04,  1.863747256077726e-03, -1.058456006746898e-03, 2.104507321032842e-03, -6.003502362497063e-03, 1.669500821796962e-03, -2.552738143636620e-03, 1.922292838947011e-03, -5.674132072549436e-04, 4.750355522307841e-03, -1.051753062494545e-03,  8.284980765187453e-04, 2.986071533595526e-04, 1.927944653376162e-03, 1.846604397409543e-03, 5.401003319609034e-04, -5.778940913771734e-04, 3.567247579107714e-04, -1.104028974993460e-03, 6.790589810369377e-04, -1.051753062494539e-03,  4.497884380258806e-03, 4.340870187804416e-04, 4.133988199966213e-04, 1.113475066004903e-03, -1.774194001926876e-03, -1.576318717186206e-03, -1.086725060738523e-04, -1.496172044048077e-03, 2.094774421838672e-04, -3.771374561200132e-04,  8.284980765187398e-04, 4.340870187804429e-04, 7.549161297569685e-03, -3.291267944834636e-04, 3.576867759428673e-05,  1.203355551834995e-04, 1.113440870161414e-03, -1.995363332157950e-04, -2.242273157024032e-04, 1.426546512098636e-03,  1.863747256077719e-03, 2.986071533596013e-04, 4.133988199966136e-04, -3.291267944834730e-04, 3.751220180644092e-03,  3.146793976006522e-04, 1.353913424502174e-03, -3.114620749734084e-03, 1.624288316180529e-03, -7.773017991843062e-04,  8.120121725066051e-04, -1.058456006746901e-03, 1.927944653376161e-03, 1.113475066004912e-03, 3.576867759428510e-05,  3.146793976006521e-04, 7.019539958680165e-03, -8.470429942051910e-04, 5.238971647467364e-04, 2.521133454554815e-04,  9.012045542213057e-04, -1.668018005020860e-03, 2.104507321032841e-03, 1.846604397409547e-03, -1.774194001926869e-03,  1.203355551835017e-04, 1.353913424502199e-03, -8.470429942052054e-04, 6.602376852428522e-03, -2.818238025833820e-03,  6.369838215976087e-04, -1.620126314930494e-03, 8.851021772772849e-04, -6.003502362497066e-03, 5.401003319609503e-04, -1.576318717186218e-03, 1.113440870161403e-03, -3.114620749734116e-03, 5.238971647467239e-04, -2.818238025833851e-03,  1.369729888105147e-02, -2.145412840821521e-03, 4.093565244426353e-03, -2.372562203480915e-03, 1.669500821796961e-03, -5.778940913771887e-04, -1.086725060738464e-04, -1.995363332158031e-04, 1.624288316180492e-03, 2.521133454554877e-04,  6.369838215976036e-04, -2.145412840821513e-03, 6.669438263601843e-03, 1.862974476845662e-03, 2.002339655390990e-03, -2.552738143636619e-03, 3.567247579107744e-04, -1.496172044048078e-03, -2.242273157023988e-04, -7.773017991842541e-04,  9.012045542212991e-04, -1.620126314930491e-03, 4.093565244426366e-03, 1.862974476845654e-03, 7.444175863878849e-03, -7.288137000166084e-04, 1.922292838947009e-03, -1.104028974993449e-03, 2.094774421838564e-04, 1.426546512098647e-03,  8.120121725066051e-04, -1.668018005020863e-03, 8.851021772773002e-04, -2.372562203480936e-03, 2.002339655390991e-03, -7.288137000166198e-04, 4.673246393019161e-03, 4.631784520344478e-03, -1.544335783152403e-03, 1.125955410508980e-03, -1.802050372323756e-03, 2.171157084852233e-03, -1.591392401824901e-03, 1.805714909620196e-03, -7.233520990523055e-03,  2.122240462844058e-03, -3.006931532383286e-03, 2.156292094309363e-03, -1.544335783152401e-03, 6.510396410338468e-03, -1.779807117787679e-03, 1.602082594175983e-03, 3.318828988881664e-04, 3.236652025198099e-03, 2.800806177789234e-03,  1.272174418068258e-03, -8.244912383488136e-04, 1.054526459817751e-03, -1.726026482670940e-03, 1.125955410508978e-03, -1.779807117787680e-03, 5.734592293433333e-03, 4.055607074019463e-04, 5.374526601018376e-04, 1.589398567497555e-03, -2.727020373437713e-03, -2.341458220418712e-03, -2.960829324992886e-04, -2.349568879007981e-03, 3.001213310958165e-04, -1.802050372323756e-03, 1.602082594175985e-03, 4.055607074019404e-04, 1.081069585784220e-02, -8.589927238728823e-04,  4.522167652876658e-04, -3.876937016289791e-05, 2.878901881760217e-03, -4.298415715990644e-04, 4.356937973273253e-04,  1.752455632648736e-03, 2.171157084852241e-03, 3.318828988881847e-04, 5.374526601018102e-04, -8.589927238728695e-04,  4.256853141259131e-03, 6.024087965980239e-04, 1.640610222093649e-03, -4.104863978688736e-03, 2.345424754429393e-03, -7.559203098648069e-04, 1.001626448861846e-03, -1.591392401824903e-03, 3.236652025198104e-03, 1.589398567497558e-03,  4.522167652876640e-04, 6.024087965980306e-04, 9.516089381302686e-03, -1.089490140540237e-03, 8.258255574955270e-04,  1.797870156560923e-04, 1.539296419044168e-03, -2.507302683118834e-03, 1.805714909620192e-03, 2.800806177789245e-03, -2.727020373437707e-03, -3.876937016289691e-05, 1.640610222093669e-03, -1.089490140540241e-03, 8.038939403233086e-03, -3.253862695156048e-03,
                  8.878666322356975e-04, -1.522833853151149e-03, 9.207745352810192e-04, -7.233520990523057e-03,  1.272174418068279e-03, -2.341458220418713e-03, 2.878901881760202e-03, -4.104863978688718e-03, 8.258255574955265e-04, -3.253862695156064e-03, 1.670734612977692e-02, -2.999854680368262e-03, 5.399567005143863e-03, -2.916906465805684e-03,  2.122240462844053e-03, -8.244912383488292e-04, -2.960829324992701e-04, -4.298415715990788e-04, 2.345424754429391e-03,  1.797870156560912e-04, 8.878666322357132e-04, -2.999854680368213e-03, 8.445077778284422e-03, 2.793198513277481e-03,  2.722679360604584e-03, -3.006931532383288e-03, 1.054526459817760e-03, -2.349568879007984e-03, 4.356937973273332e-04, -7.559203098647987e-04, 1.539296419044172e-03, -1.522833853151152e-03, 5.399567005143865e-03, 2.793198513277481e-03,  9.237523441207453e-03, -7.959388369629908e-04, 2.156292094309361e-03, -1.726026482670931e-03, 3.001213310958241e-04,  1.752455632648738e-03, 1.001626448861835e-03, -2.507302683118835e-03, 9.207745352810155e-04, -2.916906465805721e-03,  2.722679360604597e-03, -7.959388369630075e-04, 5.415456731169236e-03, 5.089674872969189e-03, -1.145661274517169e-03,  8.296131299248280e-04, -9.421981551665107e-04, 2.783080928048942e-03, -1.408029317856192e-03, 2.604368895007851e-03, -8.000582823977505e-03, 3.539785936280547e-03, -2.450773787396585e-03, 3.031444361190598e-03, -1.145661274517170e-03,  6.243179684068372e-03, -1.566536801573207e-03, 1.187682898351923e-03, 1.561698151096897e-04, 3.054089237202965e-03,  2.554406530272092e-03, 1.162074441290225e-03, -1.205746000752472e-03, 6.425661923108331e-04, -1.848582509013964e-03,  8.296131299248271e-04, -1.566536801573211e-03, 5.411688100555700e-03, 6.218887389065266e-04, 5.466858354725948e-04,  1.323452463467773e-03, -2.448043370859127e-03, -2.170753674942167e-03, -1.629242859379820e-04, -2.060085368628614e-03,  4.167699056452010e-04, -9.421981551665091e-04, 1.187682898351927e-03, 6.218887389065223e-04, 1.041002407792139e-02, -9.072910370900018e-04, 1.115752062883227e-04, -1.598381995153132e-04, 2.538563288904635e-03, -7.093380857279910e-04, -1.952026824339098e-04, 1.708522994513896e-03, 2.783080928048950e-03, 1.561698151097003e-04, 5.466858354725700e-04, -9.072910370899825e-04, 4.739677677104810e-03, 4.075191646794941e-04, 1.982508664438139e-03, -4.817347723929800e-03,  3.126974903047926e-03, -7.185104264624959e-04, 1.551037056310320e-03, -1.408029317856194e-03, 3.054089237202976e-03,  1.323452463467783e-03, 1.115752062883209e-04, 4.075191646795118e-04, 9.163202074060385e-03, -1.003153947095381e-03,  8.929966953612013e-04, 3.087649547359707e-05, 1.474490014430210e-03, -2.518348957075795e-03, 2.604368895007847e-03,  2.554406530272102e-03, -2.448043370859129e-03, -1.598381995153197e-04, 1.982508664438170e-03, -1.003153947095375e-03,  8.291067785287253e-03, -4.058266292521700e-03, 1.593677038261897e-03, -1.674122776332293e-03, 1.416507651132459e-03, -8.000582823977505e-03, 1.162074441290219e-03, -2.170753674942177e-03, 2.538563288904649e-03, -4.817347723929768e-03,  8.929966953611815e-04, -4.058266292521730e-03, 1.826518284642774e-02, -4.475444994949745e-03, 5.073420388289849e-03, -3.966275582443161e-03, 3.539785936280546e-03, -1.205746000752474e-03, -1.629242859379878e-04, -7.093380857279887e-04,  3.126974903047883e-03, 3.087649547358224e-05, 1.593677038261894e-03, -4.475444994949762e-03, 9.997168379676935e-03,  2.571939548452580e-03, 3.648369519360108e-03, -2.450773787396583e-03, 6.425661923108368e-04, -2.060085368628614e-03, -1.952026824339121e-04, -7.185104264624805e-04, 1.474490014430222e-03, -1.674122776332284e-03, 5.073420388289850e-03,  2.571939548452580e-03, 8.754649000049916e-03, -9.719466438961042e-04, 3.031444361190598e-03, -1.848582509013963e-03,  4.167699056452190e-04, 1.708522994513891e-03, 1.551037056310386e-03, -2.518348957075792e-03, 1.416507651132441e-03, -3.966275582443139e-03, 3.648369519360099e-03, -9.719466438960981e-04, 6.158715619924425e-03, 5.564997860981571e-03, -4.140419789078960e-04, 5.071335430125237e-04, -3.592933694822124e-04, 3.106418434701252e-03, -1.102376000020185e-03,  3.517223746859082e-03, -8.408830726337380e-03, 3.772853593474135e-03, -2.582832014229145e-03, 3.193306762972852e-03, -4.140419789078962e-04, 6.635594395750974e-03, -1.683832185863866e-03, 1.099538145298597e-03, 4.280333000946057e-04,  2.858250258006684e-03, 3.199860234395935e-03, 5.469789584631698e-04, -1.016772181118255e-03, 3.941754815423999e-04, -1.745279055413438e-03, 5.071335430125232e-04, -1.683832185863864e-03, 6.150489149083347e-03, 9.248433580630336e-04,  5.151129316343259e-04, 1.829449443740067e-03, -3.062376651363646e-03, -1.993173455294659e-03, -3.077209735217069e-04, -2.107768511744521e-03, 2.682404089961338e-04, -3.592933694822133e-04, 1.099538145298592e-03, 9.248433580630367e-04,  1.146399912753657e-02, -7.406074517663541e-04, 1.261068615721003e-04, -2.835133787384574e-04, 2.043357881466779e-03, -5.460081322011280e-04, -4.444316805344915e-04, 2.192249216943612e-03, 3.106418434701258e-03, 4.280333000945853e-04,  5.151129316343121e-04, -7.406074517663545e-04, 5.226471032505379e-03, 4.676481138271678e-04, 2.332618389070448e-03, -5.046814623975909e-03, 3.248574715260289e-03, -8.469768097297619e-04, 1.570767290613620e-03, -1.102376000020185e-03,  2.858250258006683e-03, 1.829449443740067e-03, 1.261068615720993e-04, 4.676481138271688e-04, 9.638788700136200e-03, -1.129009881423326e-03, 4.870829583312828e-04, 1.674426122250550e-04, 1.262446597272002e-03, -2.437526053825961e-03,  3.517223746859085e-03, 3.199860234395936e-03, -3.062376651363662e-03, -2.835133787384571e-04, 2.332618389070454e-03, -1.129009881423329e-03, 9.834127047925120e-03, -4.581061089483598e-03, 1.736238313038003e-03, -2.094728586292834e-03,  1.477318054063622e-03, -8.408830726337376e-03, 5.469789584631781e-04, -1.993173455294662e-03, 2.043357881466771e-03, -5.046814623975875e-03, 4.870829583312777e-04, -4.581061089483591e-03, 1.917052931789039e-02, -4.282596146666534e-03,  5.422872057800008e-03, -3.863020659486295e-03, 3.772853593474137e-03, -1.016772181118250e-03, -3.077209735216990e-04, -5.460081322011230e-04, 3.248574715260307e-03, 1.674426122250561e-04, 1.736238313038005e-03, -4.282596146666530e-03,  1.063705588883030e-02, 2.867698987973010e-03, 3.823896547827541e-03, -2.582832014229144e-03, 3.941754815423945e-04, -2.107768511744525e-03, -4.444316805344927e-04, -8.469768097297801e-04, 1.262446597272003e-03, -2.094728586292829e-03,  5.422872057799986e-03, 2.867698987972992e-03, 9.631314803077513e-03, -8.935792685962716e-04, 3.193306762972853e-03, -1.745279055413430e-03, 2.682404089961306e-04, 2.192249216943613e-03, 1.570767290613643e-03, -2.437526053825973e-03,  1.477318054063622e-03, -3.863020659486303e-03, 3.823896547827542e-03, -8.935792685962726e-04, 6.699601727256406e-03,  5.444851309937607e-03, -1.821821108813290e-03, 8.036911927819444e-04, 5.796599097079328e-04, 2.727524743280360e-03, -2.724755607867933e-03, 2.385425731222565e-03, -7.841410985476537e-03, 4.047614086398482e-03, -2.325879583433907e-03,  4.100372129718724e-03, -1.821821108813290e-03, 6.959641811443523e-03, -1.581669078724901e-03, 9.684226977699378e-04,  3.543609718831628e-05, 3.215975396387318e-03, 2.228372961366616e-03,
                  1.605569697627258e-03, -1.609759095219518e-03,  9.790496144863234e-04, -2.419048523632895e-03, 8.036911927819444e-04, -1.581669078724901e-03, 6.474490023840883e-03,  9.777191518697292e-04, 7.808637923227659e-04, 1.717265419606736e-03, -2.662595129004575e-03, -2.093292421710035e-03,  7.450951953918267e-05, -2.191985266806290e-03, 4.832263703268173e-04, 5.796599097079328e-04, 9.684226977699378e-04,  9.777191518697292e-04, 1.147908285480040e-02, -4.429471379880555e-04, -1.682963818247275e-04, 3.197935217235220e-04,  7.747739972951957e-04, 7.907480031609914e-05, -7.514960628171004e-04, 2.610862619893982e-03, 2.727524743280360e-03,  3.543609718831628e-05, 7.808637923227659e-04, -4.429471379880555e-04, 5.679445713580838e-03, -1.536681503777174e-04,  1.848876909100473e-03, -4.742351077181858e-03, 3.251499536353431e-03, -7.532914149336476e-04, 1.673124128774368e-03, -2.724755607867933e-03, 3.215975396387318e-03, 1.717265419606736e-03, -1.682963818247275e-04, -1.536681503777174e-04,  1.102937178224606e-02, -1.703279345352742e-03, 1.849576146092165e-03, -6.493378339272007e-04, 1.546324245725126e-03, -3.202578099618184e-03, 2.385425731222565e-03, 2.228372961366616e-03, -2.662595129004575e-03, 3.197935217235220e-04,  1.848876909100473e-03, -1.703279345352742e-03, 8.780566016416925e-03, -3.274834476837200e-03, 1.560348297102264e-03, -1.578088592871745e-03, 1.573068080340290e-03, -7.841410985476537e-03, 1.605569697627258e-03, -2.093292421710035e-03,  7.747739972951957e-04, -4.742351077181858e-03, 1.849576146092165e-03, -3.274834476837200e-03, 1.892271397781092e-02, -4.637280453621119e-03, 4.352071081880097e-03, -4.511262385527150e-03, 4.047614086398482e-03, -1.609759095219518e-03,  7.450951953918267e-05, 7.907480031609914e-05, 3.251499536353431e-03, -6.493378339272007e-04, 1.560348297102264e-03, -4.637280453621119e-03, 1.124034496169516e-02, 2.388029811900747e-03, 4.472511521519591e-03, -2.325879583433907e-03,  9.790496144863234e-04, -2.191985266806290e-03, -7.514960628171004e-04, -7.532914149336476e-04, 1.546324245725126e-03, -1.578088592871745e-03, 4.352071081880097e-03, 2.388029811900747e-03, 9.396687009879919e-03, -1.137724978390472e-03,  4.100372129718724e-03, -2.419048523632895e-03, 4.832263703268173e-04, 2.610862619893982e-03, 1.673124128774368e-03, -3.202578099618184e-03, 1.573068080340290e-03, -4.511262385527150e-03, 4.472511521519591e-03, -1.137724978390472e-03,  7.975398744662725e-03 )
               , tolerance = 0.01)

  expect_equal(c(result_exp$lag_one_cor),
               c( 5.807024095069653e-03, 9.645838550031971e-05, 3.596595703256154e-03, 1.544320531397351e-03, -2.765715046664832e-04,  1.750805184738496e-03, -2.017678592824959e-04, -3.396983091972591e-03, -4.513939617471900e-03, -6.742527558418491e-03, -1.103456613849652e-03, 1.184019553391270e-04, 2.249190589158413e-02, -6.100999654078973e-03, 6.263478414901712e-03,  2.751865995229300e-03, 1.333761039321346e-02, 1.376774207198290e-02, 5.028289394252622e-04, -3.244592647957645e-03,  7.320321407275772e-04, -6.497018280120716e-03, 3.567021228972067e-03, -6.095211952248883e-03, 1.941043149108965e-02,  3.194537305714458e-03, 2.066170558870793e-03, 8.308177768082209e-03, -1.202822357801012e-02, -6.603351468853004e-03, -1.024059463664305e-03, -8.041586579673137e-03, 4.777042826113201e-04, 1.543246660206399e-03, 6.266267381666510e-03,  3.195409636796077e-03, 4.281691534978076e-02, -1.886476101487822e-03, 1.037937286197188e-03, 1.803799003530114e-03,  5.386427111341006e-03, -6.348273809105550e-04, -2.528914231346067e-03, 9.979469861627909e-03, -2.432684470200910e-04,  2.758552289813796e-03, 2.051487204873923e-03, -1.882398912132263e-03, 1.182703797362934e-02, 4.032120127235239e-03,  4.584456997714327e-03, -1.084736561032351e-02, 8.979355310222056e-03, 2.090161819218692e-04, 2.727495492620248e-03,  1.767783730432500e-03, 1.333812188908085e-02, 8.305957057031866e-03, 1.035212808851290e-03, 4.034947292710236e-03,  3.680730733490091e-02, -2.838084252661064e-03, -1.242424322934727e-03, 2.180379206336909e-03, 3.544711955143426e-03, -9.680883419464471e-03, -1.646749432370753e-04, 1.376793965546892e-02, -1.203870389699047e-02, 1.805331855472300e-03,  4.566924415245016e-03, -2.844516717406584e-03, 2.774127727331455e-02, -7.123806420499396e-03, 1.587345706165260e-04, -5.630106475754625e-03, 1.606114762194672e-03, -3.419851324093986e-03, 4.847430126498787e-04, -6.575918639119091e-03,  5.378836627992280e-03, -1.085987088074102e-02, -1.238681288451515e-03, -7.163227181879356e-03, 3.551343691608317e-02, -7.025217933802052e-03, 1.191611412848010e-02, -6.568584832938036e-03, -4.425784946935027e-03, -3.242739596078620e-03, -1.041631613330561e-03, -6.243487538230131e-04, 8.969237350269036e-03, 2.171818404915646e-03, 1.788693255842953e-04, -6.992440550799080e-03, 3.119373569324597e-02, 1.638061142700434e-02, 1.098796202150181e-02, -6.680432412007968e-03,  7.248896253297139e-04, -8.042982711193199e-03, -2.525053751519286e-03, 1.998856164546858e-04, 3.543396503345969e-03, -5.632030589246841e-03, 1.193656382207038e-02, 1.637897077271988e-02, 3.152704778911435e-02, 8.740820614535673e-05, -1.076452046461417e-03, -6.492735797402054e-03, 4.677618364073930e-04, 9.985507866537487e-03, 2.723558834539400e-03, -9.684558837821381e-03, 1.617265133719271e-03, -6.553227557771314e-03, 1.098615921678763e-02, 8.900320379662816e-05,  1.751676322818620e-02, 9.379427577325624e-04, -4.768975001435862e-04, 1.106813009600792e-03, 8.685191964797707e-04, -7.943240129380791e-05, 1.933130417732923e-04, -8.073318019446577e-04, -7.297565398163905e-04, -4.285759354471799e-04, -9.645068710815742e-04, 9.453788527955290e-05, -3.946027286408054e-04, 3.350969845766178e-03, -7.915478999511237e-04, -5.369158850782683e-04, 6.559940388626336e-05, -1.177821890503781e-03, 1.167786389821759e-04, 1.268715535891540e-04, -1.945841829048315e-04, 7.727306453295251e-04, -3.253290354184595e-04, 1.277834604007554e-03, -7.655732995876367e-04,  5.592508188620556e-03, 8.863264961410113e-04, 6.998942784245106e-04, 9.114661869302296e-04, -1.333837717515688e-03, -2.196390155758893e-04, 5.656413362361834e-04, -8.880110109573060e-04, 2.965335641764025e-04, 8.410524994968216e-04, -5.448300058957167e-04, 8.497978756955144e-04, 4.906938032748116e-03, -1.938416111318251e-04, -3.253843263893205e-04, -9.760236768676727e-04, -5.600481238005645e-04, -3.807018587349525e-04, -4.136395629538409e-04, 3.544491041329060e-04, -2.141702582099804e-05, 8.116904770310109e-05, 6.865647713171645e-04, -2.089166818660846e-04, 4.055393453146670e-03, -2.652913154982104e-04, -4.527246165530775e-04, 9.115196249088039e-04, -2.819377851658008e-04, -5.869019712154467e-05, -6.831439630837403e-04, 1.105396100360810e-04, -1.202043825689483e-03, 8.976563486899776e-04, -2.670806420446430e-04, -2.947776159155132e-04, 3.929152012766168e-03, -9.614732737163193e-04, -4.270439751936848e-04, 4.632925202789259e-04, -5.788484715940011e-04, 7.197848178676549e-04, -7.364971727155370e-04, 1.022922360517983e-04, -1.322693572419925e-03, -9.903773768619739e-04, -4.726356837741314e-04, -9.015919106384636e-04, 4.434022222196627e-03, 1.826154561563676e-03, -3.157565639104832e-04, -1.449419373231913e-05, -2.574095856039326e-04, -6.091037921914612e-04, 2.093716661297551e-04, -3.579811106644432e-04, -6.206037878497138e-04, 9.207977759456542e-04, -3.663483053437500e-04, 1.968437851690829e-03,  4.021632157391531e-03, 1.186724749981992e-03, -1.112383030011332e-03, 7.477654690873194e-04, -2.788561116024850e-04, -1.100953182662000e-04, 4.307123958418612e-04, -5.057908727406310e-04, -3.678571420462230e-04, 5.429783863996302e-04, -1.918131549067081e-04, 1.231272388041124e-03, 2.846161183170092e-03, -8.758036965463498e-04, -5.826265616306068e-04, -1.159489693774610e-03, 7.699513404219463e-04, -9.985461387231396e-04, -5.559709436771153e-04, -1.095385468806320e-04, -5.263931992068205e-04, -3.099350092944288e-05, -1.068418553127996e-03, -8.174167563003267e-04, 4.895462201088885e-03, -8.140869359693104e-04, -4.355429742884513e-05, -3.609273968519146e-04, 3.586028352477530e-04, 3.846321404531103e-04, -6.615961541590577e-04, 6.513103926969362e-04, -2.524985674872216e-04, 6.792264472051906e-04, -4.956039907393229e-04, -8.652619983596713e-04, 3.759876789904609e-03, 7.509093958208098e-04, 1.455357209961285e-05, 7.890856055258058e-04,  4.374902234165789e-04, 1.641544966903276e-04, 2.078583915603189e-04, -9.983984072630929e-05, -7.960043061470676e-04, -8.475366886510834e-05, -9.514215176210808e-04, -9.089129525083231e-05, -3.062911650309735e-04, 2.358463228275866e-03, -3.272915954515866e-04, -3.760178774883242e-04, -6.378966046331563e-05, -1.119184087282931e-03, -4.018227474480674e-04,  2.743598496556429e-04, 1.569204649455103e-05, 5.764602115076440e-04, -7.371228296030024e-05, 7.794907328988800e-04, -1.178321587728096e-04, 3.814587241510004e-03, 3.308832006618151e-04, 5.604510295609110e-04, 4.666554976916204e-04, -1.644201903385567e-04, -2.519095130266804e-04, 4.061632004948732e-04, -4.921531388834446e-04, 2.058490694176587e-04,  6.011016464419500e-04, -2.714930876243525e-04, 3.779862083717638e-04, 2.770557323177691e-03, 6.120014794477126e-05, -4.322356744747694e-05, -3.814048619646659e-04, -8.603574689356713e-04, -2.189601770462212e-04, -3.200359873135631e-04, -4.110615692111928e-05, -6.827024136159073e-05, -7.398371884008220e-06, 3.394744231242875e-04, -7.201784325055625e-05,  3.204670834770126e-03, -3.293558068849585e-04, -3.844730125719515e-04, 1.029720852631278e-03, -3.118147648645425e-04,  9.012007920113183e-05, -4.546556997598386e-04, 1.722570786851335e-04, -9.564270000064191e-04, 3.053204747337094e-04, -2.178841426035984e-04, -3.019404259068091e-04, 2.530433570655328e-03, -3.895009259002130e-04, -1.216906024883879e-04,  2.413798105500200e-04, -4.408223903196334e-04,
                  5.871035255084239e-04, -6.024843156867766e-04, -4.177004951585617e-04, -4.311584175029177e-04, -5.258808076845937e-04, -4.846318792619587e-04, -5.362383221181686e-04, 2.699608893100080e-03,  1.724026745012281e-03, -1.184973670360069e-04, 1.747900063860321e-04, -1.912334528836184e-04, -6.176855743731535e-04, -3.542367566395197e-05, 8.940414533090179e-05, -3.374793646109936e-04, 6.570704478364702e-04, -2.244268033607160e-04,  1.034635255192499e-03, 3.283461481291085e-03, 8.238586299918269e-04, -8.867015147313692e-04, 4.881316210310488e-04, -3.262601500079304e-04, -1.336593303501805e-04, 3.711611463469894e-04, -1.336360516123429e-04, -4.315842700002214e-04,  1.414192345287018e-04, -2.867859962104099e-04, 1.146365365304405e-03, 2.028477406780429e-03, -8.164181276038920e-04, -4.969115150514052e-04, -8.514742469845728e-04, 2.325687345751407e-04, -4.036272717785842e-04, -1.365681782310501e-04, -1.670819368865276e-04, -6.388083195712508e-04, -3.046123006636215e-04, -7.655496391414324e-04, -8.004973450060453e-04,  3.860632951288002e-03, -5.158335883511933e-04, 3.283640884094418e-05, 1.579604535566085e-05, 1.541694595390551e-04, -6.073962897394864e-05, -4.589935150636832e-04, 7.517610797722102e-04, -9.073328026752226e-05, 5.668947868335576e-04, -6.382236743325033e-04, -6.211769271050233e-04, 2.853993929618147e-03, 8.098711626428623e-04, -2.871029479127342e-04,  6.141845401145190e-04, 2.688177063292789e-04, -2.275939653092117e-05, -5.107513529575239e-05, -2.886056166964595e-04, -8.196944922318390e-04, -4.339074370249075e-04, -1.058309674810034e-03, 2.776117762438456e-05, -5.833109249915145e-05,  1.783075492558759e-03, 1.024978878797255e-04, -1.979633763888137e-04, -2.600361320431992e-05, -7.908598251659808e-04, -5.871858408022313e-04, -8.743064546157452e-05, -3.054120728032336e-06, 1.189469667521763e-04, 1.675415676986333e-04,  6.280818936719156e-04, -1.681321460365339e-04, 2.859687910529480e-03, 8.054639990663610e-05, 1.596365642547297e-04, -8.641672478645239e-05, 1.779126046409633e-05, 5.362173701503928e-05, 5.509877647610774e-05, -4.344191017359631e-04,  7.681761184562529e-05, 4.473989458317539e-04, -3.829719708085474e-04, 1.870743189685902e-04, 1.430284715676945e-03,  2.673319188658074e-05, -2.246984393755274e-04, -2.637358210610733e-04, -6.219619794791486e-04, -2.054100342934787e-04, -3.177959476187862e-04, -2.806952370039209e-04, 9.718848495934954e-05, -8.366186162863320e-05, 3.110699009026563e-04,  1.848787196896786e-04, 2.541584809315462e-03, -3.243225894214142e-04, -3.691540043948310e-04, 7.239108739006150e-04, -4.485229373498237e-04, -1.187439332424055e-04, -3.026465004718069e-04, 3.033122679984976e-04, -9.276340222719574e-04,  9.962984703877674e-05, -1.315819327857735e-04, -2.895016770533269e-04, 1.559784435717368e-03, -1.203513659253994e-04, -2.236239933399980e-04, -9.636037583223088e-05, -6.995632581423176e-04, 6.365724485559783e-04, -1.884269328330220e-04, -5.314888258765057e-04, 1.610377305247890e-04, -2.426880329820071e-04, -3.278684252130732e-04, -1.002293112241638e-04,  1.779270536136505e-03, 9.127816505698647e-04, -1.169121806578289e-04, 1.014244131431570e-05, -1.011918974246300e-04, -1.017032802337001e-03, 2.411246909489481e-04, -1.190846323012206e-04, -4.902543269005064e-04, 7.586251902277328e-04,  1.643327160821753e-04, 9.821648266920505e-04, 3.085057296153334e-03, 1.000763962023848e-03, -2.001102994527392e-04,  3.850081573789905e-04, -2.193080805455908e-04, 7.797235958837545e-05, 2.740259415071111e-04, -5.783337480415061e-05, -3.400586405541827e-04, 8.456349128327227e-05, -8.044628543045634e-05, 7.334451633965648e-04, 1.541603044819526e-03, -7.419747530254704e-04, -5.671006976235491e-04, -1.013409987695476e-03, 4.515668146769888e-04, -4.005319523466997e-04, -5.893308234496950e-05, 7.265229908349268e-05, -2.418846639098689e-04, 9.111256629958022e-05, -4.591334948606523e-04, -3.918301250740211e-04, 3.573006056568081e-03, -3.889270998654334e-04, 5.343887824482148e-05, 1.483434916429618e-04,  1.095098453969460e-04, -3.494253579632710e-04, -3.454115778148294e-04, 6.440676097030939e-04, -9.425639045443346e-05,  4.635846609208913e-04, -5.960691565557773e-04, -4.040267393315454e-04, 2.113868371067409e-03, 8.761500389149808e-04, -3.078232600850853e-04, 4.964865680420428e-04, 1.324080061221532e-04, 1.159895855875149e-04, -2.266367458050744e-04, -3.034612358535413e-05, -1.216624270556356e-03, -2.135149378751771e-04, -1.161923502367393e-03, 2.083106251955664e-04, -3.380145753385771e-04, 1.615550969007365e-03, -7.731793023432472e-05, -2.043271204260901e-04, -1.150052871905668e-04, -5.624622148956671e-04, -5.537465626057473e-04, 3.415145386957975e-04, 7.227057056328215e-05, 4.333980030890145e-04,  1.043875144694346e-04, 5.278668824670014e-04, -8.451633156234320e-05, 2.368658484961471e-03, 1.203785199311907e-05,  1.767135096979205e-04, -2.716444630615029e-04, 2.024509289506459e-04, -2.134100484281298e-04, 1.140017173089680e-04, -4.896249586060663e-04, 1.841402659393542e-04, 2.563127097036582e-04, -2.687889086155461e-04, 9.150966843829287e-05,  1.113974373799797e-03, 1.929226835704265e-04, -2.372594045367340e-04, -1.515989005027450e-04, -6.202252891905156e-04, -5.524243697812594e-05, -2.145307219526394e-04, -2.393613421662956e-04, -9.210244977077858e-05, -9.391597516107079e-05,  9.046927824717403e-05, 8.955825539130603e-05, 2.094950094925713e-03, -2.745468874039597e-04, -3.247899987190766e-04,  7.510697197133701e-04, -3.211166977338840e-04, 6.947078461886405e-05, -2.267099430795503e-04, -1.605355463415901e-04, -5.956858245600482e-04, -5.617176422792317e-05, -1.481183206719710e-04, -2.319758977095232e-04, 1.399186446874092e-03, -1.246429745569859e-04, 1.921636525949897e-04, 5.818863079348966e-05, -1.220773633298864e-04, 4.759491416707771e-04, -2.644591309370794e-04, -4.086399512287441e-04, -6.346947247986689e-05, -1.680292256563491e-04, -3.527444530820006e-04, -1.974363177565649e-05, 1.528207810406210e-03, 1.030155362377758e-03, -6.685727801445969e-05, 2.897594428953176e-04, -1.659975078225589e-04, -9.682378744070314e-04, 1.695815220401231e-04, -2.461244770393678e-05, -2.769334937850833e-04,  4.703508842393948e-04, 1.803378332465619e-04, 5.733405286242314e-04, 3.197777321777687e-03, 5.253133518409489e-04,  1.388844063164672e-05, 1.827843109744655e-04, -5.285264309988305e-04, 1.864456195348478e-04, 8.222231685604098e-05, -1.677530374232840e-05, -4.578797899635317e-04, 2.574597046096857e-04, -2.539922850261258e-04, 1.119353330351434e-03,  1.236541448413261e-03, -1.599098051360043e-04, -6.922127760021067e-04, -1.099771083779660e-03, 3.753788996021001e-04, -2.923104318953744e-04, 6.080036329077776e-06, -7.348623640537300e-05, 4.482595011966715e-06, -3.321789134825919e-05,  9.702201927505464e-05, -4.646584086514664e-04, 3.365257133613832e-03, -4.347704677177303e-04, 2.254429239904968e-05,  1.522213164504315e-04, 3.811857696483942e-05, -2.773916033076546e-04, -2.320275783235540e-04, 4.363982986609700e-04, -8.453889611980818e-05, 3.660224769373510e-04, -4.993749215491188e-04, -3.002410641936207e-04, 1.806128563389510e-03,  6.774305762294767e-04, -1.757709055530974e-04, 1.209408928436392e-04, 4.547559914721666e-05, 2.428472734340176e-04, -2.112422528963071e-04, 1.667576619564642e-04, -1.203215393477584e-03, 3.294157645361625e-04,
                  -4.435308081154360e-04,  3.059198227598010e-04, -2.017657444454275e-04, 1.247066121226890e-03, 1.148896115977589e-04, -2.352066185852266e-04, -2.121968621426205e-04, -4.858965146275882e-04, -6.165842615026196e-04, 2.499499742879570e-04, -2.060008762103305e-05,  1.506668575316057e-04, 1.064366749668286e-04, 2.490526520534593e-04, 9.290678689644581e-05, 1.524641949294836e-03, -6.494092789592208e-05, 8.261176833126557e-05, -3.768106294907841e-04, 4.168287774381708e-04, 3.343681112755778e-05,  2.949614702716584e-04, 6.998873212753031e-05, 1.511196606570442e-04, 1.124692796277779e-04, -1.932194486184532e-04, -4.767813206981849e-05, 5.434045972266235e-04, 1.496263348617066e-04, -1.009670493891427e-04, -5.277304267092290e-05, -4.287063694393319e-04, 4.061982804565886e-05, -1.057893381132127e-05, -3.273165690321288e-04, 9.093658153703384e-05, -8.813973880910454e-05, -2.097976618238763e-05, 1.151578854259762e-04, 1.821667038571684e-03, -3.031255486663789e-04, -1.076557693968967e-04, 3.728933991083371e-04, -3.595947701254286e-04, -9.253915797874610e-05, -1.079759520080496e-04, -2.658161220560567e-04, -4.885462922008707e-04, -2.995953215186463e-04, -6.404167018723772e-05, -3.782792388253152e-04,  9.582387265798866e-04, -5.131417635296574e-05, 4.352917807808318e-04, -1.121660655051424e-04, -8.074801499863889e-05,  2.791189887178000e-04, -6.476177224969704e-05, -5.384851093465258e-04, 3.124282183953415e-04, -3.299845689081008e-05, -2.552526167522550e-04, 4.868616036194642e-05, 1.128282286123672e-03, 5.422712286963516e-04, -8.763368243230410e-05,  1.589937442054959e-04, -6.504359404316287e-05, -1.241583994781784e-03, 1.946814972706610e-04, 1.053391036010277e-04, -2.619350312595569e-04, 1.140510383411179e-04, 3.129689268072631e-04, 1.815447722466461e-04, 3.704368872518691e-03, -4.154211504684273e-05, -1.355962537371073e-04, -1.571702742474533e-04, -2.542027857256615e-04, 1.083172340156813e-04,  6.886020345259334e-05, -4.009876501861774e-06, -4.478244066444252e-04, 5.819176837714234e-05, -1.763928299153802e-04,  7.348324994466953e-04, 7.856175592911815e-04, -4.052119663725909e-04, -6.121044058734965e-04, -5.800375720003029e-04,  1.651942275773665e-04, 1.627582018649865e-04, 4.954028914255052e-05, -2.504438392957372e-04, -5.758896831993893e-05, -1.197414740470643e-05, 5.165368668821717e-06, -1.181674467122577e-03, 1.765779516611702e-03, -4.743785491725581e-04,  1.051452639212924e-04, 1.460433857569825e-04, 2.978104172564825e-06, -2.890798359173346e-04, -9.992147310370917e-05,  3.026191707810249e-04, -4.947670669787135e-05, 1.933452686005698e-04, -3.721056314286354e-04, -1.110289589470951e-04,  1.636452694316497e-03, 6.785719231556546e-04, -2.643373363586937e-04, 1.497760762099548e-04, -8.724614210695034e-05,  2.517507427459028e-04, -2.752186107117396e-04, 1.179508986530125e-06, -1.368080195231672e-03, 2.397526091209454e-04, -2.520705409397955e-04, 2.613404792106133e-04, -1.494409272328428e-04, 1.147776551042729e-03, 1.030009403131301e-04, -2.223215472195415e-04, -1.230326236928668e-04, -4.347019481296004e-04, -5.145089803923224e-04, 1.854303002194953e-04,  2.585918944202444e-05, 6.878716380309137e-05, 1.203506051917163e-04, 1.309794493366188e-04, 1.039005336102686e-04,  1.279879290909334e-03, -9.868823860654744e-05, -4.055631845794022e-05, -3.876890638658866e-04, 4.105361970509181e-04,  1.045510920919099e-04, 1.106596846511025e-04, 1.917663966933740e-04, 5.380010206093942e-05, 5.859107095818097e-05, -2.215046852857942e-04, -8.398442224779648e-05, 3.630258108670716e-04, 1.296172341269634e-04, -4.311187994715836e-05,  5.054346750397661e-06, -2.977415342923706e-04, 2.143691056013906e-05, 4.881286409988010e-05, -3.022697698561579e-04,  2.516775939077715e-04, -2.093847006955889e-04, -9.947064590422900e-06, 1.885787381833619e-05, 1.753717580759598e-03, -3.226037080687258e-04, -1.513235789821715e-04, 4.287282423253683e-05, -2.163664704809593e-04, -1.193259020567062e-04, -2.094287332175219e-05, -2.421149189684446e-04, -4.234357377351713e-04, -3.770142108151597e-04, 1.543289775246537e-05, -3.498873934670829e-04, 7.701983860736711e-04, 3.311601616084465e-05, 4.460467202153587e-04, -1.330858009096308e-04, -9.333527905999573e-05, 2.217479614086582e-04, 9.241194686731117e-05, -6.380864654044292e-04, 4.700527405658667e-04,  2.531302003699141e-05, -7.607485262926673e-05, 1.174272207381908e-05, 9.103603775892443e-04, 1.809126672089595e-04, -4.739245894658174e-05, 1.062056372759526e-04, -2.957428782748300e-06, -1.379586950123019e-03, 3.555118640931861e-04,  9.596279810327233e-05, -5.869020386190167e-05, 1.652478866412095e-05, 4.539670747235592e-04, 2.782827969661511e-04,  4.031810581570564e-03, -6.800471095873479e-05, -2.116427163677945e-04, -1.205805953069971e-04, 2.365238028285656e-04, -5.966127045827582e-05, 1.457587952275336e-04, -5.155439004452577e-05, -2.836063148046491e-04, -1.992701447725780e-04, -7.951775970178229e-05, -4.255710775011027e-05, 9.981620725327410e-04, -7.970939848824088e-04, -2.695295241548656e-04, -2.595810136533473e-04, 1.927924137408575e-04, 2.204919414756070e-04, 1.356155946651878e-04, -1.692920735119474e-04, -8.329770820319894e-06, 2.100918374344470e-04, -1.887862851201118e-04, -7.800927992874179e-04, 1.144918938626769e-03, -1.835308801431784e-04, 2.648702915568085e-04, 7.099905487436805e-05, 8.156845819709178e-05, -4.517768633191705e-04, -1.974518384142405e-05, 2.414960082405133e-04, -8.915685560594304e-05, -1.420912447093809e-04, -3.276546191488459e-04, -1.883675774495391e-04, 1.562241365880353e-03, 8.826311621030715e-04, -2.685197697533823e-04, 1.842162823886851e-04, -1.381166294630135e-05, 3.909424711838957e-04, -3.014583549992049e-04, 1.309428017476775e-04, -1.708507264840157e-03,  5.190526599800193e-04, -2.575709379414788e-04, 4.403950235539675e-04, -3.643586613403711e-04, 1.267032960398703e-03,  6.474132443006141e-05, -2.352778727971364e-04, -2.768616635960538e-04, -3.888692875532005e-04, -6.160609515708764e-04,  4.593381465970066e-04, -2.685484956422959e-04, 1.315068676648912e-04, -5.031316449568198e-05, 2.343582699261231e-04,  4.085056549288669e-05, 1.350422720136350e-03, -7.449070080498736e-05, 6.427862727229572e-05, -4.134661277161500e-04,  5.022008461889831e-04, -5.824991821307513e-05, 2.672461930636357e-04, 1.541860570435693e-04, 1.878149932091098e-04, -1.497301323430666e-04, -2.064603614904497e-04, -9.978169963104999e-05, 4.709381085391920e-04, -3.645676562463744e-05,  2.108408938811156e-05, -2.386276616678804e-05, 6.402071864764585e-05, -1.302307901360353e-04, 1.546990108355358e-04, -4.934078466706410e-04, 3.287264445701824e-04, -2.285657264377173e-04, 3.520409107006525e-06, 7.201596073605604e-05,  1.861883656088916e-03, -3.815078399934432e-04, -1.364196842819502e-04, -5.808435993356426e-05, -8.676684353543114e-05, -7.232611545697829e-05, 6.494601710973198e-05, -3.407027547137836e-04, -3.921257307529160e-04, -3.875361703723309e-04, -2.532008692616669e-05, -3.710915803036087e-04, 8.592820018086881e-04, -2.256426598137120e-05, 5.608367404825779e-04, -2.858632644541382e-04, 6.275909517142376e-06, 1.773083496276320e-04, 1.671181731184490e-05, -5.291457382654794e-04,  3.925920722487627e-04, 2.547760727212730e-05, -1.337840044706609e-04, -2.867237604958358e-06, 9.677919194939867e-04,  2.677862479684836e-04,
                  -2.200754157986102e-05, 2.104996700131338e-04, -4.396859243611775e-05, -1.694471912285822e-03,  3.165949617724052e-04, 1.811744275336949e-05, -1.569416473201824e-04, -1.470624456978981e-04, 4.707736435487717e-04,  1.345745238321056e-04, 4.628032258326031e-03, -3.756122286461971e-04, -1.548282336144083e-04, -3.338133148225041e-04,  3.492425173022611e-04, -6.799101962466997e-05, 1.257992892508154e-04, 3.387134946034921e-05, -1.544920009802295e-04, -2.277176389868887e-04, -1.985448767587996e-05, -1.965562067739296e-04, 1.209168771473324e-03, -7.601502664827419e-04, -1.964452681208133e-04, -3.698853897080465e-04, 1.830542958298227e-04, 1.657577030900749e-04, 5.818350634117856e-05, -2.018042600253750e-04, 4.652983345158809e-07, 8.523312758533546e-05, -6.618548941308354e-05, -1.035048799498163e-03,  1.122732359629356e-03, -3.483011099599022e-04, 3.961353805261321e-04, 7.344236238474236e-05, 9.441036408567534e-05, -3.789408738287838e-04, 8.125273049027645e-05, 2.255244718380409e-04, 6.082069989779126e-05, -3.571824540214896e-04, -1.073505678625046e-04, -2.275373866773932e-04, 1.705076447805416e-03, 1.018747515060274e-03, -1.838962365621859e-04,  1.517563857270138e-04, 1.342693831688408e-04, 4.620324261778369e-04, -2.586846686802237e-04, 2.441253722282294e-04, -1.922892572937159e-03, 5.915062143697428e-04, -2.831844098353797e-04, 5.548115316947385e-04, -3.071304184554285e-04,  1.298078823632083e-03, 8.791710705530762e-05, -2.914602962370162e-04, -2.819820101601961e-04, -4.848874454481230e-04, -6.646443326438401e-04, 3.653574453041165e-04, -1.792205217661236e-04, 1.544489090815829e-04, 2.946736747653936e-05,  1.811077090212794e-04, 1.761839754866298e-04, 1.408610553177362e-03, -7.904155776423410e-05, 5.828793737428556e-05, -3.308200934290884e-04, 4.999870048928133e-04, 7.951384135381707e-05, 2.238290994703400e-04, 2.595399111051679e-04,  8.353507201274783e-05, -1.007391166186648e-06, -2.687769949105696e-04, -5.453560741419591e-05, 4.926092645377467e-04,  6.725976633327899e-05, -3.328967260906679e-05, -9.811458322228038e-06, -1.754721029784439e-04, -1.139199499234818e-05,  3.361389295905389e-05, -4.415327961888483e-04, 4.898078880728795e-04, -2.019995212100594e-04, 3.638271309412621e-05,  1.671309197081721e-04, 2.137109225058856e-03, -4.385718487139850e-04, -4.145258156027795e-06, -2.320810984141129e-04,  5.315415436361011e-06, -1.479518852612133e-04, 1.982933475275170e-04, -3.388360864714802e-04, -5.233435725376982e-04, -4.209747678577570e-04, -6.900615876015052e-05, -4.707466247049182e-04, 8.866847625393505e-04, -6.891798785493272e-05,  5.055863638964035e-04, -2.900225123113884e-04, -4.930576812450656e-05, 2.587268301320421e-04, 1.693248842182892e-04, -5.748910950700959e-04, 4.858583980357667e-04, -3.462676705131318e-05, -1.033725642064111e-04, 7.096702467462999e-05,  1.152827974805778e-03, 1.563307967242444e-04, 7.877568622601360e-05, 1.371074604834730e-04, 7.118695291869854e-05, -1.902236096313533e-03, 1.619850615343012e-04, 6.971723664116648e-05, -4.282692189730587e-04, -1.601301295581118e-04,  4.139456965943478e-04, 3.935283069436477e-05, 5.172789898377592e-03, -3.718380693434653e-04, -2.131243540866721e-04, -5.116584067814385e-04, 6.108954586360195e-04, -1.272575950802202e-04, 1.950748286921710e-04, 4.907292839356951e-05,  3.752233343950276e-06, -2.141491873259767e-04, 1.964446673694547e-04, -4.258319963753036e-04, 1.545854548897130e-03, -1.001876034570963e-03, -1.565368154226688e-05, -3.256341810184224e-04, 6.739036468324559e-05, 2.248205346733279e-04,  2.303587334736214e-05, -1.451386420351150e-04, -1.681544701085213e-05, 6.710583160377816e-05, -1.336195037199704e-04, -1.013647898479758e-03, 1.144595078842442e-03, -3.645105679645750e-04, 5.753882483032920e-04, 5.241852292104041e-05,  1.117226730678983e-04, -3.064996889037434e-04, 1.643569310519432e-04, 2.493038072922380e-04, 1.719799466716273e-04, -4.771886819249739e-04, 5.721194427426764e-05, -2.883037058907880e-04, 2.058623376660483e-03, 1.117914579522497e-03, -4.242063317414254e-04, 1.579715463686951e-04, 3.277551275941628e-04, 4.674915162154305e-04, -5.969472156073834e-04,  9.958242109302580e-05, -1.980894959127545e-03, 6.994754092202930e-04, -2.571984186712799e-04, 7.815297820685733e-04, -2.021509150478879e-04, 1.498341730696693e-03, 1.940489418933555e-04, -3.344808993825737e-04, -1.708655726212230e-04, -6.320213189235936e-04, -6.869084827273111e-04, 1.570554869197497e-04, -7.029443653417700e-05, 2.021847082032583e-04,  3.794452939557393e-05, 1.835122152032262e-04, 1.120255532709299e-04, 1.658091839387256e-03, 8.908038748997902e-06,  9.740974950613884e-05, -4.948303082106045e-04, 5.423298600785894e-04, 1.464852515605379e-04, 2.828402905965049e-04,  2.653599582398338e-04, 1.367485697645390e-04, 1.966091137882046e-04, -3.212498868365146e-04, -9.882235727938632e-05,  5.808702603115907e-04, 2.218954657882142e-04, -1.311863796981074e-04, -7.128743547291100e-07, -5.847739514198275e-04,  6.090489446683361e-05, -1.645830429195649e-06, -3.339979689662475e-04, 5.947181247422533e-04, -3.281194383668184e-04,  1.048224039095202e-04, 1.570905821243103e-04, 2.572531809153837e-03, -7.807284123808584e-04, -4.345841822254364e-05, -2.983775249215389e-04, 9.761341378411244e-06, -2.592153359551861e-04, 2.356875456441112e-04, -3.345964872193035e-04, -5.736477448494154e-04, -3.771505245164285e-04, -1.112717080853914e-04, -5.895705369744082e-04, 1.160193484935601e-03,  6.720606632970603e-05, 5.175398502246836e-04, -2.997394594956421e-04, -7.228751484709210e-05, 2.757435491079557e-04,  2.648080487740665e-04, -8.001220913680037e-04, 6.011010225275805e-04, 6.474072158542464e-05, -5.152998669090076e-05, -8.041903614680059e-05, 1.289643539578390e-03, 1.824471566844900e-04, 2.013009786454400e-04, 1.670572788683016e-05,  2.261998624932964e-04, -2.021421041267198e-03, 4.780005471984896e-04, 2.947760064114186e-04, -8.368336266814540e-04, -3.463238544118280e-05, 9.589466627137104e-04, 4.109953349793739e-04, 5.597700431840061e-03, -4.207788633150078e-04, -5.402997998834737e-04, -7.133675447421488e-04, 6.761948526318353e-04, -2.778690886732104e-04, 2.859176227915503e-04,  1.758995971628851e-04, -3.239714851239578e-05, -4.317535772570684e-04, 6.838027454327653e-05, -2.602371383141225e-04,  1.810262660639572e-03, -1.176792818827104e-03, 1.527851696200736e-04, -3.403287948214192e-04, 2.514786132793719e-04,  2.647082456061395e-04, -3.794828660588167e-05, -1.339733054570940e-04, -2.304413353798638e-05, 1.565408051526606e-04, -3.485244936015938e-04, -1.182455859660462e-03, 1.353851408627705e-03, -4.000583828334961e-04, 6.238195442004242e-04, -1.141463114448138e-04, 7.472876132684044e-05, -2.787695060887386e-04, 7.356739224713676e-05, 2.397362658047393e-04, -4.746571625809435e-05, -3.296147947026336e-04, 2.712872857382355e-05, -3.091589402834415e-04, 2.523431874527656e-03 )
               , tolerance = 0.01)

  expect_equal(c(result_exp$n_iter),
               c(10 )
               , tolerance = 0.01)

  expect_equal(c(result_exp$Q),
               c( 0.0369347870646544035, 0.0347441227219112830, -0.0006081598839505159, -0.0208505905592843745, 0.0031443111268429137,  0.0393251215447455033, 0.0299206278758464179, -0.0151951444003944128, -0.0304787001601560248, -0.0309732421029437210, -0.0310498669589861429, 0.0347441227219112830, 0.5709159866600972411, -0.1686503514405094939, 0.1699010937409277389,  0.1982542472830608193, 0.4805414159025341858, 0.4961071726392567993, -0.1729007560066130322, 0.1410896227481328591,  0.0641279770974379493, -0.0830561037790563395, -0.0006081598839505159, -0.1686503514405094939, 0.2112168084513327826,  0.0108610445794364418, -0.1197299320638619546, -0.0230728830438975824, -0.2714619327241843960, 0.0658139684764081911, -0.2844467020380472277, -0.2177883890962907798, -0.0780901041707766086, -0.0208505905592843745, 0.1699010937409277389,  0.0108610445794364418, 0.4759802736543207180, 0.0409162138643500706, 0.1204147264070071222, 0.1023772757876701550,  0.0229778047507718450, 0.0909012903698726005, 0.0291190473324523628, 0.1266068077492524258, 0.0031443111268429137,  0.1982542472830608193, -0.1197299320638619546, 0.0409162138643500706, 0.5040173487232924021, 0.0663606828023633466,  0.5556754915441217690, -0.8218345171485136325, 0.8231285146746556425, 0.1404948236964995989, 0.4368825573380475946,  0.0393251215447455033, 0.4805414159025341858, -0.0230728830438975824, 0.1204147264070071222, 0.0663606828023633466,  0.6282884904293726258, 0.1833337155716563138, 0.0724330778377481194, -0.0429329456865757755, 0.0905455012729810410, -0.2506218843999079016, 0.0299206278758464179, 0.4961071726392567993, -0.2714619327241843960, 0.1023772757876701550,  0.5556754915441217690, 0.1833337155716563138, 0.8897873039801271755, -0.8828727924515525904, 0.7556868053838845523,  0.0671314312258635415, 0.3702887721327438042, -0.0151951444003944128, -0.1729007560066130322, 0.0658139684764081911,  0.0229778047507718450, -0.8218345171485136325, 0.0724330778377481194, -0.8828727924515525904, 1.5890405719368605464, -1.1569151417444734076, 0.1141938089344143176, -0.7516067064548171972, -0.0304787001601560248, 0.1410896227481328591, -0.2844467020380472277, 0.0909012903698726005, 0.8231285146746556425, -0.0429329456865757755, 0.7556868053838845523, -1.1569151417444734076, 1.7265942706191403921, 0.6474792688524485529, 0.8842289796125701873, -0.0309732421029437210,  0.0641279770974379493, -0.2177883890962907798, 0.0291190473324523628, 0.1404948236964995989, 0.0905455012729810410,  0.0671314312258635415, 0.1141938089344143176, 0.6474792688524485529, 0.6419670917313228253, 0.1699678941155398637, -0.0310498669589861429, -0.0830561037790563395, -0.0780901041707766086, 0.1266068077492524258, 0.4368825573380475946, -0.2506218843999079016, 0.3702887721327438042, -0.7516067064548171972, 0.8842289796125701873, 0.1699678941155398637,  0.6096324954953655784 )
               , tolerance = 0.01)

  expect_equal(c(result_exp$Q_0),
               c(100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0,   0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0,   0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100 )
               , tolerance = 0.01)

  expect_equal(c(result_exp$order),
               c(1 )
               , tolerance = 0.01)

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 )
               , tolerance = 0.01)
})
