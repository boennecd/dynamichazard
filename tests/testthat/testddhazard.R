if(interactive()){
  library(survival); library(dynamichazard); library(testthat)
  source("C:/Users/boennecd/Dropbox/skole_backup/phd/dynamichazard/R/test_utils.R")
} else
  options(warn = -1)

# Test on data set that is one of Farhmiers papers
result = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1, # Use by month intervals
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4),
  a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
  max_T = 45,
  id = head_neck_cancer$id, order = 1
)

# plot(result, cov_index = 1)
# get_expect_equal(result, file = "tmp.txt")

test_that("Testing previous computed values vs. current on head and neck cancer set assuming that the previous is correct", {
  expect_equal(c(result$state_vecs),
               c(-3.5045064165490518, -3.5045656499164295, -3.1329979343435461, -2.7762813620346121, -2.4920444550244687, -2.0475180974079015, -2.1188049966993696, -2.5082342056716649, -2.7400547989246267, -2.8849282879973148, -3.0253327692106984, -3.2406977640747754, -3.3657522145691128, -3.4217728641562681, -3.2739452065172792, -3.3169520925442670, -3.4384370809821552, -3.5426921460127447, -3.5025053437910434, -3.5883353594935170, -3.5579940746115737, -3.6815422153090513, -3.8600459984612017, -3.9790677778298500, -4.0362876817800135, -4.1737949093221500, -4.2663243629831635, -4.3146884533943091, -4.4617089602371571, -4.5811903147914004, -4.6725556962586463, -4.7359352412761311, -4.7714262957243081, -4.7789372894227720, -4.7581748229597807, -4.7086665843191895, -4.6297901735810880, -4.5207994729812713, -4.5209273736810847, -4.6295543473960477, -4.7237081990042649, -4.8005546281779816, -4.8594330723345767, -4.9032101303250126, -4.9320276910045253, -4.9459427144095427, 0.4622523023291275, 0.4622626844924319, 0.4652397589717921,  0.4740783791640956, 0.4672612377158187, 0.4836163262469676, 0.4896990261561225, 0.4863002013615905, 0.5055099547472884, 0.5138992180545477,  0.5195462743890488, 0.5209216389305817, 0.5293995373114516, 0.5447016176064285, 0.5624431287164163, 0.5625250853546695, 0.5619030953182752,  0.5668602203025682, 0.5730242083044264, 0.5781903092189493, 0.5842840398250273, 0.5778996254763145, 0.5761554595155960, 0.5747261154704411,  0.5736150619753867, 0.5773179176988464, 0.5813942440473051, 0.5858804824738809, 0.5952548377211626, 0.6050755551710356, 0.6153047774686421,  0.6259131746245181, 0.6368787546941960, 0.6481852747490043, 0.6598209416049969, 0.6717774284058471, 0.6840491395803701, 0.6966326585520586,  0.7028701970602720, 0.7026435197664337, 0.7024823951448731, 0.7023874356412544, 0.7023576772999551, 0.7023282335255832, 0.7022983939049023,  0.7022677820270420 ))

  expect_equal(c(result$state_vars),
               c( 0.24971481604065104, -0.04845111114383468, -0.04845111114383471, 0.10639152831379761, 0.16311419016912762, -0.05259256270700222, -0.05259256270700224,  0.09789681170500669, 0.15310383223295043, -0.05151399097432499, -0.05151399097432502, 0.09101731796320917, 0.13479229477473645, -0.04918940147026213, -0.04918940147026213, 0.08466734962518582, 0.11552947419685949, -0.04715973326374917, -0.04715973326374917, 0.07906340925166372, 0.10170593315556586, -0.04265467240609434, -0.04265467240609433, 0.07464409218421481, 0.08283283204131768, -0.03958875342966766, -0.03958875342966766, 0.07143014093146663,  0.08574743237753379, -0.03839075515247545, -0.03839075515247545, 0.07064371539854651, 0.09988559962713089, -0.03821046226156710, -0.03821046226156710,  0.07178361577151676, 0.11294823941314228, -0.03883277749515560, -0.03883277749515561, 0.07395046643986163, 0.12372876096303355, -0.03967075418430188, -0.03967075418430188, 0.07678826005975414, 0.13471675164657299, -0.04049594614565687, -0.04049594614565687, 0.08016446211107395, 0.15055875539669883, -0.04160790267880037, -0.04160790267880037, 0.08400586430581332, 0.16472177593961668, -0.04304400781965888, -0.04304400781965888, 0.08808479982944045,  0.17645575575408801, -0.04459796396982182, -0.04459796396982182, 0.09231756249871856, 0.17448916690674271, -0.04613087848951326, -0.04613087848951326,  0.09654727397268645, 0.17718203800291171, -0.04779606323864612, -0.04779606323864612, 0.10106119664367978, 0.18769088622561772, -0.04973601409705623, -0.04973601409705623, 0.10594721243974012, 0.20213723093262348, -0.05184855724861329, -0.05184855724861329, 0.11114422128391810, 0.21041663267921473, -0.05400173185964625, -0.05400173185964624, 0.11649745709426079, 0.22134939039718360, -0.05628334296113834, -0.05628334296113834, 0.12211582796072129,  0.22493462219519089, -0.05859873851338071, -0.05859873851338071, 0.12787957175843259, 0.23551328640885347, -0.06146059220632962, -0.06146059220632962,  0.13398312811521065, 0.25314128225693611, -0.06455439434660187, -0.06455439434660187, 0.14044073932175916, 0.27076904865840157, -0.06781819924878714, -0.06781819924878714, 0.14713904387168714, 0.28433525497363610, -0.07123289371385615, -0.07123289371385615, 0.15400961367578436, 0.30294835012113436, -0.07487234429905440, -0.07487234429905440, 0.16115504760087240, 0.32016040142844482, -0.07848373195886876, -0.07848373195886876, 0.16849145170033528,  0.33314708270447457, -0.08208776164140788, -0.08208776164140788, 0.17597734496306500, 0.35286329198897837, -0.08568163592163081, -0.08568163592163081,  0.18374253693804946, 0.37536940434514132, -0.08926715170003868, -0.08926715170003868, 0.19172907098000486, 0.39873630901420842, -0.09283743440897779, -0.09283743440897779, 0.19989975627046705, 0.42178611638715935, -0.09638204834799534, -0.09638204834799534, 0.20822832732644378, 0.44361733758340671, -0.09988908333111086, -0.09988908333111086, 0.21669518969646151, 0.46339438509377351, -0.10334609693208163, -0.10334609693208163, 0.22528520655358666,  0.48023997913036814, -0.10674058641935472, -0.10674058641935472, 0.23398639917058323, 0.49317130060577541, -0.11006025940374116, -0.11006025940374116,  0.24278911803014888, 0.50105573489729149, -0.11329321873365431, -0.11329321873365431, 0.25168548221153902, 0.50172607734539709, -0.11631830554913909, -0.11631830554913909, 0.26066293360741083, 0.50678929708482690, -0.11934048900315548, -0.11934048900315548, 0.26986042363554874, 0.53530791125108756, -0.12262821748386488, -0.12262821748386488, 0.27950428218778706, 0.58183228951032062, -0.12605788915437280, -0.12605788915437280, 0.28951529241594171,  0.64601004887201596, -0.12955062384606128, -0.12955062384606128, 0.29984925590669426, 0.72461186953629142, -0.13339769709753874, -0.13339769709753874,  0.31041514122822839, 0.82102801119622204, -0.13755295184677210, -0.13755295184677210, 0.32120094422203299, 0.93944483420711966, -0.14198397121295389, -0.14198397121295389, 0.33219697935406944 ))

  expect_equal(c(result$lag_one_cor),
               c( 0.14247809998101518, -0.04562454466206545, -0.05137802355748031, 0.09661104516862873, 0.10431362943324185, -0.04861031163654034, -0.05074624825748811,  0.08896805870054486, 0.09184477343957012, -0.04743564248174101, -0.04837237729819202, 0.08237231450353649, 0.07601053577622742, -0.04523440016109591, -0.04610259157952361, 0.07641902858491645, 0.06272959197830691, -0.04314963214418981, -0.04149989910911214, 0.07143641724934291, 0.04976314071924333, -0.03916616402682748, -0.03796388995851814, 0.06764392356351839, 0.04412181515863559, -0.03676686921781388, -0.03617305844996195, 0.06566569856513924,  0.04957618738263997, -0.03610726607094485, -0.03558333714932022, 0.06583974493543014, 0.05977040559634353, -0.03627850990537859, -0.03594986614217178,  0.06748169847710267, 0.06933620537347324, -0.03710285749548425, -0.03665274888804125, 0.06997113416459577, 0.07835041829150659, -0.03807033153789197, -0.03741195048487035, 0.07306468068633712, 0.08971951983285176, -0.03901663691773311, -0.03845755873594103, 0.07666004173543133, 0.10299946280000147, -0.04022328696742932, -0.03983256037270591, 0.08060952649316513, 0.11472344003258168, -0.04171276859073255, -0.04135647882496760, 0.08475620286942620,  0.11929227532729340, -0.04329940686768807, -0.04286793534146173, 0.08898074017370550, 0.11967540016361046, -0.04488290770616960, -0.04448705764347778,  0.09334307202317987, 0.12568799875170755, -0.04662517968415156, -0.04635577675471133, 0.09803273950070884, 0.13717177867555602, -0.04863182306761198, -0.04841087627937196, 0.10306490538053203, 0.14787275866788996, -0.05078981599588300, -0.05052653767995336, 0.10833293871056307, 0.15688588300380527, -0.05299687476906442, -0.05275883302813247, 0.11381078752011181, 0.16381944021995298, -0.05532004348347869, -0.05503651955148272, 0.11949570041494442,  0.17051149493688239, -0.05773754566103760, -0.05778598536145362, 0.12542132497706640, 0.18385072540899211, -0.06067590518220634, -0.06079972229048869,  0.13169401330722136, 0.20073896438601183, -0.06383554630746020, -0.06399621816514178, 0.13826573627697758, 0.21582321355091066, -0.06715950643846504, -0.06734839553409373, 0.14504508730574223, 0.23131933064088409, -0.07064253158215336, -0.07091460605645269, 0.15204715886760278, 0.24872592002361732, -0.07432234658493433, -0.07448779301050570, 0.15928339919198167, 0.26347881361450842, -0.07797287647187855, -0.07805429107428290, 0.16669060905090019,  0.27935516487531376, -0.08161324395427487, -0.08161445490217697, 0.17431105697061813, 0.29995728123175835, -0.08524123058740807, -0.08517037467433741,  0.18218269157975328, 0.32242897694333783, -0.08885610101288860, -0.08871628145675733, 0.19025769757665478, 0.34523646505841404, -0.09245061048291603, -0.09224163126186219, 0.19850420429615567, 0.36734292418109626, -0.09601464025775200, -0.09573402310310439, 0.20689918554441644, 0.38787792059071813, -0.09953681717678085, -0.09918041114666822, 0.21542520575241722, 0.40598228901295108, -0.10300530125416135, -0.10256766158851258, 0.22406865406081064,  0.42072371232757272, -0.10640821139739171, -0.10588284283039759, 0.23281867490497415, 0.43104305315679342, -0.10973388919853261, -0.10911340663694469,  0.24166647006743927, 0.43529495773743460, -0.11295793488214806, -0.11215243995070286, 0.25060184368002730, 0.43813459195398868, -0.11600224349998906, -0.11515841556353090, 0.25968666926394418, 0.45454851714255162, -0.11908680839297911, -0.11838596957059258, 0.26910284377369931, 0.49138481513646687, -0.12241919814228926, -0.12177557663990653, 0.27892658589834357, 0.54588612234346912, -0.12587850632515779, -0.12524485231908417, 0.28909589138451325,  0.61648577322801246, -0.12942828014459670, -0.12903240981596598, 0.29954356460855475, 0.70313264063392933, -0.13332903190180437, -0.13313154049538278,  0.31021736361643093, 0.80959999753414891, -0.13753564955227368, -0.13750879820300663, 0.32110641441598070 ))

  expect_equal(c(result$order),
               c(1 ))

  expect_equal(c(result$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result$method),
               c("EKF" ))

  expect_equal(c(result$model),
               c("logit" ))

  expect_equal(c(result$est_Q_0),
               c(FALSE ))

  expect_equal(c(result$LR),
               c(1 ))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result$Q_0)), rep(c("(Intercept)", "group1"), 2))
})

suppressMessages(
  result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 1,
    a_0 = rep(0, 2), Q_0 = diag(1, 2),
    Q = diag(1e-3, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential"))

# matplot(result_exp$state_vecs, type = "l")
# plot(result_exp, cov_index = 1)
# get_expect_equal(result_exp, file = "tmp.txt")

test_that("Result of exponential model on head_neck_data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.746423060135996685, -3.746504060013073900, -3.411975048951466860, -3.123640371003203242, -2.982809608911737520, -2.590346163235035526, -2.707462197276075067, -3.063090315919674733, -3.210805574368385873, -3.315742889070746102, -3.426247363612953123, -3.615220620358764236, -3.697315516637163402, -3.694960055771935981, -3.514271049590928619, -3.583085023499657851, -3.710830938614790853, -3.795127010362230990, -3.748048132503383201, -3.815987456462097249, -3.777482704888463161, -3.920316568467759666, -4.088637675068001798, -4.201323487740026508, -4.259461256379053040, -4.367477036724612738, -4.433043652875148233, -4.459456746007150585, -4.550360855046704067, -4.610000022861876268, -4.639325243012230260, 0.267804490680041141, 0.267771787453442156, 0.403121813911384685, 0.520049844804208572,  0.576160248484232418, 0.735892530651090726, 0.689094230510559402, 0.545630086365206601, 0.487798497798527519,  0.446442789310776300, 0.402597030242301868, 0.326664433404419530, 0.294377499738915582, 0.296650845900248650,  0.371113979808708139, 0.343329377363240540, 0.291614728358585928, 0.257804270528158685, 0.277126693289556969,  0.249812884521956741, 0.265542761334367383, 0.206999786494018956, 0.138432166714767713, 0.092322841165753983,  0.068242479179494192, 0.024306252492979658, -0.002487643961411226, -0.013462865355197196, -0.050190793123115238, -0.074287656203643360, -0.086136417649086819 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.220295737757598364, 0.030605438335697444, 0.030605438335697410, 0.107887831584073779, 0.145517332013094386, -0.001660812188336636, -0.001660812188336663, 0.093157593036923003, 0.138465436387046198, -0.005483167613022810, -0.005483167613022810, 0.090459598666057905, 0.121190284462693143, -0.013473739641127053, -0.013473739641127053,  0.086110274476198068, 0.101662279453035381, -0.022908096953915380, -0.022908096953915352, 0.081038208697458758,  0.095867522458459364, -0.023885306692934857, -0.023885306692934843, 0.080689754615085069, 0.077456526357003314, -0.030960843306268769, -0.030960843306268776, 0.077602255823180491, 0.082455078200529969, -0.027693058748322806, -0.027693058748322806, 0.079340402366294610, 0.097620413611103074, -0.019611163477797986, -0.019611163477797990,  0.083536337148846770, 0.108527839469235637, -0.013899742692818465, -0.013899742692818469, 0.086642393140734547,  0.117270064414540853, -0.009209497548788718, -0.009209497548788718, 0.089378028472115539, 0.126593308401248106, -0.004213354226871995, -0.004213354226872004, 0.092352613543143031, 0.142056902973380222, 0.003246515045985453,  0.003246515045985445, 0.096393662153779189, 0.154670481364136941, 0.009174882144043255, 0.009174882144043245,  0.099714166376657809, 0.162243181462978447, 0.012759067407502343, 0.012759067407502333, 0.102003897171627778,  0.154263017275540815, 0.009671257575669605, 0.009671257575669601, 0.101468499748081642, 0.156268829056957770,  0.010708150500953185, 0.010708150500953181, 0.102691939758461775, 0.167351999992699452, 0.015510896273943500,  0.015510896273943500, 0.105530910705355946, 0.180549724125395994, 0.021142568352647155, 0.021142568352647155,  0.108735832386015252, 0.186676114925689196, 0.023696715611691128, 0.023696715611691115, 0.110636132361143863,  0.195132553747604187, 0.027239491848385596, 0.027239491848385589, 0.112988513500728624, 0.195802238977011434,  0.027491757655777889, 0.027491757655777889, 0.113976217186229828, 0.207695680825756651, 0.032192216268221538,  0.032192216268221538, 0.116764105693921788, 0.227752670178947458, 0.040306746418476834, 0.040306746418476841,  0.121009914489442844, 0.249896037576859964, 0.049182391963886199, 0.049182391963886199, 0.125552580822571369,  0.271761552831857933, 0.057783298444313118, 0.057783298444313125, 0.129935708438214170, 0.302118813679059628,  0.069780714362332324, 0.069780714362332324, 0.135696484455231470, 0.338266746322974599, 0.084091957207221874,  0.084091957207221874, 0.142395942290244937, 0.380742938825434474, 0.100879963944609241, 0.100879963944609241,  0.150075305372945611, 0.444466596145961845, 0.126328250804517594, 0.126328250804517594, 0.161299161876744979,  0.531999976361760107, 0.161392148387444728, 0.161392148387444728, 0.176418095681750153 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.1305325959145391401, -0.0052089493607540005, -0.0075031383850821254, 0.0913894897083526447,  0.0978591671701529719, -0.0203818557153340740, -0.0217058587265687997, 0.0840417484078850863,  0.0871027536984031736, -0.0257103145416465728, -0.0270369347110312741, 0.0807535655006016984,  0.0718754960063896775, -0.0328829066769174838, -0.0346988450625990152, 0.0765703420196387208,  0.0627463772255224816, -0.0380957795304226049, -0.0370147748087408940, 0.0744469988478002331,  0.0534583084677090065, -0.0405388837288346293, -0.0403445344437134978, 0.0731890515377511819,  0.0492705124425093788, -0.0419124943754746807, -0.0407381623848610819, 0.0729254967945892063,  0.0550904854250336071, -0.0383720391423312823, -0.0364043474808718667, 0.0751809590749499268,  0.0646818331428645754, -0.0325943697662127510, -0.0311966214735018461, 0.0782561372934883481,  0.0724141563043191466, -0.0281991686317177859, -0.0268963176343049726, 0.0808251541224896952,  0.0797804455158117320, -0.0240883035819247394, -0.0226807861152099471, 0.0833984369065282755,  0.0902067802073275721, -0.0186637920628184469, -0.0172526313929301685, 0.0865748968915695943,  0.1027570922706346063, -0.0123996890580447237, -0.0113394853623166661, 0.0900044737507146586,  0.1120009335986826282, -0.0078479199412655951, -0.0070686026884887627, 0.0926644515694674403,  0.1117860758338085070, -0.0074278045023624222, -0.0069996600687590102, 0.0935353100172285346,  0.1090682377854654689, -0.0083926588204123603, -0.0078661373535679618, 0.0939187007809823837,  0.1149373780978811960, -0.0057987580848425629, -0.0051664548099843565, 0.0958339263893257659,  0.1261263964700668483, -0.0009589618233260475, -0.0003402549749295623, 0.0986949390220481504,  0.1352455177154054111, 0.0030161712941791340, 0.0034358957759992211, 0.1011546983856754234,  0.1420277061961444098, 0.0058339854340718825, 0.0063086834872375895, 0.1031939260325812069,  0.1462827175433172588, 0.0076741504403399670, 0.0080231553129095634, 0.1048109280062911042,  0.1519411620999118750, 0.0099438566889990775, 0.0102138377293466698, 0.1065951511291503562,  0.1666176315574199596, 0.0157746850138400854, 0.0161617988331630089, 0.1098988259206332418,  0.1861105705246031139, 0.0236658863932852279, 0.0239801696551823554, 0.1140313793266586884,  0.2061226601364018196, 0.0316856421716713785, 0.0318505732990983503, 0.1181718022908323784,  0.2291563181873806088, 0.0407703658724542367, 0.0409050349545056896, 0.1227457246785957634,  0.2579916680449954036, 0.0521672187956483610, 0.0522803526400809973, 0.1282610941675531024,  0.2909946363023212523, 0.0652236088850460527, 0.0652628459816799733, 0.1344287983185117885,  0.3343093943042159122, 0.0823757397213063791, 0.0824808492832314333, 0.1422924071107838917,  0.3955358834641173882, 0.1068421339980925033, 0.1069341324460411774, 0.1531238112710233690 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(72 ))

  expect_equal(c(result_exp$Q),
               c(0.11712173734693690, 0.04695251832094549, 0.04695251832094549, 0.01990459209039402 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(0.0877914951989026 ))
})

test_that("exponential model and logit moels hazzard functions differs", {
  expect_true(result_exp$model != result$model)
  expect_true(toString(body(result_exp$hazard_func)) !=
                toString(body(result$hazard_func)))
  expect_true(toString(body(result_exp$hazard_first_deriv)) !=
                toString(body(result$hazard_first_deriv)))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result_exp$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result_exp$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result_exp$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result_exp$Q_0)), rep(c("(Intercept)", "group1"), 2))
})


# Change by argument
suppressMessages(result_exp <- ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 2, Q_0 = diag(1, 2),
  Q = diag(1e-1, 2),
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-3),
  max_T = 30,
  id = head_neck_cancer$id, order = 1,
  verbose = F,
  model = "exponential"
))

# matplot(result_exp$state_vecs, type = "l")
# plot(result_exp, cov_index = 1)
# get_expect_equal(result_exp, file = "tmp.txt")

test_that("Result of exponential model on head_neck_data match previous results with altered by argument", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.87037427961885383, -3.87023087984429326, -1.91221037934947025, -2.43862280740296100, -3.22165530139148526, -3.30681140748686797, -3.89651206337075617, -3.63305833903981856, -3.53490169069086635, -3.92811419830653863, -3.83445633104215533, -4.08572279262521310, -4.38977418588174118, -4.59111421278896614, -4.26627051055878859, -4.65585179523574677, 0.25164279033439135, 0.25144509924460229, 1.37673532204583315, 1.01993204104296042,  0.53459101788916963, 0.54030801834951736, 0.19704401242214445, 0.43237882659576832, 0.45550100210285527,  0.22267296417307317, 0.25618524455277258, 0.00618157586681295, -0.22706286691347843, -0.37988354475124742, -0.23811812709966915, -0.45275960647321628 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.441292543450496955, 0.119914593826589019, 0.119914593826589033, 0.293711418856185458, 0.153610075857844225, -0.028908871706440492, -0.028908871706440492, 0.156586679956091435, 0.173792970426504961, 0.004791443767631409,  0.004791443767631437, 0.141115685933586310, 0.055149694875353913, -0.046529344162667019, -0.046529344162667019,  0.067349697349126936, 0.075678008174908079, -0.038645834720671388, -0.038645834720671381, 0.085822125254475176,  0.132443974179516144, -0.014948731361429442, -0.014948731361429435, 0.129403658956841972, 0.155750605430720168, -0.014692267525394792, -0.014692267525394792, 0.157893280988063045, 0.254860141089101100, 0.034077493139793191,  0.034077493139793191, 0.222756109854566703, 0.238890329496455001, 0.004944733239908717, 0.004944733239908720,  0.232124143223547630, 0.226881610397214217, -0.020933213616808371, -0.020933213616808360, 0.247184584339527252,  0.334349783425151426, 0.024953265993933792, 0.024953265993933771, 0.318490259893117411, 0.340131045559659451,  0.003272646957310301, 0.003272646957310294, 0.348947458402341093, 0.415849736184024044, 0.030333279839828829,  0.030333279839828808, 0.421743984834121899, 0.523382410162643530, 0.072540529768555781, 0.072540529768555739,  0.509325662871255580, 0.641622171871534919, 0.114835421711122015, 0.114835421711121988, 0.599146059513987028,  0.618035296626318953, 0.065811216941824985, 0.065811216941824985, 0.632932302407492875 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.10200382443452685, -0.04571589452880667, -0.05083395148578548, 0.13442239936127454, 0.06035462774283284, -0.04979102175280423, -0.05155823760870992, 0.09270295856323763, 0.03712398729936267, -0.04078366544120141, -0.04690857804759244, 0.05834357792228553, 0.03225048889196058, -0.04068258137312888, -0.03764188588715757,  0.04921007496276691, 0.03774942080843696, -0.04664174346994628, -0.04125586603008025, 0.06532073057893037,  0.05081104228755204, -0.04943994252619141, -0.04680513527685709, 0.09000025813177906, 0.07154819378921567, -0.05108515253310515, -0.04463860675610858, 0.12015084187547252, 0.09629910216893048, -0.04578547530236746, -0.04813716112477871, 0.15067548841267339, 0.09391302444910532, -0.06611524013466885, -0.06657478927713116,  0.16580374647646218, 0.11744037359727003, -0.07184904079874951, -0.06702917474526374, 0.19814277709906072,  0.15664336724252381, -0.06536520591652244, -0.06565715574900269, 0.24087661449129624, 0.18956975446789501, -0.06951695680969300, -0.06103640411174969, 0.28634704100628644, 0.30368102033354683, -0.01795183767719585, -0.00964876074475577, 0.37111142407645392, 0.64812791793174362, 0.16667993986692364, 0.17364424794121208,  0.53733278737797563, 1.55191487037745812, 0.67312143735963870, 0.67754892293272584, 0.89037289933934638 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(16 ))

  expect_equal(c(result_exp$Q),
               c(0.3409762050461504, 0.1803436136440473, 0.1803436136440473, 0.1426526945307628 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(0.1316872427983539 ))
})

# for(s in sample.int(1e6, 100, replace = F)){
# print(s)
# set.seed(s)
set.seed(599479)

sims <- test_sim_func_exp(n_series = 1e3, n_vars = 10, t_0 = 0, t_max = 10,
                          x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                          intercept_start = -5, sds = c(.1, rep(1, 10)))
# tmp_file <- file("exponential.log")
# sink(tmp_file)
suppressMessages(result_exp <- ddhazard(
  formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
  data = sims$res,
  by = (by_ <- 1),
  Q_0 = diag(10, 11),
  Q = diag(1e-2, 11),
  control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^3),
  max_T = 10,
  id = sims$res$id, order = 1,
  verbose = F,
  model = "exponential"))
# sink()
# close(tmp_file)

# matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
# matplot(result_exp$times, result_exp$state_vecs, result_exp$state_vecs, type = "l", lty = 2, add = T)
# get_expect_equal(result_exp, eps = 1e-5, file = "tmp.txt")

if(!interactive())
  test_that("Deal with lag one co-variance in EKF + exponential model!",
            expect_true(F))

test_that("Result of exponential model on simulated data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-5.188203295858222042, -5.192867919169898094, -4.310316958425439715, -4.336320945330846222, -4.064762463526304437, -4.470068713489812495, -4.278183682563193813, -4.738207889373453163, -5.080239744824088355, -4.330098903059813154, -3.512832514783392313, 0.903535714308593918, 0.894331964133800561, 1.816929462718155142, 0.620636215330882868, -1.210916388947183453, -2.124633635549365795, -2.018309280940417949, -2.663985587934378785, -2.388579061828196348, -1.695473603518183658, -0.908981390672407796, -1.764398534960296638, -1.783669340597084485, 0.613675018496285141, -1.259230230844413434, -3.749789731748256916, -5.281844649984472007, -4.760451807749158881, -5.760598422852969414, -4.862687284882237115, -3.721453497357167350, -2.131048877181849210, 0.646734126164619449, 0.645014594742284952,  0.674528187264348711, 0.525849444022213341, 0.419254877067003873, 0.119506867082035007, 0.344312436531998556, -0.151188667141975652, -0.984275580736283739, -0.147218581461528275, 0.643775114143569249, 0.903078090752215124,  0.906729758787989892, 0.869950217759679956, 1.595274505346900407, 2.797467744558432390, 3.253341266223266803,  3.096065389005932644, 3.496517930806801733, 3.662144599252522337, 3.192325862453184726, 2.735585334977329808,  0.678519650708181765, 0.678283654429648220, 0.307016411703131709, 0.022340565125074319, -0.486681248517496334, -0.760715580711739725, -0.664154943419190902, -1.102134793443673821, -1.900241848609568907, -1.240890040051801702, -0.694924949031594075, -0.520770279577914441, -0.521900942890573538, -0.531901667471322948, -0.584528090136232525, -0.547787771140243018, -0.717278086797987546, -0.478133042485134219, -0.786054878228679588, -1.427949733333044646, -0.838069475769509964, -0.265493352688137230, 0.051633853669528731, 0.037845740492234659, 2.924056990572987402,  2.377243559493144698, 2.098266161187867684, 1.786915474205531540, 1.968123287727698845, 2.491452526580773430,  5.761100690828738990, 4.585940059361372612, 3.944717989283841320, 1.113496343379008380, 1.109175268779626355,  1.999820516717627950, 1.860492444907890119, 1.863381980316567210, 1.696891414664366993, 1.769589769007558377,  1.745902104086367590, 2.445779023827046927, 2.361342564113131814, 2.383779024039542449, 1.713304661384221772,  1.717483031231116231, 0.609252124153554675, 0.676695613135207874, 0.634783559424135002, 0.517114549821963809,  0.547429584398183788, -0.011728153257258622, -1.912657666273230195, -0.887684276927991345, -0.007803321122974438, -1.986860410843613423, -1.973053825621926993, -5.027206005632039343, -4.593177841377539039, -4.503053956458455076, -4.187297705728798114, -4.284967037244340027, -4.835946927079818991, -8.222364049774895989, -6.998889221581012343, -6.308863713569206944 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$state_vars),
               c( 0.3564718209647352865, 0.1502042108545438848, 0.3949362494855248595, 0.2124595209322067413, -0.0476819667674404646, 0.1018442896498744504, 0.1609053367419655267, -0.0551357559837619485,  0.0553818409885371565, 0.1688038124507954263, 0.0525114410273263485, 0.1502042108545438848,  0.8663100540189390131, 1.2243281841372029017, 0.1855384361571849883, -0.4604454500014331653,  0.2503434462059512811, 0.0944020402948364534, 0.1617109294087489546, 0.0776916954361121792,  0.0888071993212603689, -0.1143341085457198342, 0.3949362494855247485, 1.2243281841372029017,  2.2197518498388131292, 0.3452033531635448904, -0.6782092839561278952, 0.3280807046148012107,  0.2242126480805420596, 0.5936128917560727913, 0.2212026029497712876, 0.0388679022587088835, -0.5096810431421557874, 0.2124595209322067413, 0.1855384361571850715, 0.3452033531635449459,  0.3066692478863988214, -0.1342364305139721325, 0.1881638378090466635, 0.1847533401768684524, -0.3227674414196349817, -0.0196826386375874331, 0.3038689827745920113, 0.3428542682694438182, -0.0476819667674404438, -0.4604454500014334428, -0.6782092839561280062, -0.1342364305139721325,  0.3831971041731261352, -0.1983124470282424667, -0.0893577393272062814, 0.0735754083882483173,  0.0081059966737519681, -0.1278031294679441432, -0.1368207672945087050, 0.1018442896498744088,  0.2503434462059513921, 0.3280807046148014328, 0.1881638378090466912, -0.1983124470282425222,  0.2648395318915124363, 0.1292535636669398247, -0.3767381053890948017, -0.0608516892457050609,  0.2841805186090277102, 0.4130142849545426764, 0.1609053367419656100, 0.0944020402948365228,  0.2242126480805420874, 0.1847533401768683692, -0.0893577393272062537, 0.1292535636669398247,  0.2069051716891880943, -0.2328161296450839690, -0.0222871352651428378, 0.2155878130752736654,  0.2582611382948359346, -0.0551357559837620109, 0.1617109294087490379, 0.5936128917560725693, -0.3227674414196348707, 0.0735754083882483173, -0.3767381053890944687, -0.2328161296450839690,  1.6980868970208273794, 0.3741475264367888909, -0.8838837043260465709, -1.6803768439410917690,  0.0553818409885371774, 0.0776916954361122347, 0.2212026029497712598, -0.0196826386375874261,  0.0081059966737519508, -0.0608516892457050332, -0.0222871352651428378, 0.3741475264367889464,  0.1742668935710796063, -0.1701766214639477137, -0.3943139678935742021, 0.1688038124507953985,  0.0888071993212603827, 0.0388679022587088488, 0.3038689827745921224, -0.1278031294679440877,  0.2841805186090277102, 0.2155878130752736099, -0.8838837043260469040, -0.1701766214639477137,  0.6422702852407251584, 0.9143797346648711022, 0.0525114410273262791, -0.1143341085457198758, -0.5096810431421558985, 0.3428542682694437627, -0.1368207672945086495, 0.4130142849545427874,  0.2582611382948359346, -1.6803768439410924351, -0.3943139678935742576, 0.9143797346648711022,  1.8316815271254398567, 0.0755229691425798877, 0.0150403026074210494, 0.0638946375928686194,  0.0351240106431329885, -0.0074949398183738331, 0.0161304587455404769, 0.0321454487166744976, -0.0236149149571044485, -0.0005326541614235347, 0.0288320307999519188, 0.0337315221568559587,  0.0150403026074210772, 0.2981174558699241084, 0.3228304959990835332, 0.0344953129534601097, -0.1372271092678233328, 0.0742397421708959060, 0.0063403885773025415, 0.0257094615546330924,  0.0148061443669236445, 0.0227934942289047676, -0.0156411384901818454, 0.0638946375928686056,  0.3228304959990835332, 0.6196144957630375094, 0.0787442000910802686, -0.1973213125090947651,  0.0918764024889000136, 0.0552997613699467011, 0.1333404441914082250, 0.0396603188211801100,  0.0133365015253159927, -0.0964537276866831994, 0.0351240106431329746, 0.0344953129534601305,  0.0787442000910802270, 0.1167558079369673818, -0.0324175248726315673, 0.0455917949012193888,  0.0518455308777304724, -0.0755190431111950611, -0.0029186013783272999, 0.0740225456331340959,  0.0826681140399420644, -0.0074949398183738192, -0.1372271092678234716, -0.1973213125090947095, -0.0324175248726315535, 0.1570409107964362283, -0.0598271800681427837, -0.0246698534529133130,  0.0134623670205698785, 0.0016038981750589776, -0.0262549776604951088, -0.0377437206308154360,  0.0161304587455404561, 0.0742397421708959615, 0.0918764024888999720, 0.0455917949012194026, -0.0598271800681428462, 0.1068986597894454604, 0.0305196659425098875, -0.0876868596859152333, -0.0122322386717625166, 0.0650188680241305939, 0.0981344954545152054, 0.0321454487166745045,  0.0063403885773026056, 0.0552997613699466387, 0.0518455308777304724, -0.0246698534529133269,  0.0305196659425098771, 0.1002929312876404966, -0.0483455202810034387, -0.0073587678894963364,  0.0486543949853659591, 0.0628465635259846528, -0.0236149149571045144, 0.0257094615546331479,  0.1333404441914080862, -0.0755190431111950056, 0.0134623670205699097, -0.0876868596859150529, -0.0483455202810034665, 0.4360614675624030490, 0.0827916630661595376, -0.2075790895970882621, -0.3815261487635674409, -0.0005326541614235208, 0.0148061443669236913, 0.0396603188211800475, -0.0029186013783272999, 0.0016038981750589585, -0.0122322386717624854, -0.0073587678894963347,  0.0827916630661596348, 0.0831112694054743084, -0.0411941736733142522, -0.0879718009141046281,  0.0288320307999518910, 0.0227934942289047607, 0.0133365015253159580, 0.0740225456331341652, -0.0262549776604951088, 0.0650188680241305939, 0.0486543949853659036, -0.2075790895970884287, -0.0411941736733142660, 0.1975923635156064950, 0.2113725903873455714, 0.0337315221568559032, -0.0156411384901818731, -0.0964537276866832965, 0.0826681140399420922, -0.0377437206308153875,  0.0981344954545153719, 0.0628465635259846389, -0.3815261487635673854, -0.0879718009141046836,  0.2113725903873457934, 0.4687297824200610252, 0.0665838676620906927, 0.0240103450712270232,  0.0746656777222383800, 0.0282308130902155091, -0.0051185976596646657, 0.0094948760719356928,  0.0243112416867661482, -0.0026784586780963411, 0.0044776706025215496, 0.0167117216883624770,  0.0074111032529636384, 0.0240103450712270787, 0.2489805992497309828, 0.2792342874294141408,  0.0352925732627961258, -0.1116865708517331829, 0.0616576534203468959, 0.0107238408595546047,  0.0252818072700318856, 0.0155288944648528764, 0.0239352257045015657, -0.0169383416224280631,  0.0746656777222383106, 0.2792342874294141963, 0.5457013104021826155, 0.0710797885264684570, -0.1596615662333365770, 0.0753270916459616163, 0.0471606005163159175, 0.1269335911760236524,  0.0416553978110258405, 0.0117662412202026011, -0.1011621899216662845, 0.0282308130902155230,  0.0352925732627961120, 0.0710797885264684570, 0.0973045213967378420, -0.0258504753440704643,  0.0369075701271407083, 0.0392020325930455410, -0.0629085512103193523, -0.0020002748968701756,  0.0615695376033766062, 0.0653518757391182564, -0.0051185976596646587, -0.1116865708517332523, -0.1596615662333364383, -0.0258504753440704643, 0.1317747947928820107, -0.0496034473063971526, -0.0194817105913085396, 0.0156667791416738936, 0.0025825977493157300, -0.0247686155021507072, -0.0357288773607840962, 0.0094948760719356790, 0.0616576534203469376, 0.0753270916459615747,  0.0369075701271407083, -0.0496034473063971873, 0.0909167520549178931, 0.0242280965298835374, -0.0776568961796967328, -0.0117692317898151471, 0.0562548774313715860,
                  0.0859002947722688481,  0.0243112416867661621, 0.0107238408595546706, 0.0471606005163158967, 0.0392020325930455271, -0.0194817105913085674, 0.0242280965298835235, 0.0804287367937793762, -0.0400308560799835303, -0.0061515315563477509, 0.0389614648486074841, 0.0489123732356284563, -0.0026784586780963706,  0.0252818072700319481, 0.1269335911760236524, -0.0629085512103194078, 0.0156667791416739074, -0.0776568961796966356, -0.0400308560799835789, 0.3943233067047047791, 0.0772406354016890589, -0.1817669108846280968, -0.3466324496471754890, 0.0044776706025215496, 0.0155288944648528937,  0.0416553978110258127, -0.0020002748968701791, 0.0025825977493157109, -0.0117692317898151367, -0.0061515315563477457, 0.0772406354016890728, 0.0745871937166110444, -0.0364307345835694490, -0.0827150111574497526, 0.0167117216883624492, 0.0239352257045015622, 0.0117662412202026220,  0.0615695376033766062, -0.0247686155021507107, 0.0562548774313715652, 0.0389614648486074841, -0.1817669108846281523, -0.0364307345835694629, 0.1692955873293200408, 0.1833135347313854524,  0.0074111032529636106, -0.0169383416224280908, -0.1011621899216662568, 0.0653518757391182564, -0.0357288773607840893, 0.0859002947722689730, 0.0489123732356284563, -0.3466324496471752670, -0.0827150111574497665, 0.1833135347313855079, 0.4246053340460555492, 0.0387760537796417587, -0.0169909441548118760, -0.0108903117950929010, 0.0126151821746198281, 0.0055828161765003933,  0.0055212367982150788, 0.0164488589531234797, -0.0436413042593582767, -0.0111317107817416189,  0.0179372277994738864, 0.0516466798429706386, -0.0169909441548118829, 0.1016353197702104666,  0.0557487799532663392, -0.0025779208616847253, -0.0317791563702843338, 0.0146390304127108940, -0.0107841584214783560, 0.0036688151491958282, 0.0020603573299375543, 0.0005012566281814260, -0.0034079142573841524, -0.0108903117950929062, 0.0557487799532663114, 0.1312436997521687354,  0.0068040207087430877, -0.0395310559406196957, 0.0182932096446945525, 0.0043814103352542684,  0.0119650727182096708, -0.0002520202103322416, 0.0028134915770576243, -0.0015179151982664578,  0.0126151821746198350, -0.0025779208616847340, 0.0068040207087430946, 0.0595230826098082366, -0.0005725541268576887, 0.0103250523360019220, 0.0175939507145214773, -0.0282903096332548232,  0.0004773131897977337, 0.0228984450989259784, 0.0285693089245477039, 0.0055828161765003933, -0.0317791563702844587, -0.0395310559406196055, -0.0005725541268576939, 0.0678419237157850963, -0.0124898786676012584, -0.0020743604155622113, -0.0030020884209542749, -0.0003626007562095371,  0.0015026692516011799, -0.0057701281841637964, 0.0055212367982150632, 0.0146390304127109096,  0.0182932096446945212, 0.0103250523360019462, -0.0124898786676012653, 0.0501054804335923504,  0.0076045511780133881, -0.0183544494140746965, -0.0001569035540571299, 0.0120466860646081062,  0.0215666604177226044, 0.0164488589531234936, -0.0107841584214782953, 0.0043814103352542207,  0.0175939507145214495, -0.0020743604155622338, 0.0076045511780133924, 0.0582271172780115254, -0.0192536594580668373, -0.0034087466249594738, 0.0148771308535675141, 0.0246499686328153812, -0.0436413042593583114, 0.0036688151491958403, 0.0119650727182096864, -0.0282903096332548579, -0.0030020884209542437, -0.0183544494140747451, -0.0192536594580668859, 0.1304588548177526564,  0.0115987641058708339, -0.0502104241362456294, -0.0854887643475530923, -0.0111317107817416328,  0.0020603573299375821, -0.0002520202103322936, 0.0004773131897977380, -0.0003626007562095666, -0.0001569035540571247, -0.0034087466249594538, 0.0115987641058708374, 0.0488695504086170129, -0.0074487659253321872, -0.0145562571281026235, 0.0179372277994738899, 0.0005012566281814308,  0.0028134915770576083, 0.0228984450989259541, 0.0015026692516011803, 0.0120466860646080958,  0.0148771308535675002, -0.0502104241362456571, -0.0074487659253322114, 0.0772272661656021736,  0.0495324927796831349, 0.0516466798429706317, -0.0034079142573841346, -0.0015179151982664700,  0.0285693089245476796, -0.0057701281841637765, 0.0215666604177226842, 0.0246499686328153604, -0.0854887643475529951, -0.0145562571281025854, 0.0495324927796830794, 0.1494750451722671181,  0.0449125881803093333, -0.0030385082500555237, 0.0139286378958670652, 0.0239739645869568724, -0.0045576509389877234, 0.0151656623765085326, 0.0229157926056221817, -0.0495213509964089194, -0.0090577126970655640, 0.0302096181987065206, 0.0597696222430394788, -0.0030385082500555306,  0.1061499393687249521, 0.0829287925900541179, 0.0047357891108694644, -0.0388432401123416302,  0.0171459078343101923, -0.0026658336814929079, 0.0100625218715885874, 0.0044413893099511425,  0.0029441976336309511, -0.0088145215248827888, 0.0139286378958670617, 0.0829287925900541179,  0.1846128284416309606, 0.0205393151016052163, -0.0565037081699213128, 0.0269114816591800414,  0.0153518788845132485, 0.0220704764103038797, 0.0062539912132161847, 0.0083052144992038814, -0.0112908196409780143, 0.0239739645869568654, 0.0047357891108694471, 0.0205393151016052336,  0.0647839367261213162, -0.0050599702561067517, 0.0179240320455897745, 0.0236659665020361384, -0.0402579180197564224, -0.0003044684020162051, 0.0354351789432449590, 0.0417863787628319563, -0.0045576509389877113, -0.0388432401123417620, -0.0565037081699212296, -0.0050599702561067448,  0.0672219051925454364, -0.0138825854884999707, -0.0062348492923361646, -0.0049855027861619196, -0.0016680874050857978, -0.0012941558306047672, -0.0024417686964614506, 0.0151656623765085066,  0.0171459078343101992, 0.0269114816591800067, 0.0179240320455898092, -0.0138825854884999638,  0.0513652380257036412, 0.0140522856235701758, -0.0290250223724292482, -0.0017910230560133004,  0.0227373130637037249, 0.0328229583980094233, 0.0229157926056221956, -0.0026658336814928802,  0.0153518788845132068, 0.0236659665020361107, -0.0062348492923361828, 0.0140522856235701758,  0.0576647292146984930, -0.0287666929366160937, -0.0037828878626689172, 0.0243758281946999007,  0.0344393477392495873, -0.0495213509964089610, 0.0100625218715885700, 0.0220704764103039214, -0.0402579180197564501, -0.0049855027861618832, -0.0290250223724292308, -0.0287666929366161353,  0.1581845565934768549, 0.0184763901823935123, -0.0718232154534486633, -0.1197582357586476076, -0.0090577126970655605, 0.0044413893099511745, 0.0062539912132161483, -0.0003044684020162137, -0.0016680874050858207, -0.0017910230560133082, -0.0037828878626688933, 0.0184763901823935574,  0.0462288017090857761, -0.0100726097387695279, -0.0214583838696109364, 0.0302096181987065240,  0.0029441976336309428, 0.0083052144992038814, 0.0354351789432449660, -0.0012941558306047750,  0.0227373130637037145, 0.0243758281946998764, -0.0718232154534487049, -0.0100726097387695279,  0.0906246749818859498, 0.0730208200767004795, 0.0597696222430394719, -0.0088145215248828044, -0.0112908196409779449, 0.0417863787628319494, -0.0024417686964614020, 0.0328229583980094788,  0.0344393477392496011, -0.1197582357586473162, -0.0214583838696109329, 0.0730208200767005211,  0.1799473863134831986, 0.0357443279952537746, 0.0187838606012037806, 0.0429387234030273734,  0.0176261251563734032, -0.0152229792294686639, 0.0148675101822077667, 0.0154857440867157276, -0.0214966430470702255, -0.0039883535192434287,
                  0.0167431246471781807, 0.0337369367591755787,  0.0187838606012037737, 0.0778269706904730074, 0.0639727861054083802, 0.0121053309485097474, -0.0209035442074435550, 0.0131764627558757525, 0.0032907472068902498, 0.0069057127808981791,  0.0076793272659196488, 0.0058762489017053672, -0.0084163615552328847, 0.0429387234030273734,  0.0639727861054083802, 0.1722244061171773755, 0.0293641126190522968, -0.0395127891929698549,  0.0264900947059089724, 0.0197471666578530360, 0.0185794862660447618, 0.0111964928886216994,  0.0110525994641521991, -0.0110945105152440472, 0.0176261251563733859, 0.0121053309485097300,  0.0293641126190522864, 0.0539825174130073582, -0.0080821076069339526, 0.0144164251877730402,  0.0162099762684597866, -0.0199932020225936438, 0.0016952407749798119, 0.0225998085838039972,  0.0228788705903524084, -0.0152229792294686569, -0.0209035442074436487, -0.0395127891929697647, -0.0080821076069339179, 0.0527449124104252473, -0.0100701985237535221, -0.0082638667666436356, -0.0004251798846757322, -0.0020504191531696115, -0.0031356275968381113, -0.0044641679468201863,  0.0148675101822077407, 0.0131764627558757993, 0.0264900947059089342, 0.0144164251877730264, -0.0100701985237535048, 0.0434876165023446865, 0.0110795395513434980, -0.0138034733974985030,  0.0003691350455453791, 0.0140917377927293752, 0.0174727983491972869, 0.0154857440867157258,  0.0032907472068902602, 0.0197471666578530151, 0.0162099762684597797, -0.0082638667666436391,  0.0110795395513434893, 0.0475514107479612716, -0.0131897259083799331, -0.0021450981864993427,  0.0137072788441822725, 0.0189682050066888562, -0.0214966430470702741, 0.0069057127808981955,  0.0185794862660447341, -0.0199932020225936577, -0.0004251798846757217, -0.0138034733974984319, -0.0131897259083799366, 0.1022591302306897487, 0.0145265441095187731, -0.0376552774647530009, -0.0696458432188979959, -0.0039883535192434304, 0.0076793272659196887, 0.0111964928886216473,  0.0016952407749798127, -0.0020504191531696301, 0.0003691350455453856, -0.0021450981864993236,  0.0145265441095187818, 0.0431195361999233417, -0.0065732146495725207, -0.0177284828576516028,  0.0167431246471781876, 0.0058762489017053941, 0.0110525994641521956, 0.0225998085838039764, -0.0031356275968381004, 0.0140917377927293752, 0.0137072788441822760, -0.0376552774647530564, -0.0065732146495724843, 0.0650572070005597108, 0.0404232744589142975, 0.0337369367591755370, -0.0084163615552328985, -0.0110945105152440177, 0.0228788705903524223, -0.0044641679468201950,  0.0174727983491973909, 0.0189682050066888423, -0.0696458432188979126, -0.0177284828576515924,  0.0404232744589142906, 0.1274342391849143941, 0.0497400297125233926, 0.0382984275745206701,  0.0801492865809485533, 0.0284247973040912816, -0.0271750958208217541, 0.0229845952308154293,  0.0243625131936422747, -0.0231204015153166839, -0.0021464265410875228, 0.0253945806924136090,  0.0356007329299677516, 0.0382984275745206770, 0.0971274741667843416, 0.1048669943089465678,  0.0261777500289367172, -0.0352139561689320674, 0.0234990129122488664, 0.0158696582501341964, -0.0012096087523571224, 0.0072264499781316792, 0.0214663120851960772, 0.0054235132468679744,  0.0801492865809485810, 0.1048669943089464984, 0.2522832155567822920, 0.0549290399534205290, -0.0664555906246877964, 0.0452552697796260311, 0.0414235253253083038, 0.0106586294503339084,  0.0134554620125994298, 0.0350856437250726752, 0.0052294218705090552, 0.0284247973040912850,  0.0261777500289367103, 0.0549290399534205220, 0.0602558703421073177, -0.0175984463566082432,  0.0212140046791610901, 0.0239267039890196792, -0.0249378870779304006, 0.0012275705119672714,  0.0317326753476671469, 0.0291254991919986800, -0.0271750958208217541, -0.0352139561689321159, -0.0664555906246877548, -0.0175984463566082154, 0.0620988573207224975, -0.0174458529282456865, -0.0166724704574235973, 0.0067889854847903172, -0.0010808825310675151, -0.0151257042295398648, -0.0152582267720093694, 0.0229845952308154119, 0.0234990129122488664, 0.0452552697796260381,  0.0212140046791610797, -0.0174458529282456691, 0.0485393530482083127, 0.0177422974484859018, -0.0214509139884192339, -0.0010710819191225996, 0.0241022236121148752, 0.0269471201462424051,  0.0243625131936422677, 0.0158696582501342276, 0.0414235253253082691, 0.0239267039890196688, -0.0166724704574236077, 0.0177422974484858949, 0.0531406847836403892, -0.0199050104736150021, -0.0023105808603491175, 0.0228326972498529707, 0.0261889344272682109, -0.0231204015153166909, -0.0012096087523571311, 0.0106586294503338806, -0.0249378870779303624, 0.0067889854847903146, -0.0214509139884192131, -0.0199050104736149917, 0.1167504717061011443, 0.0182128523560799449, -0.0522358404560015130, -0.0844543233631050438, -0.0021464265410875271, 0.0072264499781316991,  0.0134554620125994125, 0.0012275705119672818, -0.0010808825310675029, -0.0010710819191226278, -0.0023105808603491131, 0.0182128523560799623, 0.0426833910607821027, -0.0092556409354034100, -0.0212507168754150939, 0.0253945806924135882, 0.0214663120851960737, 0.0350856437250726474,  0.0317326753476671330, -0.0151257042295398700, 0.0241022236121149168, 0.0228326972498529637, -0.0522358404560016101, -0.0092556409354034412, 0.0789966867983174503, 0.0559683730612211827,  0.0356007329299677239, 0.0054235132468679345, 0.0052294218705089997, 0.0291254991919987251, -0.0152582267720093902, 0.0269471201462425231, 0.0261889344272682179, -0.0844543233631051271, -0.0212507168754151286, 0.0559683730612212937, 0.1399643616555109049, 0.0451437418893641043,  0.0326318397410594457, 0.0684000498721793887, 0.0240896939469048450, -0.0227255911547396584,  0.0192546239499636548, 0.0200906714261645733, -0.0223369042272443599, -0.0020985296160529769,  0.0230229495833586678, 0.0332510946699020732, 0.0326318397410594457, 0.0934571242913634082,  0.0942065945909704994, 0.0235071725473032164, -0.0311809299044993639, 0.0188066002376489627,  0.0108028774040850716, -0.0054980982823094968, 0.0077626645285846698, 0.0195400123518532851,  0.0050494496084822101, 0.0684000498721793887, 0.0942065945909704994, 0.2252920638151445498,  0.0482242200516460051, -0.0566107946466561443, 0.0355564125993234961, 0.0312206625408393730,  0.0065742515754418467, 0.0142639800920347712, 0.0313604283975427722, 0.0014717104168424557,  0.0240896939469048554, 0.0235071725473032095, 0.0482242200516459982, 0.0558814428730744286, -0.0149192001132770809, 0.0176230906710198067, 0.0199495695635317737, -0.0203706454557164747,  0.0023709225709005123, 0.0268207443729898652, 0.0233438325469937993, -0.0227255911547396688, -0.0311809299044993639, -0.0566107946466561304, -0.0149192001132770532, 0.0588219393797917017, -0.0132503780415975086, -0.0125795553955866512, 0.0084007337752726036, -0.0016386826503587593, -0.0118970067326525236, -0.0137484822995656078, 0.0192546239499636548, 0.0188066002376489801,  0.0355564125993235308, 0.0176230906710198171, -0.0132503780415974878, 0.0447464136289789302,  0.0137044632099095794, -0.0208691518866550609, -0.0003351876550806579, 0.0197249898334622698,  0.0244653511684393629, 0.0200906714261645768, 0.0108028774040850768, 0.0312206625408393730,  0.0199495695635317737, -0.0125795553955866390, 0.0137044632099095707, 0.0495453973227227909, -0.0163513275789484436,
                  -0.0013668044862034541, 0.0185377409173931584, 0.0214656466387778341, -0.0223369042272443669, -0.0054980982823095350, 0.0065742515754418389, -0.0203706454557164539,  0.0084007337752725845, -0.0208691518866549811, -0.0163513275789484262, 0.1130425580251438189,  0.0159314171185934370, -0.0439592640494345932, -0.0808675176050524525, -0.0020985296160529916,  0.0077626645285846707, 0.0142639800920347521, 0.0023709225709005349, -0.0016386826503587467, -0.0003351876550806853, -0.0013668044862034578, 0.0159314171185934821, 0.0417977343078681993, -0.0062325499870330477, -0.0190691896297905707, 0.0230229495833586678, 0.0195400123518532885,  0.0313604283975427861, 0.0268207443729898722, -0.0118970067326525254, 0.0197249898334623079,  0.0185377409173931515, -0.0439592640494346001, -0.0062325499870331223, 0.0704678776215234143,  0.0463790794522256980, 0.0332510946699020732, 0.0050494496084821632, 0.0014717104168424592,  0.0233438325469938063, -0.0137484822995655852, 0.0244653511684394115, 0.0214656466387778272, -0.0808675176050523969, -0.0190691896297905845, 0.0463790794522257258, 0.1360065608489532951,  0.0546304576605902772, 0.0375990972669060647, 0.0773890196976368822, 0.0275921328714588097, -0.0231151790698990028, 0.0211968910349300023, 0.0219537288345612105, -0.0217424950019131577,  0.0003252094864008436, 0.0246105712160570242, 0.0313300336885899006, 0.0375990972669060577,  0.0991648097254292094, 0.1052716628417586786, 0.0200130654324451353, -0.0297937235232060942,  0.0177773428938630094, 0.0115756097306406267, 0.0137342462633987718, 0.0134734891898095187,  0.0095512012060260977, -0.0117226070704510941, 0.0773890196976368822, 0.1052716628417587202,  0.2493899491700051207, 0.0434510043161501006, -0.0563113301401353059, 0.0334255564219990628,  0.0326705047814391109, 0.0434169425367603445, 0.0257554174328705407, 0.0132122321292613594, -0.0311583171679900954, 0.0275921328714588202, 0.0200130654324451318, 0.0434510043161501075,  0.0558350738692290557, -0.0103828514857253942, 0.0159568382130105026, 0.0190939871428896027, -0.0156906283260182210, 0.0041908609297218596, 0.0244197030172092107, 0.0169980081066557764, -0.0231151790698990098, -0.0297937235232060595, -0.0563113301401352989, -0.0103828514857253855,  0.0566762732768699290, -0.0103466628234912157, -0.0107463874032897293, -0.0061710017887048876, -0.0049964889027750989, -0.0028722597681187880, -0.0007669299453107984, 0.0211968910349300023,  0.0177773428938629886, 0.0334255564219990767, 0.0159568382130105130, -0.0103466628234912001,  0.0452857216521891995, 0.0121307342114292810, -0.0170487487125394362, 0.0004488318131049318,  0.0173737932728488809, 0.0205568527461882401, 0.0219537288345612001, 0.0115756097306406215,  0.0326705047814391109, 0.0190939871428896027, -0.0107463874032897172, 0.0121307342114292775,  0.0493688396915473587, -0.0086172114503176508, 0.0007923897701246776, 0.0149617999056284728,  0.0126993571324633247, -0.0217424950019131612, 0.0137342462633987389, 0.0434169425367603862, -0.0156906283260181967, -0.0061710017887049171, -0.0170487487125393980, -0.0086172114503176300,  0.1282277581213895068, 0.0214068131916759601, -0.0476940878659793746, -0.0878079432145598693,  0.0003252094864008388, 0.0134734891898095101, 0.0257554174328705372, 0.0041908609297218770, -0.0049964889027750755, 0.0004488318131049150, 0.0007923897701246703, 0.0214068131916759843,  0.0453304576095742429, -0.0078075588518525391, -0.0234959873372279048, 0.0246105712160570242,  0.0095512012060260942, 0.0132122321292613802, 0.0244197030172092037, -0.0028722597681187928,  0.0173737932728488982, 0.0149617999056284728, -0.0476940878659793815, -0.0078075588518525599,  0.0720955628644402019, 0.0465315145341253927, 0.0313300336885898936, -0.0117226070704511080, -0.0311583171679900364, 0.0169980081066557764, -0.0007669299453108066, 0.0205568527461882436,  0.0126993571324633178, -0.0878079432145599248, -0.0234959873372279221, 0.0465315145341253927,  0.1396375397445625832, 0.0569367895939884711, 0.0174689402170341290, 0.0382330446149549141,  0.0266378206169947500, -0.0163347273436484225, 0.0224945577728042564, 0.0229520719665545943, -0.0589409742542580176, -0.0099898633893295875, 0.0385909340507015475, 0.0689923382417200054,  0.0174689402170341047, 0.0784903820779159628, 0.0544139600311685095, 0.0064385969297837391, -0.0234419321500171467, 0.0139889956667383734, 0.0019371868565814740, -0.0052275423520415903, -0.0014446138870840462, 0.0100526238561383010, 0.0090274770376521773, 0.0382330446149549349,  0.0544139600311685442, 0.1377988393366177122, 0.0197283417538101045, -0.0401280234301886335,  0.0268183675121233638, 0.0152863241943317751, -0.0060241844226272068, -0.0039067615469152005,  0.0199479984756369307, 0.0206774990194668919, 0.0266378206169947396, 0.0064385969297837365,  0.0197283417538100837, 0.0540927516688727780, -0.0063650788609105049, 0.0136027444098753975,  0.0181984493772286045, -0.0296294849898162023, -0.0014484438038021054, 0.0270160628777588070,  0.0315795256012037576, -0.0163347273436484156, -0.0234419321500171397, -0.0401280234301886335, -0.0063650788609105067, 0.0595474596330574368, -0.0103764752947543143, -0.0079486495078420361,  0.0029892748058380370, 0.0024417626361938429, -0.0043657208720186708, -0.0125312859611460999,  0.0224945577728042495, 0.0139889956667383613, 0.0268183675121233568, 0.0136027444098753801, -0.0103764752947543143, 0.0461707196087741065, 0.0114242775934772535, -0.0201469165562363495, -0.0025436526835248890, 0.0169198340694329506, 0.0252379897436075043, 0.0229520719665545839,  0.0019371868565814865, 0.0152863241943317681, 0.0181984493772286079, -0.0079486495078420431,  0.0114242775934772639, 0.0521509134780148015, -0.0217992590011559413, -0.0034348966761655495,  0.0190429109707159726, 0.0268472586397622663, -0.0589409742542580245, -0.0052275423520416198, -0.0060241844226271947, -0.0296294849898162335, 0.0029892748058380613, -0.0201469165562363356, -0.0217992590011559170, 0.1241984013668689657, 0.0129999632958218963, -0.0514718072573056434, -0.0833352641681031625, -0.0099898633893295910, -0.0014446138870840692, -0.0039067615469151936, -0.0014484438038020902, 0.0024417626361938520, -0.0025436526835248929, -0.0034348966761655504,  0.0129999632958219067, 0.0434664114016911352, -0.0078747661449358498, -0.0163822882492316163,  0.0385909340507015267, 0.0100526238561382958, 0.0199479984756369237, 0.0270160628777587758, -0.0043657208720186778, 0.0169198340694329541, 0.0190429109707159760, -0.0514718072573055949, -0.0078747661449358637, 0.0766323868334336522, 0.0520212793196010923, 0.0689923382417200193,  0.0090274770376521929, 0.0206774990194668676, 0.0315795256012037714, -0.0125312859611460790,  0.0252379897436075182, 0.0268472586397622767, -0.0833352641681032041, -0.0163822882492315990,  0.0520212793196011269, 0.1434278137140076737, 0.0562909939056830122, 0.0196663590513499464,  0.0365332437981971750, 0.0271506882958320352, -0.0168763304829981087, 0.0231124162849584043,  0.0222997108781906629, -0.0583612412946969417, -0.0101530861598573847, 0.0379354565877788596,  0.0707553843576516073, 0.0196663590513499464, 0.1017112119894928168, 0.0795687975430821592,  0.0081953837428163298, -0.0269527730858873070, 0.0175866617942643244, -0.0010941151318956980,
                  0.0065521472484384811, 0.0043731579532861565, 0.0044012358779850014, -0.0101689829586428786,  0.0365332437981971750, 0.0795687975430821592, 0.1872142996140080951, 0.0245391939852342700, -0.0482650899122376645, 0.0283976147986434342, 0.0149623116031402173, 0.0237915888172961498,  0.0047596095615986536, 0.0073906541210240709, -0.0155599710364917546, 0.0271506882958320352,  0.0081953837428163298, 0.0245391939852342700, 0.0658047495978103109, -0.0084975032496015391,  0.0178350797448629701, 0.0245144205406488472, -0.0310658881851061559, 0.0003205423296087423,  0.0314003366563680442, 0.0340264235320264855, -0.0168763304829981087, -0.0269527730858873070, -0.0482650899122376645, -0.0084975032496015391, 0.0671370355301118271, -0.0133459334092883870, -0.0097719986686769303, -0.0004388986167159171, 0.0004188327584560874, -0.0015451742021388309, -0.0071619184719495799, 0.0231124162849584043, 0.0175866617942643244, 0.0283976147986434342,  0.0178350797448629701, -0.0133459334092883870, 0.0568120985881462592, 0.0145558338959935109, -0.0286358621712550845, -0.0028228286439883994, 0.0220799505755982506, 0.0332377340302991986,  0.0222997108781906629, -0.0010941151318956980, 0.0149623116031402173, 0.0245144205406488472, -0.0097719986686769303, 0.0145558338959935109, 0.0638420634464143266, -0.0269300306168051735, -0.0044865282866332181, 0.0236656127244495654, 0.0347592340953502485, -0.0583612412946969417,  0.0065521472484384811, 0.0237915888172961498, -0.0310658881851061559, -0.0004388986167159171, -0.0286358621712550845, -0.0269300306168051735, 0.1578884480830564097, 0.0178936816312022691, -0.0658708421953520251, -0.1135061588811079880, -0.0101530861598573847, 0.0043731579532861565,  0.0047596095615986536, 0.0003205423296087423, 0.0004188327584560874, -0.0028228286439883994, -0.0044865282866332181, 0.0178936816312022691, 0.0501116442373916934, -0.0095945293396901155, -0.0215225790245768822, 0.0379354565877788596, 0.0044012358779850014, 0.0073906541210240709,  0.0314003366563680442, -0.0015451742021388309, 0.0220799505755982506, 0.0236656127244495654, -0.0658708421953520251, -0.0095945293396901155, 0.0912626318996398456, 0.0665733520328917194,  0.0707553843576516073, -0.0101689829586428786, -0.0155599710364917546, 0.0340264235320264855, -0.0071619184719495799, 0.0332377340302991986, 0.0347592340953502485, -0.1135061588811079880, -0.0215225790245768822, 0.0665733520328917194, 0.1822712216538368291 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$n_iter),
               c(12 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$Q),
               c( 0.358020556865647044, 0.259277173053352517, 0.561431827494945024, 0.262678695715435395, -0.111608800820350337,  0.148313568851910438, 0.188390145679481924, -0.059464114894498564, 0.069090794969369901, 0.212797394618069624,  0.053432596110293065, 0.259277173053352517, 1.022218180634146822, 1.663235846535923157, 0.251973417735177507, -0.561194077846880246, 0.280168380200381928, 0.133206617639874125, 0.377351007992750731, 0.152108349530929471,  0.059406211648745461, -0.326753089205042757, 0.561431827494945024, 1.663235846535923157, 2.943349440062594358,  0.414909400161958875, -0.854700683215706691, 0.366496970214028162, 0.233543050172938638, 1.053958669454810870,  0.380261325410562567, -0.078231365026017019, -0.994465343013327563, 0.262678695715435395, 0.251973417735177507,  0.414909400161958875, 0.322843318749494568, -0.187692172879099617, 0.259446100470225538, 0.227966751856685718, -0.507652701336491541, -0.056671890881222847, 0.429488120284109209, 0.537496705144619336, -0.111608800820350337, -0.561194077846880246, -0.854700683215706691, -0.187692172879099617, 0.368451462304787480, -0.230173203879265209, -0.112506030994800776, 0.069178516825374320, -0.009813727189810207, -0.175727919508135905, -0.122728178504065116,  0.148313568851910438, 0.280168380200381928, 0.366496970214028162, 0.259446100470225538, -0.230173203879265209,  0.272970722846386515, 0.179112344318567457, -0.556693576898948495, -0.095571959045730417, 0.412149609311622811,  0.601087569471188798, 0.188390145679481924, 0.133206617639874125, 0.233543050172938638, 0.227966751856685718, -0.112506030994800776, 0.179112344318567457, 0.176676662245769028, -0.391759689168048486, -0.049062060866470310,  0.316700214402321656, 0.414341619870716993, -0.059464114894498564, 0.377351007992750731, 1.053958669454810870, -0.507652701336491541, 0.069178516825374320, -0.556693576898948495, -0.391759689168048486, 2.558747603178308516,  0.589878032665847152, -1.368983686466504146, -2.644646444659957574, 0.069090794969369901, 0.152108349530929471,  0.380261325410562567, -0.056671890881222847, -0.009813727189810207, -0.095571959045730417, -0.049062060866470310,  0.589878032665847152, 0.164899055594413479, -0.273921949705384915, -0.614841324051712657, 0.212797394618069624,  0.059406211648745461, -0.078231365026017019, 0.429488120284109209, -0.175727919508135905, 0.412149609311622811,  0.316700214402321656, -1.368983686466504146, -0.273921949705384915, 0.861064444866115664, 1.427900335394751696,  0.053432596110293065, -0.326753089205042757, -0.994465343013327563, 0.537496705144619336, -0.122728178504065116,  0.601087569471188798, 0.414341619870716993, -2.644646444659957574, -0.614841324051712657, 1.427900335394751696,  2.761453393666073008 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$method),
               c("EKF" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$model),
               c("exponential" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$LR),
               c(0.05852766346593507 )
               , tolerance = 1e-05)
})

test_that("Unmacthed control variable throw error",
          expect_error({
            result = ddhazard(
              formula = survival::Surv(start, stop, event) ~ group,
              data = head_neck_cancer,
              by = 1, # Use by month intervals
              a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
              max_T = 45,
              id = head_neck_cancer$id, order = 1,
              control = list("None_existing_parem" = 1)
            )}, regexp = "These control parameters are not recognized"))

test_that("Using alternated inverse covariance matrix in EKF with exponential model yields previously computed values", {
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(10, 11),
    Q = diag(1e-2, 11),
    control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^3,
                   EKF_inv_Cov_method = "not org"),
    max_T = 10,
    id = sims$res$id, order = 1,
    verbose = F,
    model = "exponential"))

  # get_expect_equal(result_exp, eps = 1e-5, file = "tmp.txt")
  # matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
  # matplot(result_exp$times, result_exp$state_vecs, result_exp$state_vecs, type = "l", lty = 2, add = T)

  expect_equal(c(result_exp$state_vecs),
               c(-5.37491499453456711, -5.37838561956256189, -4.82120214005348124, -4.57774126114250723, -4.37250249850003758, -4.36263736954901749, -4.37576778478690009, -4.30796374816606686, -3.96478025282279178, -4.05884163933298581, -4.06139385848421863, 0.62136248372161029, 0.62493458521790513, 0.74299025525156615, -0.39825497767733964, -1.45633073143722536, -2.22559221312591493, -2.06822623767243163, -2.23007683229433917, -1.61701543132215342, -1.53649477936356083, -1.05616071482902862, -1.97749961606802049, -1.97881595587375569, -0.57669067545861985, -2.44822473362939075, -4.13040023170904291, -5.51716864433489995, -4.95402996774829329, -4.95447727752580747, -2.85942847533379929, -3.08189629183477276, -2.23547613479184593, 1.00606836485592921, 1.00849103278899666,  0.75210260342984592, 0.52387510804844872, 0.31800579639583876, 0.19955092367601179, 0.18928931604373625,  0.08735798545854222, -0.04791068228869577, 0.08318004669572661, 0.20389970557152162, 1.54727598954221035,  1.54470660503176260, 1.63482883510482080, 2.28203085502065584, 2.87229618106439766, 3.24987579696851236,  3.13222630689859072, 3.22218833251401549, 2.98440816190581604, 2.93712750847187554, 2.71757049535431960,  0.59058706612362832, 0.59567850250647014, -0.17273648191381219, -0.35954944340969364, -0.54176236481989193, -0.56444649712038220, -0.68368263961922482, -0.86762310541703425, -1.45613685779407054, -1.22641122282940129, -1.16940644097553026, -0.28072525083253491, -0.27944565496356610, -0.45802462223737783, -0.52684459252313376, -0.58014174739532576, -0.59861885567120932, -0.60309878583613863, -0.64693742798975917, -0.78143413541395512, -0.71396365104266191, -0.67560957514061215, 0.79000280334054462, 0.77728444342701419, 3.37211417702639249,  2.74282635801478003, 2.22770624639737225, 1.47810731419400221, 2.09981672313806778, 2.50088432044739539,  5.10103955217750560, 4.44271150512847957, 4.76700198785209395, 1.60243169246471040, 1.60044167530069581,  2.06637056127744057, 1.91842821228627214, 1.79095011951254390, 1.62022624217503308, 1.71565560527511840,  1.75045295235447540, 2.22247147093365394, 2.14085607244094867, 2.23424197427617077, 1.95984215314049925,  1.96869661532479379, 0.44792822962526402, 0.47222385663508121, 0.46641360407964061, 0.67810386562519609,  0.34856655477029530, 0.04460437790988175, -1.34395601438959700, -0.90551110507820032, -0.89425338157076428, -3.37953113305516251, -3.36866884948570311, -5.63146480649819470, -5.10169842348046476, -4.65192237475799164, -3.97254029809158205, -4.47722333050160959, -4.80247779250813167, -7.04845819725316147, -6.51649582508983016, -6.83522567448175256 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$state_vars),
               c( 1.685901075026752e-01, -1.070897760618673e-01, -3.096885226292929e-02, -5.372608171222829e-02,  7.979358310940199e-02, -1.052626824792337e-01, -2.397106648280096e-02, 1.908216832079230e-01,  2.386001664806245e-02, -1.658557147727988e-01, -1.468423540042886e-01, -1.070897760618673e-01,  7.844097705192272e-01, 1.004684839983574e+00, 1.454836518920367e-01, -3.522779569953190e-01,  1.342475149889229e-01, 4.431982326283665e-02, 2.578848485834337e-01, 8.484287847779956e-02,  5.123261640441776e-02, -2.393766247234175e-01, -3.096885226292926e-02, 1.004684839983574e+00,  2.072643731309848e+00, 1.456268288764662e-01, -5.232919952498224e-01, -1.288318797103063e-02,  2.849564824246953e-02, 1.144318904519704e+00, 2.424522842144922e-01, -3.713408427398605e-01, -9.812517375898829e-01, -5.372608171222829e-02, 1.454836518920368e-01, 1.456268288764662e-01,  1.696992320892381e-01, -7.849290648742006e-02, 8.819559813567263e-02, 3.403672747253363e-02, -1.157008258792878e-01, -9.250868836579741e-04, 1.292320715287860e-01, 8.881982438425001e-02,  7.979358310940206e-02, -3.522779569953190e-01, -5.232919952498225e-01, -7.849290648742011e-02,  3.338812234088540e-01, -8.747723842289300e-02, -3.369571099278635e-02, -9.589811561618734e-02, -3.258675345141932e-02, -4.186074846865413e-02, 7.603913700119790e-02, -1.052626824792337e-01,  1.342475149889228e-01, -1.288318797103061e-02, 8.819559813567263e-02, -8.747723842289302e-02,  2.788929347846167e-01, 4.741320576347153e-02, -4.006223724554726e-01, -5.218634728136070e-02,  2.894526357013904e-01, 3.367817704749629e-01, -2.397106648280097e-02, 4.431982326283664e-02,  2.849564824246955e-02, 3.403672747253363e-02, -3.369571099278632e-02, 4.741320576347154e-02,  1.282843499377613e-01, -8.260102188306576e-02, -9.543496908737308e-03, 6.956442930851590e-02,  7.280182634376008e-02, 1.908216832079231e-01, 2.578848485834336e-01, 1.144318904519704e+00, -1.157008258792878e-01, -9.589811561618722e-02, -4.006223724554724e-01, -8.260102188306576e-02,  1.734724108756547e+00, 2.721705015041420e-01, -8.914575824320063e-01, -1.356060016365836e+00,  2.386001664806244e-02, 8.484287847779946e-02, 2.424522842144921e-01, -9.250868836579561e-04, -3.258675345141933e-02, -5.218634728136073e-02, -9.543496908737287e-03, 2.721705015041420e-01,  1.804548238238315e-01, -1.403476694854059e-01, -2.403608596725863e-01, -1.658557147727988e-01,  5.123261640441755e-02, -3.713408427398603e-01, 1.292320715287860e-01, -4.186074846865408e-02,  2.894526357013904e-01, 6.956442930851583e-02, -8.914575824320066e-01, -1.403476694854061e-01,  6.889558392869706e-01, 7.433871846784467e-01, -1.468423540042886e-01, -2.393766247234175e-01, -9.812517375898828e-01, 8.881982438425011e-02, 7.603913700119806e-02, 3.367817704749629e-01,  7.280182634376009e-02, -1.356060016365836e+00, -2.403608596725864e-01, 7.433871846784467e-01,  1.338017294545901e+00, 9.690191945344850e-02, -4.583123740922494e-02, -1.197520394034390e-02, -2.227966864888903e-02, 2.915855870452427e-02, -3.912628012313843e-02, -6.213425953422821e-03,  4.816484172684374e-02, -2.299851312471235e-03, -6.212556731535446e-02, -1.842055221818883e-02, -4.583123740922494e-02, 4.884720350876424e-01, 5.562224096845618e-01, 8.290904954469970e-02, -1.926799792939866e-01, 7.532561596918545e-02, 2.467855815757088e-02, 1.406489148755807e-01,  5.316591543148933e-02, 3.278973877083900e-02, -1.372109692602434e-01, -1.197520394034385e-02,  5.562224096845619e-01, 1.177910946603299e+00, 8.936926289144657e-02, -2.911353779129118e-01,  1.333786887269189e-02, 2.339787232337603e-02, 5.806833259255153e-01, 1.285992259075608e-01, -1.718886475684160e-01, -4.975560630409994e-01, -2.227966864888903e-02, 8.290904954469971e-02,  8.936926289144657e-02, 1.363828192564465e-01, -3.998394548603386e-02, 4.708594890171072e-02,  2.120949780300203e-02, -5.245136767415751e-02, 6.122526644713147e-03, 6.923641129295180e-02,  3.587375607215007e-02, 2.915855870452433e-02, -1.926799792939866e-01, -2.911353779129119e-01, -3.998394548603391e-02, 2.316694853185419e-01, -4.209180433459969e-02, -1.922177441513148e-02, -6.873461472828646e-02, -2.352230969743023e-02, -1.058191004755765e-02, 5.566160955777328e-02, -3.912628012313839e-02, 7.532561596918548e-02, 1.333786887269192e-02, 4.708594890171075e-02, -4.209180433459969e-02, 1.832110838077972e-01, 2.485341741553613e-02, -1.798736353376979e-01, -1.648966357896878e-02, 1.374896099958066e-01, 1.473114258235336e-01, -6.213425953422821e-03,  2.467855815757085e-02, 2.339787232337606e-02, 2.120949780300203e-02, -1.922177441513144e-02,  2.485341741553614e-02, 1.141690676359568e-01, -3.325728867430938e-02, -2.014409109851747e-03,  3.234186448445747e-02, 3.023600737220884e-02, 4.816484172684385e-02, 1.406489148755807e-01,  5.806833259255155e-01, -5.245136767415751e-02, -6.873461472828629e-02, -1.798736353376978e-01, -3.325728867430940e-02, 8.915465251937515e-01, 1.228825757620731e-01, -4.216772385746402e-01, -6.387994758423348e-01, -2.299851312471235e-03, 5.316591543148928e-02, 1.285992259075606e-01,  6.122526644713161e-03, -2.352230969743023e-02, -1.648966357896882e-02, -2.014409109851734e-03,  1.228825757620733e-01, 1.444988371628115e-01, -6.056937951377378e-02, -1.104460499655087e-01, -6.212556731535451e-02, 3.278973877083875e-02, -1.718886475684158e-01, 6.923641129295181e-02, -1.058191004755758e-02, 1.374896099958066e-01, 3.234186448445742e-02, -4.216772385746405e-01, -6.056937951377389e-02, 3.884985073741318e-01, 3.420715684605565e-01, -1.842055221818895e-02, -1.372109692602435e-01, -4.975560630409992e-01, 3.587375607215014e-02, 5.566160955777343e-02,  1.473114258235335e-01, 3.023600737220887e-02, -6.387994758423348e-01, -1.104460499655087e-01,  3.420715684605564e-01, 7.116123272812724e-01, 9.023915367818508e-02, -3.627129709324349e-02,  1.225627587149147e-02, -2.164602391429679e-02, 2.377927469567089e-02, -4.256382299351980e-02, -5.922028084789380e-03, 7.053633038050786e-02, 1.550170418629843e-03, -7.225709209592024e-02, -3.788513649099234e-02, -3.627129709324346e-02, 3.966556874784861e-01, 4.358737548053662e-01,  6.135203923759994e-02, -1.521016092070644e-01, 5.512144172985689e-02, 1.755976322015259e-02,  1.201531154952952e-01, 4.245084210753531e-02, 1.787280746620745e-02, -1.115251741142906e-01,  1.225627587149136e-02, 4.358737548053662e-01, 9.885958991508905e-01, 5.793445928355281e-02, -2.272481061190689e-01, -1.431986657399739e-02, 1.090844522922277e-02, 5.445180364466223e-01,  1.141707504729593e-01, -1.897862434214138e-01, -4.594447077059274e-01, -2.164602391429675e-02,  6.135203923759991e-02, 5.793445928355276e-02, 1.217249961540223e-01, -3.085990481192290e-02,  4.124578449173176e-02, 1.762342083761274e-02, -5.712334476181165e-02, 2.156825717184761e-03,  6.270857902186716e-02, 4.316544391657860e-02, 2.377927469567086e-02, -1.521016092070644e-01, -2.272481061190688e-01, -3.085990481192292e-02, 2.041417032902351e-01, -3.545622333885899e-02, -1.602522051677136e-02, -4.716870873103646e-02, -1.690285756858569e-02, -1.151829084878083e-02,  3.444863127307192e-02, -4.256382299351974e-02, 5.512144172985694e-02, -1.431986657399729e-02,  4.124578449173175e-02, -3.545622333885903e-02, 1.724531985880584e-01, 2.313013108162026e-02, -1.867286893709721e-01, -2.059335679168446e-02, 1.339056038457407e-01,
                  1.573236310566851e-01, -5.922028084789387e-03, 1.755976322015257e-02, 1.090844522922281e-02, 1.762342083761276e-02, -1.602522051677133e-02, 2.313013108162026e-02, 1.057752300046884e-01, -3.658124308890400e-02, -3.603183420223838e-03, 3.067618730227845e-02, 3.406021259133293e-02, 7.053633038050787e-02,  1.201531154952951e-01, 5.445180364466226e-01, -5.712334476181161e-02, -4.716870873103633e-02, -1.867286893709721e-01, -3.658124308890400e-02, 8.799881838100678e-01, 1.231666294547683e-01, -4.215880030201155e-01, -6.404771223220270e-01, 1.550170418629787e-03, 4.245084210753527e-02,  1.141707504729592e-01, 2.156825717184768e-03, -1.690285756858569e-02, -2.059335679168448e-02, -3.603183420223824e-03, 1.231666294547684e-01, 1.363927983270632e-01, -6.392595378476607e-02, -1.104754818040109e-01, -7.225709209592021e-02, 1.787280746620733e-02, -1.897862434214136e-01,  6.270857902186716e-02, -1.151829084878078e-02, 1.339056038457407e-01, 3.067618730227840e-02, -4.215880030201155e-01, -6.392595378476618e-02, 3.718312051175547e-01, 3.488305590648131e-01, -3.788513649099234e-02, -1.115251741142907e-01, -4.594447077059273e-01, 4.316544391657862e-02,  3.444863127307207e-02, 1.573236310566850e-01, 3.406021259133293e-02, -6.404771223220271e-01, -1.104754818040109e-01, 3.488305590648130e-01, 7.088176969835316e-01, 6.284488190864063e-02, -4.346028066257978e-02, -4.958521587454019e-02, -1.040683384812420e-02, 1.872177048541566e-02, -9.019771005222558e-03, 3.106493988726602e-03, -3.748224015312074e-02, -1.745692827497511e-02, -8.576658440203722e-03, 5.663422223084877e-02, -4.346028066257979e-02, 2.405019095789133e-01,  1.705147996569965e-01, 3.474526591672408e-02, -7.446057853758492e-02, 4.375803620898468e-02,  1.002440046387483e-02, -6.592179911688135e-03, 1.048618405571969e-02, 4.540803556443695e-02, -1.719696151469621e-03, -4.958521587454018e-02, 1.705147996569965e-01, 3.710682336946131e-01,  3.989723568079527e-02, -9.799265081611760e-02, 4.938867595039753e-02, 1.516599867996928e-02,  5.422721159423164e-02, 1.441396534424246e-02, 1.880462571912284e-02, -4.277513412958124e-02, -1.040683384812419e-02, 3.474526591672408e-02, 3.989723568079528e-02, 1.011380148144388e-01, -1.468922507563955e-02, 1.918772635357807e-02, 9.966117621068213e-03, -1.869954580901882e-02,  5.575769582164039e-03, 2.839228677223379e-02, 1.193448138348496e-02, 1.872177048541564e-02, -7.446057853758495e-02, -9.799265081611752e-02, -1.468922507563956e-02, 1.530007479406484e-01, -2.209687106619714e-02, -9.740210220810064e-03, -1.396711552442746e-03, -4.624433402535402e-03, -1.477867059695759e-02, -3.043595451545849e-03, -9.019771005222534e-03, 4.375803620898472e-02,  4.938867595039752e-02, 1.918772635357805e-02, -2.209687106619715e-02, 1.118326712704898e-01,  9.541422291274779e-03, -3.028979395094942e-02, 4.292569311585663e-03, 3.440739120073311e-02,  2.555311218089385e-02, 3.106493988726595e-03, 1.002440046387481e-02, 1.516599867996929e-02,  9.966117621068216e-03, -9.740210220810040e-03, 9.541422291274793e-03, 9.481053471821954e-02, -3.994526852966994e-03, 1.158084838159136e-03, 7.237569230068040e-03, 6.410162920769173e-03, -3.748224015312071e-02, -6.592179911688135e-03, 5.422721159423174e-02, -1.869954580901879e-02, -1.396711552442659e-03, -3.028979395094949e-02, -3.994526852967011e-03, 2.444365821399023e-01,  9.980804857206392e-03, -7.882738572197349e-02, -1.089826582324918e-01, -1.745692827497512e-02,  1.048618405571964e-02, 1.441396534424245e-02, 5.575769582164028e-03, -4.624433402535398e-03,  4.292569311585649e-03, 1.158084838159136e-03, 9.980804857206441e-03, 1.079119015534790e-01, -5.636172487602529e-03, -1.371757942220821e-02, -8.576658440203749e-03, 4.540803556443693e-02,  1.880462571912284e-02, 2.839228677223379e-02, -1.477867059695756e-02, 3.440739120073318e-02,  7.237569230068023e-03, -7.882738572197338e-02, -5.636172487602594e-03, 1.620470079363034e-01,  6.104037893981269e-02, 5.663422223084880e-02, -1.719696151469680e-03, -4.277513412958113e-02,  1.193448138348496e-02, -3.043595451545748e-03, 2.555311218089375e-02, 6.410162920769184e-03, -1.089826582324918e-01, -1.371757942220823e-02, 6.104037893981271e-02, 2.508068100394863e-01,  5.086478825882694e-02, -1.437615545880939e-02, -2.300326692847278e-03, -3.402063458148292e-03, -1.355300819270551e-03, -2.650444763573521e-03, 4.802191089902208e-03, -2.248100905697147e-02, -1.274300321540488e-02, -6.662852050356001e-03, 4.637303845994811e-02, -1.437615545880937e-02,  2.179132558964162e-01, 1.911219202326146e-01, 2.315223807540719e-02, -6.341066793286605e-02,  1.323690172605644e-02, 4.695216570335713e-03, 6.453367453362580e-02, 2.198951782082502e-02, -2.505580585372902e-03, -6.484186112220791e-02, -2.300326692847278e-03, 1.911219202326146e-01,  4.785778550893807e-01, 2.974558234305861e-02, -1.072680432057470e-01, 4.605460132691624e-03,  6.010646987408712e-03, 2.017892847998093e-01, 4.440215610707591e-02, -6.311074842739788e-02, -1.746780893009750e-01, -3.402063458148287e-03, 2.315223807540718e-02, 2.974558234305861e-02,  8.998143079995224e-02, -7.472001767747184e-03, 1.132490382732963e-02, 7.347065234801266e-03, -7.776784980322526e-03, 5.562693458021429e-03, 1.657333550942141e-02, 2.795572771253824e-03, -1.355300819270554e-03, -6.341066793286611e-02, -1.072680432057469e-01, -7.472001767747191e-03,  1.383886926517321e-01, -3.085409099260106e-03, -6.157014220843624e-03, -4.306739831373707e-02, -1.172325667837122e-02, 1.328208793887380e-02, 3.601985130228216e-02, -2.650444763573508e-03,  1.323690172605649e-02, 4.605460132691579e-03, 1.132490382732961e-02, -3.085409099260125e-03,  9.943086604647350e-02, 7.978485045359135e-03, -3.889665989638745e-02, -7.458248967881047e-04,  2.905738108601006e-02, 3.276727276149460e-02, 4.802191089902208e-03, 4.695216570335704e-03,  6.010646987408715e-03, 7.347065234801269e-03, -6.157014220843610e-03, 7.978485045359158e-03,  8.875188793680472e-02, -5.568004041340193e-03, 6.626579863793294e-05, 5.413304955916355e-03,  7.610054710372859e-03, -2.248100905697147e-02, 6.453367453362577e-02, 2.017892847998093e-01, -7.776784980322507e-03, -4.306739831373698e-02, -3.889665989638755e-02, -5.568004041340205e-03,  3.289457901727370e-01, 3.534010174370142e-02, -1.062979114837182e-01, -1.893127178943667e-01, -1.274300321540488e-02, 2.198951782082497e-02, 4.440215610707596e-02, 5.562693458021416e-03, -1.172325667837121e-02, -7.458248967881324e-04, 6.626579863793641e-05, 3.534010174370143e-02,  1.077708996114889e-01, -1.656136220223262e-02, -3.547394264640374e-02, -6.662852050356036e-03, -2.505580585372895e-03, -6.311074842739786e-02, 1.657333550942144e-02, 1.328208793887381e-02,  2.905738108601014e-02, 5.413304955916333e-03, -1.062979114837180e-01, -1.656136220223271e-02,  1.542737672233780e-01, 8.628986298142829e-02, 4.637303845994808e-02, -6.484186112220805e-02, -1.746780893009749e-01, 2.795572771253831e-03, 3.601985130228229e-02, 3.276727276149451e-02,  7.610054710372866e-03, -1.893127178943668e-01, -3.547394264640375e-02, 8.628986298142824e-02,  3.147064343337095e-01, 4.547779196864692e-02, 1.008266630767820e-02, 3.430682683042556e-02, -1.753194380871332e-03, -1.413315169959449e-02, -3.034244790183944e-04, 4.990270864346584e-03, -6.763366060044931e-03, -8.176754725460141e-03,
                  -9.241884399160041e-03, 3.363821885462505e-02,  1.008266630767823e-02, 1.615801216705255e-01, 1.350043159073474e-01, 1.535438840490314e-02, -3.413659614083737e-02, 9.068910806383302e-04, 6.056229108982805e-04, 6.011762951755725e-02,  2.088425950846293e-02, -1.658058183748023e-02, -6.226931101169472e-02, 3.430682683042557e-02,  1.350043159073473e-01, 4.060505321096562e-01, 2.121913357079791e-02, -7.149838104549260e-02, -6.113897216784643e-04, -7.953409310319185e-05, 1.735944579102276e-01, 4.319283759732996e-02, -6.928639389670876e-02, -1.539625133293840e-01, -1.753194380871329e-03, 1.535438840490315e-02,  2.121913357079792e-02, 8.439711159640470e-02, -4.878160582752701e-03, 1.032191049777292e-02,  6.416482973251969e-03, -9.784356223219125e-03, 3.669010345864823e-03, 1.486193931994331e-02,  5.468462072421288e-03, -1.413315169959450e-02, -3.413659614083745e-02, -7.149838104549254e-02, -4.878160582752686e-03, 1.177218932807444e-01, 1.624248150614111e-03, -4.589659409489755e-03, -3.173609833274622e-02, -9.593052818820651e-03, 1.492968040637786e-02, 2.808372028647985e-02, -3.034244790184051e-04, 9.068910806383874e-04, -6.113897216785246e-04, 1.032191049777292e-02,  1.624248150614073e-03, 8.853179343434250e-02, 7.425303384412418e-03, -2.562296775818041e-02, -9.410177329120563e-04, 1.941983137371869e-02, 2.205306561910651e-02, 4.990270864346580e-03,  6.056229108982771e-04, -7.953409310318318e-05, 6.416482973251975e-03, -4.589659409489749e-03,  7.425303384412442e-03, 8.398860358180357e-02, -7.041010423633897e-03, -8.345532045147038e-04,  4.664613948771211e-03, 9.005798961866547e-03, -6.763366060044997e-03, 6.011762951755722e-02,  1.735944579102276e-01, -9.784356223219083e-03, -3.173609833274617e-02, -2.562296775818041e-02, -7.041010423633910e-03, 2.738012449789924e-01, 3.383416088765002e-02, -8.371868408126254e-02, -1.495632056543593e-01, -8.176754725460127e-03, 2.088425950846289e-02, 4.319283759733000e-02,  3.669010345864808e-03, -9.593052818820644e-03, -9.410177329120840e-04, -8.345532045146969e-04,  3.383416088765005e-02, 1.037917092406473e-01, -1.738067226977359e-02, -3.450485968126255e-02, -9.241884399160072e-03, -1.658058183748016e-02, -6.928639389670885e-02, 1.486193931994335e-02,  1.492968040637783e-02, 1.941983137371879e-02, 4.664613948771202e-03, -8.371868408126248e-02, -1.738067226977365e-02, 1.345174673820434e-01, 6.947301898952658e-02, 3.363821885462501e-02, -6.226931101169479e-02, -1.539625133293839e-01, 5.468462072421321e-03, 2.808372028647993e-02,  2.205306561910647e-02, 9.005798961866547e-03, -1.495632056543594e-01, -3.450485968126253e-02,  6.947301898952660e-02, 2.777012374046995e-01, 4.555956729160522e-02, 1.895516400118608e-02,  5.625934866396406e-02, -8.359636590631841e-04, -1.850716469985116e-02, -2.677672111993481e-03,  3.124564529103667e-03, 9.596264067002980e-03, -4.227041442935562e-03, -2.040626586407272e-02,  1.622127748024907e-02, 1.895516400118608e-02, 1.435005881927894e-01, 1.030703323640214e-01,  1.416503964085328e-02, -2.902687735647931e-02, 2.280916333912313e-03, 4.036146214537135e-03,  3.060947587792805e-02, 1.376394848307518e-02, 7.346530022958511e-04, -2.652147826348760e-02,  5.625934866396401e-02, 1.030703323640215e-01, 3.460855235853132e-01, 1.752589272433902e-02, -5.703630335593512e-02, -3.780313743740447e-03, 2.832821316110391e-04, 1.336906062198319e-01,  3.508896676297782e-02, -5.530141816413602e-02, -1.055353576257707e-01, -8.359636590631841e-04,  1.416503964085328e-02, 1.752589272433899e-02, 7.965672420824056e-02, -5.512003281350856e-03,  1.024742560699880e-02, 7.099713691077669e-03, -1.222264854374552e-02, 1.854908617283320e-03,  1.770399374774033e-02, 1.080905629168226e-02, -1.850716469985115e-02, -2.902687735647933e-02, -5.703630335593502e-02, -5.512003281350854e-03, 1.135415153108286e-01, -4.058637205292916e-04, -7.039364635175938e-03, -1.466566191778554e-02, -5.702924146615891e-03, 2.278717171180726e-03,  7.964353471919068e-03, -2.677672111993487e-03, 2.280916333912326e-03, -3.780313743740552e-03,  1.024742560699881e-02, -4.058637205293025e-04, 8.907819859838474e-02, 9.992192171770756e-03, -3.339917844852685e-02, -3.720662008459879e-03, 2.946710101315868e-02, 3.217198703133761e-02,  3.124564529103663e-03, 4.036146214537126e-03, 2.832821316110425e-04, 7.099713691077673e-03, -7.039364635175928e-03, 9.992192171770782e-03, 8.214797817783824e-02, -1.269797686137365e-02, -1.881580881368437e-03, 9.795884131100340e-03, 1.481628588139815e-02, 9.596264067002966e-03,  3.060947587792800e-02, 1.336906062198318e-01, -1.222264854374551e-02, -1.466566191778548e-02, -3.339917844852684e-02, -1.269797686137367e-02, 2.526697437317296e-01, 3.197409267414156e-02, -9.302650347809790e-02, -1.329605048044912e-01, -4.227041442935566e-03, 1.376394848307516e-02,  3.508896676297786e-02, 1.854908617283311e-03, -5.702924146615884e-03, -3.720662008459883e-03, -1.881580881368434e-03, 3.197409267414155e-02, 1.003534760077043e-01, -2.050035681792485e-02, -3.220588466903609e-02, -2.040626586407273e-02, 7.346530022958511e-04, -5.530141816413624e-02,  1.770399374774036e-02, 2.278717171180728e-03, 2.946710101315875e-02, 9.795884131100328e-03, -9.302650347809775e-02, -2.050035681792493e-02, 1.496654217393636e-01, 8.071425368086978e-02,  1.622127748024903e-02, -2.652147826348766e-02, -1.055353576257707e-01, 1.080905629168229e-02,  7.964353471919114e-03, 3.217198703133761e-02, 1.481628588139813e-02, -1.329605048044910e-01, -3.220588466903610e-02, 8.071425368086980e-02, 2.590781816684786e-01, 4.621980915850431e-02,  1.482727833806387e-02, 4.530908100310799e-02, -8.092742277761092e-04, -1.591098653765263e-02, -2.139184153848446e-04, 3.783199673691402e-03, 8.252270523331773e-04, -7.097376465901008e-03, -1.220070347636039e-02, 2.498781313144967e-02, 1.482727833806386e-02, 1.538794491986182e-01,  1.218753556400776e-01, 1.840513954506590e-02, -3.529482893916241e-02, -1.954498736526196e-03,  3.837000259261433e-03, 3.445675980933324e-02, 1.791835336934562e-02, -1.960896883188242e-03, -3.845568482906991e-02, 4.530908100310799e-02, 1.218753556400776e-01, 3.698321980489345e-01,  2.711411178725595e-02, -6.566231446541480e-02, -9.465209821436069e-03, -4.821153388783958e-05,  1.406965319289329e-01, 4.016228669210127e-02, -5.143408209274919e-02, -1.253401083782470e-01, -8.092742277761135e-04, 1.840513954506590e-02, 2.711411178725592e-02, 7.772864582615793e-02, -8.692401982816180e-03, 8.040515627902997e-03, 6.278563459027012e-03, -4.767636590945057e-03,  4.102454008032377e-03, 1.184022724709655e-02, 3.087659701359145e-03, -1.591098653765261e-02, -3.529482893916244e-02, -6.566231446541473e-02, -8.692401982816175e-03, 1.159796159796281e-01,  1.156784846848341e-03, -6.886306741842667e-03, -1.365554939783357e-02, -7.784230153185946e-03,  2.525784821832889e-03, 1.232176553662346e-02, -2.139184153848489e-04, -1.954498736526197e-03, -9.465209821436109e-03, 8.040515627902999e-03, 1.156784846848338e-03, 8.618507411006718e-02,  8.613363637181482e-03, -3.751704240595290e-02, -2.921438717550642e-03, 2.430097085319246e-02,  3.423456489071743e-02, 3.783199673691401e-03, 3.837000259261422e-03, -4.821153388784218e-05,  6.278563459027013e-03, -6.886306741842654e-03, 8.613363637181501e-03, 8.019279682170360e-02, -1.109945282748732e-02,
                  -9.106909087092559e-04, 7.148070785490689e-03, 1.297698943133808e-02,  8.252270523331478e-04, 3.445675980933320e-02, 1.406965319289328e-01, -4.767636590945053e-03, -1.365554939783354e-02, -3.751704240595294e-02, -1.109945282748733e-02, 2.646312968589406e-01,  3.167106791070420e-02, -8.252682202562503e-02, -1.474172338412466e-01, -7.097376465901009e-03,  1.791835336934561e-02, 4.016228669210130e-02, 4.102454008032367e-03, -7.784230153185941e-03, -2.921438717550653e-03, -9.106909087092567e-04, 3.167106791070422e-02, 9.890238353083725e-02, -1.622899605738831e-02, -3.282722209073995e-02, -1.220070347636044e-02, -1.960896883188254e-03, -5.143408209274930e-02, 1.184022724709657e-02, 2.525784821832905e-03, 2.430097085319250e-02,  7.148070785490679e-03, -8.252682202562490e-02, -1.622899605738836e-02, 1.300012714900114e-01,  7.152555659065553e-02, 2.498781313144967e-02, -3.845568482906998e-02, -1.253401083782470e-01,  3.087659701359153e-03, 1.232176553662351e-02, 3.423456489071742e-02, 1.297698943133807e-02, -1.474172338412465e-01, -3.282722209073995e-02, 7.152555659065553e-02, 2.742651577415615e-01,  4.824086150194780e-02, 1.851135177309875e-02, 4.919445282763738e-02, 2.026343608529330e-03, -1.931904551997846e-02, 9.567961972648418e-04, 5.586295194090445e-03, -6.021924335562422e-03, -6.508053299023071e-03, -8.460044324054087e-03, 2.958283058369288e-02, 1.851135177309876e-02,  1.530211774429552e-01, 1.306503444528651e-01, 8.565386817628735e-03, -3.294697107164529e-02, -6.983941246038889e-03, 4.541889871427866e-03, 6.651219774041864e-02, 2.240812507035436e-02, -2.168119876121058e-02, -5.841534261623262e-02, 4.919445282763746e-02, 1.306503444528650e-01,  4.009968270422022e-01, 1.546755692650689e-02, -6.987140501986530e-02, -1.712986944456319e-02,  5.208914493073358e-03, 2.031835751339987e-01, 5.286393340247356e-02, -8.726529675140678e-02, -1.630731587972041e-01, 2.026343608529316e-03, 8.565386817628732e-03, 1.546755692650689e-02,  7.221806174111212e-02, -2.956625824138957e-03, 3.964969155321290e-03, 4.455517277886846e-03,  1.962730076385800e-03, 4.143781052237766e-03, 5.156052977788983e-03, -1.968318796819364e-03, -1.931904551997846e-02, -3.294697107164530e-02, -6.987140501986536e-02, -2.956625824138952e-03,  1.128862842732083e-01, 5.834439526125107e-03, -6.122318664896888e-03, -3.676804281683675e-02, -1.114271849306042e-02, 1.674509039579066e-02, 2.803535965627334e-02, 9.567961972648431e-04, -6.983941246038875e-03, -1.712986944456315e-02, 3.964969155321289e-03, 5.834439526125094e-03,  8.503433081649769e-02, 5.123921436402184e-03, -3.532575850175484e-02, -4.945370927768528e-03,  2.195756829848736e-02, 3.209350408514255e-02, 5.586295194090444e-03, 4.541889871427857e-03,  5.208914493073378e-03, 4.455517277886845e-03, -6.122318664896884e-03, 5.123921436402191e-03,  7.861785808925978e-02, 1.250641839785160e-03, 1.037969409675231e-03, 1.075848447909490e-04,  2.221353785030102e-03, -6.021924335562440e-03, 6.651219774041860e-02, 2.031835751339988e-01,  1.962730076385770e-03, -3.676804281683670e-02, -3.532575850175487e-02, 1.250641839785148e-03,  3.018194082508843e-01, 4.454252039582007e-02, -9.613563827741606e-02, -1.662603645558211e-01, -6.508053299023061e-03, 2.240812507035436e-02, 5.286393340247352e-02, 4.143781052237760e-03, -1.114271849306042e-02, -4.945370927768534e-03, 1.037969409675228e-03, 4.454252039582009e-02,  1.021864924449853e-01, -2.303064630620258e-02, -4.158291262103771e-02, -8.460044324054143e-03, -2.168119876121056e-02, -8.726529675140686e-02, 5.156052977788996e-03, 1.674509039579065e-02,  2.195756829848743e-02, 1.075848447909603e-04, -9.613563827741592e-02, -2.303064630620261e-02,  1.329392602904001e-01, 7.843700158703966e-02, 2.958283058369286e-02, -5.841534261623266e-02, -1.630731587972040e-01, -1.968318796819375e-03, 2.803535965627342e-02, 3.209350408514251e-02,  2.221353785030089e-03, -1.662603645558212e-01, -4.158291262103771e-02, 7.843700158703966e-02,  2.826946749206500e-01, 4.789743388848910e-02, 5.022361246522075e-03, 1.002153436320021e-02,  1.896346533360564e-03, -1.167979305628103e-02, 8.662379429434760e-03, 6.755834045531347e-03, -4.712910721179382e-02, -1.186670925647884e-02, 1.119597955684073e-02, 6.217453923458157e-02,  5.022361246522074e-03, 1.252461819913556e-01, 5.394796664055224e-02, 2.924148894385824e-03, -2.318123705364925e-02, 4.465297406100079e-03, 1.152224878720113e-03, 1.119811620759379e-02, -1.385770710675961e-03, 6.424621582570348e-03, -7.063313736800847e-03, 1.002153436320020e-02,  5.394796664055224e-02, 1.888337340835190e-01, 6.253609192063760e-03, -3.879795959386224e-02,  1.826141536829474e-02, -1.481109092385058e-03, 3.926398236740268e-02, -6.572198877471333e-04, -3.916254756103621e-03, -1.811865972202656e-02, 1.896346533360559e-03, 2.924148894385825e-03,  6.253609192063748e-03, 7.228921745774934e-02, -2.369583853768190e-03, 3.963246012894412e-03,  4.470110205076099e-03, -3.310945969490978e-03, 8.647105508165584e-04, 7.028574018687697e-03,  3.672071127273125e-03, -1.167979305628102e-02, -2.318123705364922e-02, -3.879795959386224e-02, -2.369583853768181e-03, 1.118096326996528e-01, -8.031503324605132e-04, -4.679042572868520e-03, -1.163819758968773e-02, 2.163601608566522e-04, 2.394741759387394e-03, 4.084560925757518e-03,  8.662379429434748e-03, 4.465297406100088e-03, 1.826141536829472e-02, 3.963246012894410e-03, -8.031503324605182e-04, 7.898339683533412e-02, 4.967396671384395e-03, -2.368286320066361e-03, -3.670949812920956e-04, 5.151914855139515e-03, 6.023060896646894e-03, 6.755834045531347e-03,  1.152224878720107e-03, -1.481109092385054e-03, 4.470110205076097e-03, -4.679042572868515e-03,  4.967396671384395e-03, 7.993244064723898e-02, -2.747843064232616e-03, 1.324774852304459e-04,  1.756451867057228e-03, 6.240875724027183e-03, -4.712910721179387e-02, 1.119811620759383e-02,  3.926398236740260e-02, -3.310945969490991e-03, -1.163819758968774e-02, -2.368286320066373e-03, -2.747843064232614e-03, 1.691990765058825e-01, 9.166053045845233e-03, -2.546094851573300e-02, -5.159184401030641e-02, -1.186670925647884e-02, -1.385770710675954e-03, -6.572198877471298e-04,  8.647105508165591e-04, 2.163601608566520e-04, -3.670949812921032e-04, 1.324774852304433e-04,  9.166053045845226e-03, 9.443400999348293e-02, -8.022481546586855e-03, -1.125211627477077e-02,  1.119597955684071e-02, 6.424621582570346e-03, -3.916254756103677e-03, 7.028574018687696e-03,  2.394741759387396e-03, 5.151914855139505e-03, 1.756451867057228e-03, -2.546094851573290e-02, -8.022481546586859e-03, 9.811468965818401e-02, 2.015830417931792e-02, 6.217453923458156e-02, -7.063313736800851e-03, -1.811865972202653e-02, 3.672071127273115e-03, 4.084560925757545e-03,  6.023060896646880e-03, 6.240875724027184e-03, -5.159184401030636e-02, -1.125211627477078e-02,  2.015830417931798e-02, 1.905564600888125e-01, 5.713600911939040e-02, 6.499161351604606e-03,  7.766394940110624e-03, 2.527731240385220e-03, -9.012890218966738e-03, 6.949656297538765e-03,  4.568708128856097e-03, -5.141992501894355e-02, -1.309942974773104e-02, 1.489128606970862e-02,  6.662603721662934e-02, 6.499161351604606e-03, 1.866439453909846e-01, 1.572469160149176e-01,  1.353826946481763e-02, -4.687675981588776e-02, 8.221092535367087e-03, 1.704094247595567e-03,
                  6.833467601482637e-02, 1.615934319476086e-02, -1.254415311765016e-02, -6.685420825447476e-02,  7.766394940110624e-03, 1.572469160149176e-01, 4.044522987248722e-01, 2.355332599094641e-02, -8.540714793134269e-02, 1.087058676536043e-02, -3.995860137763657e-03, 1.753795359445343e-01,  3.115307825075266e-02, -5.630696997460040e-02, -1.480108776599309e-01, 2.527731240385220e-03,  1.353826946481763e-02, 2.355332599094641e-02, 8.184537458138239e-02, -6.972965822049454e-03,  7.965705586882893e-03, 7.664576608709173e-03, 1.922270386483471e-03, 4.994564783320641e-03,  8.807249106040631e-03, -4.302802473614574e-03, -9.012890218966738e-03, -4.687675981588776e-02, -8.540714793134269e-02, -6.972965822049454e-03, 1.297660941933373e-01, -3.107382441678720e-03, -5.527035493541979e-03, -3.874422984693320e-02, -7.598436974156865e-03, 1.364945434483522e-02,  3.155904166994288e-02, 6.949656297538765e-03, 8.221092535367087e-03, 1.087058676536043e-02,  7.965705586882893e-03, -3.107382441678720e-03, 9.556422962750245e-02, 9.230571400805677e-03, -2.398497881085540e-02, -7.320558538295129e-04, 1.921534319331807e-02, 2.115345512787638e-02,  4.568708128856097e-03, 1.704094247595567e-03, -3.995860137763657e-03, 7.664576608709173e-03, -5.527035493541979e-03, 9.230571400805677e-03, 8.762922892534317e-02, -1.214975389414722e-02, -7.001404409247565e-04, 8.134689705863144e-03, 1.353791849066216e-02, -5.141992501894355e-02,  6.833467601482637e-02, 1.753795359445343e-01, 1.922270386483471e-03, -3.874422984693320e-02, -2.398497881085540e-02, -1.214975389414722e-02, 2.817380276981974e-01, 2.473262779188702e-02, -7.430124439442239e-02, -1.416035686230538e-01, -1.309942974773104e-02, 1.615934319476086e-02,  3.115307825075266e-02, 4.994564783320641e-03, -7.598436974156865e-03, -7.320558538295129e-04, -7.001404409247565e-04, 2.473262779188702e-02, 1.034931635755103e-01, -1.206142626025931e-02, -2.546537027357219e-02, 1.489128606970862e-02, -1.254415311765016e-02, -5.630696997460040e-02,  8.807249106040631e-03, 1.364945434483522e-02, 1.921534319331807e-02, 8.134689705863144e-03, -7.430124439442239e-02, -1.206142626025931e-02, 1.294249924096733e-01, 5.700429717908129e-02,  6.662603721662934e-02, -6.685420825447476e-02, -1.480108776599309e-01, -4.302802473614574e-03,  3.155904166994288e-02, 2.115345512787638e-02, 1.353791849066216e-02, -1.416035686230538e-01, -2.546537027357219e-02, 5.700429717908129e-02, 2.747854767565665e-01 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$method),
               c("EKF" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$model),
               c("exponential" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$LR),
               c(0.0877914951989026 )
               , tolerance = 1e-05)
})

#############
# Test ukf for exponential model
test_that("UKF and exp models give previous computed results",{
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 2,
    Q_0 = diag(1, 2),
    Q = diag(1e-1, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4,
                   method = "UKF", beta = 0),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential"))

  # plot(result_exp, cov_index = 1)
  # get_expect_equal(result_exp, file = "tmp.txt")

  expect_equal(c(result_exp$state_vecs),
               c(-3.332840740718179262, -3.332822250137102316, -2.923861120303850925, -2.727471174103755835, -3.090988752696004038, -3.293351899951674433, -3.571854150946218720, -3.676317531624260670, -3.742758751761905422, -3.890508361364581003, -3.992619532099590085, -4.130692031140593912, -4.271024152051297484, -4.384717160938911285, -4.414504027921516638, -4.488301855357327064, 0.315493429245648327, 0.315505122699321461, 0.527476450935162600, 0.618254387066666800, 0.428814162176183844,  0.337376258195663525, 0.198315311921671955, 0.159366952812370566, 0.124445816390255815, 0.051091730118944828, -0.001418689766588516, -0.083168697116511814, -0.160342111417614203, -0.221377759049762424, -0.241833209809698579, -0.277633027854599646 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.255409032945259407, 0.041681065472310902, 0.041681065472313539, 0.172259295135494983, 0.173242106820867547, 0.005142424115176430, 0.005142424115179595,  0.139380856414792698, 0.134515978309633688, -0.011311843198774235, -0.011311843198774249, 0.121739185078213658, 0.099426500727031283, -0.029693096334480862, -0.029693096334480806, 0.102992833726622102, 0.082576467765164405, -0.037303838826196138, -0.037303838826196166, 0.096018004006092061, 0.095995170672413338, -0.027511045742596656, -0.027511045742596656, 0.107501992868236182, 0.109171511574563715, -0.020009896050285664, -0.020009896050285653, 0.120842308788313035,  0.127243387144526238, -0.011526137736490119, -0.011526137736490126, 0.136994598552905661, 0.141293103574058360, -0.006254712347037875, -0.006254712347037870,  0.152753297878879479, 0.152647478238323725, -0.003775032406831736, -0.003775032406831750, 0.167951297768759167, 0.172715299507701925, 0.002612068025589477,  0.002612068025589477, 0.186694651494714675, 0.192631304770010697, 0.008483359225965846, 0.008483359225965850, 0.206224972421106711, 0.218793634202845227,  0.016414439381573588, 0.016414439381573574, 0.227519744975778065, 0.257465483830202013, 0.029762223718066708, 0.029762223718066708, 0.252294432127701806,  0.315092923688987281, 0.051936729485174235, 0.051936729485174235, 0.282183511486258976, 0.398047090202928722, 0.085809350672349849, 0.085809350672349849,  0.318253473960025124 ))

  expect_equal(c(result_exp$lag_one_cor),
               c(  1.445126746557467e-01, 8.945368624438330e-03, 7.886695913239011e-03, 1.135990761726857e-01, 9.222067222515645e-02, -1.217131453387031e-02,  -1.305150270724130e-02, 8.999092719676821e-02, 6.069383009546117e-02, -2.371507783710824e-02, -2.646505045909237e-02, 7.241855703744954e-02,   4.296171379947392e-02, -3.057240612960439e-02, -3.102116078717858e-02, 6.044922494173546e-02, 4.010066275869291e-02, -2.891924125889848e-02,  -2.625611520968602e-02, 5.788476009193708e-02, 4.726889325260909e-02, -2.020787567073459e-02, -1.805985106494300e-02, 6.101409088699419e-02,   5.735311464438893e-02, -1.087929818253282e-02, -9.227010470922812e-03, 6.453440319650239e-02, 6.893235007960993e-02, -1.143479574977822e-03,   1.855359021849315e-05, 6.742511217908530e-02, 7.747004462726736e-02, 6.903039336226019e-03, 7.540368710875919e-03, 6.790946945062704e-02,   8.700459440439093e-02, 1.541463450665078e-02, 1.588986574672296e-02, 6.699866026024971e-02, 9.716668357531816e-02, 2.476111015381008e-02,   2.508816274703381e-02, 6.461887835341257e-02, 1.016622926168813e-01, 3.182606731536285e-02, 3.196006359936370e-02, 5.883177577748211e-02,   9.640586939589837e-02, 3.459380715189350e-02, 3.463735844262764e-02, 4.847601622322698e-02, 6.966116476478590e-02, 2.747529148562544e-02,   2.748679150346649e-02, 3.064264393931362e-02, 0.000000000000000e+00, 0.000000000000000e+00, 1.762826224361568e-320, 1.978423033621121e-316 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(58 ))

  expect_equal(c(result_exp$Q),
               c(0.07125498137081250, 0.03131371745527368, 0.03131371745527368, 0.02525327590571668 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("UKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(1 ))




  set.seed(44334)
  sims <- test_sim_func_exp(n_series = 1e4, n_vars = 10, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                            intercept_start = -5, sds = c(.1, rep(1, 10)))
  # sum(sims$res$event)

  arg_list <- list(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(1, 11),
    Q = diag(1e-2, 11),
    control = list(est_Q_0 = F, n_max = 10^2, eps = 10^-2,
                   method = "UKF", beta = 2),
    max_T = 10,
    id = sims$res$id, order = 1,
    model = "exponential")

  suppressMessages(fit <- do.call(ddhazard, arg_list))

  # matplot(fit$state_vecs, lty = 2, type = "l", ylim = range(fit$state_vecs, sims$betas))
  # matplot(sims$betas, lty = 1, add = T, type = "l")
  # get_expect_equal(fit, eps = 1e-6, file = "tmp.txt")

  expect_equal(c(fit$state_vecs),
               c(-5.46240345634906888, -5.45168876845775952, -5.38959647624170746, -5.23706227326075968, -5.14155137421212594, -5.03737263758418763, -4.93529233291644420, -4.84477394580330323, -4.72562560142721466, -4.72678245942775010, -4.72065284563191856, 1.17430133884353105, 1.17345276814083421, 1.10517766343242818,  1.12575642646994667, 0.83291212170400097, 0.93528459640512018, 1.13658809211942846, 1.60030377145561276, 2.24679699284412848, 2.30549449028084297,  2.21358972321933933, 0.40904347439576705, 0.49873756007113412, 0.87911000322988808, 1.46228223760631004, 2.64197973526802521, 3.44341080789596443,  4.16725426712976521, 4.22136270203542363, 4.15322265083341780, 4.24968008546211884, 4.67236860482979477, -0.20366116560607875, -0.23949052803046827, -0.88896732724912852, -1.16013678276311039, -2.71664058307658873, -2.70455909475869749, -1.11229830249621808, 0.45778426068621747, 1.76326267919727808,  1.80585240038441919, 1.45103218814987223, 0.56384815314333625, 0.49142713247251596, 0.16553492667651648, -0.97120826392358506, -2.15853710083529959, -2.55192639293495516, -3.82720770299090329, -3.19371839555639836, -1.60291742569239504, -1.18734435325004828, -1.26825493505278297, 1.34021524233511680,  1.35422251836522767, 1.18251952445341235, -0.48648779542537468, -0.14056819465933046, -0.10654805314103111, -0.02610368090510808, 0.73281014382577969,  0.59794539863548224, 1.19503439651447474, 2.68881195363516490, -0.59677648448470288, -0.57153271772293246, -0.44756774376936764, -0.51491979514423469, -0.36277596199539919, 0.09572266803213346, -0.16448866651976057, 0.30431753949525914, 1.38831786317013428, 1.66684751020680255, 1.80764299813935803, -0.78688037856624427, -0.84865322916800690, -1.04046313233438159, -1.64979991741815124, -2.40626112653430058, -2.85671476570899907, -3.94158540411002711, -4.05296241125412937, -3.56588401131643939, -3.46429945223726365, -3.72155723657593818, 0.27037513657962986, 0.20762994101920912, -0.24139397143424185, -0.39469483318289378, -1.27764911967125450, -2.11562437070260145, -1.16738229681405614, -1.31221192665283426, -2.77833678537461903, -3.23433573142280339, -3.48804172656546996, 0.07518718032912645, 0.11050601143293881, 0.55943943488894576, 0.61411615276077214, 1.22405362781103189, 1.72907705945181744,  0.31552462903745093, 0.60335629407499791, 2.05691725372946888, 2.37721911523263119, 2.62282830821518997, 0.55690668163678270, 0.56174525376216999,  0.35768744862280955, -0.05554339073361461, -0.10603004788724399, -0.16500528961662347, 0.70809350649761926, 1.18466337318460901, 0.74053508731039130,  0.76299842819923280, 1.25681497195647118 )
               , tolerance = 1e-06)

  expect_equal(c(fit$state_vars),
               c( 3.452972305388113e-02, 1.949929536346226e-02, 2.958358536933119e-02, 1.643118957115543e-02, -1.602508903062335e-02, -1.647656191139200e-02,  1.154502775624981e-02, -2.192656891187228e-02, -1.480316504408288e-02, 1.984696349617331e-02, -8.468623498087403e-04, 1.949929536345852e-02,  6.830799043124014e-02, 1.229795519482639e-02, 1.274381943125930e-01, 4.601094697959623e-02, -2.295412887451611e-02, 4.065731025778036e-02, -1.078847777754582e-02, -2.973485160758263e-02, 3.456198944024334e-02, 4.113657341228389e-03, 2.958358536951399e-02, 1.229795519483256e-02,  2.403311623347413e-01, -1.085205214798782e-02, -1.721275104519047e-01, 3.024902870740506e-02, 5.406197121039615e-02, -1.499557249641810e-01, -1.139311011585237e-01, 3.083401235057965e-02, 2.722485439400819e-02, 1.643118957104853e-02, 1.274381943125905e-01, -1.085205214798970e-02,  5.333901018724041e-01, 1.082486945251046e-01, -1.919795099993040e-02, 8.126901625811425e-02, -2.797986559843116e-02, 3.697480864329973e-02, -5.972545068861220e-02, 8.045563880240807e-02, -1.602508903031893e-02, 4.601094697960629e-02, -1.721275104519024e-01, 1.082486945251066e-01,  3.528465719954228e-01, 7.290521420664263e-02, 6.231444433235234e-02, 1.818182087823178e-01, -5.626610534738657e-02, 1.044187851252149e-01, -4.428858026880074e-02, -1.647656191145425e-02, -2.295412887451792e-02, 3.024902870739674e-02, -1.919795099992758e-02, 7.290521420662859e-02,  4.886778253531808e-01, 2.215304912318687e-02, -3.225983471985430e-03, -5.859909763026390e-03, 4.432622244790867e-03, 1.504808302969829e-01,  1.154502775637104e-02, 4.065731025778400e-02, 5.406197121040088e-02, 8.126901625811198e-02, 6.231444433236049e-02, 2.215304912319179e-02,  1.296203149044090e-01, -4.753865759863543e-03, -1.336121995044470e-01, 1.107990245568166e-01, -1.739693124836347e-02, -2.192656891197967e-02, -1.078847777755046e-02, -1.499557249641787e-01, -2.797986559843269e-02, 1.818182087823238e-01, -3.225983471990823e-03, -4.753865759859226e-03,  1.930698208603555e-01, 9.972224994978969e-03, 2.615578499666693e-02, -5.879458511116403e-02, -1.480316504404796e-02, -2.973485160758139e-02, -1.139311011585243e-01, 3.697480864329879e-02, -5.626610534738600e-02, -5.859909763024571e-03, -1.336121995044483e-01, 9.972224994978544e-03,  2.996305927228479e-01, -2.024439315974951e-01, 7.320718029307928e-02, 1.984696349620904e-02, 3.456198944024406e-02, 3.083401235057995e-02, -5.972545068861191e-02, 1.044187851252139e-01, 4.432622244791560e-03, 1.107990245568150e-01, 2.615578499666694e-02, -2.024439315974956e-01,  3.039622505200482e-01, -6.382096474531052e-02, -8.468623497585386e-04, 4.113657341230481e-03, 2.722485439400587e-02, 8.045563880240948e-02, -4.428858026880441e-02, 1.504808302969868e-01, -1.739693124836666e-02, -5.879458511116410e-02, 7.320718029307811e-02, -6.382096474531013e-02,  1.438238005214580e-01, 2.746624228999323e-02, 1.275267784053596e-02, 1.392548146872454e-02, 6.874731140420417e-03, -6.261992594217346e-03, -8.342727368980719e-03, 4.752155350313312e-03, -9.807266312237188e-03, -4.697613386112777e-03, 1.174149794268606e-02, -7.339186680837768e-04,  1.275267784055867e-02, 3.728679776357480e-02, 8.674363024584915e-03, 3.941271854881563e-02, 1.250500899911413e-02, -1.259912391840672e-02,  1.259081397880168e-02, -8.673218088445161e-03, -1.016249219462804e-02, 1.696399696295781e-02, 6.587838567491146e-04, 1.392548146891413e-02,  8.674363024593325e-03, 1.010830152320349e-01, 3.736283029294524e-03, -5.368468479705912e-02, 1.141700220663605e-02, 2.258935396396322e-02, -5.030074815307355e-02, -4.411198195714137e-02, 9.923637937487378e-03, 7.010398176726471e-03, 6.874731140306744e-03, 3.941271854881104e-02,  3.736283029277900e-03, 1.656294153452861e-01, 2.260081143645518e-02, -1.087474623234208e-02, 2.441369523464874e-02, -1.358719099374965e-02,  6.488346753501687e-03, -1.468883442676627e-02, 2.205513458876278e-02, -6.261992593783490e-03, 1.250500899913684e-02, -5.368468479702115e-02,  2.260081143647178e-02, 1.183986706806964e-01, 2.230532407082100e-02, 1.337379787721049e-02, 5.564791376727842e-02, -1.208961575945565e-02,  2.394766676579119e-02, -1.473420883757295e-02, -8.342727369013054e-03, -1.259912391841049e-02, 1.141700220662484e-02, -1.087474623234525e-02,  2.230532407079468e-02, 2.140680391313975e-01, 4.454013666877608e-03, -2.702209770307228e-03, 4.213367309074532e-03, -6.314583324194703e-03,  6.348150193702673e-02, 4.752155350521871e-03, 1.259081397881192e-02, 2.258935396397610e-02, 2.441369523465863e-02, 1.337379787720279e-02,  4.454013666891988e-03, 6.558912017653123e-02, -4.025336428400209e-03, -4.760870816176974e-02, 3.825799526158030e-02, -7.599178925630057e-03, -9.807266312297086e-03, -8.673218088447975e-03, -5.030074815306552e-02, -1.358719099375711e-02, 5.564791376731070e-02, -2.702209770311020e-03, -4.025336428387656e-03, 9.285853168092856e-02, 6.819775430870594e-03, -1.244357218194562e-03, -2.274872989662754e-02, -4.697613386225336e-03, -1.016249219463254e-02, -4.411198195714414e-02, 6.488346753489355e-03, -1.208961575943335e-02, 4.213367309069221e-03, -4.760870816176282e-02,  6.819775430876232e-03, 1.255875231414419e-01, -6.033842492827412e-02, 2.728035072384949e-02, 1.174149794287725e-02, 1.696399696296573e-02,  9.923637937497639e-03, -1.468883442675497e-02, 2.394766676577259e-02, -6.314583324186736e-03, 3.825799526157517e-02, -1.244357218205266e-03, -6.033842492827970e-02, 1.432817006012396e-01, -1.514801586178670e-02, -7.339186680808711e-04, 6.587838567494169e-04, 7.010398176720896e-03,  2.205513458876403e-02, -1.473420883758519e-02, 6.348150193703048e-02, -7.599178925636246e-03, -2.274872989662689e-02, 2.728035072385105e-02, -1.514801586178985e-02, 7.676998470009519e-02, 2.440386689032947e-02, 1.244349083540180e-02, 1.755492780107401e-02, 1.078700236674035e-02, -8.835452630110447e-03, -1.088268328086494e-02, 7.899510040072846e-03, -1.240147341214942e-02, -9.832117459893545e-03, 1.280972001613241e-02, -1.219461319933393e-03, 1.244349083540872e-02, 4.131908590408273e-02, 1.008104738771426e-02, 6.544106528220946e-02, 2.048536052628658e-02, -1.503713304305427e-02, 2.180689298670686e-02, -8.810941151278525e-03, -1.770259893677333e-02, 2.039485218939424e-02, 1.416230057090983e-03,  1.755492780107037e-02, 1.008104738771222e-02, 1.204079722783735e-01, 2.328806482666699e-03, -7.677491268675619e-02, 1.244851132786217e-02,  2.910277636245119e-02, -7.108983826170703e-02, -5.845851177567103e-02, 1.869097148674444e-02, 1.179788954579201e-02, 1.078700236674789e-02,  6.544106528220921e-02, 2.328806482669127e-03, 2.683247951146074e-01, 5.080503228281497e-02, -9.993805972416480e-03, 4.374065649217344e-02, -1.749851060590635e-02, 1.006343494584378e-02, -2.438159910376049e-02, 3.831895422629868e-02, -8.835452630080277e-03, 2.048536052629002e-02, -7.677491268674926e-02, 5.080503228282037e-02, 1.562328604238191e-01, 2.957193910810174e-02, 2.394974873704450e-02, 7.834882773658734e-02, -1.759518437115786e-02, 3.850633498684788e-02, -1.784325041702818e-02, -1.088268328088048e-02, -1.503713304305653e-02, 1.244851132785923e-02, -9.993805972419828e-03, 2.957193910809927e-02, 2.698523110549217e-01, 5.129623984824277e-03, -4.261630897769491e-03, 9.867205713007979e-03, -9.288503031863042e-03,
                  8.603017045786186e-02, 7.899510040088528e-03, 2.180689298670763e-02, 2.910277636245512e-02, 4.374065649217521e-02,  2.394974873704034e-02, 5.129623984827685e-03, 7.756541945830259e-02, -6.432053842183854e-03, -7.005029566084138e-02, 5.888438568664174e-02, -9.573792360698594e-03, -1.240147341213654e-02, -8.810941151276046e-03, -7.108983826170459e-02, -1.749851060590293e-02, 7.834882773659152e-02, -4.261630897770244e-03, -6.432053842179894e-03, 1.075743335013300e-01, 1.118428723885175e-02, 4.422087910095868e-03, -2.909980160267685e-02, -9.832117459917161e-03, -1.770259893677432e-02, -5.845851177567710e-02, 1.006343494584122e-02, -1.759518437115103e-02, 9.867205713002494e-03, -7.005029566084109e-02, 1.118428723885790e-02, 1.658887630657099e-01, -1.048888474905566e-01, 3.905597876311846e-02, 1.280972001615716e-02,  2.039485218939599e-02, 1.869097148675048e-02, -2.438159910375705e-02, 3.850633498684355e-02, -9.288503031858616e-03, 5.888438568664271e-02,  4.422087910090658e-03, -1.048888474905584e-01, 1.754594415759213e-01, -3.184804162370825e-02, -1.219461319950066e-03, 1.416230057088822e-03,  1.179788954578857e-02, 3.831895422629540e-02, -1.784325041702927e-02, 8.603017045786120e-02, -9.573792360701336e-03, -2.909980160267509e-02,  3.905597876312295e-02, -3.184804162371170e-02, 8.795860027965802e-02, 2.079486504491955e-02, 1.063703181830454e-02, 1.789976943471558e-02,  1.097528877116895e-02, -1.020246174878080e-02, -1.114248494856377e-02, 8.411691357406511e-03, -1.258818796945482e-02, -1.089951840450965e-02,  1.144731713110612e-02, -1.283218980115646e-03, 1.063703181830565e-02, 3.649220104099191e-02, 1.103454038616140e-02, 6.224292515527411e-02,  1.651048103509584e-02, -1.513238866106575e-02, 2.105399106200912e-02, -9.372591903299029e-03, -1.747064573318182e-02, 1.808997088875850e-02,  1.307300828714363e-03, 1.789976943471382e-02, 1.103454038616044e-02, 1.157357867430464e-01, 4.813046481870142e-03, -7.676044558702019e-02,  7.787627004357825e-03, 3.037857496825056e-02, -7.129517397624278e-02, -5.926950617273122e-02, 2.238560892252357e-02, 1.085163933613079e-02,  1.097528877116906e-02, 6.224292515527410e-02, 4.813046481869964e-03, 2.542988468189241e-01, 4.599250915728954e-02, -1.306111666198452e-02,  4.229439834050219e-02, -1.848491566080402e-02, 7.865495275125723e-03, -2.212547785428306e-02, 3.544848590868110e-02, -1.020246174877529e-02,  1.651048103509696e-02, -7.676044558701674e-02, 4.599250915728915e-02, 1.415487964753385e-01, 2.792421803748014e-02, 1.686101566572112e-02,  7.416526458277592e-02, -6.974483037656819e-03, 2.858173695435676e-02, -1.416821209423155e-02, -1.114248494856744e-02, -1.513238866106627e-02,  7.787627004355474e-03, -1.306111666198399e-02, 2.792421803747947e-02, 2.512141388569458e-01, 1.994397210364623e-03, -2.240165445441041e-03,  1.287271736312918e-02, -1.056594538628865e-02, 8.062389664032267e-02, 8.411691357408907e-03, 2.105399106200911e-02, 3.037857496825287e-02,  4.229439834050221e-02, 1.686101566571853e-02, 1.994397210366825e-03, 7.161958711173835e-02, -1.025908633729585e-02, -6.665170690226428e-02,  5.583516028314430e-02, -8.381625740239004e-03, -1.258818796945131e-02, -9.372591903298047e-03, -7.129517397624101e-02, -1.848491566080421e-02,  7.416526458277740e-02, -2.240165445441454e-03, -1.025908633729343e-02, 1.014035635691361e-01, 1.710017679580978e-02, 4.809163543170345e-05, -2.560338744897832e-02, -1.089951840451322e-02, -1.747064573318170e-02, -5.926950617273504e-02, 7.865495275126101e-03, -6.974483037652142e-03,  1.287271736312504e-02, -6.665170690226389e-02, 1.710017679581382e-02, 1.552098327692498e-01, -1.009313764360823e-01, 3.539554198024335e-02,  1.144731713111050e-02, 1.808997088875876e-02, 2.238560892252740e-02, -2.212547785428328e-02, 2.858173695435315e-02, -1.056594538628527e-02,  5.583516028314452e-02, 4.809163542815595e-05, -1.009313764360834e-01, 1.592886563944574e-01, -3.007979052267377e-02, -1.283218980119232e-03,  1.307300828713825e-03, 1.085163933612814e-02, 3.544848590868155e-02, -1.416821209423062e-02, 8.062389664032160e-02, -8.381625740240393e-03, -2.560338744897676e-02, 3.539554198024607e-02, -3.007979052267586e-02, 7.968733382437787e-02, 1.694786544765470e-02, 7.852920073080208e-03,  1.632212439433392e-02, 8.482045803581938e-03, -1.046673294803231e-02, -8.852369592372424e-03, 7.335168195236609e-03, -1.117826987531194e-02, -9.717728849053144e-03, 8.682944018371393e-03, -8.186313089164972e-04, 7.852920073079334e-03, 2.635402177370452e-02, 1.196928664952927e-02,  4.096491642374379e-02, 6.744417675065283e-03, -1.269623091935769e-02, 1.525131161490506e-02, -9.615671671955827e-03, -1.441445276658593e-02,  1.392662134735496e-02, 3.634529213004358e-04, 1.632212439433714e-02, 1.196928664953079e-02, 9.599375322360566e-02, 1.240158064041725e-02, -6.502832523697065e-02, -8.417221980785962e-03, 2.644920333196698e-02, -5.985848638253440e-02, -4.879582107454992e-02, 1.923562727979732e-02,  5.698503395668895e-03, 8.482045803577929e-03, 4.096491642374356e-02, 1.240158064041254e-02, 1.677328056528712e-01, 2.145665588009232e-02, -1.988250556193622e-02, 3.121412077108559e-02, -1.816952860095941e-02, -3.369389139597966e-03, -8.187106441728887e-03, 1.897020384228214e-02, -1.046673294803795e-02, 6.744417675062573e-03, -6.502832523697197e-02, 2.145665588008596e-02, 1.044754364339078e-01, 2.349139681155355e-02,  3.537315165855742e-03, 5.856643463592402e-02, 6.358028975487508e-03, 1.215983108373527e-02, -9.337175559283137e-03, -8.852369592369857e-03, -1.269623091935922e-02, -8.417221980779018e-03, -1.988250556194397e-02, 2.349139681154417e-02, 1.538386691528442e-01, -5.433016187499889e-03,  8.599194462890853e-03, 1.522261508284146e-02, -9.895639589036267e-03, 4.450213694795545e-02, 7.335168195235171e-03, 1.525131161490475e-02,  2.644920333196521e-02, 3.121412077108625e-02, 3.537315165858219e-03, -5.433016187499138e-03, 5.588976242202179e-02, -1.257006361208710e-02, -4.893700681328539e-02, 3.997725929991171e-02, -6.470221680096080e-03, -1.117826987531506e-02, -9.615671671957324e-03, -5.985848638253453e-02, -1.816952860096334e-02, 5.856643463592306e-02, 8.599194462896725e-03, -1.257006361208844e-02, 8.470921017328609e-02, 2.062885731206923e-02, -5.860663676700443e-03, -1.586606651370499e-02, -9.717728849051442e-03, -1.441445276658567e-02, -4.879582107454664e-02, -3.369389139600271e-03,  6.358028975483185e-03, 1.522261508284294e-02, -4.893700681328549e-02, 2.062885731206658e-02, 1.151374867871227e-01, -6.958179180561465e-02,  2.298473522248250e-02, 8.682944018369203e-03, 1.392662134735441e-02, 1.923562727979457e-02, -8.187106441727980e-03, 1.215983108373889e-02, -9.895639589036567e-03, 3.997725929991144e-02, -5.860663676698144e-03, -6.958179180561441e-02, 1.157096647594271e-01, -1.810548626920321e-02, -8.186313089146608e-04, 3.634529213004155e-04, 5.698503395671289e-03, 1.897020384228047e-02, -9.337175559286075e-03, 4.450213694795501e-02, -6.470221680096026e-03, -1.586606651370687e-02, 2.298473522248161e-02, -1.810548626920281e-02, 5.468094427765856e-02, 1.351637976305525e-02,  6.232758467287842e-03, 1.473399016041806e-02, 8.506007369153881e-03, -8.938111010466876e-03, -6.230411304145473e-03, 7.025938943072316e-03, -9.177770848697052e-03, -8.920053750138646e-03,
                  6.329205152485562e-03, -2.903636054659715e-04, 6.232758467284268e-03, 2.297864515284698e-02,  9.017660043137513e-03, 3.998485653133277e-02, 9.086289544023591e-03, -1.024484916957611e-02, 1.442500585398989e-02, -6.604531674909122e-03, -1.284052494400695e-02, 1.196714596165100e-02, 3.140860674872745e-04, 1.473399016042153e-02, 9.017660043147340e-03, 1.174207543342210e-01,  3.416868580720273e-03, -8.737996306299099e-02, -3.512659271302099e-03, 2.975879955838663e-02, -7.440700892495719e-02, -5.796873067293054e-02,  1.994454072250294e-02, 9.267145173069145e-03, 8.506007369145209e-03, 3.998485653132776e-02, 3.416868580709214e-03, 1.631498067755282e-01,  3.055238695132608e-02, -1.775446569625247e-02, 2.994295199969918e-02, -1.154595521570306e-02, -1.583157866725983e-03, -5.732039326555112e-03,  1.680340160137689e-02, -8.938111010478353e-03, 9.086289544014543e-03, -8.737996306301798e-02, 3.055238695132723e-02, 1.160459129086144e-01,  7.510902211232028e-03, -3.816926206884227e-03, 6.930058372239024e-02, 2.235302024075946e-02, 6.177165621890331e-03, -1.305769340536385e-02, -6.230411304138997e-03, -1.024484916958526e-02, -3.512659271271077e-03, -1.775446569629135e-02, 7.510902211186233e-03, 1.023875880345500e-01, -7.238706234459897e-03, 1.893556880882693e-03, 1.443385142137106e-02, -1.189604355989040e-02, 2.989414420773412e-02, 7.025938943066653e-03,  1.442500585399245e-02, 2.975879955836633e-02, 2.994295199971185e-02, -3.816926206859002e-03, -7.238706234454328e-03, 4.934021988175286e-02, -1.631909463933621e-02, -4.343142053926703e-02, 3.315428235349456e-02, -4.468586723295958e-03, -9.177770848701791e-03, -6.604531674915538e-03, -7.440700892496663e-02, -1.154595521570564e-02, 6.930058372238034e-02, 1.893556880908645e-03, -1.631909463935206e-02, 8.761037787313881e-02,  2.922042369902061e-02, -6.282268299514046e-03, -1.670893233523582e-02, -8.920053750131733e-03, -1.284052494401480e-02, -5.796873067289614e-02, -1.583157866752515e-03, 2.235302024070896e-02, 1.443385142137779e-02, -4.343142053927322e-02, 2.922042369899060e-02, 1.028142525386539e-01, -5.853227777259978e-02, 1.705767069510662e-02, 6.329205152477988e-03, 1.196714596165617e-02, 1.994454072246890e-02, -5.732039326532375e-03,  6.177165621932662e-03, -1.189604355989002e-02, 3.315428235349514e-02, -6.282268299486918e-03, -5.853227777259096e-02, 9.319306295712540e-02, -1.608647896044806e-02, -2.903636054613606e-04, 3.140860674836093e-04, 9.267145173090557e-03, 1.680340160135772e-02, -1.305769340538929e-02,  2.989414420773222e-02, -4.468586723295559e-03, -1.670893233525192e-02, 1.705767069509729e-02, -1.608647896044428e-02, 4.444900630525619e-02,  1.035010307611165e-02, 4.946515097968848e-03, 8.298168812144589e-03, 9.471604805592214e-03, -3.765429470452357e-03, -4.873577413425818e-03,  4.765455434833057e-03, -4.189878253731065e-03, -4.253160282369989e-03, 2.626091585229219e-03, -4.689129259485239e-05, 4.946515097968409e-03,  1.716273614306902e-02, 8.340668380774931e-03, 2.988957635081099e-02, 5.007821308798565e-03, -8.916290136894541e-03, 1.104781560513163e-02, -5.597803365127080e-03, -1.019416661423725e-02, 8.722243765885552e-03, -1.675984729897635e-04, 8.298168812141665e-03, 8.340668380780930e-03,  1.000468405695585e-01, 1.266743773345142e-02, -7.198015822486541e-02, 9.607422728954455e-04, 2.421458796960631e-02, -6.088120252217863e-02, -4.349434797624743e-02, 9.316062054818166e-03, 1.173749102648853e-02, 9.471604805591735e-03, 2.988957635080927e-02, 1.266743773343905e-02,  1.268501873914811e-01, 1.037116970615483e-02, -1.782327399071420e-02, 2.457368520133646e-02, -1.782892298806171e-02, -4.608390665448992e-03, -4.551812239498384e-03, 1.336931808491631e-02, -3.765429470454128e-03, 5.007821308790517e-03, -7.198015822489381e-02, 1.037116970614224e-02,  9.194550176927639e-02, -5.899370602923438e-04, -3.835480911812700e-03, 5.532481638320345e-02, 1.393833090104709e-02, 1.149182889427093e-02, -1.585462546227481e-02, -4.873577413436568e-03, -8.916290136894718e-03, 9.607422728412471e-04, -1.782327399069718e-02, -5.899370602455761e-04,  8.425233214579853e-02, -7.585500229590333e-03, -3.111572591783397e-03, 1.301998071797717e-02, -1.221730742915712e-02, 2.578821848000293e-02,  4.765455434828849e-03, 1.104781560513145e-02, 2.421458796958536e-02, 2.457368520134216e-02, -3.835480911787819e-03, -7.585500229574885e-03,  4.068144581530238e-02, -1.231367513321996e-02, -3.395967874193201e-02, 2.431287991046309e-02, -3.948994945597219e-03, -4.189878253729737e-03, -5.597803365132261e-03, -6.088120252218492e-02, -1.782892298807241e-02, 5.532481638318787e-02, -3.111572591820717e-03, -1.231367513323615e-02,  7.253801061480131e-02, 1.857420568631077e-02, 2.114271167039947e-03, -1.761522824673761e-02, -4.253160282365174e-03, -1.019416661423806e-02, -4.349434797622771e-02, -4.608390665453464e-03, 1.393833090101623e-02, 1.301998071794171e-02, -3.395967874193930e-02, 1.857420568629371e-02,  8.146963116451811e-02, -4.346017152223663e-02, 1.426345841315137e-02, 2.626091585224569e-03, 8.722243765884471e-03, 9.316062054795467e-03, -4.551812239497198e-03, 1.149182889429536e-02, -1.221730742913741e-02, 2.431287991046336e-02, 2.114271167057114e-03, -4.346017152222864e-02,  7.221592110857269e-02, -1.534446690560751e-02, -4.689129259691834e-05, -1.675984729883743e-04, 1.173749102647923e-02, 1.336931808492415e-02, -1.585462546226285e-02, 2.578821848000427e-02, -3.948994945598597e-03, -1.761522824673021e-02, 1.426345841315601e-02, -1.534446690560964e-02,  3.936298394511614e-02, 7.822367488501051e-03, 3.696370386210077e-03, -2.026878216371108e-04, 7.300581839459427e-03, 3.735532872507418e-03, -4.743679782717652e-03, 2.653984385236739e-03, 2.688444358356154e-03, -7.578400636482872e-04, 2.079650397285313e-03, -1.748896043649127e-03,  3.696370386209325e-03, 1.348227038323874e-02, 3.303938741433296e-03, 2.247848158538819e-02, 7.273731991032055e-03, -8.316938482159511e-03,  7.637736861502212e-03, -1.117043653225202e-03, -6.466013030300368e-03, 6.207232971211814e-03, -1.434491932342161e-03, -2.026878216384856e-04,  3.303938741438374e-03, 6.534638064015172e-02, 4.006405162473402e-03, -4.140043717370913e-02, 3.351931561436713e-03, 1.566199133045628e-02, -3.256274241128236e-02, -2.857376339043282e-02, 8.122992081775932e-03, 5.112013707403541e-03, 7.300581839459628e-03, 2.247848158539381e-02,  4.006405162468474e-03, 8.065624912976978e-02, 1.729081963430550e-02, -2.227903682972572e-02, 1.955886392089617e-02, -3.577707689696712e-03, -1.186373919918281e-02, 7.296860222717571e-03, -6.267237793939912e-04, 3.735532872499645e-03, 7.273731991024998e-03, -4.140043717376366e-02,  1.729081963428792e-02, 6.363822706400223e-02, 1.623092321007468e-03, 1.442973176631790e-03, 2.967037039234150e-02, 4.828803153350589e-03,  7.849583198045310e-03, -7.224768457981225e-03, -4.743679782732121e-03, -8.316938482149944e-03, 3.351931561342154e-03, -2.227903682969340e-02,  1.623092321128930e-03, 6.924106661489690e-02, -3.406220837182236e-03, -4.004407800674359e-04, 2.346632991615109e-03, -2.365575729108920e-03,  1.615379313892766e-02, 2.653984385231313e-03, 7.637736861500656e-03, 1.566199133042581e-02, 1.955886392088512e-02, 1.442973176668121e-03, -3.406220837186320e-03, 3.264771036078670e-02, -6.126482726587800e-03,
                  -2.359311956239417e-02, 1.630950160061375e-02, -2.729304258292024e-03,  2.688444358355324e-03, -1.117043653231653e-03, -3.256274241129306e-02, -3.577707689709376e-03, 2.967037039230351e-02, -4.004407801513465e-04, -6.126482726616382e-03, 4.528987866776534e-02, 1.072548700893582e-02, -1.375505301410526e-03, -7.428253701876250e-03, -7.578400636399545e-04, -6.466013030295441e-03, -2.857376339038924e-02, -1.186373919916088e-02, 4.828803153298922e-03, 2.346632991604339e-03, -2.359311956239244e-02,  1.072548700889613e-02, 5.691820403455942e-02, -2.552159252834686e-02, 6.575435066870250e-03, 2.079650397276499e-03, 6.207232971205217e-03,  8.122992081727665e-03, 7.296860222695231e-03, 7.849583198083560e-03, -2.365575729128417e-03, 1.630950160060115e-02, -1.375505301370926e-03, -2.552159252833009e-02, 4.742428325941777e-02, -5.318524696402384e-03, -1.748896043650568e-03, -1.434491932335441e-03, 5.112013707391850e-03, -6.267237793760750e-04, -7.224768457945749e-03, 1.615379313894933e-02, -2.729304258279046e-03, -7.428253701861452e-03, 6.575435066856008e-03, -5.318524696384207e-03, 2.659055677567340e-02, 7.205970166945033e-03, 2.882953854432468e-03, -1.377982574382824e-03, 3.942537351171844e-03,  3.877073051750737e-03, -5.457862851366855e-03, 1.721960572316368e-03, 3.636585365248199e-03, -6.153931294017336e-04, 2.150209405951961e-03, -2.825992073399955e-03, 2.882953854438353e-03, 1.016712388766176e-02, 3.361971051552633e-04, 1.508256633576356e-02, 6.419731027004686e-03, -8.132687549747317e-03, 4.667374971241851e-03, 9.106654633533264e-04, -3.640446559674070e-03, 4.652612317972512e-03, -2.330287426082881e-03, -1.377982574393743e-03, 3.361971051053108e-04, 6.169609489133577e-02, -5.790733672452761e-03, -4.175394024928691e-02, 2.801424904114690e-03,  1.169942513332198e-02, -3.054716602698683e-02, -2.655599563609672e-02, 6.393774926902075e-03, 2.985185150483358e-03, 3.942537351197042e-03,  1.508256633577128e-02, -5.790733672262526e-03, 6.089064926278030e-02, 1.745376266820199e-02, -1.870679234452848e-02, 1.077199821046156e-02,  2.886371244683878e-03, -1.839462858414785e-03, 2.323453472748265e-03, -1.405439082139087e-03, 3.877073051770804e-03, 6.419731027051329e-03, -4.175394024920201e-02, 1.745376266836813e-02, 5.950978747843627e-02, -7.137063793621365e-04, -2.819225772199797e-04, 2.899215317476652e-02,  9.666847913577910e-03, 4.983642982316225e-03, -5.766798608028651e-03, -5.457862851361736e-03, -8.132687549756455e-03, 2.801424904166835e-03, -1.870679234457049e-02, -7.137063794252657e-04, 7.102680817494791e-02, -5.358567204210728e-03, -1.451893477396970e-03, 7.452228253684689e-03, -7.558098982275134e-03, 1.938991215039343e-02, 1.721960572320442e-03, 4.667374971232784e-03, 1.169942513337595e-02, 1.077199821041893e-02, -2.819225772855783e-04, -5.358567204211130e-03, 2.778042752782451e-02, -3.907139166015121e-03, -1.891255419288122e-02, 1.328058986211943e-02, -4.048345453614835e-03, 3.636585365257082e-03, 9.106654633917687e-04, -3.054716602698132e-02, 2.886371244830327e-03, 2.899215317482573e-02, -1.451893477357326e-03, -3.907139165973292e-03, 4.317382421500925e-02, 1.039382305771123e-02, -7.090529812662608e-04, -5.932721817573890e-03, -6.153931293989365e-04, -3.640446559652258e-03, -2.655599563612118e-02, -1.839462858328922e-03, 9.666847913637332e-03, 7.452228253703541e-03, -1.891255419286179e-02, 1.039382305773126e-02, 5.280676725336275e-02, -2.275702400322153e-02, 8.705008522599511e-03, 2.150209405951614e-03,  4.652612317966033e-03, 6.393774926919915e-03, 2.323453472721615e-03, 4.983642982289653e-03, -7.558098982279351e-03, 1.328058986211575e-02, -7.090529812791161e-04, -2.275702400322692e-02, 4.402301178384455e-02, -7.350725555882421e-03, -2.825992073397123e-03, -2.330287426092788e-03,  2.985185150518512e-03, -1.405439082182350e-03, -5.766798608078373e-03, 1.938991215038975e-02, -4.048345453618803e-03, -5.932721817602096e-03,  8.705008522588936e-03, -7.350725555881032e-03, 2.698517621003151e-02, 6.723092242055237e-03, 1.906162230610008e-03, -5.192129171691037e-03,  1.272320365066353e-03, 5.124425951006309e-03, -4.303207242706621e-03, -9.115245131713388e-04, 5.657777007565555e-03, 3.297684120858679e-03, -4.815991896805109e-04, -2.455091418503945e-03, 1.906162230606967e-03, 8.158525233381510e-03, -3.015087957827857e-03, 1.076195590935951e-02,  6.810194561371012e-03, -5.474182815481789e-03, 1.588879505888450e-03, 2.905868858978277e-03, 3.393757545507142e-04, 1.509983778508832e-03, -1.637629518316373e-03, -5.192129171684901e-03, -3.015087957796092e-03, 3.437114738259968e-02, -9.633634450941139e-03, -2.338100275436095e-02,  9.496298758347187e-03, -8.015759982519434e-05, -1.458680659780531e-02, -5.301230087109770e-03, -5.370933548957193e-03, 5.193575153282438e-03,  1.272320365059293e-03, 1.076195590935204e-02, -9.633634451005549e-03, 4.787531450386087e-02, 1.704811221712063e-02, -1.360613166073497e-02,  6.046076291199967e-03, 6.724902543533567e-03, 1.911754590216031e-03, -2.415764314589119e-04, -1.529731613019822e-03, 5.124425950991513e-03,  6.810194561340519e-03, -2.338100275444447e-02, 1.704811221707787e-02, 4.573847376532632e-02, -5.679506486399634e-03, 5.672671169778759e-03,  1.847139036197443e-02, -2.420233728085877e-03, 1.056309226976736e-02, -7.299490464580873e-03, -4.303207242707819e-03, -5.474182815479039e-03,  9.496298758335174e-03, -1.360613166072688e-02, -5.679506486381928e-03, 6.101488326227242e-02, -2.079764646416174e-03, -6.741136641690740e-03,  2.382626792503211e-03, -5.172044873145825e-03, 1.712662409852772e-02, -9.115245131760351e-04, 1.588879505894805e-03, -8.015759988177284e-05,  6.046076291225873e-03, 5.672671169849646e-03, -2.079764646418095e-03, 2.236866927263790e-02, 3.356126660784537e-03, -8.748280789375984e-03,  6.829135274386744e-03, -3.142712076481597e-03, 5.657777007558094e-03, 2.905868858954275e-03, -1.458680659783041e-02, 6.724902543490593e-03,  1.847139036193536e-02, -6.741136641701363e-03, 3.356126660736822e-03, 3.475736154857904e-02, -1.809617857422947e-03, 6.125053329001406e-03, -7.595659647993422e-03, 3.297684120863770e-03, 3.393757545346940e-04, -5.301230087035153e-03, 1.911754590166127e-03, -2.420233728199057e-03,  2.382626792502586e-03, -8.748280789389421e-03, -1.809617857491747e-03, 3.612131555591263e-02, -1.166231947199466e-02, 6.695773369972179e-03, -4.815991896874944e-04, 1.509983778514903e-03, -5.370933549031395e-03, -2.415764314292573e-04, 1.056309226985375e-02, -5.172044873149397e-03,  6.829135274382368e-03, 6.125053329061975e-03, -1.166231947197159e-02, 3.755999646507416e-02, -6.075427550241677e-03, -2.455091418500897e-03, -1.637629518312152e-03, 5.193575153301382e-03, -1.529731613015897e-03, -7.299490464588030e-03, 1.712662409853030e-02, -3.142712076470388e-03, -7.595659648004432e-03, 6.695773369953039e-03, -6.075427550228374e-03, 2.687685133695161e-02, 7.718107739406604e-03, 2.088973539882220e-03, -6.712074437420529e-03, 1.712483062369097e-04, 5.606195995237505e-03, -4.781770389185432e-03, -2.200373354807075e-03, 6.402750620925775e-03,  5.415107771447547e-03, -1.200367955039708e-03, -2.623711056226658e-03, 2.088973539879035e-03, 8.472401994523593e-03, -3.074346165540533e-03,  9.152607083498965e-03, 5.690809423370413e-03, -4.075090886373429e-03, 3.823977528078504e-04,
                  2.055964262143131e-03, 1.818437401852502e-03,  7.355813370340664e-04, -7.171731659330969e-04, -6.712074437412667e-03, -3.074346165514686e-03, 3.744215055466982e-02, -8.400181879214957e-03, -2.359810240101973e-02, 9.640223951858470e-03, 5.452569550512543e-04, -1.538278556377359e-02, -6.058704676837584e-03, -7.014525244563793e-03,  5.137697323740198e-03, 1.712483062256548e-04, 9.152607083480480e-03, -8.400181879269275e-03, 4.603421966667343e-02, 1.315613351323869e-02, -1.047520900948361e-02, 5.119836122950611e-03, 4.689268636094084e-03, 2.561591079776757e-03, -1.111649553912575e-03, 5.974162049728060e-04,  5.606195995225473e-03, 5.690809423355425e-03, -2.359810240107463e-02, 1.315613351325023e-02, 4.853009523940210e-02, -8.805868520469495e-04,  4.665839840012592e-03, 1.937317554481677e-02, -2.375963975504047e-03, 1.079508909967791e-02, -6.777301748689221e-03, -4.781770389184113e-03, -4.075090886371383e-03, 9.640223951861260e-03, -1.047520900947767e-02, -8.805868520462279e-04, 6.756407160864319e-02, 5.625379303052652e-04, -4.967127294291882e-03, 2.748774149773439e-04, -3.506687882766542e-03, 1.669221692046108e-02, -2.200373354809191e-03, 3.823977528195077e-04,  5.452569550101483e-04, 5.119836123006233e-03, 4.665839840061609e-03, 5.625379303020178e-04, 2.481493771297535e-02, 2.867703480892728e-03, -8.910453182019606e-03, 6.130042194880114e-03, -2.136059840570144e-03, 6.402750620919231e-03, 2.055964262128767e-03, -1.538278556378797e-02,  4.689268636075203e-03, 1.937317554479534e-02, -4.967127294290202e-03, 2.867703480863674e-03, 3.896553543739056e-02, -1.514335574280743e-03,  5.535857331612631e-03, -7.979774859571215e-03, 5.415107771446784e-03, 1.818437401824177e-03, -6.058704676785098e-03, 2.561591079676614e-03, -2.375963975596779e-03, 2.748774149808030e-04, -8.910453182041700e-03, -1.514335574325506e-03, 4.023702813809726e-02, -9.468653462657128e-03,  6.491249316907644e-03, -1.200367955041332e-03, 7.355813370558684e-04, -7.014525244618597e-03, -1.111649553825839e-03, 1.079508909975979e-02, -3.506687882768984e-03, 6.130042194891883e-03, 5.535857331655902e-03, -9.468653462643695e-03, 4.320012510198146e-02, -4.534021820071649e-03, -2.623711056225526e-03, -7.171731659372780e-04, 5.137697323753451e-03, 5.974162049548759e-04, -6.777301748708026e-03, 1.669221692046086e-02, -2.136059840571920e-03, -7.979774859581540e-03, 6.491249316903591e-03, -4.534021820070566e-03, 2.921248746394486e-02 )
               , tolerance = 1e-06)

  expect_equal(c(fit$lag_one_cor),
               c( 2.472713021091055e-02, 1.097125942793212e-02, 8.350009489440084e-03, 3.602202044835847e-03, -2.469429967404197e-03, -4.739561688121334e-03,  1.069480565499681e-03, -5.957432211894872e-03, 5.986853839816293e-04, 8.314856356014911e-03, -2.622531162771604e-04, 1.064806995475590e-02,  2.780089807037678e-02, 6.408671480477333e-03, 1.536021145668205e-02, 3.582505764476383e-03, -7.863556467937422e-03, 2.819836223316178e-03, -8.146950398293520e-03, -1.820998156039970e-03, 9.092459316017858e-03, 1.034910187481843e-03, 7.117957900161322e-03, 5.581391932367360e-03,  5.570151865660036e-02, 6.535188283600580e-03, -1.711925249372965e-02, 5.420474113633464e-03, 1.061294062970366e-02, -1.605085666718618e-02, -1.980684050212733e-02, -2.322645959216427e-03, -4.018630748242637e-04, 2.510934057876143e-03, 1.359064167340680e-02, 7.224233446905814e-03,  6.936116653833140e-02, -4.403091532863279e-04, -9.469552182755081e-03, 9.637060176761209e-03, -9.137980631453380e-03, -1.350976310905704e-03, -3.338859093942645e-03, 6.140693622340699e-03, -1.968582110680335e-03, 3.317309529727605e-03, -1.642079040786743e-02, 3.664492974537470e-04,  4.996801337970769e-02, 7.778626489188666e-03, -1.662660856294653e-03, 1.576941981204314e-02, 2.313008073047962e-04, -2.891667933854661e-03, -5.254720440561529e-03, -4.154167675832723e-03, -7.553735240025936e-03, 6.040638247338711e-03, -8.578908612062907e-03, 8.338887083339502e-03,  1.099491416986478e-01, 7.788132465100829e-04, -1.003013242757604e-03, 2.958553215884106e-03, -5.813487909292125e-03, 2.808083776544663e-02,  3.059172219823784e-04, 2.230685063238458e-03, 1.121528929454091e-02, 9.206023050143026e-03, -9.415429416215725e-05, 1.176224946549584e-03,  4.084061754263479e-02, -1.768444373932360e-03, -1.747880264526603e-02, 9.373014219954092e-03, -3.458957841360948e-03, -5.388544898644921e-03, -7.898499851924453e-03, -1.786552454967938e-02, -9.491209806381413e-03, 1.830445265426642e-02, -8.634663697510434e-04, -2.481692154196350e-03,  5.523428490042590e-02, 3.715528130884133e-03, -9.830931807914394e-03, -1.120800095150973e-02, 1.820782832910893e-03, -8.294420758748738e-04, -2.037019468920241e-02, 1.029719632248943e-04, -1.371888632252355e-03, 1.903880816033341e-03, -1.618869233556463e-02, 2.837140899089541e-03,  6.468058999413351e-02, -4.415919839102694e-03, 1.118632942222784e-02, 7.862742744359424e-03, 9.204107136590211e-03, -7.008849755449223e-04, -4.324324399246082e-03, 5.154177628525422e-04, -4.520917521818987e-03, 1.019709932708182e-02, -9.435350388135604e-03, -8.006631863028926e-03,  8.504273351602512e-02, 4.484381800560655e-03, -1.217771498537700e-04, 1.121408826840419e-03, 2.429117144609593e-04, 7.382502213201518e-03, -6.246692421674839e-03, 2.845998323489918e-02, -2.956714662136661e-03, -1.139231292080218e-02, 1.132223938794862e-02, 5.061059163389810e-03,  4.943094365206788e-02, 2.038029641120528e-02, 8.382727811430256e-03, 6.335360151471608e-03, 2.661954099400576e-03, -2.038305455635523e-03, -3.577834951790952e-03, 6.592481072584845e-04, -4.366236739970024e-03, 1.001670309680265e-03, 5.624235119456766e-03, -2.296658494476515e-04,  8.254436365191718e-03, 2.159984552721930e-02, 4.353999115077470e-03, 7.228494010191655e-03, 1.839738883906814e-03, -4.698328890390809e-03,  7.312329257120868e-04, -5.826625710821139e-03, -5.281160931329236e-05, 6.086369763764570e-03, 8.046859624684057e-04, 5.317876873758813e-03,  4.017044088012736e-03, 3.281679497191783e-02, 5.680614182011070e-03, -5.906711739878230e-03, 8.485216123781739e-04, 3.573789383327225e-03, -5.963078454875103e-03, -6.045414788648992e-03, -5.832429978252767e-03, -1.259749631315599e-03, 2.166621639160577e-03, 7.801956393518787e-03,  4.096292083437847e-03, 3.667111532679979e-02, -3.722926692390875e-04, -4.519111926131899e-03, 5.071163958086728e-03, -4.346167356988818e-03, -2.856152493969437e-03, 9.736353432171080e-04, 2.063032636656439e-03, -1.299275717490125e-03, 1.603657447480765e-03, -6.120458131551088e-03, -1.535708425739565e-03, 2.504929058912303e-02, 2.172481532539100e-03, -3.805849292667147e-03, 5.036057878995734e-03, 4.166172931104203e-03, -7.399871613828671e-03, -1.769855844327248e-03, -3.137570786973207e-03, -5.021559492351698e-03, 1.788607578048572e-03, -5.019142361453715e-03,  2.682498231585647e-03, 6.480863701740369e-02, -6.127009805162789e-04, -1.010441176171753e-04, 3.079713830468696e-03, -5.045336882771881e-03,  1.500145793064761e-02, 4.605077592994555e-04, 8.266344703163760e-04, 4.946976322741473e-03, 4.657742733093603e-03, -1.903732573225498e-03, -6.085142395886661e-05, 3.100160662357376e-02, -3.643364464400174e-04, -7.829600789102477e-03, 4.645214176014826e-03, -2.201482657299527e-03, -3.833847396609170e-03, -5.941779662892553e-03, -7.195397330089760e-03, -5.032229784032154e-03, 5.812634333935390e-03, -3.440831318255767e-04, -1.040138907522649e-03, 4.075704702794375e-02, 2.259384539383561e-03, -8.784727846692389e-03, -6.706514517419172e-03, 1.086832310430486e-03, -4.101701005149012e-04, -9.990119798683491e-03, -2.594769083570640e-03, 1.295393611599594e-03, 3.293742919910242e-03, -8.649131535813162e-03,  1.653069925363714e-03, 4.300637949878179e-02, 1.391618132968175e-03, 6.733879975044304e-03, 6.085678601479682e-03, 6.500106045018282e-03, -2.013014947195293e-03, -8.416158560118521e-04, -4.065041532113966e-03, -3.906974771302820e-03, 5.861690399955259e-03, -8.193890011428274e-03, -1.050524950592657e-04, 6.437325154478211e-02, 5.401128393142435e-03, -2.536156218162864e-04, 7.687672610966586e-04, -1.374409781681668e-03,  1.971241906085074e-03, -2.494803947291475e-03, 1.558361970095969e-02, -1.982743257006906e-03, -6.849357635350880e-03, 5.749073471778221e-03,  6.456291246790783e-03, 3.703094465659942e-02, 1.683715700002486e-02, 6.936095657068877e-03, 7.197403570202418e-03, 3.774773665792432e-03, -3.534459916417296e-03, -4.441023117839581e-03, 1.711431681537725e-03, -5.056487928302530e-03, -1.054913517101883e-03, 4.822637696136893e-03, -3.858836769837603e-04, 6.927237447931616e-03, 1.929031719108845e-02, 5.472861586559584e-03, 1.205841130996793e-02, 1.410708969735673e-03, -5.535770841088067e-03, 2.992706860573634e-03, -6.175748774066923e-03, -2.695366161343621e-03, 5.812383462601522e-03, 7.033094905161042e-04,  6.371869072767966e-03, 4.900973417609257e-03, 3.393567041140471e-02, 6.997768236037382e-03, -1.176023569448314e-02, 4.336858056647706e-05,  5.800158995292518e-03, -1.199919198733063e-02, -1.045478376576233e-02, -1.286374384443789e-03, 5.386814906282145e-04, 3.629567168397605e-03,  1.255247666111630e-02, 7.206431508831752e-03, 5.442686101776258e-02, 2.441784756416621e-03, -6.385751153612788e-03, 9.364168924074854e-03, -7.223736666939672e-03, -3.805594561361567e-03, -1.097999779851859e-03, 4.622700293693147e-03, -2.636363751700245e-03, 1.679369803624348e-03, -1.148598036991244e-02, 2.560734305151315e-03, 2.704038436971268e-02, 3.483564091953200e-03, -3.029939885716423e-03, 9.336848499506369e-03,  5.357471555939606e-03, -5.357885752232512e-03, -1.672950699363627e-03, -4.048836270648355e-03, -5.876900335088798e-03, 5.178474860094949e-04, -6.565686001553397e-03, 4.006969338771109e-03, 7.497157721698428e-02, -1.143897910250748e-03, -8.679202696653364e-05, 5.615290211980295e-03, -5.381329762754966e-03,
                  2.030637090948108e-02, 1.759365037066828e-03, 3.144003034870258e-03, 7.214923332311241e-03, 8.943959763320849e-03, -2.527293942262272e-03, -1.228055108695151e-03, 3.071136773862047e-02, -3.160460237142204e-03, -1.369388314067150e-02, 1.018659479406782e-02, -2.201261113743331e-03, -4.486876621859484e-03, -5.984107341775700e-03, -1.242346966320672e-02, -6.980891508590935e-03, 9.727451303554971e-03, -5.042815977983669e-04, -3.059667042934234e-03, 4.048981786782616e-02, 5.542570894936270e-03, -7.846679172164382e-03, -7.260609839927182e-03, -1.020337184338468e-03, -2.745243901648071e-03, -1.254723434082621e-02, -3.176830201450797e-03, 4.202595901680237e-03, 5.798913542395564e-03, -1.339430507305185e-02, 5.408230419132373e-03, 4.892909804378415e-02, -1.117597167041157e-02, 7.901336872804083e-03, 5.498549567762303e-03,  6.453787767378273e-03, 1.503984749675283e-03, -1.511063276666256e-03, -4.160674710692047e-03, -5.198074934749108e-03, 1.083083735272359e-02, -8.192165149359058e-03, -1.271631279260692e-02, 6.515319379986750e-02, 1.170376278575084e-03, -4.613657239030187e-04, 6.018574080160831e-04,  2.905267927950793e-04, 4.606639168959866e-03, -1.767981571972336e-03, 2.078629371061402e-02, -1.971705234763616e-03, -7.108496560799028e-03,  7.548322578803560e-03, 1.653732424674653e-03, 3.560435382780094e-02, 1.317652056829568e-02, 4.794140571397730e-03, 6.708939878712654e-03,  2.492352755673315e-03, -4.038546486741002e-03, -3.180824480762779e-03, 1.711528398495310e-03, -4.452406807956451e-03, -1.587950128636014e-03,  3.414779371551789e-03, -2.897778241612445e-04, 4.968493810646327e-03, 1.414090748633322e-02, 5.323542537473177e-03, 6.964063641193771e-03, -8.607173072382011e-04, -3.898417847383605e-03, 2.068847470775550e-03, -5.415088673779898e-03, -2.586131444335163e-03, 4.217171362430544e-03,  4.316457756212198e-04, 6.057780773528174e-03, 4.699902438008044e-03, 2.765917493902176e-02, 7.055439939870089e-03, -1.148997911305548e-02, -4.054406276201732e-03, 5.185630411353552e-03, -1.092732110679485e-02, -8.788508058630639e-03, 1.658213840541739e-04, -3.362016136110586e-04,  3.302683658130894e-03, 8.134088500695179e-03, 8.441058842727967e-03, 3.590212713180597e-02, -1.808036420531569e-03, -7.472519516592638e-03,  7.052650089890270e-03, -6.908159904267951e-03, -5.681574738752021e-03, 1.529757972529262e-03, 1.486286393719923e-03, -3.299970718305303e-03, -2.061912288361673e-04, -1.068263362382453e-02, -7.141735276607114e-04, 1.963909583975142e-02, 3.596257598593852e-03, -4.773492320302285e-03,  7.523108542185483e-03, 7.391371738408009e-03, -6.703635033431927e-03, -4.290683550136429e-04, -3.646525891091922e-03, -4.599337232214186e-03, -5.052988619085508e-03, -7.950686144029672e-03, 4.020845813325217e-03, 4.513639643503933e-02, -2.842697338174739e-03, 3.493549781467514e-03,  5.744727654206016e-03, -3.844280825554748e-03, 9.945444569017050e-03, 1.836535723193155e-03, 2.403122618428937e-03, 6.217388966883038e-03,  7.034328149560941e-03, -5.200955226700854e-03, -2.844138883896502e-03, 2.503372089522028e-02, -4.157691825815078e-03, -1.078846375127648e-02,  8.403770401586345e-03, -1.697822669551016e-03, -4.050752859125076e-03, -5.084892243425925e-03, -1.080148978796845e-02, -5.823549811336450e-03,  7.979118087648618e-03, 2.534709424528965e-03, -3.588352931128510e-03, 3.382229304840266e-02, 6.517112921193920e-03, -7.687314594665368e-03, -4.399021603320214e-03, -1.365912961102798e-03, -2.534015470291476e-03, -9.667029876366952e-03, -5.057372563732438e-03, 7.512693541068335e-03,  5.457139781107458e-03, -1.042849006372125e-02, 6.797002851655402e-03, 3.834328391625770e-02, -8.645551580105196e-03, 4.819943378297576e-03,  3.805518193957975e-03, 4.832582731409400e-03, 1.895883746792821e-03, 2.013193637530228e-03, -6.967453862319995e-03, -4.361798410338703e-03,  8.905980361074149e-03, -8.521788562059790e-03, -9.714844309648340e-03, 5.092913791227439e-02, 2.148632787205833e-03, -3.928876169162967e-04,  3.327785422492424e-04, -7.036548877691659e-04, 1.242079214061807e-03, -4.104546541023688e-04, 1.036431894064129e-02, -1.641731554501137e-03, -4.131506873713254e-03, 4.713169997947171e-03, 2.458285557557857e-03, 2.582596409654540e-02, 9.661481813361697e-03, 3.245628731592736e-03,  3.552524025273251e-03, 2.929711807041649e-03, -1.383174844135102e-03, -2.053726565007390e-03, 1.299351620259434e-03, -1.758417674826567e-03, -5.380602875245935e-04, 1.587053417045271e-03, -3.583982137679751e-04, 3.080702018446336e-03, 1.001082923633601e-02, 3.748349233784726e-03,  4.320181747558573e-03, -2.872423483071688e-05, -2.033202308810789e-03, 1.799016373800666e-03, -3.269293516736915e-03, -2.474740887437385e-03,  3.376126018227864e-03, 9.217771939013398e-05, 5.715304971524688e-03, 3.971480071461819e-03, 2.719331079364298e-02, 5.651464008347509e-03, -1.416723204084918e-02, -4.247617786716590e-03, 5.594956832487489e-03, -1.261771319581254e-02, -9.449416850121677e-03, 1.554541759026050e-03,  2.428276430768792e-04, 2.136818724251283e-03, 4.661969257108994e-03, 7.723484339252792e-03, 2.419234747041619e-02, -2.813081089014848e-03, -5.409359094695842e-03, 5.685568703214254e-03, -5.758951530801601e-03, -5.859897620783218e-03, 3.158534611699358e-03, 5.991645131075904e-04, -3.428649436784573e-03, -9.199766633660636e-04, -1.254580337594091e-02, -1.857679912058915e-03, 1.723696506990343e-02, 1.790451687959403e-03, -5.808081962747310e-03, 8.137492087208665e-03, 8.950220183259994e-03, -6.753919158870709e-03, -6.514916396215533e-04, -2.223876807417412e-03, -2.749665282018424e-03, -5.916415952762394e-03, -6.742867094129422e-03, 1.847153733563542e-03, 2.028581426120772e-02, -3.530650120596478e-03,  3.684127268764578e-03, 4.939039195063931e-03, -3.555297932596353e-03, 2.344118051247842e-03, 1.715823448533419e-03, 1.476496150624858e-03,  6.437786434892213e-03, 5.093985107229233e-03, -7.134216146756031e-03, -2.514227131274050e-03, 1.977902476207194e-02, -5.121196689542040e-03, -8.078249689656009e-03, 6.111220498023939e-03, -6.006048568863010e-04, -3.120738114880448e-03, -3.818103706432748e-03, -9.987685309929122e-03, -5.183801421896438e-03, 6.770713092429350e-03, 2.469820200789828e-03, -3.831424603688196e-03, 2.772039769828465e-02, 6.525042415342555e-03, -6.228773354781154e-03, -3.128509849222747e-03, -1.599842186871230e-03, -1.857800086784803e-03, -9.540233244052324e-03, -5.024320691213783e-03,  1.033653018698858e-02, 3.660283735159103e-03, -7.753958930562205e-03, 8.272269009308567e-03, 2.910491280912980e-02, -5.642652045357563e-03,  1.803579903480534e-03, 2.024167693188253e-03, 3.002682290430854e-03, 2.745206571001350e-04, 3.895428155139501e-03, -5.827272518361966e-03, -2.906737449675983e-03, 6.110041234434240e-03, -5.985136598745219e-03, -5.399626994868012e-03, 3.629501144199658e-02, 2.458230821640706e-03, -3.086120500681846e-04, 1.804207073045352e-04, -9.406289090550195e-04, -2.727381612813023e-04, -5.156178730476944e-05, 2.318948593850104e-03, -1.277862084575731e-03, -2.317449293703299e-03, 2.630406126607789e-03, 2.264864355160872e-03, 1.783602542934595e-02, 6.669133078472923e-03,  2.176858954302385e-03, 5.451092447334685e-04, 3.473223132703661e-03, 1.041364234912992e-03, -1.327753533961915e-03, 4.976159858796985e-04,  6.995125288543147e-04, 1.176210941018404e-03,
                  -3.850502614767487e-04, -3.224499549595753e-04, 1.925268900219605e-03, 6.854718757578959e-03,  2.118807923968057e-03, 2.549094836743108e-03, 2.702556383057848e-04, -9.768154133955173e-04, 8.258568973709337e-04, -1.701193235168058e-03, -1.111494154361167e-03, 1.695333750802085e-03, 5.413697714823969e-06, 3.092665116843025e-03, 2.947277212566552e-03, 2.818107712851545e-02,  6.382780895634423e-03, -1.594976032470578e-02, -2.517010234765921e-03, 6.416211855946095e-03, -1.290554995243072e-02, -1.002399768227901e-02, -3.359777886246910e-05, 1.169669825985496e-03, 2.295845993948889e-03, 3.395406254848626e-03, 4.948422783683202e-03, 1.941812737185581e-02, -2.041380505186008e-03, -4.603152228878668e-03, 3.984095743946074e-03, -4.545585893832227e-03, -3.747878776123534e-03, 2.490827253419563e-03,  2.798793992086421e-04, -1.139456571574183e-03, -1.645694616811508e-04, -1.517235081654060e-02, -3.553220419217902e-03, 1.698957114896271e-02, -2.552566926992821e-04, -6.412139174817508e-03, 8.302785845255144e-03, 9.283001205338611e-03, -3.575640710498581e-03, -1.525619458113569e-03, -1.368562635370616e-03, -1.540053805293270e-03, -2.866889311239090e-03, -4.562699848144238e-03, -3.846304498035873e-04, 1.182116176711199e-02, -2.322306063933847e-03, 1.208223807354500e-03, 2.946394330167030e-03, -2.494189931899562e-03, 6.926426942593031e-04, 1.027331090087671e-03,  1.392326026254328e-03, 5.765146371601540e-03, 5.159644628921652e-03, -6.189549103831355e-03, -2.267686142047843e-03, 1.541382827063006e-02, -4.238089863349971e-03, -5.804939273105613e-03, 3.668940447745731e-03, -2.331245893996515e-04, -8.187365838564524e-04, -2.115187266190851e-03, -1.073861164474351e-02, -5.525614307808299e-03, 7.204066953700643e-03, 6.553623093584176e-04, -3.793260699158249e-03, 2.233507459479883e-02,  5.633611469374617e-03, -2.440479787025980e-03, -3.074854554088679e-03, -3.520989001815273e-04, -1.812493411185847e-03, -9.397293565410209e-03, -5.410762997003148e-03, 9.492599298572711e-03, 2.669616532820886e-03, -6.233310924473153e-03, 6.920084224887469e-03, 2.231706412750356e-02, -2.909526933743192e-03, 7.421510107445434e-04, 2.790386691969272e-04, 2.062469510704280e-03, -1.444954641795379e-03, 3.895450049276588e-03, -3.238296446708887e-03, -2.495503959989769e-03, 3.502109875354217e-03, -2.527218226531128e-03, -1.847489001454146e-03, 2.440597041797780e-02,  1.713261828441372e-03, -3.310868621551359e-04, -1.269627788604705e-04, 5.460748735933775e-04, -2.019729693445924e-05, -1.100642003127549e-03,  7.875484100380841e-04, -5.757057976274818e-04, -2.549494916397364e-03, 1.230024057930004e-03, 1.391819328266544e-03, 1.340688798783888e-02,  4.377417789810244e-03, 1.407538781020136e-03, -2.498974279247689e-03, 2.444013678410208e-03, 3.915150686131104e-03, -1.412113956727998e-03, -1.077019445036051e-04, 3.278366819650661e-03, 1.870933394505877e-03, -3.305836159630418e-04, -1.083750900373029e-03, 1.178093788109451e-03,  4.454593105907147e-03, 1.275114999404530e-04, 2.245790433682501e-03, 9.023906591949290e-04, -1.084832595489770e-03, -4.806404767959509e-05, -1.148636838938029e-04, 6.145173492177159e-04, 5.285617559976389e-05, -9.686821806966989e-05, -4.753596670509963e-04, 1.111575606141057e-03,  1.924347450927057e-02, 3.158635380340420e-03, -8.370796098226854e-03, -6.709459760746777e-04, 4.427267053419868e-03, -5.552781755675220e-03, -7.124878450642409e-03, -9.067958410656249e-04, -8.287289146154358e-05, 2.060350864959267e-03, 1.067201957315566e-03, 1.922773831782730e-03,  1.077583730638608e-02, -2.890548359209876e-04, -4.127047953456931e-03, 2.945112130139530e-03, -1.276169131423336e-03, -3.657472241320273e-03,  3.506287923665091e-03, -1.672417123816279e-03, 1.546303754558784e-03, 7.284441573240526e-04, -1.018400531765210e-02, -1.037611273784162e-03,  1.128881316972015e-02, -8.717678334811260e-04, -4.077040265158628e-03, 3.687841303393349e-03, 6.118090834975663e-03, -1.502359215111711e-03, -6.273021005397507e-04, -9.060726227319176e-04, -7.746082297443748e-04, -1.185570172796198e-03, -3.907636301154614e-03, -9.992067184608610e-04,  8.100938279064137e-03, -1.504856756177059e-03, -1.073848669635937e-05, 1.377015106692628e-03, -1.435975977457233e-03, 2.935652960373899e-04, -8.604474480799335e-05, 1.588401561488998e-04, 3.456090592970324e-03, 2.538884337214276e-03, -4.141335444205501e-03, -1.479202730156063e-03,  1.079386947098973e-02, -1.780188864168586e-03, -3.386352955618494e-03, 1.423530336568927e-03, -4.327665181581538e-04, 1.542121606748748e-03, -4.177572111792654e-04, -5.703743638814231e-03, -1.955054790952518e-03, 2.611177413884859e-03, 4.304255964678788e-04, -2.096710305435974e-03,  1.327261287651227e-02, 3.490397425226438e-03, -1.206535724682113e-03, -1.086608486135955e-03, 1.600266017023799e-03, -2.946338173998743e-04, -5.564582001508479e-03, -3.150113473246170e-03, 5.782385058571026e-03, 1.084123123396476e-03, -3.415226649675058e-03, 2.804231206644995e-03,  1.470036676154491e-02, 4.131332520875644e-04, 4.187027718322808e-04, -7.068406930118933e-04, 5.717092328069509e-04, -1.324539599822685e-03,  2.049731826715788e-03, -3.528634164261021e-03, -1.596021841798613e-03, 8.543557502801186e-04, -1.568656877712982e-03, 1.147868702228725e-03,  1.450496712167207e-02, 1.876920213714013e-03, -4.350522189049478e-04, -2.884403841929291e-04, 8.067856163501913e-06, -1.042398673051210e-03, -3.883828092817727e-04, -2.479012713601375e-04, -3.838167781606645e-04, -1.341217233588919e-03, 4.219088244925419e-04, 1.527924268293882e-03,  9.175370977640315e-03, 2.958014364325182e-03, 8.954075301943439e-04, -2.386386855416806e-03, 1.006415152723589e-03, 3.217892157071381e-03, -1.301866831731705e-03, -3.988202871243629e-04, 2.825579162794449e-03, 1.646722363524761e-03, -5.231610591722817e-05, -1.089449614477474e-03,  9.212031861481822e-04, 2.901546874991283e-03, -3.911187172789506e-04, 6.094750127508520e-04, 1.043520160109116e-03, -8.765465632736287e-04, -5.035045523483998e-04, 4.248018829963185e-04, 8.778980518806690e-04, -1.835867689889516e-04, -3.001353235516526e-04, -2.170819433515339e-03, -6.164057565303861e-04, 1.423723449521924e-02, -1.047420924259628e-04, -7.360940960501935e-03, 1.748925127663156e-04, 2.616671719954508e-03, -3.841604877683773e-03, -4.831078950469131e-03, -1.203665330140158e-03, -2.434654989435837e-04, 1.412826210918064e-03, 1.092992055068005e-03,  2.691041289354990e-04, 5.289932750060476e-03, 7.867606550238232e-04, -3.665277857340221e-03, 1.148553651933341e-03, 4.364358054330044e-04, -1.835292379821892e-03, 1.857836087365023e-03, -1.876625181375580e-03, 3.025542313228690e-03, 1.222616937343286e-03, -6.943574382791216e-03,  7.080003561678413e-04, 9.576249022865638e-03, -1.458072164778839e-03, -2.777261815796237e-03, 2.690886227530253e-03, 4.145052121625727e-03, -1.747306199311758e-03, -7.130005995439823e-04, -9.825311911797121e-04, -8.338288947407271e-04, 3.720506528663407e-04, -2.758191131961776e-03, -1.300225581966894e-03, 6.854934637657434e-03, -8.795424158632917e-04, -3.564511974763534e-04, 5.899025004509689e-04, -1.329578159186405e-03,  4.513182703196894e-04, -3.816446862984849e-04, -4.687895962486273e-04, 2.651459826790313e-03, 1.014196110148091e-03, -2.713621256099516e-03, -1.050743196366248e-03, 7.258302080822968e-03, -9.083886444388353e-04,
                  -2.267105004161043e-03, 3.298205627076747e-04, -5.873053076950349e-04,  2.552350293238249e-03, 4.510606668211928e-04, -3.881692203497596e-03, 3.434226855695039e-04, 2.981541501542615e-03, -9.629844288604932e-05, -9.940020029138904e-04, 9.182146024797718e-03, 1.998080676238923e-03, -1.020113249204724e-03, -7.939333165185505e-04, 1.690121432399154e-03,  1.046162942677990e-03, -5.371287370884071e-03, -1.205239487889404e-03, 4.860010769819674e-03, 6.250519495508652e-04, -2.238885074971136e-03,  2.399544782057715e-03, 1.061737233908136e-02, 1.330610667548470e-03, 4.849708808367520e-04, -2.699364521934358e-04, -1.326375659671318e-04, -1.314316996855513e-03, 1.943153610399709e-03, -1.376895410630294e-03, -1.278758943924399e-03, 3.841641340398419e-04, -8.377215843298165e-04,  1.336334110308252e-03, 9.906258683843691e-03, 1.257453751565260e-03, -8.454259966833573e-04, -1.701778709734530e-04, -4.253564603211928e-04, -1.265547456033335e-03, -3.107363588327493e-04, 3.386274158485368e-04, -4.610081214675517e-04, -5.983168635459515e-04, 5.670763123689653e-04,  1.290633620634614e-03, 6.436878987738539e-03, 1.732902591090041e-03, 5.039352088567045e-04, -1.516547592376468e-03, 1.692264107890672e-04,  1.690841303959320e-03, -8.589340760889021e-04, -5.675341914066995e-04, 1.556513453874515e-03, 1.320043245668675e-03, -1.796957644899315e-04, -6.316602786018309e-04, 6.232181222683278e-04, 1.615327680585464e-03, -5.655908833140926e-04, 2.737575000597884e-04, 5.873090432370881e-04, -6.368649111664838e-04, -5.555527249860162e-04, 2.527347502604226e-04, 9.679524203443407e-04, -1.391251870816830e-04, -1.005368082280808e-04, -1.833310637940746e-03, -8.906746415961600e-04, 6.900265101305647e-03, -4.148736827052558e-04, -3.053577995760760e-03, 9.593246533585362e-04,  9.191758541622820e-04, -1.103355695050327e-03, -2.230207417362943e-03, -2.258297276922896e-03, -3.292918440136251e-04, 4.074695646627249e-04,  2.894493094611023e-04, -1.083556251394806e-03, 2.919054581849636e-03, 1.120295443517300e-03, -2.241362845815139e-03, 3.031849435175241e-04,  9.376854040812409e-04, -1.695016922016767e-04, 9.831260276649319e-04, -1.050503094959029e-03, 2.138616939928047e-03, 9.879460605554799e-04, -3.588971817887564e-03, 5.438794686454647e-04, 5.123349942698091e-03, -1.396938462389507e-03, -1.327630414830975e-03, 1.299348203911064e-03,  2.293933954695427e-03, -1.189825691137597e-04, -4.037467999195168e-04, -6.857146358191541e-04, -5.423413279626629e-04, 1.118967542766748e-03, -1.889394859424967e-03, -1.531402561624838e-03, 5.634602644597114e-03, -3.973863105727137e-04, -8.699701045343183e-04, 1.724591690858189e-04, -9.674834256580905e-04, 1.084636719716534e-03, -5.273297887161483e-04, -5.465448780377266e-04, 6.144355406042588e-04, 4.391939886714566e-04, -8.727190954602687e-04, -5.614033067245512e-04, 3.867835220144061e-03, 2.429798125798883e-04, -9.662583222746855e-04, -9.357587285571136e-05, -5.264189560748217e-04, 1.725141603957680e-03, 5.229634243704511e-04, -2.005137968179199e-03, 5.386687041038429e-04, 1.690516814958263e-03, -7.196255867966484e-04, -2.448722585499953e-04, 5.027560399286937e-03, 9.805854119061335e-04, -2.743516447939606e-05, -5.979105334943734e-04,  1.337642183858029e-03, 9.400994513574588e-04, -2.107213686951029e-03, -5.135223735291065e-04, 1.768686132616578e-03, 3.735507287517151e-04, -1.107669053431998e-03, 3.275438217958857e-04, 5.955960526661967e-03, 1.527990966305802e-03, 7.381963132000727e-04, -4.983674256048569e-05, -4.516838167957548e-05, -1.918037521251181e-03, 8.290773354562970e-04, -3.120352319319420e-04, -1.196201360187659e-03, -1.292516806990348e-05, -3.960861093614456e-05, 1.367922643800569e-03, 6.570552937705417e-03, 6.958382133024611e-04, -5.787384522429504e-04, -1.443681390255419e-04,  1.040402751427210e-04, -8.365753737560678e-04, -7.102763927508336e-04, 1.068988114554860e-03, -2.930615556577957e-04, -8.552091554467874e-04,  3.900715326940066e-04, 8.923170084934539e-04, 4.078431197893860e-03, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00 )
               , tolerance = 1e-06)

  expect_equal(c(fit$fixed_effects),
               c(numeric(0) )
               , tolerance = 1e-06)

  expect_equal(c(fit$n_iter),
               c(19 )
               , tolerance = 1e-06)

  expect_equal(c(fit$Q),
               c( 0.015244200752793882, 0.019289935529848611, 0.053937181727171109, 0.033158935723626159, -0.032153186374312859, -0.025738522284790625, 0.028382271530101307, -0.040841982951251979, -0.043164650581944436, 0.030019576507624875, -0.001539046295666052, 0.019289935529848611, 0.105365167640276841, -0.011105980413393158,  0.311405852677149264, 0.162518635003552459, -0.011033497083876704, 0.110556800917507442, 0.019874247517523251, -0.082844698509549827, 0.081351538329762690,  0.007725288071069375, 0.053937181727171109, -0.011105980413393158, 0.456110070429396608, -0.127005824776764614, -0.455601318133265654, 0.031205794450345790,  0.075975804580188544, -0.355218065515207626, -0.207737810333835038, 0.061145720865564593, 0.063726290037251360, 0.033158935723626159, 0.311405852677149264, -0.127005824776764614, 1.246741908502146723, 0.405376863513089880, 0.044145467667949238, 0.188099244101197327, 0.014734592199754265, 0.124833074946271133, -0.145942288045180391, 0.206887725565044811, -0.032153186374312859, 0.162518635003552459, -0.455601318133265654, 0.405376863513089880, 0.947513789823829056,  0.209200462429577239, 0.238719225378425270, 0.502745336701702961, -0.223882334970704255, 0.376522694056187435, -0.117241621608801888, -0.025738522284790625, -0.011033497083876704, 0.031205794450345790, 0.044145467667949238, 0.209200462429577239, 0.851028805639197139, 0.073481708405646842, 0.017867415934634888, -0.037623480879558982, 0.043213796604717462, 0.275619216030594028, 0.028382271530101307, 0.110556800917507442, 0.075975804580188544, 0.188099244101197327,  0.238719225378425270, 0.073481708405646842, 0.237021468011837932, 0.034601848109016155, -0.337994414178929503, 0.319807529257450485, -0.054444942016383578, -0.040841982951251979, 0.019874247517523251, -0.355218065515207626, 0.014734592199754265, 0.502745336701702961, 0.017867415934634888, 0.034601848109016155,  0.360054004719033149, -0.029080553050430689, 0.147404321393401094, -0.127893170490189806, -0.043164650581944436, -0.082844698509549827, -0.207737810333835038,  0.124833074946271133, -0.223882334970704255, -0.037623480879558982, -0.337994414178929503, -0.029080553050430689, 0.652971966520561775, -0.605107384151256200,  0.190279205404356860, 0.030019576507624875, 0.081351538329762690, 0.061145720865564593, -0.145942288045180391, 0.376522694056187435, 0.043213796604717462,  0.319807529257450485, 0.147404321393401094, -0.605107384151256200, 0.653807933891038751, -0.218319951360496423, -0.001539046295666052, 0.007725288071069375,  0.063726290037251360, 0.206887725565044811, -0.117241621608801888, 0.275619216030594028, -0.054444942016383578, -0.127893170490189806, 0.190279205404356860, -0.218319951360496423, 0.223042313869390968 )
               , tolerance = 1e-06)

  expect_equal(c(fit$order),
               c(1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$F_),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$method),
               c("UKF" )
               , tolerance = 1e-06)

  expect_equal(c(fit$model),
               c("exponential" )
               , tolerance = 1e-06)

  expect_equal(c(fit$est_Q_0),
               c(FALSE )
               , tolerance = 1e-06)

  expect_equal(c(fit$LR),
               c(1 )
               , tolerance = 1e-06)
})


