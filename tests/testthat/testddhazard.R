library(survival)

test_that("The head_neck_cancer must be defined for the ddhazard tests",
          expect_true(exists("head_neck_cancer")))

# Test on data set that is one of Farhmiers papers
result = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1, # Use by month intervals
  n_max = 10^4, eps = 10^-4,
  a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
  est_Q_0 = T,
  max_T = 45,
  id = head_neck_cancer$id, order_ = 1
)

test_that("Testing previous computed values vs. current on head and neck cancer set assuming that the previous is correct", {
  expect_equal(c(result$a_t_d_s),
               c(-3.5084644693000375, -3.5148844600373153, -3.1891314791814929, -2.8181185126716946, -2.5133150253138181, -2.0686431883814391, -2.1337664829927272, -2.5088816216986980, -2.7261252524003838, -2.8656346839715456, -3.0022690651419150, -3.2103909019454631, -3.3296886621454438, -3.3797024676574670, -3.2387762301797576, -3.2832268974011902, -3.4010378429506498, -3.4996364628495664, -3.4640927580381167, -3.5454306632739097, -3.5193437650355053, -3.6429455602328522, -3.8148529400485618, -3.9315760725295390, -3.9912270162929087, -4.1221212755199144, -4.2111505273306804, -4.2593181086540230, -4.3955501412991156, -4.5056360495292482, -4.5891834181979796, -4.6463491829253352, -4.6772452961075963, -4.6818100380470060, -4.6597979866888570, -4.6108005184078964, -4.5342715329240795, -4.4295511232451679, -4.4288880723551687, -4.5320293776581728, -4.6212298063525905, -4.6940739120459574, -4.7499759978712248, -4.7915369057959181, -4.8188789577153992, -4.8320508432930724, 0.4360755600018228, 0.4376620032308990,  0.4489331535887380, 0.4629877155198045, 0.4717967889720516, 0.4892432325019014, 0.4906015100905337, 0.4811672226212869, 0.4812410655726153, 0.4807008058089728,  0.4795022646846021, 0.4752694673136330, 0.4750540102025831, 0.4782488768524199, 0.4871715112202827, 0.4868843094919623, 0.4843562325887174, 0.4835935130835331,  0.4867226287750569, 0.4863614783282632, 0.4891031221907462, 0.4848002061937289, 0.4802281967614200, 0.4772168219924643, 0.4758176353352087, 0.4735558899381061,  0.4724962572592801, 0.4726240459881104, 0.4714467634180154, 0.4710489177360688, 0.4714390992094060, 0.4726106938155138, 0.4745588596923577, 0.4772841101671843,  0.4807925107278950, 0.4850950220887917, 0.4902067111479924, 0.4961460340659207, 0.4977474633246664, 0.4949782740709857, 0.4925889375015259, 0.4906451477362695,  0.4891628332671372, 0.4880589755764653, 0.4873303205106824, 0.4869755787235325 ))

  expect_equal(c(result$V_t_d_s),
               c( 0.0011007577913296656, -0.0001733451115550633, -0.0001733451115550633, 0.0004392322044566420, 0.0682991240249047060, 0.0003834452042018443,  0.0003834452042018442, 0.0029230271218272539, 0.0912395007549733350, -0.0003397914632747466, -0.0003397914632747466, 0.0052119615712443315,  0.0932049749695377378, -0.0016092541197089715, -0.0016092541197089711, 0.0073429567284740965, 0.0849686813506122934, -0.0030571106681653009, -0.0030571106681653005, 0.0093460739808944281, 0.0774928836229536178, -0.0044064881508436658, -0.0044064881508436658, 0.0112576788942480542,  0.0625786071371585012, -0.0058040178177705924, -0.0058040178177705924, 0.0131038581718835520, 0.0663037854506360463, -0.0066152078662832037, -0.0066152078662832037, 0.0149859903532218054, 0.0802636516361565355, -0.0072606054091964422, -0.0072606054091964422, 0.0169064138433351260,  0.0925945303565963995, -0.0077694160284284882, -0.0077694160284284891, 0.0188521666403896025, 0.1028653949187706279, -0.0082893243691400179, -0.0082893243691400196, 0.0208108298970566402, 0.1134521022635953669, -0.0087341231657698665, -0.0087341231657698665, 0.0227878464846351519,  0.1282127482321499812, -0.0091281359070864241, -0.0091281359070864224, 0.0247818173504978020, 0.1412262999503804406, -0.0096021138204995977, -0.0096021138204995960, 0.0267801536095240260, 0.1518039844431364749, -0.0100679733114127437, -0.0100679733114127437, 0.0287860644548110257,  0.1503781552817381462, -0.0107654864975719258, -0.0107654864975719258, 0.0307850681462566306, 0.1529892913432942814, -0.0114268209514253039, -0.0114268209514253039, 0.0328022104304094425, 0.1623989951758836869, -0.0119988254560485837, -0.0119988254560485837, 0.0348470071785677502,  0.1751405465177472420, -0.0124767948762201323, -0.0124767948762201323, 0.0369196593146410082, 0.1826262222670714253, -0.0130763410888457762, -0.0130763410888457762, 0.0390042849193854013, 0.1921213871302026865, -0.0136031573461606395, -0.0136031573461606395, 0.0411148217076838310,  0.1952137792451406062, -0.0142700820537257390, -0.0142700820537257390, 0.0432374522277687856, 0.2045009115946196943, -0.0150037228119862687, -0.0150037228119862670, 0.0453817496599724785, 0.2197992615605408318, -0.0156403530269492337, -0.0156403530269492302, 0.0475580384562985375,  0.2351742387248771660, -0.0163387197002041323, -0.0163387197002041323, 0.0497535112080704153, 0.2471786691448959739, -0.0171983898818672161, -0.0171983898818672196, 0.0519599789846230259, 0.2633406508519972045, -0.0179758501250396573, -0.0179758501250396607, 0.0541928396098181331,  0.2783570585162779554, -0.0187578421049752302, -0.0187578421049752336, 0.0564447233177911220, 0.2898617445280329274, -0.0196256986326030711, -0.0196256986326030711, 0.0587095922537396175, 0.3070089074201384216, -0.0202566671302706752, -0.0202566671302706752, 0.0610078966170546910,  0.3265517822464923947, -0.0207566923998554545, -0.0207566923998554545, 0.0633316746524540397, 0.3468613597848555496, -0.0211777326575118136, -0.0211777326575118136, 0.0656762424587988280, 0.3669330349624608245, -0.0215496836790728778, -0.0215496836790728778, 0.0680384930107222063,  0.3859999570458617635, -0.0218930814893318545, -0.0218930814893318545, 0.0704161786213701735, 0.4033580584084034970, -0.0222249753911356145, -0.0222249753911356145, 0.0728075543038044365, 0.4182756228156945255, -0.0225620115551172298, -0.0225620115551172298, 0.0752111771525787870,  0.4299395711487184468, -0.0229222709068044872, -0.0229222709068044872, 0.0776257813361121429, 0.4374185315654753881, -0.0233265169857653290, -0.0233265169857653290, 0.0800501930267311507, 0.4389396398028437285, -0.0237873509608388274, -0.0237873509608388274, 0.0824839842388029043,  0.4444370473634537966, -0.0241089985969926528, -0.0241089985969926528, 0.0849399776770060483, 0.4705099679725334716, -0.0239711015900734327, -0.0239711015900734327, 0.0874386019174675511, 0.5127677482774826156, -0.0234537793009185619, -0.0234537793009185619, 0.0899729190136854540,  0.5710035270105234817, -0.0225390051857156867, -0.0225390051857156867, 0.0925406272428825755, 0.6422966612793774566, -0.0213827332568293886, -0.0213827332568293886, 0.0951287192064125264, 0.7296350793987446126, -0.0198916154467032036, -0.0198916154467032036, 0.0977389611802057523,  0.8366982297826955906, -0.0179580979280018482, -0.0179580979280018482, 0.1003735699436583140 ))

  expect_equal(c(result$lag_one_cor),
               c( 0.0006319914823851234, -0.0001813450353835426, -0.0002126117899357636, 0.0004231047677557611, 0.0374926594959537965, -0.0005380017294018889, -0.0005485720017780360, 0.0027985731084827336, 0.0481658093802995874, -0.0016000013589881627, -0.0015949751696787691, 0.0050048137282718962,  0.0456878855983472026, -0.0029587363809467785, -0.0029189483751894322, 0.0070703673493283329, 0.0396604087798715019, -0.0043033008270456190, -0.0042589644753056816, 0.0090269214295090917, 0.0312294200116858406, -0.0056445383104769611, -0.0055052058435728288, 0.0109053718415916372,  0.0277604858121243067, -0.0066868592103896726, -0.0065493515470886115, 0.0127664150516888786, 0.0339237983194087267, -0.0074374459108181770, -0.0074140515313897131, 0.0146609784134950454, 0.0440622779829562689, -0.0081876860923845354, -0.0080158162771978795, 0.0165879425442369867,  0.0532613145041970354, -0.0087846810550449832, -0.0085842409359943670, 0.0185356890963747287, 0.0620030758351880484, -0.0093425048092310777, -0.0091025684196418474, 0.0204997891156617623, 0.0728513701255290580, -0.0097823345080032802, -0.0096128728534951753, 0.0224819052110776137,  0.0852163441699832769, -0.0102462632327539986, -0.0101088730406997656, 0.0244754314202132520, 0.0959330788853532263, -0.0107781511795978276, -0.0105860202161019556, 0.0264754322364910526, 0.1002061921916009707, -0.0114127390024465029, -0.0111391949292140822, 0.0284766937737128793,  0.1007636418466745787, -0.0120573912090688583, -0.0118570640836160000, 0.0304836792486671525, 0.1062366995263799574, -0.0126455551196479089, -0.0125325810037256995, 0.0325131894616143557, 0.1164479435890595910, -0.0131968007123752003, -0.0130824399573795571, 0.0345702739070011394,  0.1259739156939710947, -0.0137649784666452300, -0.0136274381705102868, 0.0366477215003125287, 0.1339397670426479281, -0.0143510749271825982, -0.0141996145156178810, 0.0387441154191005901, 0.1399397952275374390, -0.0149739632061277085, -0.0147895226744024933, 0.0408598614778161312,  0.1457693177465160805, -0.0155839512939056103, -0.0155955638120855878, 0.0429925035951635587, 0.1573951226983123508, -0.0162626012661845898, -0.0163227628857992857, 0.0451516935211992362, 0.1720884528462469087, -0.0169267713220890778, -0.0170279042024082637, 0.0473366336214868441,  0.1853207193021612631, -0.0176966192481461081, -0.0178397971217273306, 0.0495369101392598918, 0.1988822844190729910, -0.0185218493681163360, -0.0186795043672042492, 0.0517557651622434362, 0.2140265293846420891, -0.0193324169287155505, -0.0194536391053007109, 0.0539974391987324484,  0.2269743551126637005, -0.0201775348081844191, -0.0202760450098242243, 0.0562552827877792691, 0.2408827346519127055, -0.0209761004349988504, -0.0210013621236798051, 0.0585361402693362204, 0.2587873461391665963, -0.0215840832784766519, -0.0215509137876134238, 0.0608464935722820149,  0.2783108156512931197, -0.0220822328593056443, -0.0219982908028953338, 0.0631800531920647668, 0.2981521380750243311, -0.0225129962129074074, -0.0223819658897505894, 0.0655329263193361600, 0.3174279954979510876, -0.0229027366724126047, -0.0227258619326826256, 0.0679024304099249548,  0.3354014001863034333, -0.0232710946107934427, -0.0230480112171346438, 0.0702865626215162104, 0.3513521643906739600, -0.0236355450370131226, -0.0233647677843556098, 0.0726837231452698296, 0.3645059125021066215, -0.0240139196073090484, -0.0236931428694739724, 0.0750925529047788837,  0.3739890959881940757, -0.0244259932862989082, -0.0240522839920852098, 0.0775118285517998884, 0.3784535347735979438, -0.0249012435710693411, -0.0244462789870596130, 0.0799407418619832999, 0.3819151740934059180, -0.0253026050600785556, -0.0248317275156184590, 0.0823853873046871965,  0.3973498624532323387, -0.0253572058863496402, -0.0249807749061207209, 0.0848621500522364069, 0.4309121681052292541, -0.0250169074096886247, -0.0246995171538831222, 0.0873779395067437042, 0.4804161596009360879, -0.0243022568530614422, -0.0240233709749064703, 0.0899281997898045693,  0.5444877914482062486, -0.0232369005433537522, -0.0230542772574000854, 0.0925054925093105329, 0.6230475261289992739, -0.0218919395921305972, -0.0217917741796725788, 0.0951040211830674886, 0.7194167882990079033, -0.0201652844689610457, -0.0201377013624211842, 0.0977257666720493107 ))

  # expect_equal(c(result$n_iter),
  #              c(274 ))

  expect_equal(c(result$Q),
               c(0.129221898731263357, 0.002475034806031055, 0.002475034806031055, 0.002645631948634509 ))

  expect_equal(c(result$Q_0),
               c( 0.0011007577913296656, -0.0001733451115550633, -0.0001733451115550633, 0.0004392322044566420 ))

  expect_equal(c(result$n_risk),
               c(96, 95, 91, 84, 78, 65, 53, 49, 46, 43, 39, 37, 36, 36, 33, 31, 30, 30, 25, 25, 23, 21, 21, 21, 20, 19, 19, 18, 18, 18, 18, 18, 18, 18, 18, 18, 17, 15, 14, 14, 14, 12, 12, 12, 11 ))

  expect_equal(c(result$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45 ))

  # expect_equal(c(result$hazard_func),
  #              c([[1]]function (eta) {    exp_ = exp(eta)    exp_/(1 + exp_)}<environment: 0x000000001fb07d38> ))
  #
  # expect_equal(c(result$hazard_first_deriv),
  #              c([[1]]function (beta, x_) {    exp_ = exp(beta %*% x_)    x_ * exp_/(exp_ + 1)^2}<environment: 0x000000001fb07d38> ))

  expect_equal(c(result$risk_set),
               c(NA ))

  expect_equal(c(result$order),
               c(1 ))

  expect_equal(c(result$F_),
               c(1, 0, 0, 1 ))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result$a_t_d_s), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result$V_t_d_s)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result$Q_0)), rep(c("(Intercept)", "group1"), 2))
})

result_exp = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1,
  n_max = 10^4, eps = 10^-4,
  a_0 = rep(0, 2), Q_0 = diag(1, 2),
  Q = diag(1e-3, 2),
  est_Q_0 = F,
  max_T = 30,
  id = head_neck_cancer$id, order_ = 1,
  verbose = F,
  model = "exponential"
)

# matplot(result_exp$a_t_d_s, type = "l")
# get_expect_equal(result_exp)

test_that("Result of exponential model on head_neck_data match previous results", {
  expect_equal(c(result_exp$a_t_d_s),
               c(-3.97670917333694840, -3.97674594528922842, -3.67822723844953225, -3.38186160670887448, -3.20803125783379928, -2.81150733914823459, -2.86991583304613229, -3.19339409542700414, -3.33884572499217747, -3.44488663489353897, -3.55468195135890896, -3.74276473988639058, -3.83879589030475188, -3.85491280083719179, -3.69206869970224005, -3.74688315457354149, -3.86422464743509453, -3.94733561401569233, -3.90529955776537419, -3.96708964150362231, -3.92627936981884496, -4.05352095843694382, -4.21056855197516100, -4.31870528617516136, -4.37554856865496156, -4.48030141196976395, -4.54582342572652021, -4.57305289422576866, -4.66140004517541939, -4.72082090785410191, -4.75069382389330297, 0.23643942429448270, 0.23642538963461671, 0.35119909608991445, 0.46549545046933199, 0.53138482409557175,  0.68486304659599784, 0.66299911692218005, 0.53892413086915458, 0.48510875095794093, 0.44552674674974957, 0.40424312760390879,  0.33246258946182772, 0.29654462841347456, 0.29181540205284756, 0.35597679374548952, 0.33497520088953925, 0.28981802576768462,  0.25819314969811624, 0.27468066357009663, 0.25112029063171620, 0.26699776975209677, 0.21721608197843270, 0.15629576896568312,  0.11412921530635921, 0.09164410510332197, 0.05109346037346890, 0.02559506518920458, 0.01479926108810842, -0.01912463326287420, -0.04194359001789783, -0.05341608209319967 ))

  expect_equal(c(result_exp$V_t_d_s),
               c( 0.1832051868721281673, 0.0278848469490704347, 0.0278848469490704381, 0.0803177213322829875, 0.1132034251783800571, -0.0002825347413270007, -0.0002825347413270007, 0.0681138636429205468, 0.1057893643022574104, -0.0037108490430141639, -0.0037108490430141639, 0.0657813363200184242, 0.0933234388646140278, -0.0089983708866558654, -0.0089983708866558654,  0.0628183664969049760, 0.0788715600332714067, -0.0155162728380365406, -0.0155162728380365128, 0.0592778241516741244,  0.0734428605985888855, -0.0165822472363131579, -0.0165822472363131579, 0.0587135297616458440, 0.0591657019120934505, -0.0217911346933305147, -0.0217911346933305217, 0.0563985065119824158, 0.0614045817202078167, -0.0201269492208758713, -0.0201269492208758713, 0.0571887451287438134, 0.0723425094484046460, -0.0145208873097363092, -0.0145208873097363092,  0.0599501350321204399, 0.0803567973399948177, -0.0104885005098428984, -0.0104885005098429001, 0.0620705206328553000,  0.0869387047105238953, -0.0071134417298352650, -0.0071134417298352659, 0.0640036899753111677, 0.0939937589466598167, -0.0034894844498765754, -0.0034894844498765763, 0.0661485628168010653, 0.1056352965671321503, 0.0018561382382013911,  0.0018561382382013894, 0.0690194618275779270, 0.1154879277980833396, 0.0062299728951861078, 0.0062299728951861026,  0.0714630155033750963, 0.1222252055365240092, 0.0092166054186206374, 0.0092166054186206409, 0.0733443351545733369,  0.1171870821646983502, 0.0074167417118372499, 0.0074167417118372429, 0.0733164859929927581, 0.1186200073373010061,  0.0080962739829031592, 0.0080962739829031558, 0.0742920260983656322, 0.1267252242886504343, 0.0113714342440382615,  0.0113714342440382511, 0.0763302459132520761, 0.1368320431509568169, 0.0154106707763921706, 0.0154106707763921637,  0.0787023904830222026, 0.1418229945213846377, 0.0173294366900338045, 0.0173294366900338011, 0.0802302232935526993,  0.1484277775914494280, 0.0199114476530654755, 0.0199114476530654685, 0.0820632817930946612, 0.1488018943776022174,  0.0200040322972981702, 0.0200040322972981771, 0.0829277355347014244, 0.1570037340272072146, 0.0229661973712110210,  0.0229661973712110210, 0.0848786434078876301, 0.1710859655268716084, 0.0282664666087455024, 0.0282664666087455094,  0.0877901216774502752, 0.1865428085371889089, 0.0340275035065738946, 0.0340275035065738946, 0.0908764893254096623,  0.2014834476666247376, 0.0394535520998959832, 0.0394535520998959902, 0.0938003636583288197, 0.2229019052396607470,  0.0473425660283096975, 0.0473425660283097044, 0.0976811265666991113, 0.2487790398587779450, 0.0569349094050815366,  0.0569349094050815435, 0.1022282780020242754, 0.2799374204675383337, 0.0684956253291079536, 0.0684956253291079675,  0.1075214163665750289, 0.3289519028931106037, 0.0869897747611888261, 0.0869897747611888261, 0.1155225124818885507,  0.3996377264490825754, 0.1138172549902054936, 0.1138172549902054936, 0.1267411842245389220 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.1031151556577854234, -0.0025673007890856248, -0.0041177019347565513, 0.0671738953591519139, 0.0729285502330940805, -0.0153665974737224043, -0.0163223793842787457, 0.0611807158610895852, 0.0644065921154819421, -0.0192288355867880623, -0.0200771554947000441, 0.0587459567274195293, 0.0535427330021189529, -0.0239158942554452691, -0.0251883169614478958,  0.0558824984363825716, 0.0464796572600867930, -0.0275860737664426203, -0.0268684891017166583, 0.0542637414978720672,  0.0392122788902791175, -0.0294064481771485198, -0.0293297471017429506, 0.0532084301672932219, 0.0356480065351482064, -0.0305448770356387816, -0.0298416548856658831, 0.0528117325314924682, 0.0391007556490918923, -0.0284712115615889730, -0.0270759696825927688, 0.0541164525517244047, 0.0455860098549121379, -0.0246247696130386419, -0.0236000239726060282,  0.0561089074393790813, 0.0509999785363083741, -0.0216239631152422562, -0.0206527528940453828, 0.0578530091473455632,  0.0562916820073403254, -0.0187677945664524483, -0.0176931041764787911, 0.0596626970982066657, 0.0638551422142593222, -0.0149661074687492766, -0.0139066474561677852, 0.0619031698774247519, 0.0731667066769392804, -0.0105326229049919270, -0.0097298238679709072, 0.0643460593649873014, 0.0805695408224628151, -0.0071133009784132770, -0.0064778750491979904,  0.0663753078027907867, 0.0813318588316555291, -0.0064375392389208665, -0.0060344261003749443, 0.0672889043995953118,  0.0797084297205427755, -0.0069327416786996027, -0.0065228958987601513, 0.0677886978908447263, 0.0839155137757939540, -0.0051944934955948895, -0.0047410661895154194, 0.0692114369860178241, 0.0921739318284499620, -0.0018678257622304888, -0.0014075992625329978, 0.0712902662011879601, 0.0992140159350134720, 0.0009836567781669348, 0.0013068741186968123,  0.0731646605524272076, 0.1045839525483038546, 0.0030432240366696992, 0.0034174257987806232, 0.0747811495072748106,  0.1078806901256837703, 0.0043465972131570517, 0.0046400514000073771, 0.0761011970976562674, 0.1118466302783495819,  0.0058133786026677743, 0.0059801473520385215, 0.0774610865836157098, 0.1222694919469353436, 0.0096261272420231150,  0.0098751951619719461, 0.0797852602660696492, 0.1363267096938496348, 0.0149120552743186169, 0.0151021452356542747,  0.0826785580752974619, 0.1509511601798297353, 0.0203473430664968327, 0.0204124280247277787, 0.0855987685722870567,  0.1683981812721982996, 0.0267338143382507831, 0.0267771885593782767, 0.0888925354534749884, 0.1913172634181187770,  0.0351973298712989283, 0.0352340798926058796, 0.0929984973894393968, 0.2191117948941448679, 0.0455237478712123000,  0.0455043952847125482, 0.0978116210372377975, 0.2579818125849921984, 0.0600511874735620288, 0.0600949580273164030,  0.1042783059265411510, 0.3163625819533421035, 0.0821479346489345230, 0.0821887053999010020, 0.1136704668433825699 ))

  expect_equal(c(result_exp$n_iter),
               c(66 ))

  expect_equal(c(result_exp$Q),
               c(0.09946932732012863, 0.03783300224988726, 0.03783300224988726, 0.01543663831742442 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))
})

test_that("poisson model and logit moels hazzard functions differs", {
  expect_true(result_exp$model != result$model)
  expect_true(toString(body(result_exp$hazard_func)) !=
                toString(body(result$hazard_func)))
  expect_true(toString(body(result_exp$hazard_first_deriv)) !=
                toString(body(result$hazard_first_deriv)))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result_exp$a_t_d_s), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result_exp$V_t_d_s)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result_exp$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result_exp$Q_0)), rep(c("(Intercept)", "group1"), 2))
})


# Change by argument
result_exp = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 2,
  n_max = 10^4, eps = 10^-4,
  a_0 = rep(0, 2), Q_0 = diag(1, 2),
  Q = diag(1e-3, 2),
  est_Q_0 = F,
  max_T = 30,
  id = head_neck_cancer$id, order_ = 1,
  verbose = F,
  model = "exponential"
)

# matplot(result_exp$a_t_d_s, type = "l")
# get_expect_equal(result_exp)

test_that("Result of exponential model on head_neck_data match previous results with altered by argument", {
  expect_equal(c(result_exp$a_t_d_s),
               c(-3.66470254910492965, -3.66474706370252523, -2.76810021608623336, -2.37016905577829462, -2.88527701004363868, -3.09784986345455149, -3.48266257367868359, -3.53409599869474356, -3.50452999032306378, -3.68733386046285716, -3.75440297910365439, -3.92931420996290637, -4.13536817561038994, -4.31353242824072147, -4.29415086207046315, -4.44742781342733640, 0.14460881063442274, 0.14458966333745016,  0.54220314703993744, 0.71686313456859296, 0.48814165025303158, 0.39660025957471889, 0.22674612731683766, 0.20698865962895394,  0.22015367692421495, 0.13937097843449658, 0.10943794134073426, 0.02931587668643268, -0.06355936873028328, -0.14352365432290462, -0.13606103184196280, -0.20391357029043852 ))

  expect_equal(c(result_exp$V_t_d_s),
               c( 0.2239954769849443750, 0.0655923866343257334, 0.0655923866343257472, 0.0856850342803099352, 0.0701094856476841277, -0.0038922715688509135, -0.0038922715688509135, 0.0523721592627481858, 0.0755056468311222084, -0.0019795481071096244, -0.0019795481071096105, 0.0514742546248752875, 0.0459893287640510268, -0.0168002899428832814, -0.0168002899428832814,  0.0428520247345924449, 0.0395383065657095717, -0.0176668807846101159, -0.0176668807846101159, 0.0427380304585478071,  0.0554849050799214386, -0.0083268844417649975, -0.0083268844417650027, 0.0482405628816991311, 0.0685881166264916964, -0.0008915346260135876, -0.0008915346260135910, 0.0530967481749607603, 0.0917314760624167724, 0.0105768571207504984,  0.0105768571207505019, 0.0598970756325017256, 0.1029505276277184328, 0.0162964559289216979, 0.0162964559289216944,  0.0641352931380022306, 0.1037258639501149188, 0.0164485880804922657, 0.0164485880804922657, 0.0656497098810895630,  0.1265921801941821134, 0.0268701800644146269, 0.0268701800644146269, 0.0721116488290027280, 0.1394313143521199172,  0.0328068306908046725, 0.0328068306908046725, 0.0766830420360093551, 0.1583797329998488101, 0.0408462387555405329,  0.0408462387555405260, 0.0820262021138331576, 0.1897619001198406763, 0.0541928541421161369, 0.0541928541421161369,  0.0897223868891949550, 0.2404909896530670887, 0.0760800199433048219, 0.0760800199433048219, 0.1012582172983322176,  0.3106678049553517895, 0.1062117278334599041, 0.1062117278334599041, 0.1163272984336688326 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.0581028385172765310, -0.0072444734259627663, -0.0091541950837004671, 0.0507854295613683060, 0.0305719789171202405, -0.0205541704126560032, -0.0217954718525925212, 0.0429534684036514680, 0.0256335909301954809, -0.0232916444899874189, -0.0256021168272291474, 0.0396164859822722010, 0.0217562109295342289, -0.0268049576003472970, -0.0251706803089071125,  0.0380668354484768462, 0.0208436994532727946, -0.0254916865534527692, -0.0231220640448812874, 0.0396078590805537395,  0.0243612892264773936, -0.0218239875294321505, -0.0198641722726530523, 0.0425826594850195056, 0.0314033017870680442, -0.0171719045857336335, -0.0155045036084438571, 0.0462019832669743127, 0.0410358093169969629, -0.0117507577680532344, -0.0104671739924645686, 0.0502204627419419736, 0.0447135283650619969, -0.0094214520125273163, -0.0089886987863954937,  0.0526366994782183420, 0.0519460678887981378, -0.0064314589218757625, -0.0054966721024843051, 0.0557115478144272411,  0.0648237411726153845, -0.0004605667099179742, 0.0004626102810896780, 0.0602421445696742427, 0.0767237353479582607,  0.0050357523477366044, 0.0053979315269180438, 0.0644122809169798000, 0.0966036776555502241, 0.0134711383782364705,  0.0136579634961798840, 0.0698906297153868428, 0.1309471159607265567, 0.0281201853999506271, 0.0282851940496364022,  0.0781842396764870357, 0.1847772952660913237, 0.0513669286489622026, 0.0511865485567550155, 0.0901853413511809893 ))

  expect_equal(c(result_exp$n_iter),
               c(24 ))

  expect_equal(c(result_exp$Q),
               c(0.11112544355142200, 0.04881121798770979, 0.04881121798770979, 0.02253873603135799 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))
})

set.seed(3787)
sims <- test_sim_func_logit(n_series = 5e2, n_vars = 3, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = -.5, re_draw = T, beta_start = 0,
                            intercept_start = -4, sds = c(.1, rep(1, 3)))

test_that("Chaning time scale in EKF does no change results when other parems are changed accoridngly",{
  for(m in c("logit")){
    arg_list <- list(formula = survival::Surv(tstart, tstop, event) ~ . - tstart - tstop - event - id,
                     by = 1,
                     data = sims$res,
                     a_0 = rep(0, ncol(sims$res) + 1 - 4),
                     Q_0 = diag(rep(1e2, ncol(sims$res) + 1 - 4)),
                     Q = diag(rep(1e-3, ncol(sims$res) + 1 - 4)),
                     est_Q_0 = F, method = "EKF",
                     model = m,
                     eps = 1e-2, id = sims$res$id,
                     verbose = F,
                     max_T = 10)

    res <- do.call(ddhazard, arg_list)

    sim_tmp <- sims
    t_mult <- 2.5
    sim_tmp$res$tstart <- sim_tmp$res$tstart * t_mult
    sim_tmp$res$tstop <- sim_tmp$res$tstop * t_mult
    arg_list$data <- sim_tmp$res
    arg_list$by <- t_mult
    arg_list$max_T <- arg_list$max_T * t_mult
    arg_list$Q <- arg_list$Q / t_mult

    res_new_time <- do.call(ddhazard, arg_list)

    expect_equal(res$a_t_d_s, res_new_time$a_t_d_s)
    expect_equal(res$V_t_d_s, res_new_time$V_t_d_s)
    expect_equal(res$Q, res_new_time$Q * t_mult)
  }
})

set.seed(93143)
sims <- test_sim_func_exp(n_series = 1e4, n_vars = 10, t_0 = 0, t_max = 10,
                          x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                          intercept_start = -5, sds = c(.1, rep(1, 10)))
sum(sims$res$event)

tmp_file <- file("exponential.log")
sink(tmp_file)
result_exp = ddhazard(
  formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
  data = sims$res,
  by = (by_ <- 1),
  n_max = 10^4, eps = 10^-2,
  a_0 = rep(0, 11),
  Q_0 = diag(100, 11),
  Q = diag(1e-3, 11),
  est_Q_0 = F,
  max_T = 10,
  id = sims$res$id, order_ = 1,
  verbose = F,
  model = "exponential"
)
sink()
close(tmp_file)

matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
matplot(result_exp$times, result_exp$a_t_d_s, result_exp$a_t_d_s, type = "l", lty = 2, add = T)

# get_expect_equal(result_exp)

test_that("Result of exponential model on simulated data match previous results", {
  expect_equal(c(result_exp$a_t_d_s),
               c(-4.6404095989558618, -4.6403921080943018, -4.5511280255114395, -4.6144726846255448, -4.5912996307570610, -4.4831689949052231, -4.6202091607513758, -4.7694041763794699, -4.8342415680667665, -4.4213809361630787, -4.5228689348833671, 0.1082891581694410, 0.1084157089129437, -0.5748275203945915,  0.7906219522822504, 0.4626957787814849, 0.7412424562243989, 1.6617440523512788, 1.2185220434558623, 0.5201516167650608, 1.5208434755419789,  1.3423053805538903, -0.9809787393734105, -0.9809736656435690, -1.3632685502363773, -1.9434552600382375, -0.8970962907884400, -0.7963970138973209, -1.1124444943934706, -0.8415953337160537, -0.5505308331599315, -0.6427019077881883, -0.6180747171174954, -0.7543533462467026, -0.7543291443704009, -0.7888869126604299, -0.5569941382708128, 0.4154504122357695, 0.3212469012376346, 1.4614930669756954, 0.4843958311568954, -0.1929993231073172, -0.6536911342582187, -0.3826818560742176, 0.1537403760810888, 0.1538771283934572, -0.4452489217742360, 0.0062886118872932, -0.5687254893379011, -2.2748917683910688, -2.0935559357668949, -2.6489284864273821, -2.8058117679771595, -2.2791536233229204, -2.1866684773498997, -0.4101176977546692, -0.4099915953212039, -1.1479481674956893, 0.4388879063632611, 0.9885532042999781, 1.6126856496647570, 1.8533735711554773, 1.7649141420107985,  1.3968109553668748, 2.5279032144521212, 2.9160370492558716, 0.4555371163401958, 0.4557066501169125, -0.3445413027288091, 0.4327192390873759, -0.8517913087569688, -2.1267073964495284, -1.1607707304174597, -2.0303219926956735, -2.6594831858015358, -1.6982636604211698, -2.3008008198913332,  1.2141039894726287, 1.2138623035141456, 2.7856611711065820, 3.0802583170817104, 3.8252351428937801, 6.8575165701583103, 6.6410287200314837,  7.3178321863909455, 7.2254056118465240, 6.2801569125941574, 6.7834304749932066, 1.0550520184176948, 1.0551883026770388, 1.2430445982008709,  2.2749503783449341, 1.0932859404155943, -2.0890481971213819, -2.1796316954190638, -3.3742799631478748, -3.5470182488270221, -3.4176011952805032, -2.3452282805759461, 1.5800269262379036, 1.5799888263680009, 2.6798881977953770, 3.9822211747296326, 3.2981136546457841, 2.8123281888656364,  2.5421469149395270, 2.2020239927752261, 2.0427360524448739, 1.7502930991874659, 3.0336027043925569, 0.4669328118652871, 0.4669859597212475,  0.4787391351137185, 0.1738072749910253, -0.1923597126198209, -2.2414776145556745, -2.0530529399128850, -2.8867405206415775, -2.9262953869296808, -3.3185527649023361, -3.0777481786415333 ))

  expect_equal(c(result_exp$V_t_d_s),
               c( 5.031754710689995e-02, 5.935408560628216e-02, -5.298040186429141e-03, -8.992781121321996e-03, 1.245349943615739e-02, 5.488032121783697e-02,  5.613529702311346e-02, -3.097265863909292e-02, -3.138519758664036e-02, -4.114663360463250e-02, -3.265989493895428e-02, 5.935408560628216e-02,  4.977234481550425e-01, -8.960248369902984e-02, 2.119695511833467e-01, 1.915607133105036e-01, 4.617625252486834e-01, 4.081496546388741e-01, -1.924033350107316e-01, 1.428236486887309e-01, 2.984081806000624e-02, -4.845524017704118e-02, -5.298040186429139e-03, -8.960248369902984e-02,  1.595026902429879e-01, -2.043322824375882e-02, -9.996536575840301e-02, 1.854370427516708e-02, -1.907796947485635e-01, 6.763839775210892e-02, -2.729070953227591e-01, -1.895735870858334e-01, -1.096109134030575e-01, -8.992781121321994e-03, 2.119695511833467e-01, -2.043322824375882e-02,  4.868079153818883e-01, 5.887773287435152e-02, 1.320036656174410e-01, 1.615489493692523e-01, -2.485350520577370e-03, 1.142986336592903e-01,  3.812167279081968e-02, 1.313047817987677e-01, 1.245349943615739e-02, 1.915607133105037e-01, -9.996536575840298e-02, 5.887773287435150e-02,  5.256132045594057e-01, 7.340194759335694e-02, 5.599098767787758e-01, -8.568721011295172e-01, 8.512067832636676e-01, 1.253438410501495e-01,  4.575293487711662e-01, 5.488032121783697e-02, 4.617625252486836e-01, 1.854370427516706e-02, 1.320036656174409e-01, 7.340194759335694e-02,  6.706427262616330e-01, 1.372715506132721e-01, 6.907359175948818e-02, -1.796365498634918e-02, 1.030337815724726e-01, -2.451065795109012e-01,  5.613529702311346e-02, 4.081496546388742e-01, -1.907796947485635e-01, 1.615489493692523e-01, 5.599098767787760e-01, 1.372715506132721e-01,  8.264937288810188e-01, -9.373592492403395e-01, 7.746885395940442e-01, 7.870226040894697e-03, 4.338654802864971e-01, -3.097265863909292e-02, -1.924033350107315e-01, 6.763839775210893e-02, -2.485350520577407e-03, -8.568721011295171e-01, 6.907359175948823e-02, -9.373592492403392e-01,  1.657439622834289e+00, -1.206820838743362e+00, 1.341997502805051e-01, -7.836382209675949e-01, -3.138519758664034e-02, 1.428236486887309e-01, -2.729070953227591e-01, 1.142986336592903e-01, 8.512067832636676e-01, -1.796365498634919e-02, 7.746885395940443e-01, -1.206820838743361e+00,  1.792961949666690e+00, 6.486599047329742e-01, 9.172219141168354e-01, -4.114663360463249e-02, 2.984081806000625e-02, -1.895735870858333e-01,  3.812167279081967e-02, 1.253438410501496e-01, 1.030337815724726e-01, 7.870226040894721e-03, 1.341997502805052e-01, 6.486599047329742e-01,  6.609180796273080e-01, 1.718738077432155e-01, -3.265989493895426e-02, -4.845524017704121e-02, -1.096109134030576e-01, 1.313047817987677e-01,  4.575293487711662e-01, -2.451065795109012e-01, 4.338654802864971e-01, -7.836382209675952e-01, 9.172219141168356e-01, 1.718738077432155e-01,  6.267351631013156e-01, 5.814166662601464e-03, 1.279686330948262e-04, 3.594644817840626e-03, 1.542212800710156e-03, -2.690450020647365e-04,  1.778827630555954e-03, -1.744595231103620e-04, -3.413803632261871e-03, -4.530362276673169e-03, -6.763135682689020e-03, -1.119329083369248e-03,  1.279686330948275e-04, 2.273757019016872e-02, -6.136192717807628e-03, 6.373356456772414e-03, 2.854632143095674e-03, 1.357263166296849e-02,  1.396918113195857e-02, 3.863663857976636e-04, -3.171321431436423e-03, 7.380947663121885e-04, -6.516869828782116e-03, 3.594644817840626e-03, -6.136192717807623e-03, 1.947452979825531e-02, 3.181575105809239e-03, 2.008508983291430e-03, 8.309812669161644e-03, -1.211214619924439e-02, -6.554077098075886e-03, -1.168619577373519e-03, -8.136043358619668e-03, 4.180257911599788e-04, 1.542212800710154e-03, 6.373356456772419e-03,  3.181575105809253e-03, 4.303405173389009e-02, -1.853096234677108e-03, 1.107568661168836e-03, 1.889419177936702e-03, 5.376851356840124e-03, -5.755104653708579e-04, -2.509241783130412e-03, 1.003796651057894e-02, -2.690450020647363e-04, 2.854632143095710e-03, 2.008508983291460e-03, -1.853096234677128e-03, 1.211084612154240e-02, 4.069592660751091e-03, 4.874892015667720e-03, -1.132863057926687e-02, 9.435923021933048e-03,  2.691546618294861e-04, 2.976797103469614e-03, 1.778827630555955e-03, 1.357263166296850e-02, 8.309812669161627e-03, 1.107568661168844e-03,  4.069592660751082e-03, 3.713124754145976e-02, -2.764682463660976e-03, -1.206940445576931e-03, 2.161579238049114e-03, 3.592437175855695e-03, -9.804210115743495e-03, -1.744595231103639e-04, 1.396918113195859e-02, -1.211214619924438e-02, 1.889419177936675e-03, 4.874892015667744e-03, -2.764682463660958e-03, 2.815226304701424e-02, -7.657084905616339e-03, 5.772895633877426e-04, -5.635965637866391e-03, 1.843800230910154e-03, -3.413803632261872e-03, 3.863663857976783e-04, -6.554077098075883e-03, 5.376851356840092e-03, -1.132863057926689e-02, -1.206940445576904e-03, -7.657084905616366e-03, 3.642707389403767e-02, -7.682102004759540e-03, 1.199368476493897e-02, -6.995205395459289e-03, -4.530362276673168e-03, -3.171321431436413e-03, -1.168619577373530e-03, -5.755104653708588e-04, 9.435923021933029e-03, 2.161579238049105e-03, 5.772895633877285e-04, -7.682102004759546e-03, 3.214473558939748e-02, 1.671373075632247e-02, 1.147969248679116e-02, -6.763135682689021e-03, 7.380947663121948e-04, -8.136043358619642e-03, -2.509241783130408e-03, 2.691546618295305e-04, 3.592437175855680e-03, -5.635965637866367e-03, 1.199368476493900e-02,  1.671373075632248e-02, 3.186655481213974e-02, 1.788141003457675e-04, -1.119329083369245e-03, -6.516869828782133e-03, 4.180257911599540e-04,  1.003796651057895e-02, 2.976797103469539e-03, -9.804210115743476e-03, 1.843800230910118e-03, -6.995205395459346e-03, 1.147969248679121e-02,  1.788141003457464e-04, 1.784375866817385e-02, 4.862047549244369e-03, 2.955569897353273e-04, 2.775510241052798e-03, 9.679043459355209e-04, -2.215759375356912e-04, 1.123332086653332e-03, 2.507998277038193e-04, -2.520827579153313e-03, -3.649230319398213e-03, -5.707366891719806e-03, -1.160943692789717e-03, 2.955569897353305e-04, 2.007650397842905e-02, -4.904890832626097e-03, 5.951799671447635e-03, 2.702658765793621e-03,  1.260078913127083e-02, 1.227317963244396e-02, -2.368494995847904e-05, -2.562145223170865e-03, 2.472056918825817e-04, -5.628641501572223e-03,  2.775510241052796e-03, -4.904890832626093e-03, 1.592593808493398e-02, 2.033347647150088e-03, 1.525882850247503e-03, 7.063710444733687e-03, -9.926839097601010e-03, -5.261215616349406e-03, -1.142446050806942e-03, -6.416563887070511e-03, 6.196494493496162e-05, 9.679043459355219e-04,  5.951799671447635e-03, 2.033347647150095e-03, 3.774916256115913e-02, -1.430590751196936e-03, 1.075557694515614e-03, 2.158534412366538e-03,  5.175787055740058e-03, 5.703002474181384e-04, -1.027657821942612e-03, 9.137849050770024e-03, -2.215759375356923e-04, 2.702658765793657e-03,  1.525882850247522e-03, -1.430590751196954e-03, 1.061197055153253e-02, 3.772468705533793e-03, 4.641342588614450e-03, -1.022822573973595e-02,  8.526254587813411e-03, 3.122842454777772e-04, 2.882924878284988e-03, 1.123332086653330e-03, 1.260078913127083e-02, 7.063710444733680e-03,  1.075557694515625e-03, 3.772468705533803e-03, 3.295063321920987e-02, -2.112537240589282e-03, -7.948523150948141e-04, 1.996023541542637e-03,  3.636449069707731e-03,
                  -9.003045627373325e-03, 2.507998277038174e-04, 1.227317963244398e-02, -9.926839097601000e-03, 2.158534412366531e-03,  4.641342588614454e-03, -2.112537240589285e-03, 2.458164454595939e-02, -7.763949145076327e-03, 5.977358157248868e-04, -5.681178852950254e-03,  1.846673218532086e-03, -2.520827579153319e-03, -2.368494995846429e-05, -5.261215616349391e-03, 5.175787055740046e-03, -1.022822573973598e-02, -7.948523150947958e-04, -7.763949145076327e-03, 3.218179940391729e-02, -6.754202576490651e-03, 1.100704392142761e-02, -6.306405666276983e-03, -3.649230319398213e-03, -2.562145223170872e-03, -1.142446050806923e-03, 5.703002474181345e-04, 8.526254587813387e-03, 1.996023541542649e-03,  5.977358157248986e-04, -6.754202576490634e-03, 2.894914277723270e-02, 1.546339827900977e-02, 1.059767367541851e-02, -5.707366891719804e-03,  2.472056918825837e-04, -6.416563887070514e-03, -1.027657821942615e-03, 3.122842454777893e-04, 3.636449069707714e-03, -5.681178852950251e-03,  1.100704392142761e-02, 1.546339827900978e-02, 2.844295092093132e-02, 6.480462354271923e-04, -1.160943692789715e-03, -5.628641501572247e-03,  6.196494493492433e-05, 9.137849050770051e-03, 2.882924878284973e-03, -9.003045627373314e-03, 1.846673218532070e-03, -6.306405666277047e-03,  1.059767367541851e-02, 6.480462354272044e-04, 1.600312001583716e-02, 4.909448816452618e-03, 1.504531307224529e-03, 2.261972495775652e-03,  5.519877664123653e-04, 1.055855005270927e-03, 2.240757892215376e-03, 2.081883941768456e-03, -5.038305867825979e-03, -2.473598789569213e-03, -5.891174050468179e-03, -6.351182833404400e-04, 1.504531307224533e-03, 1.274769131654491e-02, -3.403295816728689e-03, 3.361528245910094e-03,  1.467484361239805e-03, 7.105304499683397e-03, 7.525889235415558e-03, 3.517054427479878e-04, -1.347950260229431e-03, 5.130706794258951e-04, -3.267568482957136e-03, 2.261972495775652e-03, -3.403295816728675e-03, 1.092251435144477e-02, 1.275665415655517e-03, 9.430398998313992e-04,  4.259618473003647e-03, -6.379432539361638e-03, -3.248509558199436e-03, -3.891582906618464e-04, -3.986890001591974e-03, 2.074818223693917e-04,  5.519877664123648e-04, 3.361528245910101e-03, 1.275665415655524e-03, 2.346891889171202e-02, -1.081280151902351e-03, 5.683369342385755e-04,  8.699246191141009e-04, 3.686365297374825e-03, 3.223962279613755e-04, -3.585115117989643e-04, 5.336481960459284e-03, 1.055855005270929e-03,  1.467484361239853e-03, 9.430398998313943e-04, -1.081280151902369e-03, 7.544625000363053e-03, 2.166442039146196e-03, 2.917182239449879e-03, -6.495901281888433e-03, 5.688387796207985e-03, 3.595102796370149e-04, 1.880033267780175e-03, 2.240757892215377e-03, 7.105304499683390e-03,  4.259618473003644e-03, 5.683369342385883e-04, 2.166442039146200e-03, 2.074785529330022e-02, -1.440313794472338e-03, -3.189071564636268e-04,  1.720438112389457e-03, 2.443676435392946e-03, -5.089951566409306e-03, 2.081883941768455e-03, 7.525889235415587e-03, -6.379432539361624e-03,  8.699246191140996e-04, 2.917182239449886e-03, -1.440313794472348e-03, 1.650294529600154e-02, -5.182910491877033e-03, 5.249299911763386e-04, -3.764082015338114e-03, 1.199400568247111e-03, -5.038305867825979e-03, 3.517054427480015e-04, -3.248509558199420e-03, 3.686365297374826e-03, -6.495901281888464e-03, -3.189071564636273e-04, -5.182910491877012e-03, 2.251120800202175e-02, -4.853870357844867e-03, 7.022992530141569e-03, -4.169206437295682e-03, -2.473598789569214e-03, -1.347950260229430e-03, -3.891582906618386e-04, 3.223962279613680e-04, 5.688387796207982e-03,  1.720438112389461e-03, 5.249299911763408e-04, -4.853870357844892e-03, 1.913333807731444e-02, 9.520711404146051e-03, 6.533910149835143e-03, -5.891174050468177e-03, 5.130706794258982e-04, -3.986890001591977e-03, -3.585115117989565e-04, 3.595102796370459e-04, 2.443676435392928e-03, -3.764082015338131e-03, 7.022992530141573e-03, 9.520711404146058e-03, 1.932244450815373e-02, 2.436659381779525e-04, -6.351182833404349e-04, -3.267568482957140e-03, 2.074818223693640e-04, 5.336481960459290e-03, 1.880033267780071e-03, -5.089951566409276e-03, 1.199400568247099e-03, -4.169206437295692e-03, 6.533910149835139e-03, 2.436659381779724e-04, 1.048131080972456e-02, 5.098084074653938e-03, -9.584751875149229e-04,  2.860825427786768e-03, 2.176363152658068e-04, -3.072085245928630e-05, -4.635457487227446e-04, 3.508333231171711e-04, -4.417399385011204e-03, -3.801592263704451e-03, -7.055420850859249e-03, -1.579296350383231e-04, -9.584751875149174e-04, 9.584470549431848e-03, -2.521042509008141e-03,  2.618836917077052e-03, 1.194369941060958e-03, 4.773424270829205e-03, 5.307366105214100e-03, 1.582380479396318e-04, -8.370612734678660e-04,  5.657717150229942e-04, -2.049551808563104e-03, 2.860825427786770e-03, -2.521042509008120e-03, 9.162293437233120e-03, 1.073676030546161e-03,  6.596806158114708e-04, 3.646247667170460e-03, -4.976343479359961e-03, -2.745539760403424e-03, -7.663531153624672e-04, -3.819215479577352e-03, -4.973007770288058e-05, 2.176363152658061e-04, 2.618836917077045e-03, 1.073676030546157e-03, 1.788998530267755e-02, -6.277448797059693e-04,  2.928972606468949e-04, 7.593510843382700e-04, 2.394237892264397e-03, -8.031460882891550e-05, -7.493604426798870e-04, 3.919236911631182e-03, -3.072085245929158e-05, 1.194369941060980e-03, 6.596806158114801e-04, -6.277448797059971e-04, 6.062460522737656e-03, 1.885062723342229e-03,  1.972070444050253e-03, -4.652689823485199e-03, 4.602236452222535e-03, 7.837534136232098e-04, 1.472173982136634e-03, -4.635457487227456e-04,  4.773424270829179e-03, 3.646247667170470e-03, 2.928972606468974e-04, 1.885062723342206e-03, 1.538837165747815e-02, -1.688981894037587e-03, -7.394297591863902e-04, 1.668232164666678e-03, 1.901827565424668e-03, -3.289537305210370e-03, 3.508333231171679e-04, 5.307366105214101e-03, -4.976343479359937e-03, 7.593510843382709e-04, 1.972070444050269e-03, -1.688981894037611e-03, 1.245711894699175e-02, -3.551063124741519e-03,  1.755094015069125e-04, -2.756053837250755e-03, 1.022124172740046e-03, -4.417399385011203e-03, 1.582380479396495e-04, -2.745539760403417e-03,  2.394237892264387e-03, -4.652689823485240e-03, -7.394297591863841e-04, -3.551063124741531e-03, 1.740468045277248e-02, -3.266042015597900e-03,  5.624142951453649e-03, -2.876566577604092e-03, -3.801592263704451e-03, -8.370612734678591e-04, -7.663531153624652e-04, -8.031460882892296e-05,  4.602236452222566e-03, 1.668232164666679e-03, 1.755094015069165e-04, -3.266042015597892e-03, 1.608173151912984e-02, 8.992951264259041e-03,  5.054598889747857e-03, -7.055420850859247e-03, 5.657717150230082e-04, -3.819215479577352e-03, -7.493604426798792e-04, 7.837534136231757e-04,  1.901827565424658e-03, -2.756053837250774e-03, 5.624142951453625e-03, 8.992951264259049e-03, 1.743561771367994e-02, 5.789849794825419e-04, -1.579296350383179e-04, -2.049551808563101e-03, -4.973007770288814e-05, 3.919236911631195e-03, 1.472173982136556e-03, -3.289537305210369e-03,  1.022124172740042e-03, -2.876566577604122e-03, 5.054598889747868e-03, 5.789849794825333e-04, 7.928892975201047e-03, 5.299313945328752e-03, -4.186090418899204e-04, 1.468844435472098e-03, -1.064849925735568e-03, 1.052795998331314e-03, -1.326132573567419e-03, 2.631826876037878e-03, -6.438932094503316e-03, -2.115255722458735e-03,
                  -6.605815839051106e-03, 5.887759327683095e-04, -4.186090418899171e-04, 1.047079556327449e-02, -2.765947558451538e-03, 2.871383688480947e-03, 1.376762235620714e-03, 5.909774779292187e-03, 6.342583544412037e-03, -6.597730751767256e-05, -8.473859611059980e-04, 3.849042506945953e-04, -2.406931248584115e-03, 1.468844435472099e-03, -2.765947558451524e-03, 9.591063941648279e-03,  1.534255775168608e-03, 6.113910524070782e-04, 4.089278813174895e-03, -5.906807561773279e-03, -3.114906368381066e-03, -1.145917994654749e-03, -4.131006950820395e-03, -7.162613700031206e-05, -1.064849925735567e-03, 2.871383688480944e-03, 1.534255775168604e-03, 1.934032489604314e-02, -6.086367842555022e-04, 5.399781037588507e-04, 6.680254039613198e-04, 2.398931549729160e-03, -9.961413919826945e-05, -1.042117439856942e-03,  4.484281618014731e-03, 1.052795998331319e-03, 1.376762235620759e-03, 6.113910524070470e-04, -6.086367842555059e-04, 5.851372649924682e-03,  2.212262189325755e-03, 2.397599651578586e-03, -5.299435424973739e-03, 4.606708295599891e-03, 4.797111472465284e-04, 1.516555076550674e-03, -1.326132573567418e-03, 5.909774779292193e-03, 4.089278813174904e-03, 5.399781037588518e-04, 2.212262189325752e-03, 1.719243973608971e-02, -1.796069948394727e-03, -9.835495066464507e-04, 1.661198839081299e-03, 2.064765789812847e-03, -4.111694209104061e-03, 2.631826876037879e-03,  6.342583544412078e-03, -5.906807561773262e-03, 6.680254039613218e-04, 2.397599651578625e-03, -1.796069948394743e-03, 1.432818816711173e-02, -4.577055504461184e-03, 4.466406325270923e-04, -3.037189753534919e-03, 1.145915560535639e-03, -6.438932094503316e-03, -6.597730751764773e-05, -3.114906368381053e-03, 2.398931549729145e-03, -5.299435424973743e-03, -9.835495066464277e-04, -4.577055504461180e-03, 1.928234697312022e-02, -3.279602126105374e-03, 6.935810166343963e-03, -3.154780000921633e-03, -2.115255722458733e-03, -8.473859611060075e-04, -1.145917994654743e-03, -9.961413919827220e-05, 4.606708295599884e-03, 1.661198839081299e-03, 4.466406325270776e-04, -3.279602126105361e-03, 1.625554953137441e-02,  9.477356420708129e-03, 5.199614753643424e-03, -6.605815839051106e-03, 3.849042506946232e-04, -4.131006950820404e-03, -1.042117439856937e-03,  4.797111472465520e-04, 2.064765789812828e-03, -3.037189753534925e-03, 6.935810166343953e-03, 9.477356420708139e-03, 1.787429803429460e-02,  4.668618113319301e-04, 5.887759327683124e-04, -2.406931248584113e-03, -7.162613700032247e-05, 4.484281618014737e-03, 1.516555076550625e-03, -4.111694209104047e-03, 1.145915560535644e-03, -3.154780000921697e-03, 5.199614753643444e-03, 4.668618113319165e-04, 8.209410633317768e-03,  3.847955608576837e-03, -5.672725325997246e-04, 6.789013940464930e-04, -3.769288027147405e-04, 1.863615691747715e-03, -1.058470410780992e-03,  2.104379729598333e-03, -6.003091694390087e-03, 1.669426424454598e-03, -2.552447884625065e-03, 1.922245823280701e-03, -5.672725325997181e-04,  4.750337218014111e-03, -1.051733894155082e-03, 8.284552039578056e-04, 2.986659963575035e-04, 1.927909678164267e-03, 1.846655567993650e-03,  5.397997960440399e-04, -5.778812959209048e-04, 3.566542110662734e-04, -1.103997435911753e-03, 6.789013940464945e-04, -1.051733894155070e-03,  4.497822707745255e-03, 4.341617335379440e-04, 4.133242712041862e-04, 1.113479117604350e-03, -1.774280629150326e-03, -1.576042936036478e-03, -1.087164981930963e-04, -1.496024592791628e-03, 2.094304560514774e-04, -3.769288027147449e-04, 8.284552039578092e-04, 4.341617335379493e-04,  7.549088670556686e-03, -3.289856803302813e-04, 3.571171888957052e-05, 1.204710266125432e-04, 1.113156371003106e-03, -1.994234552484991e-04, -2.243995814778635e-04, 1.426616843491322e-03, 1.863615691747709e-03, 2.986659963574911e-04, 4.133242712041875e-04, -3.289856803302776e-04,  3.751189918043667e-03, 3.146287845143886e-04, 1.353854075838237e-03, -3.114430529744880e-03, 1.624261943475778e-03, -7.771447723871935e-04,  8.119968278196555e-04, -1.058470410780990e-03, 1.927909678164276e-03, 1.113479117604351e-03, 3.571171888957306e-05, 3.146287845143757e-04,  7.019576241644275e-03, -8.471100323740315e-04, 5.238652997357528e-04, 2.520514231666893e-04, 9.012416101805310e-04, -1.668077953875291e-03,  2.104379729598335e-03, 1.846655567993661e-03, -1.774280629150323e-03, 1.204710266125484e-04, 1.353854075838238e-03, -8.471100323740325e-04,  6.602315362895537e-03, -2.818085131843554e-03, 6.369550427472587e-04, -1.619994607080855e-03, 8.851093593536214e-04, -6.003091694390086e-03,  5.397997960440554e-04, -1.576042936036467e-03, 1.113156371003085e-03, -3.114430529744923e-03, 5.238652997357736e-04, -2.818085131843531e-03,  1.369684503735942e-02, -2.145275070850798e-03, 4.093106372932707e-03, -2.372470823649631e-03, 1.669426424454595e-03, -5.778812959209058e-04, -1.087164981931029e-04, -1.994234552485153e-04, 1.624261943475752e-03, 2.520514231666996e-04, 6.369550427472615e-04, -2.145275070850784e-03,  6.669457896723525e-03, 1.863052236997481e-03, 2.002378645838464e-03, -2.552447884625065e-03, 3.566542110662805e-04, -1.496024592791624e-03, -2.243995814778553e-04, -7.771447723871789e-04, 9.012416101805236e-04, -1.619994607080863e-03, 4.093106372932699e-03, 1.863052236997487e-03,  7.443924072624876e-03, -7.287772238658436e-04, 1.922245823280708e-03, -1.103997435911767e-03, 2.094304560514892e-04, 1.426616843491328e-03,  8.119968278196500e-04, -1.668077953875287e-03, 8.851093593536535e-04, -2.372470823649671e-03, 2.002378645838432e-03, -7.287772238658202e-04,  4.673290377691932e-03, 4.630607672831770e-03, -1.543849440839455e-03, 1.125596907630311e-03, -1.801306149589586e-03, 2.170622975548882e-03, -1.590988373100849e-03, 1.805194001562770e-03, -7.231734885731010e-03, 2.121778937185507e-03, -3.005945042945169e-03, 2.155831212191169e-03, -1.543849440839456e-03, 6.510209309094614e-03, -1.779670112274405e-03, 1.601786048639164e-03, 3.320916939517282e-04, 3.236477807610966e-03,  2.800958567202418e-03, 1.271284992225286e-03, -8.243696862634410e-04, 1.054177870010459e-03, -1.725872763053437e-03, 1.125596907630315e-03, -1.779670112274385e-03, 5.734420067370859e-03, 4.058124275041855e-04, 5.372921155750407e-04, 1.589452840640875e-03, -2.727132279774157e-03, -2.340852255631535e-03, -2.961814364891339e-04, -2.349232504092535e-03, 3.000221900085756e-04, -1.801306149589591e-03, 1.601786048639164e-03,  4.058124275041920e-04, 1.081020600162351e-02, -8.585896335312958e-04, 4.519535640552841e-04, -3.842580994509460e-05, 2.877805232364738e-03, -4.294869174371761e-04, 4.350849830531618e-04, 1.752718118221391e-03, 2.170622975548874e-03, 3.320916939517169e-04, 5.372921155750574e-04, -8.585896335312965e-04, 4.256638515682301e-03, 6.025403653357487e-04, 1.640362809405055e-03, -4.104060706324016e-03, 2.345205092289143e-03, -7.554458847402448e-04, 1.001419692265956e-03, -1.590988373100844e-03, 3.236477807610974e-03, 1.589452840640877e-03, 4.519535640552816e-04,  6.025403653357383e-04, 9.515896172458311e-03, -1.089343122511452e-03, 8.250997883608391e-04, 1.798763780440564e-04, 1.539020943185718e-03, -2.507152415285315e-03, 1.805194001562775e-03, 2.800958567202437e-03, -2.727132279774146e-03, -3.842580994509956e-05, 1.640362809405053e-03, -1.089343122511453e-03, 8.038636218549340e-03, -3.253124448084252e-03,
                  8.876246484661164e-04, -1.522409612149513e-03, 9.205574168799714e-04, -7.231734885731008e-03, 1.271284992225283e-03, -2.340852255631519e-03, 2.877805232364714e-03, -4.104060706324049e-03, 8.250997883608572e-04, -3.253124448084231e-03, 1.670480140938885e-02, -2.999093262308555e-03, 5.398011357457731e-03, -2.916137759845161e-03, 2.121778937185503e-03, -8.243696862634519e-04, -2.961814364891488e-04, -4.294869174371802e-04, 2.345205092289175e-03, 1.798763780440555e-04, 8.876246484661217e-04, -2.999093262308529e-03, 8.444880705224270e-03, 2.793546777789901e-03, 2.722520761262224e-03, -3.005945042945166e-03, 1.054177870010472e-03, -2.349232504092522e-03, 4.350849830531712e-04, -7.554458847402514e-04, 1.539020943185711e-03, -1.522409612149521e-03, 5.398011357457712e-03,  2.793546777789908e-03, 9.236689279969979e-03, -7.955986559401525e-04, 2.155831212191183e-03, -1.725872763053439e-03, 3.000221900085802e-04,  1.752718118221408e-03, 1.001419692265947e-03, -2.507152415285340e-03, 9.205574168799707e-04, -2.916137759845226e-03, 2.722520761262243e-03, -7.955986559401338e-04, 5.415271773905794e-03, 5.088427339593617e-03, -1.145294524468058e-03, 8.293410260949178e-04, -9.416277756801361e-04,  2.782409175058876e-03, -1.407701540326345e-03, 2.603627502404953e-03, -7.998586155047045e-03, 3.538988749092436e-03, -2.449922090547705e-03,  3.030759051026276e-03, -1.145294524468056e-03, 6.243114361611745e-03, -1.566477756722579e-03, 1.187510408226639e-03, 1.563501129960611e-04,  3.054002180615455e-03, 2.554584744753050e-03, 1.161335933660456e-03, -1.205603686290671e-03, 6.423623313180471e-04, -1.848436694286204e-03,  8.293410260949192e-04, -1.566477756722575e-03, 5.411598626704803e-03, 6.220336766047655e-04, 5.465440349374733e-04, 1.323481926040377e-03, -2.448192321276153e-03, -2.170260930586028e-03, -1.630607591521151e-04, -2.059865393775544e-03, 4.166538657658763e-04, -9.416277756801381e-04,  1.187510408226629e-03, 6.220336766047669e-04, 1.040980982844646e-02, -9.069311999546453e-04, 1.113859420957282e-04, -1.594892183180934e-04,  2.537714932639606e-03, -7.088999726320496e-04, -1.955641243656150e-04, 1.708837368811663e-03, 2.782409175058867e-03, 1.563501129960701e-04,  5.465440349374780e-04, -9.069311999546645e-04, 4.739351932382140e-03, 4.076474214691999e-04, 1.982094864234899e-03, -4.816264300942180e-03,  3.126546057021357e-03, -7.180172326917919e-04, 1.550667519795608e-03, -1.407701540326344e-03, 3.054002180615452e-03, 1.323481926040380e-03,  1.113859420957266e-04, 4.076474214691810e-04, 9.163127014718782e-03, -1.003004072748478e-03, 8.923364841401278e-04, 3.101178124554794e-05,  1.474324963144183e-03, -2.518201226632701e-03, 2.603627502404953e-03, 2.554584744753057e-03, -2.448192321276146e-03, -1.594892183180997e-04,  1.982094864234894e-03, -1.003004072748489e-03, 8.290604536275753e-03, -4.057113724106866e-03, 1.593167215777918e-03, -1.673632543676673e-03,  1.416089366379006e-03, -7.998586155047048e-03, 1.161335933660466e-03, -2.170260930586023e-03, 2.537714932639597e-03, -4.816264300942229e-03,  8.923364841401376e-04, -4.057113724106871e-03, 1.826215947035773e-02, -4.474089521219435e-03, 5.071999975979972e-03, -3.965093475316364e-03,  3.538988749092435e-03, -1.205603686290697e-03, -1.630607591521083e-04, -7.088999726320419e-04, 3.126546057021395e-03, 3.101178124555510e-05,  1.593167215777931e-03, -4.474089521219442e-03, 9.996717510714461e-03, 2.572483627421369e-03, 3.647986856045450e-03, -2.449922090547704e-03,  6.423623313180635e-04, -2.059865393775548e-03, -1.955641243656227e-04, -7.180172326918027e-04, 1.474324963144177e-03, -1.673632543676682e-03,  5.071999975979974e-03, 2.572483627421354e-03, 8.754096274982826e-03, -9.715095192187764e-04, 3.030759051026287e-03, -1.848436694286183e-03,  4.166538657658764e-04, 1.708837368811670e-03, 1.550667519795521e-03, -2.518201226632708e-03, 1.416089366379005e-03, -3.965093475316432e-03,  3.647986856045453e-03, -9.715095192187723e-04, 6.158368469741231e-03, 5.563666051169286e-03, -4.138980348373947e-04, 5.069940419308191e-04, -3.588761551778286e-04, 3.105650388143974e-03, -1.102128826992204e-03, 3.516187613336164e-03, -8.406837469047149e-03, 3.771926333956087e-03, -2.582004053009159e-03, 3.192568901592155e-03, -4.138980348373941e-04, 6.635630229991501e-03, -1.683823462419470e-03, 1.099483348013014e-03,  4.281003754883629e-04, 2.858254494528438e-03, 3.199923911850877e-03, 5.465970022582444e-04, -1.016790091937454e-03, 3.941106900566008e-04, -1.745276191112542e-03, 5.069940419308184e-04, -1.683823462419467e-03, 6.150418733650426e-03, 9.249472680431283e-04, 5.150495125164751e-04,  1.829421141581331e-03, -3.062451729375633e-03, -1.992885884139249e-03, -3.077408779238005e-04, -2.107605281031928e-03, 2.682197663186355e-04, -3.588761551778289e-04, 1.099483348013008e-03, 9.249472680431256e-04, 1.146392332965149e-02, -7.403156023221491e-04, 1.260178191821656e-04, -2.832115160611549e-04, 2.042809602558945e-03, -5.456669677119872e-04, -4.446917178240769e-04, 2.192458574397542e-03, 3.105650388143970e-03,  4.281003754883554e-04, 5.150495125164818e-04, -7.403156023221564e-04, 5.226084188257766e-03, 4.677520108681809e-04, 2.332004702000099e-03, -5.045645955952526e-03, 3.248036581691438e-03, -8.464713533755885e-04, 1.570328190275115e-03, -1.102128826992205e-03, 2.858254494528445e-03,  1.829421141581333e-03, 1.260178191821663e-04, 4.677520108681784e-04, 9.638780137176875e-03, -1.128845542546786e-03, 4.865819225065592e-04,  1.675678853032714e-04, 1.262370203008993e-03, -2.437415994525848e-03, 3.516187613336162e-03, 3.199923911850861e-03, -3.062451729375614e-03, -2.832115160611481e-04, 2.332004702000077e-03, -1.128845542546783e-03, 9.833304470975756e-03, -4.579549566003007e-03, 1.735450077677873e-03, -2.094152351094299e-03, 1.476714737453941e-03, -8.406837469047152e-03, 5.465970022582600e-04, -1.992885884139257e-03, 2.042809602558930e-03, -5.045645955952549e-03, 4.865819225065690e-04, -4.579549566003016e-03, 1.916774250607688e-02, -4.281111629679953e-03, 5.421564693973097e-03, -3.861824136369393e-03, 3.771926333956090e-03, -1.016790091937464e-03, -3.077408779238022e-04, -5.456669677119927e-04, 3.248036581691461e-03,  1.675678853032767e-04, 1.735450077677879e-03, -4.281111629679959e-03, 1.063647057705491e-02, 2.868246842883024e-03, 3.823428979780991e-03, -2.582004053009161e-03, 3.941106900566054e-04, -2.107605281031921e-03, -4.446917178240743e-04, -8.464713533756144e-04, 1.262370203008992e-03, -2.094152351094309e-03, 5.421564693973108e-03, 2.868246842883019e-03, 9.630821449230342e-03, -8.931801940851934e-04, 3.192568901592158e-03, -1.745276191112497e-03, 2.682197663186238e-04, 2.192458574397552e-03, 1.570328190275084e-03, -2.437415994525868e-03, 1.476714737453930e-03, -3.861824136369444e-03, 3.823428979781024e-03, -8.931801940852257e-04, 6.699226690431137e-03, 5.444645552269122e-03, -1.821654798514161e-03,  8.035990708573791e-04, 5.797769746778880e-04, 2.727441032812630e-03, -2.724651522937317e-03, 2.385319232848484e-03, -7.841057078476547e-03,  4.047479822541076e-03, -2.325662868608859e-03, 4.100226929978101e-03, -1.821654798514161e-03, 6.959726818119447e-03, -1.581691753479179e-03,  9.684089105627782e-04, 3.553046298192193e-05, 3.215987689330476e-03, 2.228524307996567e-03,
                  1.605154398348711e-03, -1.609727218184153e-03,  9.789955871406532e-04, -2.419020856661004e-03, 8.035990708573791e-04, -1.581691753479179e-03, 6.474572501782970e-03, 9.778058465941854e-04,  7.808395857791879e-04, 1.717334027731843e-03, -2.662739453698595e-03, -2.093136758967632e-03, 7.443951073781921e-05, -2.191962348678503e-03,  4.831830112961434e-04, 5.797769746778880e-04, 9.684089105627782e-04, 9.778058465941854e-04, 1.147937439611693e-02, -4.428499159205760e-04, -1.683805945553948e-04, 3.198776212393713e-04, 7.747084626433033e-04, 7.921082074350064e-05, -7.515877117769138e-04, 2.611007275709025e-03,  2.727441032812630e-03, 3.553046298192193e-05, 7.808395857791879e-04, -4.428499159205760e-04, 5.679529152051497e-03, -1.536380069026816e-04,  1.848835427282652e-03, -4.742188960725422e-03, 3.251467128133262e-03, -7.531314731924180e-04, 1.673021910413737e-03, -2.724651522937317e-03,  3.215987689330476e-03, 1.717334027731843e-03, -1.683805945553948e-04, -1.536380069026816e-04, 1.102957262985691e-02, -1.703272499335246e-03,  1.849237268823640e-03, -6.492772701259933e-04, 1.546282322273434e-03, -3.202574417483338e-03, 2.385319232848484e-03, 2.228524307996567e-03, -2.662739453698595e-03, 3.198776212393713e-04, 1.848835427282652e-03, -1.703272499335246e-03, 8.780663654293664e-03, -3.274612261098040e-03,  1.560237032088245e-03, -1.577987829495903e-03, 1.572958397521402e-03, -7.841057078476547e-03, 1.605154398348711e-03, -2.093136758967632e-03,  7.747084626433033e-04, -4.742188960725422e-03, 1.849237268823640e-03, -3.274612261098040e-03, 1.892249503694123e-02, -4.636882070805283e-03,  4.351696477724524e-03, -4.510891831782480e-03, 4.047479822541076e-03, -1.609727218184153e-03, 7.443951073781921e-05, 7.921082074350064e-05,  3.251467128133262e-03, -6.492772701259933e-04, 1.560237032088245e-03, -4.636882070805283e-03, 1.124049840745790e-02, 2.388340446667358e-03,  4.472498291863812e-03, -2.325662868608859e-03, 9.789955871406532e-04, -2.191962348678503e-03, -7.515877117769138e-04, -7.531314731924180e-04,  1.546282322273434e-03, -1.577987829495903e-03, 4.351696477724524e-03, 2.388340446667358e-03, 9.396759307166552e-03, -1.137582236855174e-03,  4.100226929978101e-03, -2.419020856661004e-03, 4.831830112961434e-04, 2.611007275709025e-03, 1.673021910413737e-03, -3.202574417483338e-03,  1.572958397521402e-03, -4.510891831782480e-03, 4.472498291863812e-03, -1.137582236855174e-03, 7.975395613406657e-03 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 5.806321223149110e-03, 9.656610036389826e-05, 3.596098325889233e-03, 1.544782806616053e-03, -2.766257656755528e-04, 1.750544846142646e-03, -2.018596730067571e-04, -3.396236780827872e-03, -4.513357187089445e-03, -6.741454216359480e-03, -1.103211683624810e-03, 1.184905064830926e-04,  2.249216291178696e-02, -6.101107378646006e-03, 6.263467200841266e-03, 2.751857413586822e-03, 1.333768495754818e-02, 1.376776395674568e-02,  5.021391096371229e-04, -3.244998449548086e-03, 7.320912288608121e-04, -6.497278758531047e-03, 3.566520831095821e-03, -6.095325238630905e-03,  1.941009124584531e-02, 3.195064832726338e-03, 2.066125095395545e-03, 8.307834633902885e-03, -1.202841718773354e-02, -6.602598485931618e-03, -1.023586890206128e-03, -8.040757396011148e-03, 4.780061337278669e-04, 1.543722149034525e-03, 6.266251498590869e-03, 3.195932005383242e-03,  4.281726661294950e-02, -1.886243300841952e-03, 1.038014706520298e-03, 1.803846187557304e-03, 5.386282023771400e-03, -6.349672047397199e-04, -2.529563730630875e-03, 9.979380551096670e-03, -2.433359414820221e-04, 2.758541434361214e-03, 2.051445964557536e-03, -1.882157859497170e-03,  1.182720703891007e-02, 4.031890970398913e-03, 4.584440449921835e-03, -1.084737217607121e-02, 8.979367484595295e-03, 2.092486970273720e-04,  2.727462401926561e-03, 1.767509347344777e-03, 1.333819528879820e-02, 8.305616355884072e-03, 1.035295064153069e-03, 4.034718470891673e-03,  3.680730261917804e-02, -2.838360486717391e-03, -1.242572018280972e-03, 2.180308812086684e-03, 3.545406980270011e-03, -9.680963648210779e-03, -1.647940153992450e-04, 1.376796475749343e-02, -1.203888801759134e-02, 1.805385767900213e-03, 4.566914199636465e-03, -2.844788284785591e-03,  2.774142289467548e-02, -7.123980365173535e-03, 1.586220141057900e-04, -5.630061908530236e-03, 1.606063720519977e-03, -3.419067587918455e-03,  4.840593236907110e-04, -6.575176944129931e-03, 5.378671265589149e-03, -1.085987935001619e-02, -1.238829858432317e-03, -7.163384926691650e-03,  3.551343742232434e-02, -7.025572233946577e-03, 1.191479396244614e-02, -6.568515004905177e-03, -4.425190986753414e-03, -3.243143089678151e-03, -1.041162328915579e-03, -6.244871948933429e-04, 8.969249002857052e-03, 2.171746997773411e-03, 1.787606536401202e-04, -6.992788905748284e-03,  3.119343101134959e-02, 1.637986902872869e-02, 1.098791521402152e-02, -6.679327034288187e-03, 7.249542583247105e-04, -8.042163567173943e-03, -2.525714110574269e-03, 2.001176124274945e-04, 3.544089908662239e-03, -5.631972410168718e-03, 1.193524756227742e-02, 1.637822769016459e-02,  3.152571223225629e-02, 8.692846410280426e-05, -1.076200590186708e-03, -6.492998103066531e-03, 4.680619141345366e-04, 9.985421327298707e-03,  2.723522943814507e-03, -9.684641027405487e-03, 1.617211434517718e-03, -6.553148658955405e-03, 1.098611341061209e-02, 8.852838801893333e-05,  1.751678755851403e-02, 9.384461644953211e-04, -4.769043201519924e-04, 1.107125986234623e-03, 8.681029823308440e-04, -7.935622768677432e-05,  1.934075713351566e-04, -8.071843842092452e-04, -7.303083729829663e-04, -4.290477033588437e-04, -9.653361567384827e-04, 9.430606377686590e-05, -3.946109681279911e-04, 3.350942973072453e-03, -7.915921055448804e-04, -5.368061063310567e-04, 6.556522226859422e-05, -1.177885232494381e-03,  1.167393246067601e-04, 1.269663323159622e-04, -1.945136599926318e-04, 7.728666628076206e-04, -3.252584771269206e-04, 1.278095779555911e-03, -7.656143275564620e-04, 5.592727768251527e-03, 8.861263434003005e-04, 6.999895726811699e-04, 9.115122531469398e-04, -1.333788078406024e-03, -2.199476927672033e-04, 5.653507790230269e-04, -8.885147111873295e-04, 2.963972991604235e-04, 8.406465836099018e-04, -5.447280553136456e-04,  8.495510935714690e-04, 4.906981965403441e-03, -1.938445065469822e-04, -3.253892801570858e-04, -9.760306039089831e-04, -5.597679346972116e-04, -3.804827576315842e-04, -4.131273654134903e-04, 3.544742938006024e-04, -2.135341582491828e-05, 8.114318946032730e-05, 6.866515230239292e-04, -2.089078250216815e-04, 4.055523023690773e-03, -2.653424125259238e-04, -4.526968612119722e-04, 9.115523155406964e-04, -2.819786408046103e-04, -5.878609029716175e-05, -6.832023758747152e-04, 1.107056799024846e-04, -1.202094685639402e-03, 8.977414686348923e-04, -2.671416177911172e-04, -2.948209848635417e-04, 3.929112421698133e-03, -9.613874660815551e-04, -4.271270148596532e-04, 4.631689588445531e-04, -5.791761174063193e-04,  7.198038741513318e-04, -7.363783430874067e-04, 1.022501537903025e-04, -1.322637699561721e-03, -9.903744118807878e-04, -4.726115009040066e-04, -9.015470372035441e-04, 4.434079534728498e-03, 1.826218092128798e-03, -3.156898957975084e-04, -1.460755443694972e-05, -2.573863956237495e-04, -6.097254943115282e-04, 2.094596683761636e-04, -3.583899951358194e-04, -6.202623831446418e-04, 9.208044378857241e-04, -3.663642684306294e-04,  1.968447920818057e-03, 4.022287343053465e-03, 1.187270122968075e-03, -1.111510552667239e-03, 7.479203115975030e-04, -2.793853013991030e-04, -1.100196971067940e-04, 4.303209369755583e-04, -5.055212211618493e-04, -3.679213118150332e-04, 5.429033684203365e-04, -1.917798138964683e-04,  1.231812703904240e-03, 2.846543938698336e-03, -8.751258579202739e-04, -5.824543825644294e-04, -1.160279919956965e-03, 7.700805842039554e-04, -9.991335792680117e-04, -5.554873359653675e-04, -1.096630954626008e-04, -5.266163635402005e-04, -3.113007871454387e-05, -1.067698984654100e-03, -8.168706005927092e-04, 4.896718909678129e-03, -8.138469062531329e-04, -4.375185179396812e-05, -3.608595671407786e-04, 3.584564405274354e-04,  3.846251482704285e-04, -6.616569249410077e-04, 6.513641043208473e-04, -2.524707934264225e-04, 6.793152756108976e-04, -4.954956122154566e-04, -8.650646589807762e-04, 3.759905802784125e-03, 7.512987364797390e-04, 1.465173490565133e-05, 7.892043015727637e-04, 4.372473299502389e-04,  1.642714960992579e-04, 2.080285902783631e-04, -9.961088440930826e-05, -7.965628023060559e-04, -8.502893721622180e-05, -9.519477702975559e-04, -9.098580849803666e-05, -3.062817716468055e-04, 2.358444863721213e-03, -3.272868392059430e-04, -3.759620051026916e-04, -6.379235836235478e-05, -1.119195805081248e-03, -4.018393768895276e-04, 2.743927566197493e-04, 1.573176406251774e-05, 5.764865469058459e-04, -7.366699684096829e-05,  7.797055846709926e-04, -1.177883641756651e-04, 3.814655211684857e-03, 3.307242782014112e-04, 5.605433513770706e-04, 4.667319239577922e-04, -1.642822471064100e-04, -2.522368698885302e-04, 4.059636281979097e-04, -4.924903678136640e-04, 2.057681995580765e-04, 6.007101784778176e-04, -2.715357125561892e-04, 3.778213245940030e-04, 2.770559433105453e-03, 6.110349601497385e-05, -4.337351889656484e-05, -3.815712159614934e-04, -8.599133452915479e-04, -2.187929603251692e-04, -3.195574768638035e-04, -4.112486378926453e-05, -6.821568638115701e-05, -7.398851098116069e-06,  3.395276610011313e-04, -7.202657326412204e-05, 3.204763331197727e-03, -3.293641015260538e-04, -3.844269085347086e-04, 1.029707041786560e-03, -3.118486642514190e-04, 9.003065429824447e-05, -4.546959223182510e-04, 1.723284319891821e-04, -9.564369505465171e-04, 3.053416348232829e-04, -2.178817217799950e-04, -3.019491568885679e-04, 2.530421248698880e-03, -3.894246055826327e-04, -1.217253817562356e-04, 2.413488688442885e-04, -4.409826549662467e-04,
                  5.871445795247051e-04, -6.023320461611482e-04, -4.176912381430148e-04, -4.310818007888322e-04, -5.258891419007094e-04, -4.845688634847740e-04, -5.361187359968957e-04, 2.699694007159859e-03, 1.723920317704714e-03, -1.184853440695787e-04, 1.746031395528265e-04, -1.912135996295691e-04, -6.181310179253072e-04, -3.548408015336642e-05, 8.923416613949853e-05, -3.373192134924943e-04, 6.569902331883272e-04, -2.245607002748953e-04, 1.034479677303233e-03, 3.284077822263755e-03, 8.241444837254609e-04, -8.861520682626658e-04, 4.881465314470492e-04, -3.266434698852849e-04, -1.337157659805860e-04, 3.709916122864408e-04, -1.335092938758069e-04, -4.316977739381197e-04, 1.412644979706149e-04, -2.869015488485714e-04, 1.146901529950816e-03, 2.028674918349679e-03, -8.159924746585735e-04, -4.968715946168682e-04, -8.521251093995317e-04,  2.324604785540284e-04, -4.038857972973558e-04, -1.362563130266649e-04, -1.672855521194715e-04, -6.391582401199249e-04, -3.049549115747285e-04, -7.646886358578095e-04, -8.001517659280972e-04, 3.861505825305305e-03, -5.157443723930976e-04, 3.263917525737876e-05, 1.578797113373524e-05,  1.540702166405184e-04, -6.071963571566532e-05, -4.590859441271018e-04, 7.517199854419911e-04, -9.081030798850078e-05, 5.671057152955641e-04, -6.381281217377596e-04, -6.209443339904310e-04, 2.853998543061171e-03, 8.102388347986196e-04, -2.871623097736818e-04, 6.143758904206952e-04,  2.686242578264413e-04, -2.273271764772635e-05, -5.111982708697062e-05, -2.885030108088877e-04, -8.200780712790089e-04, -4.342065717622130e-04, -1.058873988673030e-03, 2.769569857778465e-05, -5.820881910582969e-05, 1.783034742656901e-03, 1.025694521181648e-04, -1.979943639888779e-04, -2.599834625876114e-05, -7.908873363635638e-04, -5.871699268490515e-04, -8.752892600138343e-05, -3.125284901221628e-06, 1.187735746067469e-04,  1.675516751788960e-04, 6.282081172145082e-04, -1.681405355203556e-04, 2.859737190123438e-03, 8.045305034538408e-05, 1.596646839301614e-04, -8.643180675912574e-05, 1.785624063740314e-05, 5.347146606417394e-05, 5.496170569540210e-05, -4.346385025494962e-04, 7.676725308631429e-05,  4.470826168333501e-04, -3.828746989735985e-04, 1.868672202874883e-04, 1.430295232163835e-03, 2.671220108607425e-05, -2.246411896723626e-04, -2.637623837492688e-04, -6.216918595807385e-04, -2.052251372262692e-04, -3.173441133393469e-04, -2.806982688632065e-04, 9.732004037197242e-05, -8.368842922918768e-05, 3.111600559274264e-04, 1.848211569131798e-04, 2.541640237397311e-03, -3.243520073199168e-04, -3.691049497161219e-04,  7.238044260330842e-04, -4.486254533025375e-04, -1.189584360839200e-04, -3.026888934651312e-04, 3.034629577544718e-04, -9.276642958237981e-04,  9.970177355403571e-05, -1.316514625277349e-04, -2.895077988828987e-04, 1.559741660927727e-03, -1.202718369531642e-04, -2.237328634735024e-04, -9.647762861933896e-05, -6.998457330024168e-04, 6.365685977972792e-04, -1.881562272146808e-04, -5.315553652821151e-04, 1.612082730980632e-04, -2.427929043070764e-04, -3.278332346527375e-04, -1.002289520430623e-04, 1.779333468752278e-03, 9.125473730146196e-04, -1.170643038166316e-04,  9.729136527813998e-06, -1.012152285425188e-04, -1.017556542061301e-03, 2.412388583285514e-04, -1.193765949498973e-04, -4.900480696958677e-04,  7.586262564935819e-04, 1.644413064277803e-04, 9.820853650152001e-04, 3.085578211874862e-03, 1.001191576131202e-03, -1.993323757839619e-04,  3.850608398786331e-04, -2.195670994405569e-04, 7.804395338446390e-05, 2.738504483905347e-04, -5.775970127188334e-05, -3.400817381627400e-04,  8.460753078235806e-05, -8.044767878757756e-05, 7.337121633977567e-04, 1.541772402759496e-03, -7.416297046781242e-04, -5.670793333425786e-04, -1.013914259417756e-03, 4.516677107329710e-04, -4.008269905275753e-04, -5.868786492146373e-05, 7.259885509718788e-05, -2.418714374265116e-04,  9.098086388253761e-05, -4.586175599377148e-04, -3.914751773027732e-04, 3.573777589480353e-03, -3.888511343298287e-04, 5.329352360082751e-05,  1.484023821282745e-04, 1.093998141656444e-04, -3.494124948994139e-04, -3.454414287872381e-04, 6.441158290927216e-04, -9.426114786418183e-05,  4.636799243076306e-04, -5.959722937234392e-04, -4.038188228432262e-04, 2.113871012413875e-03, 8.765328770692451e-04, -3.078254636613254e-04,  4.965652886931600e-04, 1.320907228334193e-04, 1.160952471292259e-04, -2.267068390473221e-04, -3.008792293029763e-05, -1.217142939299054e-03, -2.137323506867059e-04, -1.162418379229466e-03, 2.082642954882233e-04, -3.380631140651115e-04, 1.615527940462806e-03, -7.732222157907833e-05, -2.042580909353201e-04, -1.150200849613079e-04, -5.624714297765548e-04, -5.537899829598570e-04, 3.416039977823252e-04, 7.233059333006304e-05,  4.334723907052157e-04, 1.044273708337174e-04, 5.280768618980252e-04, -8.451007562107525e-05, 2.368701073380755e-03, 1.185307946549444e-05,  1.767822292038989e-04, -2.716711047951190e-04, 2.026003176133565e-04, -2.137007158809091e-04, 1.138531857641199e-04, -4.899176898591125e-04,  1.840897673551835e-04, 2.560964244755627e-04, -2.687532828426772e-04, 9.145127528597548e-05, 1.114054716557581e-03, 1.928624751539951e-04, -2.371937161377980e-04, -1.517291950065611e-04, -6.199659844673882e-04, -5.518221965050828e-05, -2.142627039394495e-04, -2.393896658459877e-04, -9.205645165174782e-05, -9.392265538742171e-05, 9.049502165550053e-05, 8.952730615451797e-05, 2.094989658977776e-03, -2.745663377209847e-04, -3.247505837635280e-04, 7.510402344272386e-04, -3.211398053975113e-04, 6.939576804838841e-05, -2.267221027451638e-04, -1.605472412216711e-04, -5.956998038330165e-04, -5.617201567812596e-05, -1.480849814735541e-04, -2.319902238177757e-04, 1.399167880558903e-03, -1.246320528075908e-04,  1.922225573425718e-04, 5.820717229655209e-05, -1.220952014371920e-04, 4.759754171426720e-04, -2.643629080936915e-04, -4.086568654704846e-04, -6.343855277751059e-05, -1.680802772262074e-04, -3.527037995862736e-04, -1.975103893065951e-05, 1.528279500684946e-03, 1.030061102329855e-03, -6.685130799651058e-05, 2.896405900956150e-04, -1.659776761639302e-04, -9.686528794951325e-04, 1.696121389382287e-04, -2.470894635460126e-05, -2.766215405647000e-04, 4.702571476941411e-04, 1.804604863676696e-04, 5.730936057198396e-04, 3.198314866789955e-03, 5.255484902175244e-04,  1.442354631614223e-05, 1.827926220512281e-04, -5.288526972353392e-04, 1.864746091391915e-04, 8.213172867643800e-05, -1.655055433906369e-05, -4.579702013160920e-04, 2.575331493580772e-04, -2.541690614613388e-04, 1.119805979188822e-03, 1.236688839947952e-03, -1.595225860586929e-04, -6.921936926498362e-04, -1.100345140550847e-03, 3.753971764599034e-04, -2.924473868389155e-04, 6.531533439503896e-06, -7.365790645393958e-05,  4.558422168290336e-06, -3.360429499764828e-05, 9.779556224850006e-05, -4.643760070661819e-04, 3.365994705817834e-03, -4.347170980012015e-04,  2.247833783705259e-05, 1.522538341632076e-04, 3.808915787383020e-05, -2.773679096724074e-04, -2.320560254841440e-04, 4.364401757103477e-04, -8.456668348489228e-05, 3.660849945746483e-04, -4.993581843398150e-04, -3.001653204123517e-04, 1.806115804016762e-03, 6.778295307982159e-04, -1.758118657187969e-04, 1.210216159030330e-04, 4.532859559154038e-05, 2.430659706863195e-04, -2.113424649595251e-04, 1.670219212351339e-04, -1.203854808585661e-03, 3.295532898823094e-04,
                  -4.438430740292250e-04, 3.060973929702645e-04, -2.017889976498234e-04, 1.247057225874382e-03,  1.148841866434168e-04, -2.351870529857787e-04, -2.122095527928045e-04, -4.858998426856208e-04, -6.165955848225717e-04, 2.500162284343481e-04, -2.058254159359525e-05, 1.506910035583572e-04, 1.064503082603490e-04, 2.491738604596654e-04, 9.289497078649741e-05, 1.524674435039335e-03, -6.499371935823303e-05, 8.268467005225001e-05, -3.768331963147917e-04, 4.169080703871386e-04, 3.323281244064884e-05, 2.949839800905669e-04,  6.987721159187833e-05, 1.511588231791609e-04, 1.122217430938528e-04, -1.931779413005162e-04, -4.773700243753702e-05, 5.434667688076193e-04,  1.494874241005029e-04, -1.008993156933723e-04, -5.292487860912211e-05, -4.283365349254651e-04, 4.050556729292000e-05, -1.039429105932406e-05, -3.274307975108217e-04, 9.101380434157840e-05, -8.814961102141481e-05, -2.095631140075521e-05, 1.151182742538968e-04, 1.821721192001271e-03, -3.031472593811000e-04, -1.075971156391530e-04, 3.727865374666325e-04, -3.595712545506026e-04, -9.261160542027382e-05, -1.079492124641051e-04, -2.658948216454266e-04, -4.885490182330633e-04, -2.995982784696846e-04, -6.400717267959069e-05, -3.783216431292979e-04, 9.582534239450191e-04, -5.135649065035612e-05, 4.354544220311034e-04, -1.121777681126133e-04, -8.070589232201839e-05, 2.790989670233551e-04, -6.456624204339968e-05, -5.385125562793592e-04, 3.124747878445714e-04, -3.308041318679960e-05, -2.551399601167684e-04, 4.865610267455953e-05, 1.128415238179497e-03,  5.419896593157501e-04, -8.754247337962643e-05, 1.588400378643658e-04, -6.495280374331708e-05, -1.242090989395261e-03, 1.947436558328305e-04,  1.052396286323708e-04, -2.617647308173370e-04, 1.137850344340519e-04, 3.131290301607529e-04, 1.812178051592772e-04, 3.705169648632961e-03, -4.172005952644822e-05, -1.352016205865750e-04, -1.574215886967224e-04, -2.543918903858762e-04, 1.083531328602150e-04, 6.881261117202472e-05, -3.965392487233317e-06, -4.479263442293917e-04, 5.825139444993141e-05, -1.764918999936882e-04, 7.351328789125121e-04, 7.855331869061296e-04, -4.050874772941663e-04, -6.121962809202649e-04, -5.806011327361053e-04, 1.652583591543515e-04, 1.626309669454407e-04, 4.974249418605452e-05, -2.507594207890276e-04, -5.747175683351572e-05, -1.234393053307236e-05, 6.065606855321071e-06, -1.181884375485054e-03, 1.766218266899852e-03, -4.746259761763729e-04, 1.051572123704639e-04, 1.460595811099037e-04, 2.966711993385607e-06, -2.890923596240961e-04, -9.992058034910598e-05,  3.026249753482584e-04, -4.945453482762288e-05, 1.933034193746998e-04, -3.721102610578804e-04, -1.110462958969271e-04, 1.636452806409828e-03,  6.788935227700294e-04, -2.644266644519450e-04, 1.498643691752570e-04, -8.746796233168272e-05, 2.518984363083598e-04, -2.753093131025853e-04,  1.307671209788223e-06, -1.368588565491254e-03, 2.398795312195309e-04, -2.523448933054801e-04, 2.614765233664875e-04, -1.494769352767485e-04,  1.147776716828649e-03, 1.029920827579320e-04, -2.222875945340101e-04, -1.230527050078568e-04, -4.346996861183648e-04, -5.145297629037158e-04,  1.855020299176958e-04, 2.585796591696891e-05, 6.881999055289815e-05, 1.203487409562570e-04, 1.310340005634916e-04, 1.038843664704700e-04,  1.279901689835751e-03, -9.873647779045915e-05, -4.052657413768985e-05, -3.876960209546743e-04, 4.105650126947753e-04, 1.044660339803198e-04,  1.106729565141643e-04, 1.917054913165900e-04, 5.381270814910131e-05, 5.845886531411810e-05, -2.214540650708851e-04, -8.402894413644303e-05,  3.630963120552005e-04, 1.295473974543174e-04, -4.306708912910560e-05, 4.993722624499390e-06, -2.975542381380378e-04, 2.136531619578048e-05,  4.892204785512709e-05, -3.023290304538353e-04, 2.518519277317261e-04, -2.094352582523373e-04, -9.894776914931854e-06, 1.873302192831002e-05,  1.753801904693048e-03, -3.226517296782131e-04, -1.512517518120349e-04, 4.260561312657125e-05, -2.162967079769834e-04, -1.194817679329809e-04, -2.087084936398269e-05, -2.421881235053864e-04, -4.234251779248354e-04, -3.770265592816529e-04, 1.548593778054164e-05, -3.499174155189815e-04,  7.702140443271034e-04, 3.310465163562735e-05, 4.461911250166488e-04, -1.330989416415657e-04, -9.329039660935584e-05, 2.217242334431214e-04,  9.265228549546914e-05, -6.381553327709464e-04, 4.701184621231874e-04, 2.515426076699941e-05, -7.596132679149665e-05, 1.167986585526674e-05,  9.104557000354125e-04, 1.805459738478738e-04, -4.727904751800898e-05, 1.060053165149055e-04, -2.846426234590110e-06, -1.380072995010427e-03,  3.556637481595127e-04, 9.582824252691229e-05, -5.837033480440149e-05, 1.631249960267218e-05, 4.541314306595349e-04, 2.781076899368131e-04,  4.032565148132695e-03, -6.820359417349022e-05, -2.112312894626783e-04, -1.208044005127215e-04, 2.366382050566618e-04, -5.967336825950022e-05,  1.457811599802574e-04, -5.165210654732259e-05, -2.835546829964881e-04, -1.992884058880639e-04, -7.945956600161998e-05, -4.274811205884394e-05,  9.981927698012641e-04, -7.972042238434470e-04, -2.694865213826209e-04, -2.598733571153913e-04, 1.928787833235822e-04, 2.203995653768443e-04,  1.358068639256001e-04, -1.694350906678811e-04, -8.261361380241129e-06, 2.099726498270568e-04, -1.883300517509452e-04, -7.802219480447651e-04,  1.145162019343088e-03, -1.836551083858035e-04, 2.650220193423678e-04, 7.097511036417142e-05, 8.160059338627195e-05, -4.518842191161653e-04, -1.967907122195823e-05, 2.414649402175080e-04, -8.909499892920586e-05, -1.423553109358482e-04, -3.276022904425107e-04, -1.884954023629597e-04,  1.562301480943164e-03, 8.829085813537434e-04, -2.685663707085704e-04, 1.842641428077217e-04, -1.398217415073988e-05, 3.911179883476369e-04, -3.015053423915658e-04, 1.311385072982262e-04, -1.708944824301999e-03, 5.192123145012555e-04, -2.577783803501501e-04, 4.405339318977870e-04, -3.644307424789375e-04, 1.267033156798850e-03, 6.473085540036797e-05, -2.352182380177796e-04, -2.769129429606642e-04, -3.888662116746915e-04, -6.161207639958748e-04, 4.594692531877747e-04, -2.685723561024501e-04, 1.315668635436048e-04, -5.033121166096254e-05, 2.344295148075164e-04,  4.084015939540894e-05, 1.350443469885455e-03, -7.454389456246528e-05, 6.433068118128469e-05, -4.134736397334453e-04, 5.022552131202179e-04, -5.836321335987326e-05, 2.672786880952507e-04, 1.541182325770254e-04, 1.878421779086847e-04, -1.499746018644303e-04, -2.064043010706662e-04, -9.983180820628514e-05, 4.710436960469568e-04, -3.661076051118459e-05, 2.114048163128779e-05, -2.402433114495214e-05, 6.438684789782396e-05, -1.304005248657476e-04, 1.548618442419767e-04, -4.935454784056883e-04, 3.288896671917209e-04, -2.286032340791548e-04, 3.555157693393244e-06,  7.191313938394709e-05, 1.861994425123680e-03, -3.815424618387263e-04, -1.363043471633957e-04, -5.832950027429877e-05, -8.667006660157595e-05, -7.245505128327786e-05, 6.502783845603702e-05, -3.407665140877240e-04, -3.921262303179007e-04, -3.875417383355681e-04, -2.526178339039836e-05, -3.711328176089602e-04, 8.592823519036052e-04, -2.260498300508353e-05, 5.609667232427985e-04, -2.858784980683321e-04, 6.315404437360083e-06,  1.772966664875186e-04, 1.688262475303559e-05, -5.291853201855219e-04, 3.926226791307570e-04, 2.538725279620741e-05, -1.336749725809869e-04, -2.891956443704527e-06, 9.679146766285386e-04, 2.675401377445626e-04,
                  -2.187846731154301e-05, 2.103845070489113e-04, -4.386853670019733e-05, -1.694891711236965e-03, 3.166782951798150e-04, 1.804397544113348e-05, -1.567053697303801e-04, -1.473169005763235e-04, 4.708650252632372e-04,  1.342986832599668e-04, 4.628683746815963e-03, -3.758594941631263e-04, -1.545241449715407e-04, -3.340442958019258e-04, 3.493328906501968e-04, -6.799173150203701e-05, 1.258042919509850e-04, 3.378543734112661e-05, -1.544322360843739e-04, -2.277190368256718e-04, -1.976467403321822e-05, -1.967054626499702e-04, 1.209204377475992e-03, -7.602403337053570e-04, -1.964102237262077e-04, -3.701587528881987e-04, 1.831111531073396e-04,  1.656974887898747e-04, 5.833359561915050e-05, -2.019813645676573e-04, 5.061097439101924e-07, 8.504825068031439e-05, -6.576564444480944e-05, -1.035230159808450e-03, 1.122926602360688e-03, -3.484464652551685e-04, 3.962081361080231e-04, 7.345107994209523e-05, 9.441445377596333e-05, -3.790070438245984e-04, 8.129862578272849e-05, 2.255344003202594e-04, 6.088529902482404e-05, -3.573190909862498e-04, -1.073259112875043e-04, -2.276028563059332e-04, 1.705100751427955e-03, 1.019087155613311e-03, -1.839129235333426e-04, 1.518010347420722e-04, 1.340812875604250e-04,  4.622601083430731e-04, -2.587343645372846e-04, 2.444063629020423e-04, -1.923413620636633e-03, 5.916920080140995e-04, -2.834577329063774e-04,  5.549425908641761e-04, -3.071947847170552e-04, 1.298076475508314e-03, 8.790805753411933e-05, -2.914096164616226e-04, -2.820358783950366e-04, -4.848853297704386e-04, -6.647067790955479e-04, 3.654701522422402e-04, -1.792398903119715e-04, 1.545145454508574e-04, 2.946411823519550e-05,  1.811708399774261e-04, 1.761792265150948e-04, 1.408632314513454e-03, -7.908429977570242e-05, 5.834020095689906e-05, -3.308265436301001e-04,  5.000397277318158e-04, 7.941708422884319e-05, 2.238550487862845e-04, 2.594764923340082e-04, 8.355147299253629e-05, -1.208988417894054e-06, -2.687587595598287e-04, -5.456663414339867e-05, 4.926716537038807e-04, 6.712106697179420e-05, -3.324816108351371e-05, -9.971050532486874e-06, -1.751979317717509e-04, -1.154253218805120e-05, 3.375164660424197e-05, -4.416352657595533e-04, 4.900122345979029e-04, -2.020138310085681e-04,  3.641981063521890e-05, 1.670145880246236e-04, 2.137268444161755e-03, -4.386038832779246e-04, -3.970334577099577e-06, -2.323745721680801e-04,  5.429705057530810e-06, -1.481232600509720e-04, 1.983657367832510e-04, -3.388966915158722e-04, -5.233480387528179e-04, -4.209809805164816e-04, -6.895385909150407e-05, -4.707976110022517e-04, 8.866894394783838e-04, -6.896065033973469e-05, 5.057052641065389e-04, -2.900346863203843e-04, -4.926031033122919e-05, 2.587315572864140e-04, 1.695505752096992e-04, -5.749066097396442e-04, 4.858860181308535e-04, -3.473881844763550e-05, -1.032187049305341e-04, 7.094334389000126e-05, 1.153030023306862e-03, 1.560198218485732e-04, 7.893571785014717e-05, 1.369389265525459e-04,  7.129010835580042e-05, -1.902792224923524e-03, 1.620263953552892e-04, 6.964454038165400e-05, -4.279906222901635e-04, -1.604828220866554e-04,  4.140532252662316e-04, 3.892650453914005e-05, 5.173646430505391e-03, -3.721474881788457e-04, -2.127015102233204e-04, -5.118980463933490e-04,  6.110936148064512e-04, -1.272538851032676e-04, 1.950921216324283e-04, 4.892959213324525e-05, 3.887980028028089e-06, -2.141595956844734e-04,  1.966445210529606e-04, -4.261374724124857e-04, 1.545950169889953e-03, -1.002068486523113e-03, -1.559401042637148e-05, -3.258795295971592e-04,  6.740805103094903e-05, 2.247757275149655e-04, 2.314940956144673e-05, -1.453120880167469e-04, -1.679028415783975e-05, 6.690868755140591e-05, -1.332666348918709e-04, -1.013814874433100e-03, 1.144786247806164e-03, -3.646203497339066e-04, 5.755364748182474e-04, 5.242596509224129e-05,  1.117355794909275e-04, -3.066077941883064e-04, 1.644525875922357e-04, 2.493005931999652e-04, 1.721171408216029e-04, -4.774368343827039e-04,  5.727395065517305e-05, -2.884440161996372e-04, 2.058668419632687e-03, 1.118892058313451e-03, -4.232253345055394e-04, 1.562942387188787e-04,  3.276508519948737e-04, 4.770005474531256e-04, -5.998511136592481e-04, 1.102434190032802e-04, -1.998976545745218e-03, 7.144078520640079e-04, -2.576255258885467e-04, 7.914827494358869e-04, -2.022481015796425e-04, 1.498918224516356e-03, 1.939443624087728e-04, -3.339039097496006e-04, -1.715617273670690e-04, -6.310232150638516e-04, -6.875612681181039e-04, 1.589979254030526e-04, -7.108263639937437e-05, 2.029380759987616e-04,  3.704854694836980e-05, 1.836000118471352e-04, 1.115022849231949e-04, 1.658468518620488e-03, 8.362297517894605e-06, 9.704190191159938e-05, -4.952572686967064e-04, 5.418175356700113e-04, 1.465911805328483e-04, 2.817693012427136e-04, 2.645147748094435e-04, 1.363694417659237e-04,  1.963826603799089e-04, -3.208472290149935e-04, -9.885053731173433e-05, 5.811969797968777e-04, 2.207080516328261e-04, -1.304090093577746e-04, -1.761072278518044e-06, -5.822359211150750e-04, 5.903896657995738e-05, -1.320931320961072e-06, -3.353979241801789e-04, 5.953009814092707e-04, -3.273291719592201e-04, 1.037632866057085e-04, 1.571315261164656e-04, 2.578401529130553e-03, -7.822715816936664e-04, -3.688263204834001e-05, -3.092596941081190e-04, 1.892805171629663e-05, -2.593353913279541e-04, 2.416702412080780e-04, -3.348309901914503e-04, -5.737870297416412e-04, -3.764940922111356e-04, -1.112333650828607e-04, -5.931224227282380e-04, 1.161669693025551e-03, 6.328684045993253e-05, 5.243912523727307e-04, -3.053759251477613e-04, -7.213278653721818e-05, 2.718512763627025e-04, 2.655373253024170e-04, -7.986565814398913e-04, 5.993841356537319e-04,  6.532890561811427e-05, -4.337156660434245e-05, -8.216922161295725e-05, 1.298944722328432e-03, 1.676869141208276e-04, 2.145341343278736e-04,  1.716708937987006e-05, 2.346431494742311e-04, -2.022990710187718e-03, 4.766866264541083e-04, 2.972897364187982e-04, -8.364859870005499e-04, -4.964512189332089e-05, 9.637793005819197e-04, 3.942737361187683e-04, 5.626591110848960e-03, -4.442489179247362e-04, -5.393648909549897e-04, -7.291621526350647e-04, 6.768634450188741e-04, -2.766593511504570e-04, 2.843329940606357e-04, 1.759874607481542e-04, -2.467953977053027e-05, -4.336095390511453e-04, 7.715449909397923e-05, -2.744537912201058e-04, 1.822603944391664e-03, -1.176619415714293e-03, 1.606959396534812e-04, -3.409156031546959e-04, 2.515299763810305e-04, 2.652317823899555e-04, -3.753984645496481e-05, -1.387222320833255e-04, -2.098922501249802e-05,  1.513306820096841e-04, -3.389288290017504e-04, -1.189557905269538e-03, 1.354891085340873e-03, -4.051852241358408e-04, 6.244030798376824e-04, -1.134007131673352e-04, 7.344704584067482e-05, -2.788376903340111e-04, 8.029007314857564e-05, 2.376554957418823e-04, -3.984259936772819e-05, -3.424041612229618e-04, 3.774523965831397e-05, -3.093975866481624e-04, 2.530516906613733e-03 ))

  expect_equal(c(result_exp$n_iter),
               c(10 ))

  expect_equal(c(result_exp$Q),
               c( 0.0369348396399250128, 0.0347535511930727389, -0.0006142671952991933, -0.0208447893425685940, 0.0031460832425121896, 0.0393297494262970504,  0.0299297174994285764, -0.0151926692108345467, -0.0304751855775745178, -0.0309684844331610185, -0.0310498296907123425, 0.0347535511930727389,  0.5709121944188325637, -0.1686446597941585746, 0.1698945560382618125, 0.1982616446128275534, 0.4805387239719434156, 0.4961075211032802690, -0.1729245057808235231, 0.1410952323022368615, 0.0641271199491234706, -0.0830552743371907182, -0.0006142671952991933, -0.1686446597941585746,  0.2112098669548191920, 0.0108623296507916415, -0.1197334189624230938, -0.0230686928011459846, -0.2714598922926150792, 0.0658273313727851805, -0.2844472599392421364, -0.2177800214777957932, -0.0780936464698704647, -0.0208447893425685940, 0.1698945560382618125, 0.0108623296507916415,  0.4759693020985424350, 0.0409217112887969303, 0.1204106441871845706, 0.1023787602371219185, 0.0229607102482250747, 0.0909124959262914978,  0.0291199215832718961, 0.1266105293138096721, 0.0031460832425121896, 0.1982616446128275534, -0.1197334189624230938, 0.0409217112887969303,  0.5040282957950377174, 0.0663591920373213517, 0.5556898969294927770, -0.8218583134208413687, 0.8231420338480111010, 0.1404992728419708625,  0.4368889442881035423, 0.0393297494262970504, 0.4805387239719434156, -0.0230686928011459846, 0.1204106441871845706, 0.0663591920373213517,  0.6282889570563814363, 0.1833274871838001530, 0.0724276357786615421, -0.0429390608416417227, 0.0905470814526384976, -0.2506286019847893121,  0.0299297174994285764, 0.4961075211032802690, -0.2714598922926150792, 0.1023787602371219185, 0.5556898969294927770, 0.1833274871838001530,  0.8897977345459746612, -0.8829071761313642686, 0.7557043863090896485, 0.0671338895524428714, 0.3702981787936599489, -0.0151926692108345467, -0.1729245057808235231, 0.0658273313727851805, 0.0229607102482250747, -0.8218583134208413687, 0.0724276357786615421, -0.8829071761313642686,  1.5890781319281903627, -1.1569513773541761914, 0.1141741126471425977, -0.7516214852224204490, -0.0304751855775745178, 0.1410952323022368615, -0.2844472599392421364, 0.0909124959262914978, 0.8231420338480111010, -0.0429390608416417227, 0.7557043863090896485, -1.1569513773541761914,  1.7266088448965291047, 0.6474761161033781853, 0.8842405502195805900, -0.0309684844331610185, 0.0641271199491234706, -0.2177800214777957932,  0.0291199215832718961, 0.1404992728419708625, 0.0905470814526384976, 0.0671338895524428714, 0.1141741126471425977, 0.6474761161033781853,  0.6419516180932933747, 0.1699699068377856226, -0.0310498296907123425, -0.0830552743371907182, -0.0780936464698704647, 0.1266105293138096721,  0.4368889442881035423, -0.2506286019847893121, 0.3702981787936599489, -0.7516214852224204490, 0.8842405502195805900, 0.1699699068377856226,  0.6096406213301375221 ))

  expect_equal(c(result_exp$Q_0),
               c(100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100 ))

  expect_equal(c(result_exp$n_risk),
               c(20188, 19718, 19208, 18895, 18093, 17286, 16014, 14766, 13487, 12518 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))
})
