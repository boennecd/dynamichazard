if(interactive()){
  library(survival); library(dynamichazard); library(testthat)
  source("C:/Users/boennecd/Dropbox/skole_backup/phd/dynamichazard/R/test_utils.R")
} else
  options(warn = -1)

# Test on data set that is one of Farhmiers papers
result = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1, # Use by month intervals
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4),
  a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
  max_T = 45,
  id = head_neck_cancer$id, order = 1
)

# plot(result, cov_index = 1)
# get_expect_equal(result, file = "tmp.txt")

test_that("Testing previous computed values vs. current on head and neck cancer set assuming that the previous is correct", {
  expect_equal(c(result$state_vecs),
               c(-3.5045064165490518, -3.5045656499164295, -3.1329979343435461, -2.7762813620346121, -2.4920444550244687, -2.0475180974079015, -2.1188049966993696, -2.5082342056716649, -2.7400547989246267, -2.8849282879973148, -3.0253327692106984, -3.2406977640747754, -3.3657522145691128, -3.4217728641562681, -3.2739452065172792, -3.3169520925442670, -3.4384370809821552, -3.5426921460127447, -3.5025053437910434, -3.5883353594935170, -3.5579940746115737, -3.6815422153090513, -3.8600459984612017, -3.9790677778298500, -4.0362876817800135, -4.1737949093221500, -4.2663243629831635, -4.3146884533943091, -4.4617089602371571, -4.5811903147914004, -4.6725556962586463, -4.7359352412761311, -4.7714262957243081, -4.7789372894227720, -4.7581748229597807, -4.7086665843191895, -4.6297901735810880, -4.5207994729812713, -4.5209273736810847, -4.6295543473960477, -4.7237081990042649, -4.8005546281779816, -4.8594330723345767, -4.9032101303250126, -4.9320276910045253, -4.9459427144095427, 0.4622523023291275, 0.4622626844924319, 0.4652397589717921,  0.4740783791640956, 0.4672612377158187, 0.4836163262469676, 0.4896990261561225, 0.4863002013615905, 0.5055099547472884, 0.5138992180545477,  0.5195462743890488, 0.5209216389305817, 0.5293995373114516, 0.5447016176064285, 0.5624431287164163, 0.5625250853546695, 0.5619030953182752,  0.5668602203025682, 0.5730242083044264, 0.5781903092189493, 0.5842840398250273, 0.5778996254763145, 0.5761554595155960, 0.5747261154704411,  0.5736150619753867, 0.5773179176988464, 0.5813942440473051, 0.5858804824738809, 0.5952548377211626, 0.6050755551710356, 0.6153047774686421,  0.6259131746245181, 0.6368787546941960, 0.6481852747490043, 0.6598209416049969, 0.6717774284058471, 0.6840491395803701, 0.6966326585520586,  0.7028701970602720, 0.7026435197664337, 0.7024823951448731, 0.7023874356412544, 0.7023576772999551, 0.7023282335255832, 0.7022983939049023,  0.7022677820270420 ))

  expect_equal(c(result$state_vars),
               c( 0.24971481604065104, -0.04845111114383468, -0.04845111114383471, 0.10639152831379761, 0.16311419016912762, -0.05259256270700222, -0.05259256270700224,  0.09789681170500669, 0.15310383223295043, -0.05151399097432499, -0.05151399097432502, 0.09101731796320917, 0.13479229477473645, -0.04918940147026213, -0.04918940147026213, 0.08466734962518582, 0.11552947419685949, -0.04715973326374917, -0.04715973326374917, 0.07906340925166372, 0.10170593315556586, -0.04265467240609434, -0.04265467240609433, 0.07464409218421481, 0.08283283204131768, -0.03958875342966766, -0.03958875342966766, 0.07143014093146663,  0.08574743237753379, -0.03839075515247545, -0.03839075515247545, 0.07064371539854651, 0.09988559962713089, -0.03821046226156710, -0.03821046226156710,  0.07178361577151676, 0.11294823941314228, -0.03883277749515560, -0.03883277749515561, 0.07395046643986163, 0.12372876096303355, -0.03967075418430188, -0.03967075418430188, 0.07678826005975414, 0.13471675164657299, -0.04049594614565687, -0.04049594614565687, 0.08016446211107395, 0.15055875539669883, -0.04160790267880037, -0.04160790267880037, 0.08400586430581332, 0.16472177593961668, -0.04304400781965888, -0.04304400781965888, 0.08808479982944045,  0.17645575575408801, -0.04459796396982182, -0.04459796396982182, 0.09231756249871856, 0.17448916690674271, -0.04613087848951326, -0.04613087848951326,  0.09654727397268645, 0.17718203800291171, -0.04779606323864612, -0.04779606323864612, 0.10106119664367978, 0.18769088622561772, -0.04973601409705623, -0.04973601409705623, 0.10594721243974012, 0.20213723093262348, -0.05184855724861329, -0.05184855724861329, 0.11114422128391810, 0.21041663267921473, -0.05400173185964625, -0.05400173185964624, 0.11649745709426079, 0.22134939039718360, -0.05628334296113834, -0.05628334296113834, 0.12211582796072129,  0.22493462219519089, -0.05859873851338071, -0.05859873851338071, 0.12787957175843259, 0.23551328640885347, -0.06146059220632962, -0.06146059220632962,  0.13398312811521065, 0.25314128225693611, -0.06455439434660187, -0.06455439434660187, 0.14044073932175916, 0.27076904865840157, -0.06781819924878714, -0.06781819924878714, 0.14713904387168714, 0.28433525497363610, -0.07123289371385615, -0.07123289371385615, 0.15400961367578436, 0.30294835012113436, -0.07487234429905440, -0.07487234429905440, 0.16115504760087240, 0.32016040142844482, -0.07848373195886876, -0.07848373195886876, 0.16849145170033528,  0.33314708270447457, -0.08208776164140788, -0.08208776164140788, 0.17597734496306500, 0.35286329198897837, -0.08568163592163081, -0.08568163592163081,  0.18374253693804946, 0.37536940434514132, -0.08926715170003868, -0.08926715170003868, 0.19172907098000486, 0.39873630901420842, -0.09283743440897779, -0.09283743440897779, 0.19989975627046705, 0.42178611638715935, -0.09638204834799534, -0.09638204834799534, 0.20822832732644378, 0.44361733758340671, -0.09988908333111086, -0.09988908333111086, 0.21669518969646151, 0.46339438509377351, -0.10334609693208163, -0.10334609693208163, 0.22528520655358666,  0.48023997913036814, -0.10674058641935472, -0.10674058641935472, 0.23398639917058323, 0.49317130060577541, -0.11006025940374116, -0.11006025940374116,  0.24278911803014888, 0.50105573489729149, -0.11329321873365431, -0.11329321873365431, 0.25168548221153902, 0.50172607734539709, -0.11631830554913909, -0.11631830554913909, 0.26066293360741083, 0.50678929708482690, -0.11934048900315548, -0.11934048900315548, 0.26986042363554874, 0.53530791125108756, -0.12262821748386488, -0.12262821748386488, 0.27950428218778706, 0.58183228951032062, -0.12605788915437280, -0.12605788915437280, 0.28951529241594171,  0.64601004887201596, -0.12955062384606128, -0.12955062384606128, 0.29984925590669426, 0.72461186953629142, -0.13339769709753874, -0.13339769709753874,  0.31041514122822839, 0.82102801119622204, -0.13755295184677210, -0.13755295184677210, 0.32120094422203299, 0.93944483420711966, -0.14198397121295389, -0.14198397121295389, 0.33219697935406944 ))

  expect_equal(c(result$order),
               c(1 ))

  expect_equal(c(result$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result$method),
               c("EKF" ))

  expect_equal(c(result$model),
               c("logit" ))

  expect_equal(c(result$est_Q_0),
               c(FALSE ))

  expect_equal(c(result$LR),
               c(1 ))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result$Q_0)), rep(c("(Intercept)", "group1"), 2))
})

suppressMessages(
  result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 1,
    a_0 = rep(0, 2), Q_0 = diag(1, 2),
    Q = diag(1e-3, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential"))

# matplot(result_exp$state_vecs, type = "l")
# plot(result_exp, cov_index = 1)
# get_expect_equal(result_exp, file = "tmp.txt")

test_that("Result of exponential model on head_neck_data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.746423060135996685, -3.746504060013073900, -3.411975048951466860, -3.123640371003203242, -2.982809608911737520, -2.590346163235035526, -2.707462197276075067, -3.063090315919674733, -3.210805574368385873, -3.315742889070746102, -3.426247363612953123, -3.615220620358764236, -3.697315516637163402, -3.694960055771935981, -3.514271049590928619, -3.583085023499657851, -3.710830938614790853, -3.795127010362230990, -3.748048132503383201, -3.815987456462097249, -3.777482704888463161, -3.920316568467759666, -4.088637675068001798, -4.201323487740026508, -4.259461256379053040, -4.367477036724612738, -4.433043652875148233, -4.459456746007150585, -4.550360855046704067, -4.610000022861876268, -4.639325243012230260, 0.267804490680041141, 0.267771787453442156, 0.403121813911384685, 0.520049844804208572,  0.576160248484232418, 0.735892530651090726, 0.689094230510559402, 0.545630086365206601, 0.487798497798527519,  0.446442789310776300, 0.402597030242301868, 0.326664433404419530, 0.294377499738915582, 0.296650845900248650,  0.371113979808708139, 0.343329377363240540, 0.291614728358585928, 0.257804270528158685, 0.277126693289556969,  0.249812884521956741, 0.265542761334367383, 0.206999786494018956, 0.138432166714767713, 0.092322841165753983,  0.068242479179494192, 0.024306252492979658, -0.002487643961411226, -0.013462865355197196, -0.050190793123115238, -0.074287656203643360, -0.086136417649086819 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.220295737757598364, 0.030605438335697444, 0.030605438335697410, 0.107887831584073779, 0.145517332013094386, -0.001660812188336636, -0.001660812188336663, 0.093157593036923003, 0.138465436387046198, -0.005483167613022810, -0.005483167613022810, 0.090459598666057905, 0.121190284462693143, -0.013473739641127053, -0.013473739641127053,  0.086110274476198068, 0.101662279453035381, -0.022908096953915380, -0.022908096953915352, 0.081038208697458758,  0.095867522458459364, -0.023885306692934857, -0.023885306692934843, 0.080689754615085069, 0.077456526357003314, -0.030960843306268769, -0.030960843306268776, 0.077602255823180491, 0.082455078200529969, -0.027693058748322806, -0.027693058748322806, 0.079340402366294610, 0.097620413611103074, -0.019611163477797986, -0.019611163477797990,  0.083536337148846770, 0.108527839469235637, -0.013899742692818465, -0.013899742692818469, 0.086642393140734547,  0.117270064414540853, -0.009209497548788718, -0.009209497548788718, 0.089378028472115539, 0.126593308401248106, -0.004213354226871995, -0.004213354226872004, 0.092352613543143031, 0.142056902973380222, 0.003246515045985453,  0.003246515045985445, 0.096393662153779189, 0.154670481364136941, 0.009174882144043255, 0.009174882144043245,  0.099714166376657809, 0.162243181462978447, 0.012759067407502343, 0.012759067407502333, 0.102003897171627778,  0.154263017275540815, 0.009671257575669605, 0.009671257575669601, 0.101468499748081642, 0.156268829056957770,  0.010708150500953185, 0.010708150500953181, 0.102691939758461775, 0.167351999992699452, 0.015510896273943500,  0.015510896273943500, 0.105530910705355946, 0.180549724125395994, 0.021142568352647155, 0.021142568352647155,  0.108735832386015252, 0.186676114925689196, 0.023696715611691128, 0.023696715611691115, 0.110636132361143863,  0.195132553747604187, 0.027239491848385596, 0.027239491848385589, 0.112988513500728624, 0.195802238977011434,  0.027491757655777889, 0.027491757655777889, 0.113976217186229828, 0.207695680825756651, 0.032192216268221538,  0.032192216268221538, 0.116764105693921788, 0.227752670178947458, 0.040306746418476834, 0.040306746418476841,  0.121009914489442844, 0.249896037576859964, 0.049182391963886199, 0.049182391963886199, 0.125552580822571369,  0.271761552831857933, 0.057783298444313118, 0.057783298444313125, 0.129935708438214170, 0.302118813679059628,  0.069780714362332324, 0.069780714362332324, 0.135696484455231470, 0.338266746322974599, 0.084091957207221874,  0.084091957207221874, 0.142395942290244937, 0.380742938825434474, 0.100879963944609241, 0.100879963944609241,  0.150075305372945611, 0.444466596145961845, 0.126328250804517594, 0.126328250804517594, 0.161299161876744979,  0.531999976361760107, 0.161392148387444728, 0.161392148387444728, 0.176418095681750153 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(72 ))

  expect_equal(c(result_exp$Q),
               c(0.11712173734693690, 0.04695251832094549, 0.04695251832094549, 0.01990459209039402 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(0.0877914951989026 ))
})

test_that("exponential model and logit moels hazzard functions differs", {
  expect_true(result_exp$model != result$model)
  expect_true(toString(body(result_exp$hazard_func)) !=
                toString(body(result$hazard_func)))
  expect_true(toString(body(result_exp$hazard_first_deriv)) !=
                toString(body(result$hazard_first_deriv)))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result_exp$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result_exp$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result_exp$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result_exp$Q_0)), rep(c("(Intercept)", "group1"), 2))
})


# Change by argument
suppressMessages(result_exp <- ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 2, Q_0 = diag(1, 2),
  Q = diag(1e-1, 2),
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-3),
  max_T = 30,
  id = head_neck_cancer$id, order = 1,
  verbose = F,
  model = "exponential"
))

# matplot(result_exp$state_vecs, type = "l")
# plot(result_exp, cov_index = 1)
# get_expect_equal(result_exp, file = "tmp.txt")

test_that("Result of exponential model on head_neck_data match previous results with altered by argument", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.87037427961885383, -3.87023087984429326, -1.91221037934947025, -2.43862280740296100, -3.22165530139148526, -3.30681140748686797, -3.89651206337075617, -3.63305833903981856, -3.53490169069086635, -3.92811419830653863, -3.83445633104215533, -4.08572279262521310, -4.38977418588174118, -4.59111421278896614, -4.26627051055878859, -4.65585179523574677, 0.25164279033439135, 0.25144509924460229, 1.37673532204583315, 1.01993204104296042,  0.53459101788916963, 0.54030801834951736, 0.19704401242214445, 0.43237882659576832, 0.45550100210285527,  0.22267296417307317, 0.25618524455277258, 0.00618157586681295, -0.22706286691347843, -0.37988354475124742, -0.23811812709966915, -0.45275960647321628 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.441292543450496955, 0.119914593826589019, 0.119914593826589033, 0.293711418856185458, 0.153610075857844225, -0.028908871706440492, -0.028908871706440492, 0.156586679956091435, 0.173792970426504961, 0.004791443767631409,  0.004791443767631437, 0.141115685933586310, 0.055149694875353913, -0.046529344162667019, -0.046529344162667019,  0.067349697349126936, 0.075678008174908079, -0.038645834720671388, -0.038645834720671381, 0.085822125254475176,  0.132443974179516144, -0.014948731361429442, -0.014948731361429435, 0.129403658956841972, 0.155750605430720168, -0.014692267525394792, -0.014692267525394792, 0.157893280988063045, 0.254860141089101100, 0.034077493139793191,  0.034077493139793191, 0.222756109854566703, 0.238890329496455001, 0.004944733239908717, 0.004944733239908720,  0.232124143223547630, 0.226881610397214217, -0.020933213616808371, -0.020933213616808360, 0.247184584339527252,  0.334349783425151426, 0.024953265993933792, 0.024953265993933771, 0.318490259893117411, 0.340131045559659451,  0.003272646957310301, 0.003272646957310294, 0.348947458402341093, 0.415849736184024044, 0.030333279839828829,  0.030333279839828808, 0.421743984834121899, 0.523382410162643530, 0.072540529768555781, 0.072540529768555739,  0.509325662871255580, 0.641622171871534919, 0.114835421711122015, 0.114835421711121988, 0.599146059513987028,  0.618035296626318953, 0.065811216941824985, 0.065811216941824985, 0.632932302407492875 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.10200382443452685, -0.04571589452880667, -0.05083395148578548, 0.13442239936127454, 0.06035462774283284, -0.04979102175280423, -0.05155823760870992, 0.09270295856323763, 0.03712398729936267, -0.04078366544120141, -0.04690857804759244, 0.05834357792228553, 0.03225048889196058, -0.04068258137312888, -0.03764188588715757,  0.04921007496276691, 0.03774942080843696, -0.04664174346994628, -0.04125586603008025, 0.06532073057893037,  0.05081104228755204, -0.04943994252619141, -0.04680513527685709, 0.09000025813177906, 0.07154819378921567, -0.05108515253310515, -0.04463860675610858, 0.12015084187547252, 0.09629910216893048, -0.04578547530236746, -0.04813716112477871, 0.15067548841267339, 0.09391302444910532, -0.06611524013466885, -0.06657478927713116,  0.16580374647646218, 0.11744037359727003, -0.07184904079874951, -0.06702917474526374, 0.19814277709906072,  0.15664336724252381, -0.06536520591652244, -0.06565715574900269, 0.24087661449129624, 0.18956975446789501, -0.06951695680969300, -0.06103640411174969, 0.28634704100628644, 0.30368102033354683, -0.01795183767719585, -0.00964876074475577, 0.37111142407645392, 0.64812791793174362, 0.16667993986692364, 0.17364424794121208,  0.53733278737797563, 1.55191487037745812, 0.67312143735963870, 0.67754892293272584, 0.89037289933934638 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(16 ))

  expect_equal(c(result_exp$Q),
               c(0.3409762050461504, 0.1803436136440473, 0.1803436136440473, 0.1426526945307628 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(0.1316872427983539 ))
})

# for(s in sample.int(1e6, 100, replace = F)){
# print(s)
# set.seed(s)
set.seed(599479)

sims <- test_sim_func_exp(n_series = 1e3, n_vars = 10, t_0 = 0, t_max = 10,
                          x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                          intercept_start = -5, sds = c(.1, rep(1, 10)))
# tmp_file <- file("exponential.log")
# sink(tmp_file)
suppressMessages(result_exp <- ddhazard(
  formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
  data = sims$res,
  by = (by_ <- 1),
  Q_0 = diag(10, 11),
  Q = diag(1e-2, 11),
  control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^3),
  max_T = 10,
  id = sims$res$id, order = 1,
  verbose = F,
  model = "exponential"))
# sink()
# close(tmp_file)

# matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
# matplot(result_exp$times, result_exp$state_vecs, result_exp$state_vecs, type = "l", lty = 2, add = T)
# get_expect_equal(result_exp, eps = 1e-5, file = "tmp.txt")

if(!interactive())
  test_that("Deal with lag one co-variance in EKF + exponential model!",
            expect_true(F))

test_that("Result of exponential model on simulated data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-5.188203295858222042, -5.192867919169898094, -4.310316958425439715, -4.336320945330846222, -4.064762463526304437, -4.470068713489812495, -4.278183682563193813, -4.738207889373453163, -5.080239744824088355, -4.330098903059813154, -3.512832514783392313, 0.903535714308593918, 0.894331964133800561, 1.816929462718155142, 0.620636215330882868, -1.210916388947183453, -2.124633635549365795, -2.018309280940417949, -2.663985587934378785, -2.388579061828196348, -1.695473603518183658, -0.908981390672407796, -1.764398534960296638, -1.783669340597084485, 0.613675018496285141, -1.259230230844413434, -3.749789731748256916, -5.281844649984472007, -4.760451807749158881, -5.760598422852969414, -4.862687284882237115, -3.721453497357167350, -2.131048877181849210, 0.646734126164619449, 0.645014594742284952,  0.674528187264348711, 0.525849444022213341, 0.419254877067003873, 0.119506867082035007, 0.344312436531998556, -0.151188667141975652, -0.984275580736283739, -0.147218581461528275, 0.643775114143569249, 0.903078090752215124,  0.906729758787989892, 0.869950217759679956, 1.595274505346900407, 2.797467744558432390, 3.253341266223266803,  3.096065389005932644, 3.496517930806801733, 3.662144599252522337, 3.192325862453184726, 2.735585334977329808,  0.678519650708181765, 0.678283654429648220, 0.307016411703131709, 0.022340565125074319, -0.486681248517496334, -0.760715580711739725, -0.664154943419190902, -1.102134793443673821, -1.900241848609568907, -1.240890040051801702, -0.694924949031594075, -0.520770279577914441, -0.521900942890573538, -0.531901667471322948, -0.584528090136232525, -0.547787771140243018, -0.717278086797987546, -0.478133042485134219, -0.786054878228679588, -1.427949733333044646, -0.838069475769509964, -0.265493352688137230, 0.051633853669528731, 0.037845740492234659, 2.924056990572987402,  2.377243559493144698, 2.098266161187867684, 1.786915474205531540, 1.968123287727698845, 2.491452526580773430,  5.761100690828738990, 4.585940059361372612, 3.944717989283841320, 1.113496343379008380, 1.109175268779626355,  1.999820516717627950, 1.860492444907890119, 1.863381980316567210, 1.696891414664366993, 1.769589769007558377,  1.745902104086367590, 2.445779023827046927, 2.361342564113131814, 2.383779024039542449, 1.713304661384221772,  1.717483031231116231, 0.609252124153554675, 0.676695613135207874, 0.634783559424135002, 0.517114549821963809,  0.547429584398183788, -0.011728153257258622, -1.912657666273230195, -0.887684276927991345, -0.007803321122974438, -1.986860410843613423, -1.973053825621926993, -5.027206005632039343, -4.593177841377539039, -4.503053956458455076, -4.187297705728798114, -4.284967037244340027, -4.835946927079818991, -8.222364049774895989, -6.998889221581012343, -6.308863713569206944 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$state_vars),
               c( 0.3564718209647352865, 0.1502042108545438848, 0.3949362494855248595, 0.2124595209322067413, -0.0476819667674404646, 0.1018442896498744504, 0.1609053367419655267, -0.0551357559837619485,  0.0553818409885371565, 0.1688038124507954263, 0.0525114410273263485, 0.1502042108545438848,  0.8663100540189390131, 1.2243281841372029017, 0.1855384361571849883, -0.4604454500014331653,  0.2503434462059512811, 0.0944020402948364534, 0.1617109294087489546, 0.0776916954361121792,  0.0888071993212603689, -0.1143341085457198342, 0.3949362494855247485, 1.2243281841372029017,  2.2197518498388131292, 0.3452033531635448904, -0.6782092839561278952, 0.3280807046148012107,  0.2242126480805420596, 0.5936128917560727913, 0.2212026029497712876, 0.0388679022587088835, -0.5096810431421557874, 0.2124595209322067413, 0.1855384361571850715, 0.3452033531635449459,  0.3066692478863988214, -0.1342364305139721325, 0.1881638378090466635, 0.1847533401768684524, -0.3227674414196349817, -0.0196826386375874331, 0.3038689827745920113, 0.3428542682694438182, -0.0476819667674404438, -0.4604454500014334428, -0.6782092839561280062, -0.1342364305139721325,  0.3831971041731261352, -0.1983124470282424667, -0.0893577393272062814, 0.0735754083882483173,  0.0081059966737519681, -0.1278031294679441432, -0.1368207672945087050, 0.1018442896498744088,  0.2503434462059513921, 0.3280807046148014328, 0.1881638378090466912, -0.1983124470282425222,  0.2648395318915124363, 0.1292535636669398247, -0.3767381053890948017, -0.0608516892457050609,  0.2841805186090277102, 0.4130142849545426764, 0.1609053367419656100, 0.0944020402948365228,  0.2242126480805420874, 0.1847533401768683692, -0.0893577393272062537, 0.1292535636669398247,  0.2069051716891880943, -0.2328161296450839690, -0.0222871352651428378, 0.2155878130752736654,  0.2582611382948359346, -0.0551357559837620109, 0.1617109294087490379, 0.5936128917560725693, -0.3227674414196348707, 0.0735754083882483173, -0.3767381053890944687, -0.2328161296450839690,  1.6980868970208273794, 0.3741475264367888909, -0.8838837043260465709, -1.6803768439410917690,  0.0553818409885371774, 0.0776916954361122347, 0.2212026029497712598, -0.0196826386375874261,  0.0081059966737519508, -0.0608516892457050332, -0.0222871352651428378, 0.3741475264367889464,  0.1742668935710796063, -0.1701766214639477137, -0.3943139678935742021, 0.1688038124507953985,  0.0888071993212603827, 0.0388679022587088488, 0.3038689827745921224, -0.1278031294679440877,  0.2841805186090277102, 0.2155878130752736099, -0.8838837043260469040, -0.1701766214639477137,  0.6422702852407251584, 0.9143797346648711022, 0.0525114410273262791, -0.1143341085457198758, -0.5096810431421558985, 0.3428542682694437627, -0.1368207672945086495, 0.4130142849545427874,  0.2582611382948359346, -1.6803768439410924351, -0.3943139678935742576, 0.9143797346648711022,  1.8316815271254398567, 0.0755229691425798877, 0.0150403026074210494, 0.0638946375928686194,  0.0351240106431329885, -0.0074949398183738331, 0.0161304587455404769, 0.0321454487166744976, -0.0236149149571044485, -0.0005326541614235347, 0.0288320307999519188, 0.0337315221568559587,  0.0150403026074210772, 0.2981174558699241084, 0.3228304959990835332, 0.0344953129534601097, -0.1372271092678233328, 0.0742397421708959060, 0.0063403885773025415, 0.0257094615546330924,  0.0148061443669236445, 0.0227934942289047676, -0.0156411384901818454, 0.0638946375928686056,  0.3228304959990835332, 0.6196144957630375094, 0.0787442000910802686, -0.1973213125090947651,  0.0918764024889000136, 0.0552997613699467011, 0.1333404441914082250, 0.0396603188211801100,  0.0133365015253159927, -0.0964537276866831994, 0.0351240106431329746, 0.0344953129534601305,  0.0787442000910802270, 0.1167558079369673818, -0.0324175248726315673, 0.0455917949012193888,  0.0518455308777304724, -0.0755190431111950611, -0.0029186013783272999, 0.0740225456331340959,  0.0826681140399420644, -0.0074949398183738192, -0.1372271092678234716, -0.1973213125090947095, -0.0324175248726315535, 0.1570409107964362283, -0.0598271800681427837, -0.0246698534529133130,  0.0134623670205698785, 0.0016038981750589776, -0.0262549776604951088, -0.0377437206308154360,  0.0161304587455404561, 0.0742397421708959615, 0.0918764024888999720, 0.0455917949012194026, -0.0598271800681428462, 0.1068986597894454604, 0.0305196659425098875, -0.0876868596859152333, -0.0122322386717625166, 0.0650188680241305939, 0.0981344954545152054, 0.0321454487166745045,  0.0063403885773026056, 0.0552997613699466387, 0.0518455308777304724, -0.0246698534529133269,  0.0305196659425098771, 0.1002929312876404966, -0.0483455202810034387, -0.0073587678894963364,  0.0486543949853659591, 0.0628465635259846528, -0.0236149149571045144, 0.0257094615546331479,  0.1333404441914080862, -0.0755190431111950056, 0.0134623670205699097, -0.0876868596859150529, -0.0483455202810034665, 0.4360614675624030490, 0.0827916630661595376, -0.2075790895970882621, -0.3815261487635674409, -0.0005326541614235208, 0.0148061443669236913, 0.0396603188211800475, -0.0029186013783272999, 0.0016038981750589585, -0.0122322386717624854, -0.0073587678894963347,  0.0827916630661596348, 0.0831112694054743084, -0.0411941736733142522, -0.0879718009141046281,  0.0288320307999518910, 0.0227934942289047607, 0.0133365015253159580, 0.0740225456331341652, -0.0262549776604951088, 0.0650188680241305939, 0.0486543949853659036, -0.2075790895970884287, -0.0411941736733142660, 0.1975923635156064950, 0.2113725903873455714, 0.0337315221568559032, -0.0156411384901818731, -0.0964537276866832965, 0.0826681140399420922, -0.0377437206308153875,  0.0981344954545153719, 0.0628465635259846389, -0.3815261487635673854, -0.0879718009141046836,  0.2113725903873457934, 0.4687297824200610252, 0.0665838676620906927, 0.0240103450712270232,  0.0746656777222383800, 0.0282308130902155091, -0.0051185976596646657, 0.0094948760719356928,  0.0243112416867661482, -0.0026784586780963411, 0.0044776706025215496, 0.0167117216883624770,  0.0074111032529636384, 0.0240103450712270787, 0.2489805992497309828, 0.2792342874294141408,  0.0352925732627961258, -0.1116865708517331829, 0.0616576534203468959, 0.0107238408595546047,  0.0252818072700318856, 0.0155288944648528764, 0.0239352257045015657, -0.0169383416224280631,  0.0746656777222383106, 0.2792342874294141963, 0.5457013104021826155, 0.0710797885264684570, -0.1596615662333365770, 0.0753270916459616163, 0.0471606005163159175, 0.1269335911760236524,  0.0416553978110258405, 0.0117662412202026011, -0.1011621899216662845, 0.0282308130902155230,  0.0352925732627961120, 0.0710797885264684570, 0.0973045213967378420, -0.0258504753440704643,  0.0369075701271407083, 0.0392020325930455410, -0.0629085512103193523, -0.0020002748968701756,  0.0615695376033766062, 0.0653518757391182564, -0.0051185976596646587, -0.1116865708517332523, -0.1596615662333364383, -0.0258504753440704643, 0.1317747947928820107, -0.0496034473063971526, -0.0194817105913085396, 0.0156667791416738936, 0.0025825977493157300, -0.0247686155021507072, -0.0357288773607840962, 0.0094948760719356790, 0.0616576534203469376, 0.0753270916459615747,  0.0369075701271407083, -0.0496034473063971873, 0.0909167520549178931, 0.0242280965298835374, -0.0776568961796967328, -0.0117692317898151471, 0.0562548774313715860,
                  0.0859002947722688481,  0.0243112416867661621, 0.0107238408595546706, 0.0471606005163158967, 0.0392020325930455271, -0.0194817105913085674, 0.0242280965298835235, 0.0804287367937793762, -0.0400308560799835303, -0.0061515315563477509, 0.0389614648486074841, 0.0489123732356284563, -0.0026784586780963706,  0.0252818072700319481, 0.1269335911760236524, -0.0629085512103194078, 0.0156667791416739074, -0.0776568961796966356, -0.0400308560799835789, 0.3943233067047047791, 0.0772406354016890589, -0.1817669108846280968, -0.3466324496471754890, 0.0044776706025215496, 0.0155288944648528937,  0.0416553978110258127, -0.0020002748968701791, 0.0025825977493157109, -0.0117692317898151367, -0.0061515315563477457, 0.0772406354016890728, 0.0745871937166110444, -0.0364307345835694490, -0.0827150111574497526, 0.0167117216883624492, 0.0239352257045015622, 0.0117662412202026220,  0.0615695376033766062, -0.0247686155021507107, 0.0562548774313715652, 0.0389614648486074841, -0.1817669108846281523, -0.0364307345835694629, 0.1692955873293200408, 0.1833135347313854524,  0.0074111032529636106, -0.0169383416224280908, -0.1011621899216662568, 0.0653518757391182564, -0.0357288773607840893, 0.0859002947722689730, 0.0489123732356284563, -0.3466324496471752670, -0.0827150111574497665, 0.1833135347313855079, 0.4246053340460555492, 0.0387760537796417587, -0.0169909441548118760, -0.0108903117950929010, 0.0126151821746198281, 0.0055828161765003933,  0.0055212367982150788, 0.0164488589531234797, -0.0436413042593582767, -0.0111317107817416189,  0.0179372277994738864, 0.0516466798429706386, -0.0169909441548118829, 0.1016353197702104666,  0.0557487799532663392, -0.0025779208616847253, -0.0317791563702843338, 0.0146390304127108940, -0.0107841584214783560, 0.0036688151491958282, 0.0020603573299375543, 0.0005012566281814260, -0.0034079142573841524, -0.0108903117950929062, 0.0557487799532663114, 0.1312436997521687354,  0.0068040207087430877, -0.0395310559406196957, 0.0182932096446945525, 0.0043814103352542684,  0.0119650727182096708, -0.0002520202103322416, 0.0028134915770576243, -0.0015179151982664578,  0.0126151821746198350, -0.0025779208616847340, 0.0068040207087430946, 0.0595230826098082366, -0.0005725541268576887, 0.0103250523360019220, 0.0175939507145214773, -0.0282903096332548232,  0.0004773131897977337, 0.0228984450989259784, 0.0285693089245477039, 0.0055828161765003933, -0.0317791563702844587, -0.0395310559406196055, -0.0005725541268576939, 0.0678419237157850963, -0.0124898786676012584, -0.0020743604155622113, -0.0030020884209542749, -0.0003626007562095371,  0.0015026692516011799, -0.0057701281841637964, 0.0055212367982150632, 0.0146390304127109096,  0.0182932096446945212, 0.0103250523360019462, -0.0124898786676012653, 0.0501054804335923504,  0.0076045511780133881, -0.0183544494140746965, -0.0001569035540571299, 0.0120466860646081062,  0.0215666604177226044, 0.0164488589531234936, -0.0107841584214782953, 0.0043814103352542207,  0.0175939507145214495, -0.0020743604155622338, 0.0076045511780133924, 0.0582271172780115254, -0.0192536594580668373, -0.0034087466249594738, 0.0148771308535675141, 0.0246499686328153812, -0.0436413042593583114, 0.0036688151491958403, 0.0119650727182096864, -0.0282903096332548579, -0.0030020884209542437, -0.0183544494140747451, -0.0192536594580668859, 0.1304588548177526564,  0.0115987641058708339, -0.0502104241362456294, -0.0854887643475530923, -0.0111317107817416328,  0.0020603573299375821, -0.0002520202103322936, 0.0004773131897977380, -0.0003626007562095666, -0.0001569035540571247, -0.0034087466249594538, 0.0115987641058708374, 0.0488695504086170129, -0.0074487659253321872, -0.0145562571281026235, 0.0179372277994738899, 0.0005012566281814308,  0.0028134915770576083, 0.0228984450989259541, 0.0015026692516011803, 0.0120466860646080958,  0.0148771308535675002, -0.0502104241362456571, -0.0074487659253322114, 0.0772272661656021736,  0.0495324927796831349, 0.0516466798429706317, -0.0034079142573841346, -0.0015179151982664700,  0.0285693089245476796, -0.0057701281841637765, 0.0215666604177226842, 0.0246499686328153604, -0.0854887643475529951, -0.0145562571281025854, 0.0495324927796830794, 0.1494750451722671181,  0.0449125881803093333, -0.0030385082500555237, 0.0139286378958670652, 0.0239739645869568724, -0.0045576509389877234, 0.0151656623765085326, 0.0229157926056221817, -0.0495213509964089194, -0.0090577126970655640, 0.0302096181987065206, 0.0597696222430394788, -0.0030385082500555306,  0.1061499393687249521, 0.0829287925900541179, 0.0047357891108694644, -0.0388432401123416302,  0.0171459078343101923, -0.0026658336814929079, 0.0100625218715885874, 0.0044413893099511425,  0.0029441976336309511, -0.0088145215248827888, 0.0139286378958670617, 0.0829287925900541179,  0.1846128284416309606, 0.0205393151016052163, -0.0565037081699213128, 0.0269114816591800414,  0.0153518788845132485, 0.0220704764103038797, 0.0062539912132161847, 0.0083052144992038814, -0.0112908196409780143, 0.0239739645869568654, 0.0047357891108694471, 0.0205393151016052336,  0.0647839367261213162, -0.0050599702561067517, 0.0179240320455897745, 0.0236659665020361384, -0.0402579180197564224, -0.0003044684020162051, 0.0354351789432449590, 0.0417863787628319563, -0.0045576509389877113, -0.0388432401123417620, -0.0565037081699212296, -0.0050599702561067448,  0.0672219051925454364, -0.0138825854884999707, -0.0062348492923361646, -0.0049855027861619196, -0.0016680874050857978, -0.0012941558306047672, -0.0024417686964614506, 0.0151656623765085066,  0.0171459078343101992, 0.0269114816591800067, 0.0179240320455898092, -0.0138825854884999638,  0.0513652380257036412, 0.0140522856235701758, -0.0290250223724292482, -0.0017910230560133004,  0.0227373130637037249, 0.0328229583980094233, 0.0229157926056221956, -0.0026658336814928802,  0.0153518788845132068, 0.0236659665020361107, -0.0062348492923361828, 0.0140522856235701758,  0.0576647292146984930, -0.0287666929366160937, -0.0037828878626689172, 0.0243758281946999007,  0.0344393477392495873, -0.0495213509964089610, 0.0100625218715885700, 0.0220704764103039214, -0.0402579180197564501, -0.0049855027861618832, -0.0290250223724292308, -0.0287666929366161353,  0.1581845565934768549, 0.0184763901823935123, -0.0718232154534486633, -0.1197582357586476076, -0.0090577126970655605, 0.0044413893099511745, 0.0062539912132161483, -0.0003044684020162137, -0.0016680874050858207, -0.0017910230560133082, -0.0037828878626688933, 0.0184763901823935574,  0.0462288017090857761, -0.0100726097387695279, -0.0214583838696109364, 0.0302096181987065240,  0.0029441976336309428, 0.0083052144992038814, 0.0354351789432449660, -0.0012941558306047750,  0.0227373130637037145, 0.0243758281946998764, -0.0718232154534487049, -0.0100726097387695279,  0.0906246749818859498, 0.0730208200767004795, 0.0597696222430394719, -0.0088145215248828044, -0.0112908196409779449, 0.0417863787628319494, -0.0024417686964614020, 0.0328229583980094788,  0.0344393477392496011, -0.1197582357586473162, -0.0214583838696109329, 0.0730208200767005211,  0.1799473863134831986, 0.0357443279952537746, 0.0187838606012037806, 0.0429387234030273734,  0.0176261251563734032, -0.0152229792294686639, 0.0148675101822077667, 0.0154857440867157276, -0.0214966430470702255, -0.0039883535192434287,
                  0.0167431246471781807, 0.0337369367591755787,  0.0187838606012037737, 0.0778269706904730074, 0.0639727861054083802, 0.0121053309485097474, -0.0209035442074435550, 0.0131764627558757525, 0.0032907472068902498, 0.0069057127808981791,  0.0076793272659196488, 0.0058762489017053672, -0.0084163615552328847, 0.0429387234030273734,  0.0639727861054083802, 0.1722244061171773755, 0.0293641126190522968, -0.0395127891929698549,  0.0264900947059089724, 0.0197471666578530360, 0.0185794862660447618, 0.0111964928886216994,  0.0110525994641521991, -0.0110945105152440472, 0.0176261251563733859, 0.0121053309485097300,  0.0293641126190522864, 0.0539825174130073582, -0.0080821076069339526, 0.0144164251877730402,  0.0162099762684597866, -0.0199932020225936438, 0.0016952407749798119, 0.0225998085838039972,  0.0228788705903524084, -0.0152229792294686569, -0.0209035442074436487, -0.0395127891929697647, -0.0080821076069339179, 0.0527449124104252473, -0.0100701985237535221, -0.0082638667666436356, -0.0004251798846757322, -0.0020504191531696115, -0.0031356275968381113, -0.0044641679468201863,  0.0148675101822077407, 0.0131764627558757993, 0.0264900947059089342, 0.0144164251877730264, -0.0100701985237535048, 0.0434876165023446865, 0.0110795395513434980, -0.0138034733974985030,  0.0003691350455453791, 0.0140917377927293752, 0.0174727983491972869, 0.0154857440867157258,  0.0032907472068902602, 0.0197471666578530151, 0.0162099762684597797, -0.0082638667666436391,  0.0110795395513434893, 0.0475514107479612716, -0.0131897259083799331, -0.0021450981864993427,  0.0137072788441822725, 0.0189682050066888562, -0.0214966430470702741, 0.0069057127808981955,  0.0185794862660447341, -0.0199932020225936577, -0.0004251798846757217, -0.0138034733974984319, -0.0131897259083799366, 0.1022591302306897487, 0.0145265441095187731, -0.0376552774647530009, -0.0696458432188979959, -0.0039883535192434304, 0.0076793272659196887, 0.0111964928886216473,  0.0016952407749798127, -0.0020504191531696301, 0.0003691350455453856, -0.0021450981864993236,  0.0145265441095187818, 0.0431195361999233417, -0.0065732146495725207, -0.0177284828576516028,  0.0167431246471781876, 0.0058762489017053941, 0.0110525994641521956, 0.0225998085838039764, -0.0031356275968381004, 0.0140917377927293752, 0.0137072788441822760, -0.0376552774647530564, -0.0065732146495724843, 0.0650572070005597108, 0.0404232744589142975, 0.0337369367591755370, -0.0084163615552328985, -0.0110945105152440177, 0.0228788705903524223, -0.0044641679468201950,  0.0174727983491973909, 0.0189682050066888423, -0.0696458432188979126, -0.0177284828576515924,  0.0404232744589142906, 0.1274342391849143941, 0.0497400297125233926, 0.0382984275745206701,  0.0801492865809485533, 0.0284247973040912816, -0.0271750958208217541, 0.0229845952308154293,  0.0243625131936422747, -0.0231204015153166839, -0.0021464265410875228, 0.0253945806924136090,  0.0356007329299677516, 0.0382984275745206770, 0.0971274741667843416, 0.1048669943089465678,  0.0261777500289367172, -0.0352139561689320674, 0.0234990129122488664, 0.0158696582501341964, -0.0012096087523571224, 0.0072264499781316792, 0.0214663120851960772, 0.0054235132468679744,  0.0801492865809485810, 0.1048669943089464984, 0.2522832155567822920, 0.0549290399534205290, -0.0664555906246877964, 0.0452552697796260311, 0.0414235253253083038, 0.0106586294503339084,  0.0134554620125994298, 0.0350856437250726752, 0.0052294218705090552, 0.0284247973040912850,  0.0261777500289367103, 0.0549290399534205220, 0.0602558703421073177, -0.0175984463566082432,  0.0212140046791610901, 0.0239267039890196792, -0.0249378870779304006, 0.0012275705119672714,  0.0317326753476671469, 0.0291254991919986800, -0.0271750958208217541, -0.0352139561689321159, -0.0664555906246877548, -0.0175984463566082154, 0.0620988573207224975, -0.0174458529282456865, -0.0166724704574235973, 0.0067889854847903172, -0.0010808825310675151, -0.0151257042295398648, -0.0152582267720093694, 0.0229845952308154119, 0.0234990129122488664, 0.0452552697796260381,  0.0212140046791610797, -0.0174458529282456691, 0.0485393530482083127, 0.0177422974484859018, -0.0214509139884192339, -0.0010710819191225996, 0.0241022236121148752, 0.0269471201462424051,  0.0243625131936422677, 0.0158696582501342276, 0.0414235253253082691, 0.0239267039890196688, -0.0166724704574236077, 0.0177422974484858949, 0.0531406847836403892, -0.0199050104736150021, -0.0023105808603491175, 0.0228326972498529707, 0.0261889344272682109, -0.0231204015153166909, -0.0012096087523571311, 0.0106586294503338806, -0.0249378870779303624, 0.0067889854847903146, -0.0214509139884192131, -0.0199050104736149917, 0.1167504717061011443, 0.0182128523560799449, -0.0522358404560015130, -0.0844543233631050438, -0.0021464265410875271, 0.0072264499781316991,  0.0134554620125994125, 0.0012275705119672818, -0.0010808825310675029, -0.0010710819191226278, -0.0023105808603491131, 0.0182128523560799623, 0.0426833910607821027, -0.0092556409354034100, -0.0212507168754150939, 0.0253945806924135882, 0.0214663120851960737, 0.0350856437250726474,  0.0317326753476671330, -0.0151257042295398700, 0.0241022236121149168, 0.0228326972498529637, -0.0522358404560016101, -0.0092556409354034412, 0.0789966867983174503, 0.0559683730612211827,  0.0356007329299677239, 0.0054235132468679345, 0.0052294218705089997, 0.0291254991919987251, -0.0152582267720093902, 0.0269471201462425231, 0.0261889344272682179, -0.0844543233631051271, -0.0212507168754151286, 0.0559683730612212937, 0.1399643616555109049, 0.0451437418893641043,  0.0326318397410594457, 0.0684000498721793887, 0.0240896939469048450, -0.0227255911547396584,  0.0192546239499636548, 0.0200906714261645733, -0.0223369042272443599, -0.0020985296160529769,  0.0230229495833586678, 0.0332510946699020732, 0.0326318397410594457, 0.0934571242913634082,  0.0942065945909704994, 0.0235071725473032164, -0.0311809299044993639, 0.0188066002376489627,  0.0108028774040850716, -0.0054980982823094968, 0.0077626645285846698, 0.0195400123518532851,  0.0050494496084822101, 0.0684000498721793887, 0.0942065945909704994, 0.2252920638151445498,  0.0482242200516460051, -0.0566107946466561443, 0.0355564125993234961, 0.0312206625408393730,  0.0065742515754418467, 0.0142639800920347712, 0.0313604283975427722, 0.0014717104168424557,  0.0240896939469048554, 0.0235071725473032095, 0.0482242200516459982, 0.0558814428730744286, -0.0149192001132770809, 0.0176230906710198067, 0.0199495695635317737, -0.0203706454557164747,  0.0023709225709005123, 0.0268207443729898652, 0.0233438325469937993, -0.0227255911547396688, -0.0311809299044993639, -0.0566107946466561304, -0.0149192001132770532, 0.0588219393797917017, -0.0132503780415975086, -0.0125795553955866512, 0.0084007337752726036, -0.0016386826503587593, -0.0118970067326525236, -0.0137484822995656078, 0.0192546239499636548, 0.0188066002376489801,  0.0355564125993235308, 0.0176230906710198171, -0.0132503780415974878, 0.0447464136289789302,  0.0137044632099095794, -0.0208691518866550609, -0.0003351876550806579, 0.0197249898334622698,  0.0244653511684393629, 0.0200906714261645768, 0.0108028774040850768, 0.0312206625408393730,  0.0199495695635317737, -0.0125795553955866390, 0.0137044632099095707, 0.0495453973227227909, -0.0163513275789484436,
                  -0.0013668044862034541, 0.0185377409173931584, 0.0214656466387778341, -0.0223369042272443669, -0.0054980982823095350, 0.0065742515754418389, -0.0203706454557164539,  0.0084007337752725845, -0.0208691518866549811, -0.0163513275789484262, 0.1130425580251438189,  0.0159314171185934370, -0.0439592640494345932, -0.0808675176050524525, -0.0020985296160529916,  0.0077626645285846707, 0.0142639800920347521, 0.0023709225709005349, -0.0016386826503587467, -0.0003351876550806853, -0.0013668044862034578, 0.0159314171185934821, 0.0417977343078681993, -0.0062325499870330477, -0.0190691896297905707, 0.0230229495833586678, 0.0195400123518532885,  0.0313604283975427861, 0.0268207443729898722, -0.0118970067326525254, 0.0197249898334623079,  0.0185377409173931515, -0.0439592640494346001, -0.0062325499870331223, 0.0704678776215234143,  0.0463790794522256980, 0.0332510946699020732, 0.0050494496084821632, 0.0014717104168424592,  0.0233438325469938063, -0.0137484822995655852, 0.0244653511684394115, 0.0214656466387778272, -0.0808675176050523969, -0.0190691896297905845, 0.0463790794522257258, 0.1360065608489532951,  0.0546304576605902772, 0.0375990972669060647, 0.0773890196976368822, 0.0275921328714588097, -0.0231151790698990028, 0.0211968910349300023, 0.0219537288345612105, -0.0217424950019131577,  0.0003252094864008436, 0.0246105712160570242, 0.0313300336885899006, 0.0375990972669060577,  0.0991648097254292094, 0.1052716628417586786, 0.0200130654324451353, -0.0297937235232060942,  0.0177773428938630094, 0.0115756097306406267, 0.0137342462633987718, 0.0134734891898095187,  0.0095512012060260977, -0.0117226070704510941, 0.0773890196976368822, 0.1052716628417587202,  0.2493899491700051207, 0.0434510043161501006, -0.0563113301401353059, 0.0334255564219990628,  0.0326705047814391109, 0.0434169425367603445, 0.0257554174328705407, 0.0132122321292613594, -0.0311583171679900954, 0.0275921328714588202, 0.0200130654324451318, 0.0434510043161501075,  0.0558350738692290557, -0.0103828514857253942, 0.0159568382130105026, 0.0190939871428896027, -0.0156906283260182210, 0.0041908609297218596, 0.0244197030172092107, 0.0169980081066557764, -0.0231151790698990098, -0.0297937235232060595, -0.0563113301401352989, -0.0103828514857253855,  0.0566762732768699290, -0.0103466628234912157, -0.0107463874032897293, -0.0061710017887048876, -0.0049964889027750989, -0.0028722597681187880, -0.0007669299453107984, 0.0211968910349300023,  0.0177773428938629886, 0.0334255564219990767, 0.0159568382130105130, -0.0103466628234912001,  0.0452857216521891995, 0.0121307342114292810, -0.0170487487125394362, 0.0004488318131049318,  0.0173737932728488809, 0.0205568527461882401, 0.0219537288345612001, 0.0115756097306406215,  0.0326705047814391109, 0.0190939871428896027, -0.0107463874032897172, 0.0121307342114292775,  0.0493688396915473587, -0.0086172114503176508, 0.0007923897701246776, 0.0149617999056284728,  0.0126993571324633247, -0.0217424950019131612, 0.0137342462633987389, 0.0434169425367603862, -0.0156906283260181967, -0.0061710017887049171, -0.0170487487125393980, -0.0086172114503176300,  0.1282277581213895068, 0.0214068131916759601, -0.0476940878659793746, -0.0878079432145598693,  0.0003252094864008388, 0.0134734891898095101, 0.0257554174328705372, 0.0041908609297218770, -0.0049964889027750755, 0.0004488318131049150, 0.0007923897701246703, 0.0214068131916759843,  0.0453304576095742429, -0.0078075588518525391, -0.0234959873372279048, 0.0246105712160570242,  0.0095512012060260942, 0.0132122321292613802, 0.0244197030172092037, -0.0028722597681187928,  0.0173737932728488982, 0.0149617999056284728, -0.0476940878659793815, -0.0078075588518525599,  0.0720955628644402019, 0.0465315145341253927, 0.0313300336885898936, -0.0117226070704511080, -0.0311583171679900364, 0.0169980081066557764, -0.0007669299453108066, 0.0205568527461882436,  0.0126993571324633178, -0.0878079432145599248, -0.0234959873372279221, 0.0465315145341253927,  0.1396375397445625832, 0.0569367895939884711, 0.0174689402170341290, 0.0382330446149549141,  0.0266378206169947500, -0.0163347273436484225, 0.0224945577728042564, 0.0229520719665545943, -0.0589409742542580176, -0.0099898633893295875, 0.0385909340507015475, 0.0689923382417200054,  0.0174689402170341047, 0.0784903820779159628, 0.0544139600311685095, 0.0064385969297837391, -0.0234419321500171467, 0.0139889956667383734, 0.0019371868565814740, -0.0052275423520415903, -0.0014446138870840462, 0.0100526238561383010, 0.0090274770376521773, 0.0382330446149549349,  0.0544139600311685442, 0.1377988393366177122, 0.0197283417538101045, -0.0401280234301886335,  0.0268183675121233638, 0.0152863241943317751, -0.0060241844226272068, -0.0039067615469152005,  0.0199479984756369307, 0.0206774990194668919, 0.0266378206169947396, 0.0064385969297837365,  0.0197283417538100837, 0.0540927516688727780, -0.0063650788609105049, 0.0136027444098753975,  0.0181984493772286045, -0.0296294849898162023, -0.0014484438038021054, 0.0270160628777588070,  0.0315795256012037576, -0.0163347273436484156, -0.0234419321500171397, -0.0401280234301886335, -0.0063650788609105067, 0.0595474596330574368, -0.0103764752947543143, -0.0079486495078420361,  0.0029892748058380370, 0.0024417626361938429, -0.0043657208720186708, -0.0125312859611460999,  0.0224945577728042495, 0.0139889956667383613, 0.0268183675121233568, 0.0136027444098753801, -0.0103764752947543143, 0.0461707196087741065, 0.0114242775934772535, -0.0201469165562363495, -0.0025436526835248890, 0.0169198340694329506, 0.0252379897436075043, 0.0229520719665545839,  0.0019371868565814865, 0.0152863241943317681, 0.0181984493772286079, -0.0079486495078420431,  0.0114242775934772639, 0.0521509134780148015, -0.0217992590011559413, -0.0034348966761655495,  0.0190429109707159726, 0.0268472586397622663, -0.0589409742542580245, -0.0052275423520416198, -0.0060241844226271947, -0.0296294849898162335, 0.0029892748058380613, -0.0201469165562363356, -0.0217992590011559170, 0.1241984013668689657, 0.0129999632958218963, -0.0514718072573056434, -0.0833352641681031625, -0.0099898633893295910, -0.0014446138870840692, -0.0039067615469151936, -0.0014484438038020902, 0.0024417626361938520, -0.0025436526835248929, -0.0034348966761655504,  0.0129999632958219067, 0.0434664114016911352, -0.0078747661449358498, -0.0163822882492316163,  0.0385909340507015267, 0.0100526238561382958, 0.0199479984756369237, 0.0270160628777587758, -0.0043657208720186778, 0.0169198340694329541, 0.0190429109707159760, -0.0514718072573055949, -0.0078747661449358637, 0.0766323868334336522, 0.0520212793196010923, 0.0689923382417200193,  0.0090274770376521929, 0.0206774990194668676, 0.0315795256012037714, -0.0125312859611460790,  0.0252379897436075182, 0.0268472586397622767, -0.0833352641681032041, -0.0163822882492315990,  0.0520212793196011269, 0.1434278137140076737, 0.0562909939056830122, 0.0196663590513499464,  0.0365332437981971750, 0.0271506882958320352, -0.0168763304829981087, 0.0231124162849584043,  0.0222997108781906629, -0.0583612412946969417, -0.0101530861598573847, 0.0379354565877788596,  0.0707553843576516073, 0.0196663590513499464, 0.1017112119894928168, 0.0795687975430821592,  0.0081953837428163298, -0.0269527730858873070, 0.0175866617942643244, -0.0010941151318956980,
                  0.0065521472484384811, 0.0043731579532861565, 0.0044012358779850014, -0.0101689829586428786,  0.0365332437981971750, 0.0795687975430821592, 0.1872142996140080951, 0.0245391939852342700, -0.0482650899122376645, 0.0283976147986434342, 0.0149623116031402173, 0.0237915888172961498,  0.0047596095615986536, 0.0073906541210240709, -0.0155599710364917546, 0.0271506882958320352,  0.0081953837428163298, 0.0245391939852342700, 0.0658047495978103109, -0.0084975032496015391,  0.0178350797448629701, 0.0245144205406488472, -0.0310658881851061559, 0.0003205423296087423,  0.0314003366563680442, 0.0340264235320264855, -0.0168763304829981087, -0.0269527730858873070, -0.0482650899122376645, -0.0084975032496015391, 0.0671370355301118271, -0.0133459334092883870, -0.0097719986686769303, -0.0004388986167159171, 0.0004188327584560874, -0.0015451742021388309, -0.0071619184719495799, 0.0231124162849584043, 0.0175866617942643244, 0.0283976147986434342,  0.0178350797448629701, -0.0133459334092883870, 0.0568120985881462592, 0.0145558338959935109, -0.0286358621712550845, -0.0028228286439883994, 0.0220799505755982506, 0.0332377340302991986,  0.0222997108781906629, -0.0010941151318956980, 0.0149623116031402173, 0.0245144205406488472, -0.0097719986686769303, 0.0145558338959935109, 0.0638420634464143266, -0.0269300306168051735, -0.0044865282866332181, 0.0236656127244495654, 0.0347592340953502485, -0.0583612412946969417,  0.0065521472484384811, 0.0237915888172961498, -0.0310658881851061559, -0.0004388986167159171, -0.0286358621712550845, -0.0269300306168051735, 0.1578884480830564097, 0.0178936816312022691, -0.0658708421953520251, -0.1135061588811079880, -0.0101530861598573847, 0.0043731579532861565,  0.0047596095615986536, 0.0003205423296087423, 0.0004188327584560874, -0.0028228286439883994, -0.0044865282866332181, 0.0178936816312022691, 0.0501116442373916934, -0.0095945293396901155, -0.0215225790245768822, 0.0379354565877788596, 0.0044012358779850014, 0.0073906541210240709,  0.0314003366563680442, -0.0015451742021388309, 0.0220799505755982506, 0.0236656127244495654, -0.0658708421953520251, -0.0095945293396901155, 0.0912626318996398456, 0.0665733520328917194,  0.0707553843576516073, -0.0101689829586428786, -0.0155599710364917546, 0.0340264235320264855, -0.0071619184719495799, 0.0332377340302991986, 0.0347592340953502485, -0.1135061588811079880, -0.0215225790245768822, 0.0665733520328917194, 0.1822712216538368291 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$n_iter),
               c(12 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$Q),
               c( 0.358020556865647044, 0.259277173053352517, 0.561431827494945024, 0.262678695715435395, -0.111608800820350337,  0.148313568851910438, 0.188390145679481924, -0.059464114894498564, 0.069090794969369901, 0.212797394618069624,  0.053432596110293065, 0.259277173053352517, 1.022218180634146822, 1.663235846535923157, 0.251973417735177507, -0.561194077846880246, 0.280168380200381928, 0.133206617639874125, 0.377351007992750731, 0.152108349530929471,  0.059406211648745461, -0.326753089205042757, 0.561431827494945024, 1.663235846535923157, 2.943349440062594358,  0.414909400161958875, -0.854700683215706691, 0.366496970214028162, 0.233543050172938638, 1.053958669454810870,  0.380261325410562567, -0.078231365026017019, -0.994465343013327563, 0.262678695715435395, 0.251973417735177507,  0.414909400161958875, 0.322843318749494568, -0.187692172879099617, 0.259446100470225538, 0.227966751856685718, -0.507652701336491541, -0.056671890881222847, 0.429488120284109209, 0.537496705144619336, -0.111608800820350337, -0.561194077846880246, -0.854700683215706691, -0.187692172879099617, 0.368451462304787480, -0.230173203879265209, -0.112506030994800776, 0.069178516825374320, -0.009813727189810207, -0.175727919508135905, -0.122728178504065116,  0.148313568851910438, 0.280168380200381928, 0.366496970214028162, 0.259446100470225538, -0.230173203879265209,  0.272970722846386515, 0.179112344318567457, -0.556693576898948495, -0.095571959045730417, 0.412149609311622811,  0.601087569471188798, 0.188390145679481924, 0.133206617639874125, 0.233543050172938638, 0.227966751856685718, -0.112506030994800776, 0.179112344318567457, 0.176676662245769028, -0.391759689168048486, -0.049062060866470310,  0.316700214402321656, 0.414341619870716993, -0.059464114894498564, 0.377351007992750731, 1.053958669454810870, -0.507652701336491541, 0.069178516825374320, -0.556693576898948495, -0.391759689168048486, 2.558747603178308516,  0.589878032665847152, -1.368983686466504146, -2.644646444659957574, 0.069090794969369901, 0.152108349530929471,  0.380261325410562567, -0.056671890881222847, -0.009813727189810207, -0.095571959045730417, -0.049062060866470310,  0.589878032665847152, 0.164899055594413479, -0.273921949705384915, -0.614841324051712657, 0.212797394618069624,  0.059406211648745461, -0.078231365026017019, 0.429488120284109209, -0.175727919508135905, 0.412149609311622811,  0.316700214402321656, -1.368983686466504146, -0.273921949705384915, 0.861064444866115664, 1.427900335394751696,  0.053432596110293065, -0.326753089205042757, -0.994465343013327563, 0.537496705144619336, -0.122728178504065116,  0.601087569471188798, 0.414341619870716993, -2.644646444659957574, -0.614841324051712657, 1.427900335394751696,  2.761453393666073008 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$method),
               c("EKF" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$model),
               c("exponential" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$LR),
               c(0.05852766346593507 )
               , tolerance = 1e-05)
})

test_that("Unmacthed control variable throw error",
          expect_error({
            result = ddhazard(
              formula = survival::Surv(start, stop, event) ~ group,
              data = head_neck_cancer,
              by = 1, # Use by month intervals
              a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
              max_T = 45,
              id = head_neck_cancer$id, order = 1,
              control = list("None_existing_parem" = 1)
            )}, regexp = "These control parameters are not recognized"))

test_that("Using alternated inverse covariance matrix in EKF with exponential model yields previously computed values", {
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(10, 11),
    Q = diag(1e-2, 11),
    control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^3,
                   EKF_inv_Cov_method = "not org"),
    max_T = 10,
    id = sims$res$id, order = 1,
    verbose = F,
    model = "exponential"))

  # get_expect_equal(result_exp, eps = 1e-5, file = "tmp.txt")
  # matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
  # matplot(result_exp$times, result_exp$state_vecs, result_exp$state_vecs, type = "l", lty = 2, add = T)

  expect_equal(c(result_exp$state_vecs),
               c(-5.37491499453456711, -5.37838561956256189, -4.82120214005348124, -4.57774126114250723, -4.37250249850003758, -4.36263736954901749, -4.37576778478690009, -4.30796374816606686, -3.96478025282279178, -4.05884163933298581, -4.06139385848421863, 0.62136248372161029, 0.62493458521790513, 0.74299025525156615, -0.39825497767733964, -1.45633073143722536, -2.22559221312591493, -2.06822623767243163, -2.23007683229433917, -1.61701543132215342, -1.53649477936356083, -1.05616071482902862, -1.97749961606802049, -1.97881595587375569, -0.57669067545861985, -2.44822473362939075, -4.13040023170904291, -5.51716864433489995, -4.95402996774829329, -4.95447727752580747, -2.85942847533379929, -3.08189629183477276, -2.23547613479184593, 1.00606836485592921, 1.00849103278899666,  0.75210260342984592, 0.52387510804844872, 0.31800579639583876, 0.19955092367601179, 0.18928931604373625,  0.08735798545854222, -0.04791068228869577, 0.08318004669572661, 0.20389970557152162, 1.54727598954221035,  1.54470660503176260, 1.63482883510482080, 2.28203085502065584, 2.87229618106439766, 3.24987579696851236,  3.13222630689859072, 3.22218833251401549, 2.98440816190581604, 2.93712750847187554, 2.71757049535431960,  0.59058706612362832, 0.59567850250647014, -0.17273648191381219, -0.35954944340969364, -0.54176236481989193, -0.56444649712038220, -0.68368263961922482, -0.86762310541703425, -1.45613685779407054, -1.22641122282940129, -1.16940644097553026, -0.28072525083253491, -0.27944565496356610, -0.45802462223737783, -0.52684459252313376, -0.58014174739532576, -0.59861885567120932, -0.60309878583613863, -0.64693742798975917, -0.78143413541395512, -0.71396365104266191, -0.67560957514061215, 0.79000280334054462, 0.77728444342701419, 3.37211417702639249,  2.74282635801478003, 2.22770624639737225, 1.47810731419400221, 2.09981672313806778, 2.50088432044739539,  5.10103955217750560, 4.44271150512847957, 4.76700198785209395, 1.60243169246471040, 1.60044167530069581,  2.06637056127744057, 1.91842821228627214, 1.79095011951254390, 1.62022624217503308, 1.71565560527511840,  1.75045295235447540, 2.22247147093365394, 2.14085607244094867, 2.23424197427617077, 1.95984215314049925,  1.96869661532479379, 0.44792822962526402, 0.47222385663508121, 0.46641360407964061, 0.67810386562519609,  0.34856655477029530, 0.04460437790988175, -1.34395601438959700, -0.90551110507820032, -0.89425338157076428, -3.37953113305516251, -3.36866884948570311, -5.63146480649819470, -5.10169842348046476, -4.65192237475799164, -3.97254029809158205, -4.47722333050160959, -4.80247779250813167, -7.04845819725316147, -6.51649582508983016, -6.83522567448175256 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$state_vars),
               c( 1.685901075026752e-01, -1.070897760618673e-01, -3.096885226292929e-02, -5.372608171222829e-02,  7.979358310940199e-02, -1.052626824792337e-01, -2.397106648280096e-02, 1.908216832079230e-01,  2.386001664806245e-02, -1.658557147727988e-01, -1.468423540042886e-01, -1.070897760618673e-01,  7.844097705192272e-01, 1.004684839983574e+00, 1.454836518920367e-01, -3.522779569953190e-01,  1.342475149889229e-01, 4.431982326283665e-02, 2.578848485834337e-01, 8.484287847779956e-02,  5.123261640441776e-02, -2.393766247234175e-01, -3.096885226292926e-02, 1.004684839983574e+00,  2.072643731309848e+00, 1.456268288764662e-01, -5.232919952498224e-01, -1.288318797103063e-02,  2.849564824246953e-02, 1.144318904519704e+00, 2.424522842144922e-01, -3.713408427398605e-01, -9.812517375898829e-01, -5.372608171222829e-02, 1.454836518920368e-01, 1.456268288764662e-01,  1.696992320892381e-01, -7.849290648742006e-02, 8.819559813567263e-02, 3.403672747253363e-02, -1.157008258792878e-01, -9.250868836579741e-04, 1.292320715287860e-01, 8.881982438425001e-02,  7.979358310940206e-02, -3.522779569953190e-01, -5.232919952498225e-01, -7.849290648742011e-02,  3.338812234088540e-01, -8.747723842289300e-02, -3.369571099278635e-02, -9.589811561618734e-02, -3.258675345141932e-02, -4.186074846865413e-02, 7.603913700119790e-02, -1.052626824792337e-01,  1.342475149889228e-01, -1.288318797103061e-02, 8.819559813567263e-02, -8.747723842289302e-02,  2.788929347846167e-01, 4.741320576347153e-02, -4.006223724554726e-01, -5.218634728136070e-02,  2.894526357013904e-01, 3.367817704749629e-01, -2.397106648280097e-02, 4.431982326283664e-02,  2.849564824246955e-02, 3.403672747253363e-02, -3.369571099278632e-02, 4.741320576347154e-02,  1.282843499377613e-01, -8.260102188306576e-02, -9.543496908737308e-03, 6.956442930851590e-02,  7.280182634376008e-02, 1.908216832079231e-01, 2.578848485834336e-01, 1.144318904519704e+00, -1.157008258792878e-01, -9.589811561618722e-02, -4.006223724554724e-01, -8.260102188306576e-02,  1.734724108756547e+00, 2.721705015041420e-01, -8.914575824320063e-01, -1.356060016365836e+00,  2.386001664806244e-02, 8.484287847779946e-02, 2.424522842144921e-01, -9.250868836579561e-04, -3.258675345141933e-02, -5.218634728136073e-02, -9.543496908737287e-03, 2.721705015041420e-01,  1.804548238238315e-01, -1.403476694854059e-01, -2.403608596725863e-01, -1.658557147727988e-01,  5.123261640441755e-02, -3.713408427398603e-01, 1.292320715287860e-01, -4.186074846865408e-02,  2.894526357013904e-01, 6.956442930851583e-02, -8.914575824320066e-01, -1.403476694854061e-01,  6.889558392869706e-01, 7.433871846784467e-01, -1.468423540042886e-01, -2.393766247234175e-01, -9.812517375898828e-01, 8.881982438425011e-02, 7.603913700119806e-02, 3.367817704749629e-01,  7.280182634376009e-02, -1.356060016365836e+00, -2.403608596725864e-01, 7.433871846784467e-01,  1.338017294545901e+00, 9.690191945344850e-02, -4.583123740922494e-02, -1.197520394034390e-02, -2.227966864888903e-02, 2.915855870452427e-02, -3.912628012313843e-02, -6.213425953422821e-03,  4.816484172684374e-02, -2.299851312471235e-03, -6.212556731535446e-02, -1.842055221818883e-02, -4.583123740922494e-02, 4.884720350876424e-01, 5.562224096845618e-01, 8.290904954469970e-02, -1.926799792939866e-01, 7.532561596918545e-02, 2.467855815757088e-02, 1.406489148755807e-01,  5.316591543148933e-02, 3.278973877083900e-02, -1.372109692602434e-01, -1.197520394034385e-02,  5.562224096845619e-01, 1.177910946603299e+00, 8.936926289144657e-02, -2.911353779129118e-01,  1.333786887269189e-02, 2.339787232337603e-02, 5.806833259255153e-01, 1.285992259075608e-01, -1.718886475684160e-01, -4.975560630409994e-01, -2.227966864888903e-02, 8.290904954469971e-02,  8.936926289144657e-02, 1.363828192564465e-01, -3.998394548603386e-02, 4.708594890171072e-02,  2.120949780300203e-02, -5.245136767415751e-02, 6.122526644713147e-03, 6.923641129295180e-02,  3.587375607215007e-02, 2.915855870452433e-02, -1.926799792939866e-01, -2.911353779129119e-01, -3.998394548603391e-02, 2.316694853185419e-01, -4.209180433459969e-02, -1.922177441513148e-02, -6.873461472828646e-02, -2.352230969743023e-02, -1.058191004755765e-02, 5.566160955777328e-02, -3.912628012313839e-02, 7.532561596918548e-02, 1.333786887269192e-02, 4.708594890171075e-02, -4.209180433459969e-02, 1.832110838077972e-01, 2.485341741553613e-02, -1.798736353376979e-01, -1.648966357896878e-02, 1.374896099958066e-01, 1.473114258235336e-01, -6.213425953422821e-03,  2.467855815757085e-02, 2.339787232337606e-02, 2.120949780300203e-02, -1.922177441513144e-02,  2.485341741553614e-02, 1.141690676359568e-01, -3.325728867430938e-02, -2.014409109851747e-03,  3.234186448445747e-02, 3.023600737220884e-02, 4.816484172684385e-02, 1.406489148755807e-01,  5.806833259255155e-01, -5.245136767415751e-02, -6.873461472828629e-02, -1.798736353376978e-01, -3.325728867430940e-02, 8.915465251937515e-01, 1.228825757620731e-01, -4.216772385746402e-01, -6.387994758423348e-01, -2.299851312471235e-03, 5.316591543148928e-02, 1.285992259075606e-01,  6.122526644713161e-03, -2.352230969743023e-02, -1.648966357896882e-02, -2.014409109851734e-03,  1.228825757620733e-01, 1.444988371628115e-01, -6.056937951377378e-02, -1.104460499655087e-01, -6.212556731535451e-02, 3.278973877083875e-02, -1.718886475684158e-01, 6.923641129295181e-02, -1.058191004755758e-02, 1.374896099958066e-01, 3.234186448445742e-02, -4.216772385746405e-01, -6.056937951377389e-02, 3.884985073741318e-01, 3.420715684605565e-01, -1.842055221818895e-02, -1.372109692602435e-01, -4.975560630409992e-01, 3.587375607215014e-02, 5.566160955777343e-02,  1.473114258235335e-01, 3.023600737220887e-02, -6.387994758423348e-01, -1.104460499655087e-01,  3.420715684605564e-01, 7.116123272812724e-01, 9.023915367818508e-02, -3.627129709324349e-02,  1.225627587149147e-02, -2.164602391429679e-02, 2.377927469567089e-02, -4.256382299351980e-02, -5.922028084789380e-03, 7.053633038050786e-02, 1.550170418629843e-03, -7.225709209592024e-02, -3.788513649099234e-02, -3.627129709324346e-02, 3.966556874784861e-01, 4.358737548053662e-01,  6.135203923759994e-02, -1.521016092070644e-01, 5.512144172985689e-02, 1.755976322015259e-02,  1.201531154952952e-01, 4.245084210753531e-02, 1.787280746620745e-02, -1.115251741142906e-01,  1.225627587149136e-02, 4.358737548053662e-01, 9.885958991508905e-01, 5.793445928355281e-02, -2.272481061190689e-01, -1.431986657399739e-02, 1.090844522922277e-02, 5.445180364466223e-01,  1.141707504729593e-01, -1.897862434214138e-01, -4.594447077059274e-01, -2.164602391429675e-02,  6.135203923759991e-02, 5.793445928355276e-02, 1.217249961540223e-01, -3.085990481192290e-02,  4.124578449173176e-02, 1.762342083761274e-02, -5.712334476181165e-02, 2.156825717184761e-03,  6.270857902186716e-02, 4.316544391657860e-02, 2.377927469567086e-02, -1.521016092070644e-01, -2.272481061190688e-01, -3.085990481192292e-02, 2.041417032902351e-01, -3.545622333885899e-02, -1.602522051677136e-02, -4.716870873103646e-02, -1.690285756858569e-02, -1.151829084878083e-02,  3.444863127307192e-02, -4.256382299351974e-02, 5.512144172985694e-02, -1.431986657399729e-02,  4.124578449173175e-02, -3.545622333885903e-02, 1.724531985880584e-01, 2.313013108162026e-02, -1.867286893709721e-01, -2.059335679168446e-02, 1.339056038457407e-01,
                  1.573236310566851e-01, -5.922028084789387e-03, 1.755976322015257e-02, 1.090844522922281e-02, 1.762342083761276e-02, -1.602522051677133e-02, 2.313013108162026e-02, 1.057752300046884e-01, -3.658124308890400e-02, -3.603183420223838e-03, 3.067618730227845e-02, 3.406021259133293e-02, 7.053633038050787e-02,  1.201531154952951e-01, 5.445180364466226e-01, -5.712334476181161e-02, -4.716870873103633e-02, -1.867286893709721e-01, -3.658124308890400e-02, 8.799881838100678e-01, 1.231666294547683e-01, -4.215880030201155e-01, -6.404771223220270e-01, 1.550170418629787e-03, 4.245084210753527e-02,  1.141707504729592e-01, 2.156825717184768e-03, -1.690285756858569e-02, -2.059335679168448e-02, -3.603183420223824e-03, 1.231666294547684e-01, 1.363927983270632e-01, -6.392595378476607e-02, -1.104754818040109e-01, -7.225709209592021e-02, 1.787280746620733e-02, -1.897862434214136e-01,  6.270857902186716e-02, -1.151829084878078e-02, 1.339056038457407e-01, 3.067618730227840e-02, -4.215880030201155e-01, -6.392595378476618e-02, 3.718312051175547e-01, 3.488305590648131e-01, -3.788513649099234e-02, -1.115251741142907e-01, -4.594447077059273e-01, 4.316544391657862e-02,  3.444863127307207e-02, 1.573236310566850e-01, 3.406021259133293e-02, -6.404771223220271e-01, -1.104754818040109e-01, 3.488305590648130e-01, 7.088176969835316e-01, 6.284488190864063e-02, -4.346028066257978e-02, -4.958521587454019e-02, -1.040683384812420e-02, 1.872177048541566e-02, -9.019771005222558e-03, 3.106493988726602e-03, -3.748224015312074e-02, -1.745692827497511e-02, -8.576658440203722e-03, 5.663422223084877e-02, -4.346028066257979e-02, 2.405019095789133e-01,  1.705147996569965e-01, 3.474526591672408e-02, -7.446057853758492e-02, 4.375803620898468e-02,  1.002440046387483e-02, -6.592179911688135e-03, 1.048618405571969e-02, 4.540803556443695e-02, -1.719696151469621e-03, -4.958521587454018e-02, 1.705147996569965e-01, 3.710682336946131e-01,  3.989723568079527e-02, -9.799265081611760e-02, 4.938867595039753e-02, 1.516599867996928e-02,  5.422721159423164e-02, 1.441396534424246e-02, 1.880462571912284e-02, -4.277513412958124e-02, -1.040683384812419e-02, 3.474526591672408e-02, 3.989723568079528e-02, 1.011380148144388e-01, -1.468922507563955e-02, 1.918772635357807e-02, 9.966117621068213e-03, -1.869954580901882e-02,  5.575769582164039e-03, 2.839228677223379e-02, 1.193448138348496e-02, 1.872177048541564e-02, -7.446057853758495e-02, -9.799265081611752e-02, -1.468922507563956e-02, 1.530007479406484e-01, -2.209687106619714e-02, -9.740210220810064e-03, -1.396711552442746e-03, -4.624433402535402e-03, -1.477867059695759e-02, -3.043595451545849e-03, -9.019771005222534e-03, 4.375803620898472e-02,  4.938867595039752e-02, 1.918772635357805e-02, -2.209687106619715e-02, 1.118326712704898e-01,  9.541422291274779e-03, -3.028979395094942e-02, 4.292569311585663e-03, 3.440739120073311e-02,  2.555311218089385e-02, 3.106493988726595e-03, 1.002440046387481e-02, 1.516599867996929e-02,  9.966117621068216e-03, -9.740210220810040e-03, 9.541422291274793e-03, 9.481053471821954e-02, -3.994526852966994e-03, 1.158084838159136e-03, 7.237569230068040e-03, 6.410162920769173e-03, -3.748224015312071e-02, -6.592179911688135e-03, 5.422721159423174e-02, -1.869954580901879e-02, -1.396711552442659e-03, -3.028979395094949e-02, -3.994526852967011e-03, 2.444365821399023e-01,  9.980804857206392e-03, -7.882738572197349e-02, -1.089826582324918e-01, -1.745692827497512e-02,  1.048618405571964e-02, 1.441396534424245e-02, 5.575769582164028e-03, -4.624433402535398e-03,  4.292569311585649e-03, 1.158084838159136e-03, 9.980804857206441e-03, 1.079119015534790e-01, -5.636172487602529e-03, -1.371757942220821e-02, -8.576658440203749e-03, 4.540803556443693e-02,  1.880462571912284e-02, 2.839228677223379e-02, -1.477867059695756e-02, 3.440739120073318e-02,  7.237569230068023e-03, -7.882738572197338e-02, -5.636172487602594e-03, 1.620470079363034e-01,  6.104037893981269e-02, 5.663422223084880e-02, -1.719696151469680e-03, -4.277513412958113e-02,  1.193448138348496e-02, -3.043595451545748e-03, 2.555311218089375e-02, 6.410162920769184e-03, -1.089826582324918e-01, -1.371757942220823e-02, 6.104037893981271e-02, 2.508068100394863e-01,  5.086478825882694e-02, -1.437615545880939e-02, -2.300326692847278e-03, -3.402063458148292e-03, -1.355300819270551e-03, -2.650444763573521e-03, 4.802191089902208e-03, -2.248100905697147e-02, -1.274300321540488e-02, -6.662852050356001e-03, 4.637303845994811e-02, -1.437615545880937e-02,  2.179132558964162e-01, 1.911219202326146e-01, 2.315223807540719e-02, -6.341066793286605e-02,  1.323690172605644e-02, 4.695216570335713e-03, 6.453367453362580e-02, 2.198951782082502e-02, -2.505580585372902e-03, -6.484186112220791e-02, -2.300326692847278e-03, 1.911219202326146e-01,  4.785778550893807e-01, 2.974558234305861e-02, -1.072680432057470e-01, 4.605460132691624e-03,  6.010646987408712e-03, 2.017892847998093e-01, 4.440215610707591e-02, -6.311074842739788e-02, -1.746780893009750e-01, -3.402063458148287e-03, 2.315223807540718e-02, 2.974558234305861e-02,  8.998143079995224e-02, -7.472001767747184e-03, 1.132490382732963e-02, 7.347065234801266e-03, -7.776784980322526e-03, 5.562693458021429e-03, 1.657333550942141e-02, 2.795572771253824e-03, -1.355300819270554e-03, -6.341066793286611e-02, -1.072680432057469e-01, -7.472001767747191e-03,  1.383886926517321e-01, -3.085409099260106e-03, -6.157014220843624e-03, -4.306739831373707e-02, -1.172325667837122e-02, 1.328208793887380e-02, 3.601985130228216e-02, -2.650444763573508e-03,  1.323690172605649e-02, 4.605460132691579e-03, 1.132490382732961e-02, -3.085409099260125e-03,  9.943086604647350e-02, 7.978485045359135e-03, -3.889665989638745e-02, -7.458248967881047e-04,  2.905738108601006e-02, 3.276727276149460e-02, 4.802191089902208e-03, 4.695216570335704e-03,  6.010646987408715e-03, 7.347065234801269e-03, -6.157014220843610e-03, 7.978485045359158e-03,  8.875188793680472e-02, -5.568004041340193e-03, 6.626579863793294e-05, 5.413304955916355e-03,  7.610054710372859e-03, -2.248100905697147e-02, 6.453367453362577e-02, 2.017892847998093e-01, -7.776784980322507e-03, -4.306739831373698e-02, -3.889665989638755e-02, -5.568004041340205e-03,  3.289457901727370e-01, 3.534010174370142e-02, -1.062979114837182e-01, -1.893127178943667e-01, -1.274300321540488e-02, 2.198951782082497e-02, 4.440215610707596e-02, 5.562693458021416e-03, -1.172325667837121e-02, -7.458248967881324e-04, 6.626579863793641e-05, 3.534010174370143e-02,  1.077708996114889e-01, -1.656136220223262e-02, -3.547394264640374e-02, -6.662852050356036e-03, -2.505580585372895e-03, -6.311074842739786e-02, 1.657333550942144e-02, 1.328208793887381e-02,  2.905738108601014e-02, 5.413304955916333e-03, -1.062979114837180e-01, -1.656136220223271e-02,  1.542737672233780e-01, 8.628986298142829e-02, 4.637303845994808e-02, -6.484186112220805e-02, -1.746780893009749e-01, 2.795572771253831e-03, 3.601985130228229e-02, 3.276727276149451e-02,  7.610054710372866e-03, -1.893127178943668e-01, -3.547394264640375e-02, 8.628986298142824e-02,  3.147064343337095e-01, 4.547779196864692e-02, 1.008266630767820e-02, 3.430682683042556e-02, -1.753194380871332e-03, -1.413315169959449e-02, -3.034244790183944e-04, 4.990270864346584e-03, -6.763366060044931e-03, -8.176754725460141e-03,
                  -9.241884399160041e-03, 3.363821885462505e-02,  1.008266630767823e-02, 1.615801216705255e-01, 1.350043159073474e-01, 1.535438840490314e-02, -3.413659614083737e-02, 9.068910806383302e-04, 6.056229108982805e-04, 6.011762951755725e-02,  2.088425950846293e-02, -1.658058183748023e-02, -6.226931101169472e-02, 3.430682683042557e-02,  1.350043159073473e-01, 4.060505321096562e-01, 2.121913357079791e-02, -7.149838104549260e-02, -6.113897216784643e-04, -7.953409310319185e-05, 1.735944579102276e-01, 4.319283759732996e-02, -6.928639389670876e-02, -1.539625133293840e-01, -1.753194380871329e-03, 1.535438840490315e-02,  2.121913357079792e-02, 8.439711159640470e-02, -4.878160582752701e-03, 1.032191049777292e-02,  6.416482973251969e-03, -9.784356223219125e-03, 3.669010345864823e-03, 1.486193931994331e-02,  5.468462072421288e-03, -1.413315169959450e-02, -3.413659614083745e-02, -7.149838104549254e-02, -4.878160582752686e-03, 1.177218932807444e-01, 1.624248150614111e-03, -4.589659409489755e-03, -3.173609833274622e-02, -9.593052818820651e-03, 1.492968040637786e-02, 2.808372028647985e-02, -3.034244790184051e-04, 9.068910806383874e-04, -6.113897216785246e-04, 1.032191049777292e-02,  1.624248150614073e-03, 8.853179343434250e-02, 7.425303384412418e-03, -2.562296775818041e-02, -9.410177329120563e-04, 1.941983137371869e-02, 2.205306561910651e-02, 4.990270864346580e-03,  6.056229108982771e-04, -7.953409310318318e-05, 6.416482973251975e-03, -4.589659409489749e-03,  7.425303384412442e-03, 8.398860358180357e-02, -7.041010423633897e-03, -8.345532045147038e-04,  4.664613948771211e-03, 9.005798961866547e-03, -6.763366060044997e-03, 6.011762951755722e-02,  1.735944579102276e-01, -9.784356223219083e-03, -3.173609833274617e-02, -2.562296775818041e-02, -7.041010423633910e-03, 2.738012449789924e-01, 3.383416088765002e-02, -8.371868408126254e-02, -1.495632056543593e-01, -8.176754725460127e-03, 2.088425950846289e-02, 4.319283759733000e-02,  3.669010345864808e-03, -9.593052818820644e-03, -9.410177329120840e-04, -8.345532045146969e-04,  3.383416088765005e-02, 1.037917092406473e-01, -1.738067226977359e-02, -3.450485968126255e-02, -9.241884399160072e-03, -1.658058183748016e-02, -6.928639389670885e-02, 1.486193931994335e-02,  1.492968040637783e-02, 1.941983137371879e-02, 4.664613948771202e-03, -8.371868408126248e-02, -1.738067226977365e-02, 1.345174673820434e-01, 6.947301898952658e-02, 3.363821885462501e-02, -6.226931101169479e-02, -1.539625133293839e-01, 5.468462072421321e-03, 2.808372028647993e-02,  2.205306561910647e-02, 9.005798961866547e-03, -1.495632056543594e-01, -3.450485968126253e-02,  6.947301898952660e-02, 2.777012374046995e-01, 4.555956729160522e-02, 1.895516400118608e-02,  5.625934866396406e-02, -8.359636590631841e-04, -1.850716469985116e-02, -2.677672111993481e-03,  3.124564529103667e-03, 9.596264067002980e-03, -4.227041442935562e-03, -2.040626586407272e-02,  1.622127748024907e-02, 1.895516400118608e-02, 1.435005881927894e-01, 1.030703323640214e-01,  1.416503964085328e-02, -2.902687735647931e-02, 2.280916333912313e-03, 4.036146214537135e-03,  3.060947587792805e-02, 1.376394848307518e-02, 7.346530022958511e-04, -2.652147826348760e-02,  5.625934866396401e-02, 1.030703323640215e-01, 3.460855235853132e-01, 1.752589272433902e-02, -5.703630335593512e-02, -3.780313743740447e-03, 2.832821316110391e-04, 1.336906062198319e-01,  3.508896676297782e-02, -5.530141816413602e-02, -1.055353576257707e-01, -8.359636590631841e-04,  1.416503964085328e-02, 1.752589272433899e-02, 7.965672420824056e-02, -5.512003281350856e-03,  1.024742560699880e-02, 7.099713691077669e-03, -1.222264854374552e-02, 1.854908617283320e-03,  1.770399374774033e-02, 1.080905629168226e-02, -1.850716469985115e-02, -2.902687735647933e-02, -5.703630335593502e-02, -5.512003281350854e-03, 1.135415153108286e-01, -4.058637205292916e-04, -7.039364635175938e-03, -1.466566191778554e-02, -5.702924146615891e-03, 2.278717171180726e-03,  7.964353471919068e-03, -2.677672111993487e-03, 2.280916333912326e-03, -3.780313743740552e-03,  1.024742560699881e-02, -4.058637205293025e-04, 8.907819859838474e-02, 9.992192171770756e-03, -3.339917844852685e-02, -3.720662008459879e-03, 2.946710101315868e-02, 3.217198703133761e-02,  3.124564529103663e-03, 4.036146214537126e-03, 2.832821316110425e-04, 7.099713691077673e-03, -7.039364635175928e-03, 9.992192171770782e-03, 8.214797817783824e-02, -1.269797686137365e-02, -1.881580881368437e-03, 9.795884131100340e-03, 1.481628588139815e-02, 9.596264067002966e-03,  3.060947587792800e-02, 1.336906062198318e-01, -1.222264854374551e-02, -1.466566191778548e-02, -3.339917844852684e-02, -1.269797686137367e-02, 2.526697437317296e-01, 3.197409267414156e-02, -9.302650347809790e-02, -1.329605048044912e-01, -4.227041442935566e-03, 1.376394848307516e-02,  3.508896676297786e-02, 1.854908617283311e-03, -5.702924146615884e-03, -3.720662008459883e-03, -1.881580881368434e-03, 3.197409267414155e-02, 1.003534760077043e-01, -2.050035681792485e-02, -3.220588466903609e-02, -2.040626586407273e-02, 7.346530022958511e-04, -5.530141816413624e-02,  1.770399374774036e-02, 2.278717171180728e-03, 2.946710101315875e-02, 9.795884131100328e-03, -9.302650347809775e-02, -2.050035681792493e-02, 1.496654217393636e-01, 8.071425368086978e-02,  1.622127748024903e-02, -2.652147826348766e-02, -1.055353576257707e-01, 1.080905629168229e-02,  7.964353471919114e-03, 3.217198703133761e-02, 1.481628588139813e-02, -1.329605048044910e-01, -3.220588466903610e-02, 8.071425368086980e-02, 2.590781816684786e-01, 4.621980915850431e-02,  1.482727833806387e-02, 4.530908100310799e-02, -8.092742277761092e-04, -1.591098653765263e-02, -2.139184153848446e-04, 3.783199673691402e-03, 8.252270523331773e-04, -7.097376465901008e-03, -1.220070347636039e-02, 2.498781313144967e-02, 1.482727833806386e-02, 1.538794491986182e-01,  1.218753556400776e-01, 1.840513954506590e-02, -3.529482893916241e-02, -1.954498736526196e-03,  3.837000259261433e-03, 3.445675980933324e-02, 1.791835336934562e-02, -1.960896883188242e-03, -3.845568482906991e-02, 4.530908100310799e-02, 1.218753556400776e-01, 3.698321980489345e-01,  2.711411178725595e-02, -6.566231446541480e-02, -9.465209821436069e-03, -4.821153388783958e-05,  1.406965319289329e-01, 4.016228669210127e-02, -5.143408209274919e-02, -1.253401083782470e-01, -8.092742277761135e-04, 1.840513954506590e-02, 2.711411178725592e-02, 7.772864582615793e-02, -8.692401982816180e-03, 8.040515627902997e-03, 6.278563459027012e-03, -4.767636590945057e-03,  4.102454008032377e-03, 1.184022724709655e-02, 3.087659701359145e-03, -1.591098653765261e-02, -3.529482893916244e-02, -6.566231446541473e-02, -8.692401982816175e-03, 1.159796159796281e-01,  1.156784846848341e-03, -6.886306741842667e-03, -1.365554939783357e-02, -7.784230153185946e-03,  2.525784821832889e-03, 1.232176553662346e-02, -2.139184153848489e-04, -1.954498736526197e-03, -9.465209821436109e-03, 8.040515627902999e-03, 1.156784846848338e-03, 8.618507411006718e-02,  8.613363637181482e-03, -3.751704240595290e-02, -2.921438717550642e-03, 2.430097085319246e-02,  3.423456489071743e-02, 3.783199673691401e-03, 3.837000259261422e-03, -4.821153388784218e-05,  6.278563459027013e-03, -6.886306741842654e-03, 8.613363637181501e-03, 8.019279682170360e-02, -1.109945282748732e-02,
                  -9.106909087092559e-04, 7.148070785490689e-03, 1.297698943133808e-02,  8.252270523331478e-04, 3.445675980933320e-02, 1.406965319289328e-01, -4.767636590945053e-03, -1.365554939783354e-02, -3.751704240595294e-02, -1.109945282748733e-02, 2.646312968589406e-01,  3.167106791070420e-02, -8.252682202562503e-02, -1.474172338412466e-01, -7.097376465901009e-03,  1.791835336934561e-02, 4.016228669210130e-02, 4.102454008032367e-03, -7.784230153185941e-03, -2.921438717550653e-03, -9.106909087092567e-04, 3.167106791070422e-02, 9.890238353083725e-02, -1.622899605738831e-02, -3.282722209073995e-02, -1.220070347636044e-02, -1.960896883188254e-03, -5.143408209274930e-02, 1.184022724709657e-02, 2.525784821832905e-03, 2.430097085319250e-02,  7.148070785490679e-03, -8.252682202562490e-02, -1.622899605738836e-02, 1.300012714900114e-01,  7.152555659065553e-02, 2.498781313144967e-02, -3.845568482906998e-02, -1.253401083782470e-01,  3.087659701359153e-03, 1.232176553662351e-02, 3.423456489071742e-02, 1.297698943133807e-02, -1.474172338412465e-01, -3.282722209073995e-02, 7.152555659065553e-02, 2.742651577415615e-01,  4.824086150194780e-02, 1.851135177309875e-02, 4.919445282763738e-02, 2.026343608529330e-03, -1.931904551997846e-02, 9.567961972648418e-04, 5.586295194090445e-03, -6.021924335562422e-03, -6.508053299023071e-03, -8.460044324054087e-03, 2.958283058369288e-02, 1.851135177309876e-02,  1.530211774429552e-01, 1.306503444528651e-01, 8.565386817628735e-03, -3.294697107164529e-02, -6.983941246038889e-03, 4.541889871427866e-03, 6.651219774041864e-02, 2.240812507035436e-02, -2.168119876121058e-02, -5.841534261623262e-02, 4.919445282763746e-02, 1.306503444528650e-01,  4.009968270422022e-01, 1.546755692650689e-02, -6.987140501986530e-02, -1.712986944456319e-02,  5.208914493073358e-03, 2.031835751339987e-01, 5.286393340247356e-02, -8.726529675140678e-02, -1.630731587972041e-01, 2.026343608529316e-03, 8.565386817628732e-03, 1.546755692650689e-02,  7.221806174111212e-02, -2.956625824138957e-03, 3.964969155321290e-03, 4.455517277886846e-03,  1.962730076385800e-03, 4.143781052237766e-03, 5.156052977788983e-03, -1.968318796819364e-03, -1.931904551997846e-02, -3.294697107164530e-02, -6.987140501986536e-02, -2.956625824138952e-03,  1.128862842732083e-01, 5.834439526125107e-03, -6.122318664896888e-03, -3.676804281683675e-02, -1.114271849306042e-02, 1.674509039579066e-02, 2.803535965627334e-02, 9.567961972648431e-04, -6.983941246038875e-03, -1.712986944456315e-02, 3.964969155321289e-03, 5.834439526125094e-03,  8.503433081649769e-02, 5.123921436402184e-03, -3.532575850175484e-02, -4.945370927768528e-03,  2.195756829848736e-02, 3.209350408514255e-02, 5.586295194090444e-03, 4.541889871427857e-03,  5.208914493073378e-03, 4.455517277886845e-03, -6.122318664896884e-03, 5.123921436402191e-03,  7.861785808925978e-02, 1.250641839785160e-03, 1.037969409675231e-03, 1.075848447909490e-04,  2.221353785030102e-03, -6.021924335562440e-03, 6.651219774041860e-02, 2.031835751339988e-01,  1.962730076385770e-03, -3.676804281683670e-02, -3.532575850175487e-02, 1.250641839785148e-03,  3.018194082508843e-01, 4.454252039582007e-02, -9.613563827741606e-02, -1.662603645558211e-01, -6.508053299023061e-03, 2.240812507035436e-02, 5.286393340247352e-02, 4.143781052237760e-03, -1.114271849306042e-02, -4.945370927768534e-03, 1.037969409675228e-03, 4.454252039582009e-02,  1.021864924449853e-01, -2.303064630620258e-02, -4.158291262103771e-02, -8.460044324054143e-03, -2.168119876121056e-02, -8.726529675140686e-02, 5.156052977788996e-03, 1.674509039579065e-02,  2.195756829848743e-02, 1.075848447909603e-04, -9.613563827741592e-02, -2.303064630620261e-02,  1.329392602904001e-01, 7.843700158703966e-02, 2.958283058369286e-02, -5.841534261623266e-02, -1.630731587972040e-01, -1.968318796819375e-03, 2.803535965627342e-02, 3.209350408514251e-02,  2.221353785030089e-03, -1.662603645558212e-01, -4.158291262103771e-02, 7.843700158703966e-02,  2.826946749206500e-01, 4.789743388848910e-02, 5.022361246522075e-03, 1.002153436320021e-02,  1.896346533360564e-03, -1.167979305628103e-02, 8.662379429434760e-03, 6.755834045531347e-03, -4.712910721179382e-02, -1.186670925647884e-02, 1.119597955684073e-02, 6.217453923458157e-02,  5.022361246522074e-03, 1.252461819913556e-01, 5.394796664055224e-02, 2.924148894385824e-03, -2.318123705364925e-02, 4.465297406100079e-03, 1.152224878720113e-03, 1.119811620759379e-02, -1.385770710675961e-03, 6.424621582570348e-03, -7.063313736800847e-03, 1.002153436320020e-02,  5.394796664055224e-02, 1.888337340835190e-01, 6.253609192063760e-03, -3.879795959386224e-02,  1.826141536829474e-02, -1.481109092385058e-03, 3.926398236740268e-02, -6.572198877471333e-04, -3.916254756103621e-03, -1.811865972202656e-02, 1.896346533360559e-03, 2.924148894385825e-03,  6.253609192063748e-03, 7.228921745774934e-02, -2.369583853768190e-03, 3.963246012894412e-03,  4.470110205076099e-03, -3.310945969490978e-03, 8.647105508165584e-04, 7.028574018687697e-03,  3.672071127273125e-03, -1.167979305628102e-02, -2.318123705364922e-02, -3.879795959386224e-02, -2.369583853768181e-03, 1.118096326996528e-01, -8.031503324605132e-04, -4.679042572868520e-03, -1.163819758968773e-02, 2.163601608566522e-04, 2.394741759387394e-03, 4.084560925757518e-03,  8.662379429434748e-03, 4.465297406100088e-03, 1.826141536829472e-02, 3.963246012894410e-03, -8.031503324605182e-04, 7.898339683533412e-02, 4.967396671384395e-03, -2.368286320066361e-03, -3.670949812920956e-04, 5.151914855139515e-03, 6.023060896646894e-03, 6.755834045531347e-03,  1.152224878720107e-03, -1.481109092385054e-03, 4.470110205076097e-03, -4.679042572868515e-03,  4.967396671384395e-03, 7.993244064723898e-02, -2.747843064232616e-03, 1.324774852304459e-04,  1.756451867057228e-03, 6.240875724027183e-03, -4.712910721179387e-02, 1.119811620759383e-02,  3.926398236740260e-02, -3.310945969490991e-03, -1.163819758968774e-02, -2.368286320066373e-03, -2.747843064232614e-03, 1.691990765058825e-01, 9.166053045845233e-03, -2.546094851573300e-02, -5.159184401030641e-02, -1.186670925647884e-02, -1.385770710675954e-03, -6.572198877471298e-04,  8.647105508165591e-04, 2.163601608566520e-04, -3.670949812921032e-04, 1.324774852304433e-04,  9.166053045845226e-03, 9.443400999348293e-02, -8.022481546586855e-03, -1.125211627477077e-02,  1.119597955684071e-02, 6.424621582570346e-03, -3.916254756103677e-03, 7.028574018687696e-03,  2.394741759387396e-03, 5.151914855139505e-03, 1.756451867057228e-03, -2.546094851573290e-02, -8.022481546586859e-03, 9.811468965818401e-02, 2.015830417931792e-02, 6.217453923458156e-02, -7.063313736800851e-03, -1.811865972202653e-02, 3.672071127273115e-03, 4.084560925757545e-03,  6.023060896646880e-03, 6.240875724027184e-03, -5.159184401030636e-02, -1.125211627477078e-02,  2.015830417931798e-02, 1.905564600888125e-01, 5.713600911939040e-02, 6.499161351604606e-03,  7.766394940110624e-03, 2.527731240385220e-03, -9.012890218966738e-03, 6.949656297538765e-03,  4.568708128856097e-03, -5.141992501894355e-02, -1.309942974773104e-02, 1.489128606970862e-02,  6.662603721662934e-02, 6.499161351604606e-03, 1.866439453909846e-01, 1.572469160149176e-01,  1.353826946481763e-02, -4.687675981588776e-02, 8.221092535367087e-03, 1.704094247595567e-03,
                  6.833467601482637e-02, 1.615934319476086e-02, -1.254415311765016e-02, -6.685420825447476e-02,  7.766394940110624e-03, 1.572469160149176e-01, 4.044522987248722e-01, 2.355332599094641e-02, -8.540714793134269e-02, 1.087058676536043e-02, -3.995860137763657e-03, 1.753795359445343e-01,  3.115307825075266e-02, -5.630696997460040e-02, -1.480108776599309e-01, 2.527731240385220e-03,  1.353826946481763e-02, 2.355332599094641e-02, 8.184537458138239e-02, -6.972965822049454e-03,  7.965705586882893e-03, 7.664576608709173e-03, 1.922270386483471e-03, 4.994564783320641e-03,  8.807249106040631e-03, -4.302802473614574e-03, -9.012890218966738e-03, -4.687675981588776e-02, -8.540714793134269e-02, -6.972965822049454e-03, 1.297660941933373e-01, -3.107382441678720e-03, -5.527035493541979e-03, -3.874422984693320e-02, -7.598436974156865e-03, 1.364945434483522e-02,  3.155904166994288e-02, 6.949656297538765e-03, 8.221092535367087e-03, 1.087058676536043e-02,  7.965705586882893e-03, -3.107382441678720e-03, 9.556422962750245e-02, 9.230571400805677e-03, -2.398497881085540e-02, -7.320558538295129e-04, 1.921534319331807e-02, 2.115345512787638e-02,  4.568708128856097e-03, 1.704094247595567e-03, -3.995860137763657e-03, 7.664576608709173e-03, -5.527035493541979e-03, 9.230571400805677e-03, 8.762922892534317e-02, -1.214975389414722e-02, -7.001404409247565e-04, 8.134689705863144e-03, 1.353791849066216e-02, -5.141992501894355e-02,  6.833467601482637e-02, 1.753795359445343e-01, 1.922270386483471e-03, -3.874422984693320e-02, -2.398497881085540e-02, -1.214975389414722e-02, 2.817380276981974e-01, 2.473262779188702e-02, -7.430124439442239e-02, -1.416035686230538e-01, -1.309942974773104e-02, 1.615934319476086e-02,  3.115307825075266e-02, 4.994564783320641e-03, -7.598436974156865e-03, -7.320558538295129e-04, -7.001404409247565e-04, 2.473262779188702e-02, 1.034931635755103e-01, -1.206142626025931e-02, -2.546537027357219e-02, 1.489128606970862e-02, -1.254415311765016e-02, -5.630696997460040e-02,  8.807249106040631e-03, 1.364945434483522e-02, 1.921534319331807e-02, 8.134689705863144e-03, -7.430124439442239e-02, -1.206142626025931e-02, 1.294249924096733e-01, 5.700429717908129e-02,  6.662603721662934e-02, -6.685420825447476e-02, -1.480108776599309e-01, -4.302802473614574e-03,  3.155904166994288e-02, 2.115345512787638e-02, 1.353791849066216e-02, -1.416035686230538e-01, -2.546537027357219e-02, 5.700429717908129e-02, 2.747854767565665e-01 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$method),
               c("EKF" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$model),
               c("exponential" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$LR),
               c(0.0877914951989026 )
               , tolerance = 1e-05)
})

#############
# Test ukf for exponential model
test_that("UKF and exp models give previous computed results with exponential estimation method",{
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 2,
    Q_0 = diag(1, 2),
    Q = diag(1e-1, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4,
                   method = "UKF", beta = 0),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential"))

  # plot(result_exp, cov_index = 1)
  # get_expect_equal(result_exp, file = "tmp.txt")

  expect_equal(c(result_exp$state_vecs),
               c(-3.16199430337179610, -3.16198708395727657, -2.78623108042084278, -2.56228292273211444, -2.90743359326256678, -3.10062205387759704, -3.33580310975087357, -3.41234771827994621, -3.50366626137125037, -3.61502277333748134, -3.71132284679002078, -3.86517945282306741, -3.99546432056050627, -4.11531585921853704, -4.16729804960914407, -4.22736821201123458, 0.34780900532241971, 0.34782203045614879, 0.53790347839878894, 0.65159168262057665,  0.48426982848327976, 0.40068722743400220, 0.29094955110058607, 0.26817382135840329, 0.22393430569403019,  0.17344861804905146, 0.12896626453875240, 0.04600508273813272, -0.02235584515736795, -0.08227043740544628, -0.11044552866380872, -0.13860082016259184 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.269555544328238694, 0.026053935667783364, 0.026053935667782850, 0.193628418752367693, 0.189222021374983201, -0.009396627040680491, -0.009396627040681116, 0.162628606510636431, 0.156118029209446646, -0.022502041952993601, -0.022502041952994198, 0.148079732969919220, 0.123705022690981645, -0.038400411078905142, -0.038400411078905711,  0.132512916183176344, 0.102748043634898478, -0.049426126997736353, -0.049426126997736922, 0.123647999137540807,  0.118978722738251219, -0.039049123113550174, -0.039049123113550716, 0.135129455056223535, 0.134218698294669592, -0.030612683576736435, -0.030612683576736941, 0.148917706117519338, 0.152659261292579063, -0.022223551634789708, -0.022223551634790166, 0.164857575528181255, 0.166458776107462680, -0.017420368823043715, -0.017420368823044183,  0.180267872077609470, 0.181166440528194944, -0.013449992856644648, -0.013449992856645099, 0.196436411097436592,  0.201254244947800420, -0.007688597414792879, -0.007688597414793330, 0.214795860751088696, 0.222552900375636631, -0.001987382846240879, -0.001987382846241302, 0.234140046027276227, 0.253469020819906077, 0.007275751591854895,  0.007275751591854479, 0.256079353103652874, 0.296620730159250279, 0.021571901071078238, 0.021571901071077815,  0.281204310053986162, 0.360564506272234631, 0.045209866274483854, 0.045209866274483416, 0.311561685452059312,  0.452044767091079380, 0.081162275036824189, 0.081162275036823744, 0.348238947290205103 ))

  expect_equal(c(result_exp$lag_one_cor),
               c(  1.546028800904405e-01, 2.643773741444061e-03, 1.169249661951227e-03, 1.245778982038979e-01,   1.050543901998079e-01, -1.655917429047343e-02, -1.719710999529248e-02, 1.026139917535743e-01,   7.554198335706871e-02, -2.602359682915641e-02, -2.794858815007396e-02, 8.673697407134492e-02,   5.438800569150745e-02, -3.322513277130497e-02, -3.443003592323718e-02, 7.375373218911752e-02,   5.101782831570285e-02, -3.191469661661157e-02, -2.977190467349472e-02, 6.948520980271258e-02,   6.083184006371047e-02, -2.161845003089291e-02, -1.962545646923080e-02, 7.160794039676963e-02,   7.260140182267005e-02, -1.077871262801296e-02, -9.274368340218830e-03, 7.393606214500026e-02,   8.439525715025871e-02, -3.071771750401756e-04, 7.326760943436178e-04, 7.523106671678172e-02,   9.372454318288817e-02, 8.798639562029274e-03, 9.443252040565342e-03, 7.450457501629963e-02,   1.036297627557526e-01, 1.824101507461600e-02, 1.866538665411709e-02, 7.241992284659790e-02,   1.118157834696941e-01, 2.724228952823509e-02, 2.751503443646169e-02, 6.835958925090949e-02,   1.143121374456680e-01, 3.400752277215534e-02, 3.412217418750479e-02, 6.119213227737630e-02,   1.058441687580752e-01, 3.607384046902287e-02, 3.611114241528623e-02, 4.958332318599007e-02,   7.410912277223547e-02, 2.774312296528218e-02, 2.775283221259562e-02, 3.066642786743218e-02,   0.000000000000000e+00, 0.000000000000000e+00, 1.770731274695028e-320, 1.978423033621121e-316 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(67 ))

  expect_equal(c(result_exp$Q),
               c(0.07160509933767206, 0.02994612473266408, 0.02994612473266408, 0.02413655616270586 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("UKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(1 ))




  set.seed(44334)
  sims <- test_sim_func_exp(n_series = 1e3, n_vars = 10, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                            intercept_start = -5, sds = c(.1, rep(1, 10)))
  # sum(sims$res$event)

  arg_list <- list(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(1, 11),
    Q = diag(1e-2, 11),
    control = list(est_Q_0 = F, n_max = 10^2, eps = 10^-2,
                   method = "UKF", beta = 2, save_risk_set = F,
                   save_data = F),
    max_T = 10,
    id = sims$res$id, order = 1,
    model = "exponential")

  suppressMessages(fit <- do.call(ddhazard, arg_list))

  # matplot(fit$state_vecs, lty = 2, type = "l", ylim = range(fit$state_vecs, sims$betas))
  # matplot(sims$betas, lty = 1, add = T, type = "l")
  # get_expect_equal(fit, eps = 1e-6, file = "tmp.txt")

  expect_equal(c(fit$state_vecs),
               c(-6.0778115124668552482, -6.0748823262037525694, -5.9747653564506020274, -5.7557333982006841921, -5.4509953526153767100, -5.1925494993190604021, -5.0725266702170248578, -5.0675514980181093350, -5.1015511748714654772, -5.2451298665454295644, -5.1644612334935668940, 1.4528248804080006185,  1.4897959805660510035, 1.5306175269953439244, 1.5924909861792049259, 1.6371932488080358503,  1.8461874046582054110, 1.9246579525196074734, 2.1821160818898612810, 2.5812843095801771831,  2.7096266709853447097, 3.0095477509297130503, 2.3659555578791415797, 2.4296831627882031768,  2.5401948554834570260, 2.7429267157288017565, 2.9594535295361401595, 3.4401383801481086877,  3.6381682179009149358, 4.0613329042217145570, 4.7030314791967056109, 4.8510577749548895454,  5.3956792038998333538, -1.7294894046751454475, -1.6231037304550510747, -1.5899935510994305243, -1.5901147907285095862, -1.7077398286730767207, -1.2939481747838106340, -1.1483155890392739984, -0.4185618794399746934, 0.7592102425998554782, 1.2482583059155079042, 2.0680940633618600799, -2.0391056498005823983, -2.0128037090603632109, -2.0858259850655858081, -2.2651357836478966945, -2.5479874311831127720, -2.6512174067758200735, -2.7173460706105290186, -2.5315078504460131192, -2.1851571529313145170, -1.9370795753378700077, -1.7748168070414862552, -0.0382108346500819665,  0.0339503778444588955, 0.0442147506615133690, 0.0152141133334223744, -0.0999324502706233075,  0.1499937939376772000, 0.2308286025493869742, 0.7161203814516832189, 1.5137587821413074352,  1.8667446826542066773, 2.4325411803284131551, -0.9657049001032774749, -0.8984978997010371060, -0.8614608462864064009, -0.8279993802120135804, -0.8527912259691624586, -0.5545231645170478618, -0.4520710533476438586, 0.0008196467706284016, 0.7350063474314452172, 1.0202984407681618961,  1.5511681670666583877, -2.3597274792852855896, -2.3926550791645087024, -2.4772297267046341496, -2.6401420945908089521, -2.8337480386357780660, -3.1446449947234578204, -3.2798582863792740127, -3.4971100512440624897, -3.8154461662239005371, -3.8542626148976792955, -4.1510958481669160136, -0.2065619576823340686, -0.2880339426891434518, -0.3577634646923166795, -0.4546361392837011683, -0.5035458104009755687, -0.9350436064635949673, -1.0933333471054329511, -1.6397196278626868793, -2.5078440361169067607, -2.8160190917930512100, -3.4775431960261347086, 0.4723337765990856529,  0.5176277658367607337, 0.5503686622228070036, 0.5910799746034645086, 0.5969186904231325030,  0.8127071816212952937, 0.8855139065032131551, 1.1934363530571086010, 1.6867118118786987857,  1.8647569569919413279, 2.2271829858235983046, -0.2778829905944703027, -0.2291812317290174705, -0.1860181688898914776, -0.1236073256397456355, -0.0863512281748026744, 0.1777648191762044583,  0.2791006148565605138, 0.6069244247839489237, 1.1217947466151985125, 1.2994919883597215726,  1.7013767511746236138 )
               , tolerance = 1e-06)

  expect_equal(c(fit$state_vars),
               c( 2.277632998500462e-01, 1.277605276859282e-02, 6.931295356440616e-02, -1.942154081853447e-02, -7.392475466247136e-02, -3.076232109003011e-02, 2.029707355613770e-03, -4.457868124953114e-02, -2.601657944583678e-02, 1.770199894607956e-03, 2.018193042107533e-02, 1.277605276859274e-02,  2.156453872259408e-01, 5.445961897359831e-02, 5.899007273950852e-02, -4.327601989450669e-03,  4.247010818709488e-02, 3.889611095066012e-02, -3.000915111126767e-02, -5.395091160516909e-02,  2.484101448366859e-02, 3.355200978559537e-02, 6.931295356440595e-02, 5.445961897359849e-02,  3.444833732681057e-01, 8.674260662534013e-02, -3.982975786584015e-02, 4.177174668128837e-02,  5.887317841804654e-02, -7.596749642052542e-02, -8.986227378213284e-02, 4.857726355833652e-02,  5.320243513005756e-02, -1.942154081853435e-02, 5.899007273950835e-02, 8.674260662534020e-02,  4.072471582769950e-01, 6.792218823526729e-02, 1.256196531077234e-01, 1.105313826516776e-01, -2.986519567691648e-02, -1.245244856510784e-01, 6.717416279656918e-02, 7.201237714484955e-02, -7.392475466247216e-02, -4.327601989450694e-03, -3.982975786584023e-02, 6.792218823526726e-02,  3.871884431270443e-01, 5.777345566515343e-02, 2.330569974239820e-02, 3.560888914085501e-02, -1.416047433762677e-02, 1.275247699159201e-02, 8.611119209115330e-03, -3.076232109003265e-02,  4.247010818709476e-02, 4.177174668128834e-02, 1.256196531077237e-01, 5.777345566515353e-02,  3.474727008491079e-01, 7.010128442480068e-02, -1.172894963598709e-02, -7.452597425696306e-02,  5.267270111163880e-02, 5.492908264557025e-02, 2.029707355615360e-03, 3.889611095066020e-02,  5.887317841804683e-02, 1.105313826516776e-01, 2.330569974239810e-02, 7.010128442480064e-02,  3.306580682313499e-01, -2.865888755322930e-02, -8.090918782126599e-02, 4.558013367898121e-02,  4.896441882418658e-02, -4.457868124953122e-02, -3.000915111126782e-02, -7.596749642052517e-02, -2.986519567691645e-02, 3.560888914085499e-02, -1.172894963598710e-02, -2.865888755322923e-02,  3.563258227344805e-01, 4.477652798775134e-02, -2.115406106602060e-02, -4.215871827630967e-02, -2.601657944583653e-02, -5.395091160516922e-02, -8.986227378213282e-02, -1.245244856510781e-01, -1.416047433762682e-02, -7.452597425696329e-02, -8.090918782126628e-02, 4.477652798775110e-02,  3.617975342754561e-01, -5.859975318084841e-02, -5.896157875945372e-02, 1.770199894608845e-03,  2.484101448366867e-02, 4.857726355833639e-02, 6.717416279656911e-02, 1.275247699159190e-02,  5.267270111163899e-02, 4.558013367898126e-02, -2.115406106602067e-02, -5.859975318084852e-02,  2.956341823668217e-01, 2.219995775456768e-02, 2.018193042107577e-02, 3.355200978559543e-02,  5.320243513005755e-02, 7.201237714484980e-02, 8.611119209115269e-03, 5.492908264557021e-02,  4.896441882418642e-02, -4.215871827630964e-02, -5.896157875945356e-02, 2.219995775456785e-02,  2.945729415316363e-01, 1.969876914001792e-01, 1.467384035210179e-02, 6.506314914254391e-02,  8.602627490498366e-05, -6.000655018400908e-02, -1.775540078662752e-02, 1.241927168045805e-02, -4.053619636480857e-02, -3.347338479247412e-02, 6.507241993816176e-03, 2.485571409299284e-02,  1.467384035210155e-02, 2.362545848888237e-01, 9.744645410445074e-02, 1.253781088367899e-01,  1.126268110722727e-02, 9.066590527139068e-02, 8.528178789023363e-02, -5.620258804901472e-02, -1.093676373841662e-01, 5.562428802493443e-02, 6.755485422487333e-02, 6.506314914254349e-02,  9.744645410445102e-02, 4.106600401491739e-01, 2.006312813127206e-01, -1.272910736305073e-02,  1.232474674912196e-01, 1.380717327351932e-01, -1.197381727303543e-01, -1.832215672181697e-01,  1.009214999336440e-01, 1.104418163864536e-01, 8.602627490467835e-05, 1.253781088367898e-01,  2.006312813127207e-01, 5.669558733160551e-01, 1.049188292015071e-01, 2.466327809769056e-01,  2.277216777525957e-01, -9.997537265533796e-02, -2.661438392274134e-01, 1.464409736958945e-01,  1.586545101488403e-01, -6.000655018401018e-02, 1.126268110722720e-02, -1.272910736305091e-02,  1.049188292015071e-01, 3.953060748516709e-01, 8.672416664766297e-02, 4.961958020732531e-02,  2.049213790956841e-02, -4.673408168583262e-02, 3.131840269025569e-02, 2.827436935128053e-02, -1.775540078663067e-02, 9.066590527139051e-02, 1.232474674912193e-01, 2.466327809769058e-01,  8.672416664766329e-02, 4.319569225043155e-01, 1.551577063042116e-01, -6.091419787910878e-02, -1.768261104677778e-01, 1.103107427592644e-01, 1.174615723740232e-01, 1.241927168045957e-02,  8.528178789023380e-02, 1.380717327351936e-01, 2.277216777525955e-01, 4.961958020732510e-02,  1.551577063042116e-01, 4.093144837938787e-01, -7.696898057923002e-02, -1.802329048099577e-01,  1.010862196108445e-01, 1.097104662494076e-01, -4.053619636480858e-02, -5.620258804901494e-02, -1.197381727303540e-01, -9.997537265533794e-02, 2.049213790956831e-02, -6.091419787910902e-02, -7.696898057922985e-02, 3.803176307590593e-01, 1.019414604403377e-01, -5.290131314723273e-02, -7.745393971716140e-02, -3.347338479247355e-02, -1.093676373841665e-01, -1.832215672181697e-01, -2.661438392274131e-01, -4.673408168583280e-02, -1.768261104677782e-01, -1.802329048099580e-01,  1.019414604403375e-01, 4.769041949140461e-01, -1.252035093139367e-01, -1.316707163200608e-01,  6.507241993816982e-03, 5.562428802493457e-02, 1.009214999336440e-01, 1.464409736958944e-01,  3.131840269025555e-02, 1.103107427592647e-01, 1.010862196108445e-01, -5.290131314723285e-02, -1.252035093139369e-01, 3.290270657337139e-01, 6.282268125697289e-02, 2.485571409299314e-02,  6.755485422487345e-02, 1.104418163864536e-01, 1.586545101488405e-01, 2.827436935128050e-02,  1.174615723740233e-01, 1.097104662494074e-01, -7.745393971716139e-02, -1.316707163200606e-01,  6.282268125697305e-02, 3.352313991125607e-01, 1.736418232951641e-01, 1.388693271329893e-02,  5.846185447258012e-02, 7.823731774912746e-03, -5.183242334210042e-02, -1.300652490634139e-02,  1.586748116286259e-02, -3.590395008037724e-02, -3.456844869004889e-02, 7.263066905269137e-03,  2.578329610264087e-02, 1.388693271329878e-02, 2.440779002160616e-01, 1.152696016774356e-01,  1.548737769496041e-01, 1.796846386386194e-02, 1.134923747343440e-01, 1.061568769554683e-01, -6.866190930767682e-02, -1.363936936195794e-01, 7.055086554661896e-02, 8.332269582990022e-02,  5.846185447257982e-02, 1.152696016774359e-01, 4.302250621878190e-01, 2.420679197273798e-01, -3.944198123886668e-03, 1.550221590170590e-01, 1.679190694249530e-01, -1.381395316992386e-01, -2.217724186693865e-01, 1.225885131727834e-01, 1.327862640564241e-01, 7.823731774912582e-03,  1.548737769496041e-01, 2.420679197273800e-01, 6.259321324665509e-01, 1.185818961828626e-01,  2.979174756687286e-01, 2.742487381825238e-01, -1.303224286931826e-01, -3.282147154170684e-01,  1.815445847749720e-01, 1.941132517158935e-01, -5.183242334210153e-02, 1.796846386386192e-02, -3.944198123886789e-03, 1.185818961828626e-01, 3.985418694092865e-01, 9.955232709261297e-02,  5.945699710088717e-02, 1.520828231490047e-02, -6.012206703037415e-02, 3.940098374411915e-02,  3.545038218128398e-02, -1.300652490634443e-02, 1.134923747343438e-01, 1.550221590170587e-01,  2.979174756687286e-01, 9.955232709261325e-02, 4.690383029069733e-01, 1.917010972046994e-01, -8.293136542741872e-02, -2.243637012288368e-01, 1.376076058706880e-01,
                  1.447714944269335e-01,  1.586748116286424e-02, 1.061568769554686e-01, 1.679190694249535e-01, 2.742487381825237e-01,  5.945699710088692e-02, 1.917010972046995e-01, 4.395705267470598e-01, -9.827332409028144e-02, -2.243758632336913e-01, 1.258501971541957e-01, 1.351251455768945e-01, -3.590395008037734e-02, -6.866190930767703e-02, -1.381395316992384e-01, -1.303224286931825e-01, 1.520828231490041e-02, -8.293136542741894e-02, -9.827332409028126e-02, 3.909420298578375e-01, 1.291695128526237e-01, -6.789074929795363e-02, -9.380630783231286e-02, -3.456844869004849e-02, -1.363936936195796e-01, -2.217724186693866e-01, -3.282147154170679e-01, -6.012206703037425e-02, -2.243637012288372e-01, -2.243758632336917e-01, 1.291695128526235e-01, 5.310925844279142e-01, -1.575574200412170e-01, -1.648621736921699e-01, 7.263066905269999e-03, 7.055086554661916e-02, 1.225885131727834e-01,  1.815445847749719e-01, 3.940098374411901e-02, 1.376076058706882e-01, 1.258501971541958e-01, -6.789074929795377e-02, -1.575574200412171e-01, 3.438546481308957e-01, 8.145107055336126e-02,  2.578329610264124e-02, 8.332269582990037e-02, 1.327862640564241e-01, 1.941132517158937e-01,  3.545038218128395e-02, 1.447714944269337e-01, 1.351251455768943e-01, -9.380630783231290e-02, -1.648621736921698e-01, 8.145107055336145e-02, 3.511170805999345e-01, 1.583593604622359e-01,  1.246814952265795e-02, 5.285405498371962e-02, 1.169407582899974e-02, -4.639197980455960e-02, -1.112393938562662e-02, 1.726427534177843e-02, -3.164911409996979e-02, -3.364242434046263e-02,  6.744540912104476e-03, 2.586308608417855e-02, 1.246814952265803e-02, 2.386294573747453e-01,  1.118486934872660e-01, 1.521552527183630e-01, 1.769819560490065e-02, 1.135785698293734e-01,  1.048613484500717e-01, -6.856417735604378e-02, -1.360537947009118e-01, 7.034065856214453e-02,  8.319605776476868e-02, 5.285405498371978e-02, 1.118486934872662e-01, 4.173305833691433e-01,  2.340431806168221e-01, -5.358684208300948e-03, 1.517537513554340e-01, 1.633909295578100e-01, -1.364394856321916e-01, -2.175927181908838e-01, 1.207016356518999e-01, 1.304951628931264e-01,  1.169407582900031e-02, 1.521552527183632e-01, 2.340431806168229e-01, 6.115905030924126e-01,  1.154249594700708e-01, 2.963087536963982e-01, 2.689233673563959e-01, -1.314912211303316e-01, -3.266461184234953e-01, 1.813415642922363e-01, 1.926063395098461e-01, -4.639197980456054e-02,  1.769819560490079e-02, -5.358684208300739e-03, 1.154249594700711e-01, 3.962570719897457e-01,  9.998369026115003e-02, 5.756318637927112e-02, 1.493002717473639e-02, -5.996140827792210e-02,  3.978298145604352e-02, 3.458648533246571e-02, -1.112393938562916e-02, 1.135785698293735e-01,  1.517537513554340e-01, 2.963087536963983e-01, 9.998369026115009e-02, 4.685308742209048e-01,  1.912786381876636e-01, -8.452548237045959e-02, -2.267061701820892e-01, 1.398486085986049e-01,  1.458021426858136e-01, 1.726427534178056e-02, 1.048613484500721e-01, 1.633909295578108e-01,  2.689233673563957e-01, 5.756318637927062e-02, 1.912786381876636e-01, 4.339582178237933e-01, -9.932601300351393e-02, -2.241777555051415e-01, 1.259857592696175e-01, 1.347513489581635e-01, -3.164911409997013e-02, -6.856417735604396e-02, -1.364394856321913e-01, -1.314912211303311e-01,  1.493002717473649e-02, -8.452548237045956e-02, -9.932601300351356e-02, 3.892739066730400e-01,  1.308789820122613e-01, -6.890890405167016e-02, -9.543604382057352e-02, -3.364242434046281e-02, -1.360537947009123e-01, -2.175927181908843e-01, -3.266461184234946e-01, -5.996140827792192e-02, -2.267061701820895e-01, -2.241777555051418e-01, 1.308789820122613e-01, 5.307803952713162e-01, -1.596080538435463e-01, -1.662125560748017e-01, 6.744540912105651e-03, 7.034065856214480e-02,  1.207016356519001e-01, 1.813415642922360e-01, 3.978298145604323e-02, 1.398486085986052e-01,  1.259857592696175e-01, -6.890890405167038e-02, -1.596080538435464e-01, 3.421791312868153e-01,  8.246004976018084e-02, 2.586308608417926e-02, 8.319605776476893e-02, 1.304951628931266e-01,  1.926063395098461e-01, 3.458648533246549e-02, 1.458021426858137e-01, 1.347513489581633e-01, -9.543604382057362e-02, -1.662125560748016e-01, 8.246004976018098e-02, 3.488101127577995e-01,  1.459606225184144e-01, 1.067771363006738e-02, 4.594349698052904e-02, 1.393183699798464e-02, -3.991241115595706e-02, -9.713126114524056e-03, 1.758896609656679e-02, -2.588247142959953e-02, -3.107869924964234e-02, 5.287000059006558e-03, 2.479139525358488e-02, 1.067771363006739e-02,  2.290348876515624e-01, 1.025827450479277e-01, 1.376502322105669e-01, 1.460245259740867e-02,  1.045996838109286e-01, 9.611422109358722e-02, -6.394678424494671e-02, -1.253249468649938e-01,  6.418695979635675e-02, 7.721084831089059e-02, 4.594349698052907e-02, 1.025827450479281e-01,  3.968164797639033e-01, 2.124732470726400e-01, -7.797240140931125e-03, 1.378684469998884e-01,  1.499765538176263e-01, -1.271215149514585e-01, -1.995694725088000e-01, 1.110092281381799e-01,  1.204388423933136e-01, 1.393183699798503e-02, 1.376502322105674e-01, 2.124732470726406e-01,  5.668595459661430e-01, 1.026144109605154e-01, 2.699461900929037e-01, 2.442943991921923e-01, -1.222576101703235e-01, -2.983262371398444e-01, 1.657701143927162e-01, 1.762343441498593e-01, -3.991241115595805e-02, 1.460245259740878e-02, -7.797240140930996e-03, 1.026144109605156e-01,  3.873292023265046e-01, 9.201397669581338e-02, 5.013959992961238e-02, 1.446650359104339e-02, -5.348653471682254e-02, 3.629328039996942e-02, 3.046335296091330e-02, -9.713126114526710e-03,  1.045996838109288e-01, 1.378684469998884e-01, 2.699461900929037e-01, 9.201397669581346e-02,  4.486718761492005e-01, 1.754039560182554e-01, -7.865287867695675e-02, -2.083559654162798e-01,  1.302174732436153e-01, 1.353102272941254e-01, 1.758896609656880e-02, 9.611422109358760e-02,  1.499765538176270e-01, 2.442943991921921e-01, 5.013959992961191e-02, 1.754039560182556e-01,  4.163246936635642e-01, -9.338624239665526e-02, -2.069215035212700e-01, 1.163184976170392e-01,  1.248664172784670e-01, -2.588247142959979e-02, -6.394678424494693e-02, -1.271215149514583e-01, -1.222576101703231e-01, 1.446650359104343e-02, -7.865287867695676e-02, -9.338624239665493e-02,  3.815224623937798e-01, 1.220867203154333e-01, -6.414360382866201e-02, -9.096279796936919e-02, -3.107869924964240e-02, -1.253249468649943e-01, -1.995694725088005e-01, -2.983262371398436e-01, -5.348653471682241e-02, -2.083559654162800e-01, -2.069215035212701e-01, 1.220867203154332e-01,  5.068954792903371e-01, -1.481580637369055e-01, -1.541148211927836e-01, 5.287000059007661e-03,  6.418695979635708e-02, 1.110092281381801e-01, 1.657701143927160e-01, 3.629328039996921e-02,  1.302174732436156e-01, 1.163184976170392e-01, -6.414360382866227e-02, -1.481580637369057e-01,  3.330336693442369e-01, 7.581838457319198e-02, 2.479139525358551e-02, 7.721084831089084e-02,  1.204388423933139e-01, 1.762343441498593e-01, 3.046335296091314e-02, 1.353102272941255e-01,  1.248664172784668e-01, -9.096279796936929e-02, -1.541148211927835e-01, 7.581838457319212e-02,  3.391170020870818e-01, 1.319207503099308e-01, 7.417292071433441e-03, 3.403043278248823e-02,  1.463617862393803e-02, -2.918860321744808e-02, -8.131467919986661e-03, 1.612663564871177e-02, -1.552361503204549e-02, -2.510566266058196e-02,
                  2.103887781978482e-03, 2.135139612928062e-02,  7.417292071433235e-03, 2.133940776975447e-01, 7.982391615692676e-02, 1.038873373224912e-01,  8.130740937927601e-03, 8.108649381210817e-02, 7.396024477693963e-02, -5.096103239312474e-02, -9.759722241691844e-02, 4.824797485640450e-02, 6.083599419424089e-02, 3.403043278248789e-02,  7.982391615692713e-02, 3.477390464593236e-01, 1.533253637516641e-01, -1.397546927188730e-02,  9.665519432938625e-02, 1.101652356968996e-01, -9.913804089256545e-02, -1.472548452120917e-01,  8.188029737295846e-02, 8.937507087922161e-02, 1.463617862393776e-02, 1.038873373224916e-01,  1.533253637516641e-01, 4.628441160757209e-01, 7.441393871963123e-02, 1.974724303260678e-01,  1.790128899340137e-01, -9.145071317515853e-02, -2.198086036028145e-01, 1.211428097127420e-01,  1.294887728599372e-01, -2.918860321744930e-02, 8.130740937927532e-03, -1.397546927188756e-02,  7.441393871963099e-02, 3.685537619693404e-01, 7.082367181326731e-02, 3.328261988935777e-02,  1.409265066275906e-02, -3.719766174333818e-02, 2.666527153454676e-02, 2.067609301469125e-02, -8.131467919989734e-03, 8.108649381210838e-02, 9.665519432938594e-02, 1.974724303260677e-01,  7.082367181326760e-02, 3.937619679815844e-01, 1.285995029438349e-01, -5.766768324458726e-02, -1.524092171003794e-01, 9.878162584711858e-02, 1.021222512539316e-01, 1.612663564871343e-02,  7.396024477694005e-02, 1.101652356969001e-01, 1.790128899340134e-01, 3.328261988935752e-02,  1.285995029438351e-01, 3.711600541481490e-01, -7.201398009894756e-02, -1.552051266704890e-01,  8.680385577835423e-02, 9.406676806059444e-02, -1.552361503204557e-02, -5.096103239312504e-02, -9.913804089256534e-02, -9.145071317515849e-02, 1.409265066275887e-02, -5.766768324458755e-02, -7.201398009894736e-02, 3.615427379908173e-01, 9.268335838993320e-02, -4.787219808944784e-02, -7.379409118345420e-02, -2.510566266058159e-02, -9.759722241691890e-02, -1.472548452120919e-01, -2.198086036028140e-01, -3.719766174333838e-02, -1.524092171003796e-01, -1.552051266704892e-01,  9.268335838993291e-02, 4.398899841785556e-01, -1.118531134975215e-01, -1.156542539990766e-01,  2.103887781979337e-03, 4.824797485640482e-02, 8.188029737295856e-02, 1.211428097127417e-01,  2.666527153454671e-02, 9.878162584711897e-02, 8.680385577835419e-02, -4.787219808944801e-02, -1.118531134975217e-01, 3.098836970014043e-01, 5.408849997513011e-02, 2.135139612928100e-02,  6.083599419424118e-02, 8.937507087922175e-02, 1.294887728599373e-01, 2.067609301469130e-02,  1.021222512539318e-01, 9.406676806059429e-02, -7.379409118345426e-02, -1.156542539990765e-01,  5.408849997513023e-02, 3.135826251681222e-01, 1.196183615948153e-01, 6.295507004159986e-03,  2.686325845238362e-02, 1.962667656166488e-02, -1.677709489867869e-02, -4.369677931993596e-03,  1.700470567028366e-02, -6.263801275552787e-03, -2.109705095520393e-02, 1.023472066003346e-03,  1.940096449372669e-02, 6.295507004160365e-03, 2.041336359184695e-01, 7.077509152863874e-02,  8.650703082045610e-02, 5.488829265884196e-03, 6.754274814393227e-02, 6.207282059323043e-02, -4.399413297895922e-02, -8.338064832595010e-02, 3.901909386380829e-02, 5.204614120345308e-02,  2.686325845238426e-02, 7.077509152863895e-02, 3.314385921966656e-01, 1.334151521172933e-01, -1.111475139229260e-02, 7.964666186462394e-02, 9.491247316209236e-02, -8.515248087381230e-02, -1.262556758396205e-01, 6.921435758781561e-02, 7.642462034038879e-02, 1.962667656166676e-02,  8.650703082045721e-02, 1.334151521172953e-01, 4.125583653310151e-01, 5.928411133199536e-02,  1.580679187406755e-01, 1.467231482100817e-01, -7.868707999388118e-02, -1.848295872715628e-01,  9.764549240313172e-02, 1.069639387734645e-01, -1.677709489867930e-02, 5.488829265884698e-03, -1.111475139229168e-02, 5.928411133199664e-02, 3.521865245474590e-01, 5.834850223148784e-02,  2.507890291889647e-02, 8.192074748625561e-03, -3.348822618887955e-02, 2.228612259466062e-02,  1.766328143597866e-02, -4.369677931995187e-03, 6.754274814393300e-02, 7.964666186462503e-02,  1.580679187406757e-01, 5.834850223148717e-02, 3.602254679955216e-01, 1.023061506260002e-01, -4.755266110172119e-02, -1.237647441357077e-01, 8.033605689905871e-02, 8.397756457478596e-02,  1.700470567028668e-02, 6.207282059323123e-02, 9.491247316209392e-02, 1.467231482100812e-01,  2.507890291889522e-02, 1.023061506260002e-01, 3.469836570913454e-01, -6.148370129210230e-02, -1.302537522811795e-01, 7.040156660227496e-02, 7.815049251870235e-02, -6.263801275553429e-03, -4.399413297895927e-02, -8.515248087381200e-02, -7.868707999387967e-02, 8.192074748626117e-03, -4.755266110172045e-02, -6.148370129210123e-02, 3.473526556533473e-01, 7.656586623645388e-02, -3.884942404293308e-02, -6.430514949739367e-02, -2.109705095520518e-02, -8.338064832595085e-02, -1.262556758396218e-01, -1.848295872715615e-01, -3.348822618887839e-02, -1.237647441357072e-01, -1.302537522811794e-01, 7.656586623645453e-02, 4.078351732782324e-01, -9.280618609156997e-02, -9.646827113761161e-02, 1.023472066005108e-03, 3.901909386380877e-02, 6.921435758781624e-02,  9.764549240313103e-02, 2.228612259465986e-02, 8.033605689905876e-02, 7.040156660227478e-02, -3.884942404293373e-02, -9.280618609157026e-02, 2.957689626835074e-01, 4.194800036431898e-02,  1.940096449372804e-02, 5.204614120345350e-02, 7.642462034038955e-02, 1.069639387734639e-01,  1.766328143597787e-02, 8.397756457478571e-02, 7.815049251870193e-02, -6.430514949739431e-02, -9.646827113761140e-02, 4.194800036431904e-02, 2.993609262538605e-01, 1.094258445537720e-01,  3.751730029184123e-03, 1.800659525724748e-02, 2.074543737173386e-02, -4.158762989416316e-03, -4.193894685688719e-03, 1.657687903194882e-02, 3.666728306674666e-03, -1.390189075293021e-02, -9.939233996051713e-04, 1.546113849622368e-02, 3.751730029184458e-03, 1.956574123088647e-01,  6.202248625271309e-02, 7.309943197434246e-02, 5.526765408683407e-03, 5.861832036246122e-02,  5.187455228394630e-02, -3.491439860784465e-02, -6.880023292431083e-02, 3.093982595427979e-02,  4.336340406289015e-02, 1.800659525724796e-02, 6.202248625271312e-02, 3.203860012582518e-01,  1.248545102116511e-01, -2.337417482976171e-03, 7.306812251546141e-02, 8.579695852442745e-02, -6.940126223022822e-02, -1.080494900999921e-01, 6.075639823193316e-02, 6.583966695495276e-02,  2.074543737173534e-02, 7.309943197434321e-02, 1.248545102116528e-01, 3.925002481673456e-01,  5.442071943890572e-02, 1.445529454178799e-01, 1.292365006622201e-01, -6.509215141751709e-02, -1.624596110613799e-01, 8.436930725775700e-02, 9.297950456198543e-02, -4.158762989417208e-03,  5.526765408683667e-03, -2.337417482975713e-03, 5.442071943890661e-02, 3.381123955517137e-01,  5.538591768085404e-02, 2.201720966836102e-02, 7.142822876035218e-04, -3.657423984678494e-02,  2.166892728399598e-02, 1.895942394256467e-02, -4.193894685690569e-03, 5.861832036246170e-02,  7.306812251546230e-02, 1.445529454178800e-01, 5.538591768085366e-02, 3.500972902478515e-01,  8.982426318611197e-02, -3.783657298840047e-02, -1.080530426827442e-01, 7.127931330648508e-02,  7.440387619594550e-02, 1.657687903195161e-02, 5.187455228394686e-02, 8.579695852442890e-02,  1.292365006622195e-01, 2.201720966836013e-02, 8.982426318611195e-02, 3.314608618605031e-01, -5.017118941000829e-02,
                  -1.110635449427556e-01, 5.930825887140188e-02, 6.622436426399048e-02,  3.666728306673994e-03, -3.491439860784473e-02, -6.940126223022811e-02, -6.509215141751595e-02,  7.142822876038098e-04, -3.783657298839995e-02, -5.017118941000746e-02, 3.316477980256675e-01,  5.663982298162415e-02, -2.937468922319631e-02, -5.295768066307791e-02, -1.390189075293130e-02, -6.880023292431134e-02, -1.080494900999935e-01, -1.624596110613788e-01, -3.657423984678415e-02, -1.080530426827438e-01, -1.110635449427554e-01, 5.663982298162457e-02, 3.791731928767461e-01, -7.769380140638138e-02, -7.920260992549090e-02, -9.939233996035211e-04, 3.093982595428012e-02,  6.075639823193368e-02, 8.436930725775635e-02, 2.166892728399540e-02, 7.127931330648515e-02,  5.930825887140166e-02, -2.937468922319682e-02, -7.769380140638160e-02, 2.865248691551926e-01,  3.248998541349970e-02, 1.546113849622497e-02, 4.336340406289045e-02, 6.583966695495355e-02,  9.297950456198512e-02, 1.895942394256414e-02, 7.440387619594535e-02, 6.622436426399020e-02, -5.295768066307849e-02, -7.920260992549077e-02, 3.248998541349984e-02, 2.880053442852370e-01,  1.019517146080138e-01, -1.538342796382937e-03, 6.606945545617231e-03, 1.329614488717073e-02,  4.184150645232469e-03, -8.849871244420510e-03, 9.136910088987354e-03, 1.364806209006383e-02, -3.136526019889447e-03, -5.705341697577572e-03, 8.888067508912904e-03, -1.538342796382744e-03,  1.930224967274781e-01, 5.867857649632623e-02, 6.688985645382448e-02, 7.611140275900991e-03,  5.568758068411690e-02, 4.709654615328222e-02, -2.923852800613579e-02, -6.113640588408648e-02,  2.764362315233199e-02, 3.984361533007558e-02, 6.606945545617547e-03, 5.867857649632624e-02,  3.198269316741419e-01, 1.235459044613639e-01, 6.714375541377635e-03, 7.393683902621458e-02,  8.218403204577128e-02, -5.991274173404412e-02, -9.990102374872167e-02, 5.902811558192374e-02,  6.298513288575558e-02, 1.329614488717179e-02, 6.688985645382513e-02, 1.235459044613655e-01,  3.826908591140890e-01, 5.338457962515070e-02, 1.396612955909581e-01, 1.210271721984773e-01, -5.584512621330372e-02, -1.484882557976964e-01, 7.901249022778598e-02, 8.780908345307296e-02,  4.184150645231383e-03, 7.611140275901079e-03, 6.714375541377840e-03, 5.338457962515129e-02,  3.295229039160887e-01, 5.511431375287490e-02, 2.385248963690001e-02, -5.730242053729500e-03, -4.045008979566025e-02, 2.303050002109494e-02, 2.217210769365262e-02, -8.849871244422648e-03,  5.568758068411718e-02, 7.393683902621531e-02, 1.396612955909581e-01, 5.511431375287470e-02,  3.495418460350251e-01, 8.582595885258168e-02, -3.243850414318607e-02, -1.005699809598745e-01,  6.908365699189772e-02, 7.246771365949979e-02, 9.136910088989895e-03, 4.709654615328268e-02,  8.218403204577257e-02, 1.210271721984767e-01, 2.385248963689931e-02, 8.582595885258172e-02,  3.253607584833756e-01, -4.159726257201200e-02, -9.962595262562612e-02, 5.463591726087336e-02,  6.124312518397648e-02, 1.364806209006321e-02, -2.923852800613591e-02, -5.991274173404415e-02, -5.584512621330288e-02, -5.730242053729351e-03, -3.243850414318570e-02, -4.159726257201131e-02,  3.221188642423984e-01, 4.354462189915143e-02, -2.400938757194349e-02, -4.628190872371770e-02, -3.136526019890224e-03, -6.113640588408681e-02, -9.990102374872289e-02, -1.484882557976953e-01, -4.045008979565967e-02, -1.005699809598742e-01, -9.962595262562590e-02, 4.354462189915163e-02,  3.626192412705943e-01, -7.040305249799320e-02, -7.091881674538361e-02, -5.705341697576063e-03,  2.764362315233224e-02, 5.902811558192417e-02, 7.901249022778534e-02, 2.303050002109445e-02,  6.908365699189774e-02, 5.463591726087302e-02, -2.400938757194391e-02, -7.040305249799342e-02,  2.846358086712675e-01, 2.917262163073386e-02, 8.888067508914056e-03, 3.984361533007585e-02,  6.298513288575631e-02, 8.780908345307281e-02, 2.217210769365225e-02, 7.246771365949975e-02,  6.124312518397625e-02, -4.628190872371825e-02, -7.091881674538358e-02, 2.917262163073409e-02,  2.852007061740178e-01, 9.334678077371819e-02, -1.686964605489873e-02, -2.246832676910668e-02, -2.213617115277479e-02, 4.241925472574274e-03, -2.965649935066022e-02, -1.845938619333795e-02,  3.096627649715163e-02, 2.708481478722170e-02, -2.347771685136792e-02, -1.115128152387098e-02, -1.686964605489933e-02, 1.912558343589638e-01, 4.539901732759820e-02, 5.810126603666291e-02,  1.081724581270555e-02, 4.986776537710058e-02, 3.704315613069895e-02, -1.819637741675077e-02, -4.902860768931726e-02, 2.025503961935468e-02, 3.287053705347608e-02, -2.246832676910825e-02,  4.539901732759782e-02, 2.904959875293079e-01, 9.463418799563680e-02, 1.098789620766746e-02,  5.519618827185291e-02, 5.393117352268618e-02, -3.502425924158591e-02, -6.742936871576456e-02,  3.981927496646519e-02, 4.394857872272590e-02, -2.213617115277639e-02, 5.810126603666257e-02,  9.463418799563730e-02, 3.685260666780982e-01, 5.741103235747565e-02, 1.246394922405693e-01,  1.002975370769327e-01, -2.976580311896210e-02, -1.205030321733517e-01, 6.257857295736841e-02,  7.462593773993603e-02, 4.241925472572508e-03, 1.081724581270490e-02, 1.098789620766614e-02,  5.741103235747459e-02, 3.284694338430525e-01, 5.446851754767044e-02, 2.820199856252791e-02, -6.854672084244868e-03, -4.269913277056835e-02, 2.459299144440120e-02, 2.619566758472804e-02, -2.965649935066423e-02, 4.986776537709994e-02, 5.519618827185245e-02, 1.246394922405687e-01,  5.446851754767128e-02, 3.397006778065081e-01, 7.011487082537664e-02, -1.593775138443594e-02, -8.027658673112394e-02, 5.728692204998829e-02, 6.317634556702176e-02, -1.845938619333714e-02,  3.704315613069877e-02, 5.393117352268677e-02, 1.002975370769325e-01, 2.820199856252835e-02,  7.011487082537715e-02, 3.072087814101053e-01, -1.837366697732711e-02, -7.199044537460172e-02,  3.869771213901776e-02, 4.660357504513087e-02, 3.096627649715190e-02, -1.819637741675089e-02, -3.502425924158637e-02, -2.976580311896244e-02, -6.854672084245597e-03, -1.593775138443658e-02, -1.837366697732717e-02, 3.076709141425170e-01, 1.771643199886283e-02, -8.749320696979156e-03, -3.056127957677995e-02, 2.708481478722305e-02, -4.902860768931695e-02, -6.742936871576527e-02, -1.205030321733514e-01, -4.269913277056925e-02, -8.027658673112435e-02, -7.199044537460182e-02,  1.771643199886228e-02, 3.321492211348263e-01, -5.084426416430957e-02, -5.261904162712432e-02, -2.347771685136752e-02, 2.025503961935455e-02, 3.981927496646529e-02, 6.257857295736799e-02,  2.459299144440145e-02, 5.728692204998862e-02, 3.869771213901745e-02, -8.749320696979125e-03, -5.084426416430964e-02, 2.758550474755741e-01, 1.831827515882867e-02, -1.115128152387101e-02,  3.287053705347615e-02, 4.394857872272669e-02, 7.462593773993650e-02, 2.619566758472855e-02,  6.317634556702240e-02, 4.660357504513104e-02, -3.056127957678022e-02, -5.261904162712454e-02,  1.831827515882908e-02, 2.780015668591713e-01, 1.114211548864103e-01, -2.399928926091414e-02, -2.828986984391321e-02, -6.222978399477802e-02, -1.646364240712996e-02, -5.675906625253539e-02, -4.309215538316429e-02, 2.867344944225095e-02, 4.942298496366965e-02, -3.681800147927751e-02, -2.147173057938079e-02, -2.399928926091493e-02, 2.060781902131275e-01, 5.718245045545733e-02,  8.234028760059056e-02, 2.274157331259190e-02, 6.802117583422351e-02, 4.918612431099206e-02,
                  -2.577217614499525e-02, -6.518956442503082e-02, 2.839873829473931e-02, 4.486669727883986e-02, -2.828986984391510e-02, 5.718245045545697e-02, 3.124772023340016e-01, 1.151052830024976e-01,  2.078763135301624e-02, 7.190026055542048e-02, 6.170864173749108e-02, -4.768467593853856e-02, -8.267332714990777e-02, 4.635333682789083e-02, 5.890564518387092e-02, -6.222978399478021e-02,  8.234028760059003e-02, 1.151052830024976e-01, 4.602721830401089e-01, 1.112352798062510e-01,  1.886903560715905e-01, 1.432526953755671e-01, -3.741069474436348e-02, -1.682521078254163e-01,  8.740186256260274e-02, 1.082462739886592e-01, -1.646364240713192e-02, 2.274157331259106e-02,  2.078763135301453e-02, 1.112352798062496e-01, 3.648290739445044e-01, 9.294337448328535e-02,  5.916301075104423e-02, -7.045761316355646e-03, -7.293940929581150e-02, 4.173443888468617e-02,  4.336250466504591e-02, -5.675906625253979e-02, 6.802117583422274e-02, 7.190026055541970e-02,  1.886903560715899e-01, 9.294337448328648e-02, 3.930466927660730e-01, 1.026806176344502e-01, -2.237622124270744e-02, -1.171381022984787e-01, 7.647943558804163e-02, 8.830841621224775e-02, -4.309215538316384e-02, 4.918612431099179e-02, 6.170864173749141e-02, 1.432526953755670e-01,  5.916301075104499e-02, 1.026806176344508e-01, 3.325340972523350e-01, -2.064396582444325e-02, -9.393149006179685e-02, 4.963051923896519e-02, 6.323232705450513e-02, 2.867344944225139e-02, -2.577217614499543e-02, -4.768467593853909e-02, -3.741069474436415e-02, -7.045761316356610e-03, -2.237622124270833e-02, -2.064396582444350e-02, 3.241138515012848e-01, 2.638990071269764e-02, -1.223353860968905e-02, -3.954904036792264e-02, 4.942298496367144e-02, -6.518956442503043e-02, -8.267332714990822e-02, -1.682521078254162e-01, -7.293940929581279e-02, -1.171381022984792e-01, -9.393149006179702e-02, 2.638990071269690e-02, 3.653462182231922e-01, -6.427821666484021e-02, -7.431716763495816e-02, -3.681800147927735e-02, 2.839873829473909e-02, 4.635333682789075e-02,  8.740186256260235e-02, 4.173443888468661e-02, 7.647943558804202e-02, 4.963051923896483e-02, -1.223353860968888e-02, -6.427821666484021e-02, 2.878531831980042e-01, 2.871311992999054e-02, -2.147173057938107e-02, 4.486669727883992e-02, 5.890564518387156e-02, 1.082462739886598e-01,  4.336250466504665e-02, 8.830841621224844e-02, 6.323232705450535e-02, -3.954904036792281e-02, -7.431716763495838e-02, 2.871311992999098e-02, 2.996185764799277e-01 )
               , tolerance = 1e-06)

  expect_equal(c(fit$lag_one_cor),
               c(  1.291354907487104e-01, 1.367165253220436e-02, 6.377103496493168e-02, -2.713850538773270e-02,  -7.908164779750179e-02, -2.858109696804390e-02, -3.079201993233168e-03, -5.565337086442223e-02,  -1.949224743361964e-02, 4.166327909938982e-03, 1.374627197005648e-02, 1.384858762110340e-02,   7.822529451079530e-02, 3.260827572512458e-02, 3.330157723220588e-02, -4.034681115029457e-03,   1.853177788155577e-02, 2.274201877285169e-02, -2.120240999397914e-02, -3.047690533758286e-02,   1.802062168537765e-02, 1.763606852517010e-02, 6.527228197510904e-02, 3.228631683248581e-02,   1.499206666887788e-01, 3.892369722981977e-02, -4.774254202935778e-02, 1.755175735959478e-02,   3.436872198780772e-02, -6.291984408550595e-02, -6.005728050465139e-02, 2.749046841875910e-02,   3.803388937809946e-02, -2.830358644668687e-02, 3.158366687482873e-02, 3.718389729681361e-02,   1.766209306314006e-01, 5.414877793631663e-02, 7.698138391026371e-02, 6.626593410210005e-02,  -1.096391944128223e-02, -7.026071685451446e-02, 4.126339125236730e-02, 4.116445265938309e-02,  -8.201024047329183e-02, -4.419033058202577e-03, -4.830855581587429e-02, 5.514966314139694e-02,   1.532510232418497e-01, 5.021523319555447e-02, 2.305522291179828e-02, 4.801903816071131e-02,  -4.092669514288748e-03, 9.891318812580447e-03, -1.371415706372730e-04, -3.003818523118846e-02,   1.817302251129751e-02, 1.755276863602903e-02, 7.973455081919611e-02, 5.054170016288446e-02,   1.284017000866442e-01, 4.762861203904770e-02, -1.284833212463268e-05, -4.999655385991860e-02,   2.955947396543553e-02, 3.038269983314280e-02, -3.385945387964767e-03, 2.272020156194152e-02,   3.506824647529740e-02, 6.928682304413317e-02, 2.329593596303032e-02, 4.801314828905891e-02,   1.068787279568598e-01, -1.678064316149868e-02, -5.096440498896490e-02, 2.976324691405924e-02,   2.996404598157235e-02, -5.736898742753699e-02, -2.174131652340937e-02, -6.421797114440145e-02,  -1.358072902863536e-02, 4.733532436073291e-02, -1.274310543440687e-03, -1.754960416549582e-02,   1.147624510237752e-01, 3.726919602665114e-02, -1.634155403365111e-02, -2.416935841778206e-02,  -1.970238270400751e-02, -3.019708332997418e-02, -6.041186259581446e-02, -7.312195395711919e-02,  -4.411795504676703e-03, -5.005680001525114e-02, -5.045855888535600e-02, 3.599929745741667e-02,   1.285708684805613e-01, -3.501055389878537e-02, -4.005330623903801e-02, 3.959774295787784e-03,   1.791617601167220e-02, 2.771229001791248e-02, 4.315598965640619e-02, 1.022325578719900e-02,   2.977952594566998e-02, 2.964672026256594e-02, -1.562591348321014e-02, -3.516410961982341e-02,   8.512456299745330e-02, 1.940263875776680e-02, 1.404514251209198e-02, 1.761578629352489e-02,   3.854736704096862e-02, 4.320192781245620e-02, 5.850487225643203e-05, 3.063862437204921e-02,   2.988516990402513e-02, -2.358891861583658e-02, -4.035546525458460e-02, 1.947425964869793e-02,   8.804725678102265e-02, 1.099667820882783e-01, 1.446514109289120e-02, 6.000919286178950e-02,  -1.548022657023520e-02, -6.746020788097479e-02, -1.995679810560000e-02, 2.455616347298809e-03,  -5.100596364502235e-02, -2.303289075037387e-02, 6.795578651882516e-03, 1.576035422309921e-02,   1.491171859965126e-02, 8.544613010363289e-02, 5.660350878207020e-02, 7.213517664960932e-02,   5.559502643007858e-03, 4.585592517360471e-02, 4.833404895701760e-02, -3.426494132808686e-02,  -6.140943418461473e-02, 3.503273203973367e-02, 3.636672230735241e-02, 6.169306839187043e-02,   5.565810444564588e-02, 1.808458901663907e-01, 1.068126564236014e-01, -2.779582376954578e-02,   6.516084725975363e-02, 7.838531884627779e-02, -8.271455243725566e-02, -1.119236393518551e-01,   5.670352933043542e-02, 6.918069471402361e-02, -1.545721332001809e-02, 7.055522263566479e-02,   1.071013434276220e-01, 2.702408675474491e-01, 7.292069006219759e-02, 1.472464384716169e-01,   1.340420704392534e-01, -5.106583754189425e-02, -1.542256166544204e-01, 8.764201235965999e-02,   9.184804885073572e-02, -6.941340438990742e-02, 5.192721121899914e-03, -2.776955047360483e-02,   7.364591742994933e-02, 1.436520113273726e-01, 6.257013058898381e-02, 3.682138367015826e-02,   3.467571287587497e-02, -2.326744505718044e-02, 1.997701976570834e-02, 1.155784701402205e-02,  -2.046076547288124e-02, 4.540669451820673e-02, 6.626837419885408e-02, 1.493778599369434e-01,   6.286666004716954e-02, 1.692902644740740e-01, 9.436934283401498e-02, -2.806404407704938e-02,  -1.078064543015824e-01, 6.153760810759065e-02, 6.514222840119278e-02, 2.759899544328693e-03,   4.784987232522456e-02, 7.941088752798808e-02, 1.354942222259905e-01, 3.682128651088158e-02,   9.406917224948702e-02, 1.443073124745158e-01, -4.185002745788943e-02, -1.051860313682023e-01,   5.969995231539356e-02, 6.270883266080181e-02, -5.257136213526671e-02, -3.436011402703942e-02,  -8.375748358214334e-02, -5.236937913733120e-02, 3.435026045077857e-02, -2.855611238925401e-02,  -4.227197559353212e-02, 1.174781019889453e-01, 6.584020370063444e-02, -3.248315768471851e-02,  -4.129954277054237e-02, -2.398453366741980e-02, -6.112354058381191e-02, -1.136722447805614e-01,  -1.567101224182862e-01, -2.352073356878254e-02, -1.080285417782296e-01, -1.056615375584736e-01,   6.555928079042932e-02, 1.888366161428970e-01, -7.228012257657938e-02, -8.040611224779089e-02,   7.046420886651651e-03, 3.491230724203201e-02, 5.768312342385580e-02, 8.927967504689785e-02,   2.027168280564330e-02, 6.182371180945886e-02, 6.010059154107222e-02, -3.230384993944495e-02,  -7.240890925590092e-02, 9.877792778836691e-02, 4.202085113604918e-02, 1.645984973593604e-02,   3.608206737758191e-02, 7.007340039178192e-02, 9.291843160497690e-02, 1.153486822831095e-02,   6.499161515361637e-02, 6.274724939356918e-02, -4.107493307923356e-02, -8.013377477339130e-02,   4.178858090236712e-02, 1.052197641226942e-01, 9.580385405900435e-02, 1.418727991459177e-02,   5.607355872981781e-02, -1.008794116668616e-02, -6.009266428811302e-02, -1.575939024676214e-02,   4.582046857445694e-03, -4.710471610955869e-02, -2.361498440214090e-02, 7.556911244746173e-03,   1.603955423150859e-02, 1.418124564320530e-02, 8.256856220032061e-02, 6.231828369409792e-02,   8.297090921697474e-02, 8.924006061875876e-03, 5.404780670146360e-02, 5.546202776837981e-02,  -3.745135688351003e-02, -7.029217245500700e-02, 3.983078415887185e-02, 4.163487451540536e-02,   5.666558816561221e-02, 6.209151207424805e-02, 1.815621137792321e-01, 1.268569289492623e-01,  -1.919762532208245e-02, 8.007295759386618e-02, 9.101431288687764e-02, -8.637231526332240e-02,  -1.266468239543999e-01, 6.529790789557642e-02, 7.764764498373929e-02, -1.048183831508476e-02,   8.284278455081653e-02, 1.276269383391714e-01, 2.919312576705764e-01, 7.712931844874335e-02,   1.682866193758450e-01, 1.537863236418600e-01, -6.402057174055623e-02, -1.803210463467766e-01,   1.020824490959388e-01, 1.071073886754951e-01, -6.128180542259216e-02, 8.816759317223951e-03,  -1.912631976649991e-02, 7.749172104417971e-02, 1.321631821935714e-01, 6.486065433728301e-02,   4.043450143905361e-02, 2.817161789616027e-02, -2.971934702731426e-02, 2.312246721668258e-02,   1.541912409670556e-02, -1.639936728425104e-02, 5.431064484398980e-02, 8.107902470131939e-02,   1.695833762364396e-01, 6.515003489974518e-02, 1.763307309467531e-01, 1.081295275512801e-01,  -3.749869397280314e-02, -1.258531619115244e-01, 7.157247306303208e-02,
                   7.556347558665812e-02,   4.471567948589175e-03, 5.552479928094786e-02, 9.170912420534814e-02, 1.541546594830793e-01,   4.036109217962028e-02, 1.076096427091886e-01, 1.501099192896956e-01, -4.940727565753181e-02,  -1.214486069666459e-01, 6.864504016491946e-02, 7.223520029172507e-02, -4.776118411418508e-02,  -3.770965194692179e-02, -8.700403229196996e-02, -6.454090742394181e-02, 2.796147044964768e-02,  -3.767152781015549e-02, -4.964404212854985e-02, 1.115384818310612e-01, 7.399984440782936e-02,  -3.727541383458609e-02, -4.598530094553678e-02, -2.373480241121866e-02, -7.064708056848325e-02,  -1.279077061613744e-01, -1.814840722613465e-01, -2.991174498140400e-02, -1.257919277602640e-01,  -1.219019464165897e-01, 7.390232844918954e-02, 2.024592208011263e-01, -8.375051197866015e-02,  -9.224741354101534e-02, 7.454141664915092e-03, 4.005262393836831e-02, 6.600647570967844e-02,   1.029112735984757e-01, 2.333714375996522e-02, 7.165138101324528e-02, 6.899474360841309e-02,  -3.720343841750012e-02, -8.383911873293028e-02, 9.813414691261768e-02, 4.886677958403913e-02,   1.625714292906448e-02, 4.183434208538984e-02, 7.843343421544022e-02, 1.076557696759963e-01,   1.540155706377551e-02, 7.542065338595128e-02, 7.243333590125266e-02, -4.597458822668302e-02,  -9.219362742669568e-02, 4.877717505973561e-02, 1.054330118212000e-01, 8.431857718015340e-02,   1.319790773618851e-02, 5.148151856217900e-02, -7.715970394916491e-03, -5.421014324467038e-02,  -1.355835726720273e-02, 4.990181031060602e-03, -4.304473440708468e-02, -2.235003217221129e-02,   7.286815251722300e-03, 1.523782541963845e-02, 1.309994127410162e-02, 7.315089409590536e-02,   5.749533353392529e-02, 7.692689289281951e-02, 8.338118785743196e-03, 5.050478856030199e-02,   5.146919262245542e-02, -3.478831386829104e-02, -6.550158758757463e-02, 3.703080672059117e-02,   3.884178770665610e-02, 5.154649860075501e-02, 5.770925538449367e-02, 1.647261345876967e-01,   1.191243846124960e-01, -1.683347991664182e-02, 7.574142493883292e-02, 8.529649103560449e-02,  -8.016785573867444e-02, -1.186956085687691e-01, 6.135292040774105e-02, 7.274597930561433e-02,  -8.126086102704641e-03, 7.698243167364680e-02, 1.187189344387291e-01, 2.673396301958531e-01,   7.071088889396783e-02, 1.570004139147034e-01, 1.428630530753070e-01, -6.057556416000195e-02,  -1.686370121447761e-01, 9.551294197057940e-02, 1.000830623333905e-01, -5.480912838062069e-02,   8.173201872572370e-03, -1.728418781165460e-02, 7.047951293723725e-02, 1.177636106434026e-01,   5.936549959824289e-02, 3.681668095713467e-02, 2.532895853676774e-02, -2.738705512808928e-02,   2.130067776541324e-02, 1.411499394517187e-02, -1.403060600388677e-02, 5.065465048660969e-02,   7.559200212623721e-02, 1.574767311037139e-01, 5.975516931049518e-02, 1.606740575765581e-01,   1.005186297219738e-01, -3.571376190003595e-02, -1.176620396337518e-01, 6.699521345133536e-02,   7.051127930640079e-02, 4.807811046433075e-03, 5.163790390983680e-02, 8.526782520481968e-02,   1.432161079012625e-01, 3.707062442644989e-02, 1.004815074638706e-01, 1.362409847752809e-01,  -4.652091852111497e-02, -1.135740033446002e-01, 6.416591169860680e-02, 6.752644794358238e-02,  -4.322204670254099e-02, -3.503830163893949e-02, -8.041245917139422e-02, -6.111362149832814e-02,   2.499789251404973e-02, -3.605268996270677e-02, -4.674663817507405e-02, 9.997726244984273e-02,   6.945347481466480e-02, -3.506331666381086e-02, -4.316374153070604e-02, -2.219080329701551e-02,  -6.578010090575442e-02, -1.187554416788252e-01, -1.692690736228668e-01, -2.783009212420057e-02,  -1.178041533974273e-01, -1.136936470704210e-01, 6.920742077319211e-02, 1.858890001618820e-01,  -7.849674364962608e-02, -8.630851322821222e-02, 7.080047615750299e-03, 3.717550431240543e-02,   6.133072756196575e-02, 9.591988889443435e-02, 2.162176204649699e-02, 6.710970521368329e-02,   6.425426705403231e-02, -3.487686602771949e-02, -7.849554784698723e-02, 8.809632555292635e-02,   4.581863360836645e-02, 1.523619483285129e-02, 3.906240017014430e-02, 7.291085660998320e-02,   1.005481002361424e-01, 1.433931849767367e-02, 7.065030351376156e-02, 6.766514131840135e-02,  -4.310344024751119e-02, -8.641275755452113e-02, 4.587344236520911e-02, 9.505035548246676e-02,   7.151757743996826e-02, 1.131616346549501e-02, 4.419091584164853e-02, -6.524838781554448e-03,  -4.664680735021938e-02, -1.169712281443978e-02, 4.353965786510434e-03, -3.695986751676708e-02,  -1.921664646892108e-02, 6.164226001083427e-03, 1.318685404454260e-02, 1.112457321609451e-02,   5.903081213409012e-02, 4.471662077480057e-02, 5.802589466212532e-02, 5.029773003155704e-03,   3.803223615905515e-02, 3.922120675751248e-02, -2.755258581263797e-02, -5.028583243150487e-02,   2.843596255580652e-02, 2.986012880138798e-02, 4.379474056365592e-02, 4.452888652726582e-02,   1.320997460052210e-01, 8.810389047064529e-02, -1.816165631454061e-02, 5.550678733802726e-02,   6.443642601420180e-02, -6.462357352137976e-02, -9.125853999348582e-02, 4.670542054834714e-02,   5.620331324464663e-02, -7.064946828496222e-03, 5.765141590879653e-02, 8.797779244010084e-02,   2.043725623065878e-01, 5.429671181509396e-02, 1.186808405101208e-01, 1.076128741380446e-01,  -4.509389037832641e-02, -1.268025816178097e-01, 7.203633006291353e-02, 7.526573582598309e-02,  -4.684397217021381e-02, 4.748545601838431e-03, -1.858237868241200e-02, 5.382494856821073e-02,   9.850316622385680e-02, 4.658609767738169e-02, 2.742456504705999e-02, 2.358675743722154e-02,  -1.858529724824150e-02, 1.563183933965425e-02, 9.128928588644822e-03, -1.208440072734887e-02,   3.758541053335463e-02, 5.507912452504472e-02, 1.181313154411448e-01, 4.677023035842570e-02,   1.256369480214128e-01, 7.568495583580138e-02, -2.580680536220524e-02, -8.830439855803356e-02,   5.050533403495804e-02, 5.297786231167637e-02, 4.028004808848205e-03, 3.893677645083653e-02,   6.428957963060002e-02, 1.074518346771413e-01, 2.767493337776304e-02, 7.592166167088894e-02,   1.064608994595814e-01, -3.552694531955418e-02, -8.599238982172346e-02, 4.866832294889417e-02,   5.116146216024804e-02, -3.673383751175999e-02, -2.749202975997445e-02, -6.468822108541088e-02,  -4.527126942533980e-02, 2.330996221924847e-02, -2.610759579569688e-02, -3.566515700297459e-02,   8.274981420793370e-02, 5.418094198744298e-02, -2.702143759759779e-02, -3.388820423437473e-02,  -1.877151550150427e-02, -4.994869200180253e-02, -9.108419959385972e-02, -1.266586834967437e-01,  -1.895564087147553e-02, -8.863281045426903e-02, -8.601196534908760e-02, 5.400877211444313e-02,   1.447735537827531e-01, -5.963381438439377e-02, -6.586065473681252e-02, 5.818593491392382e-03,   2.820518307738407e-02, 4.648732119455503e-02, 7.190978974570553e-02, 1.589903505274131e-02,   5.066541564704343e-02, 4.863672467415751e-02, -2.683710850141104e-02, -5.955333695980877e-02,   7.037969657190113e-02, 3.471795605177087e-02, 1.295936973721851e-02, 2.968246691659166e-02,   5.615811705353854e-02, 7.521872577260635e-02, 9.331482483921811e-03, 5.319720882997445e-02,   5.120301657170975e-02, -3.382564297450641e-02, -6.590778530113700e-02, 3.479162053168958e-02,   7.583590939078588e-02, 5.791984180787881e-02, 9.648586685938499e-03, 3.654197040552237e-02,  -3.943663502464442e-03, -3.749654365029924e-02, -8.597622338520067e-03, 4.375546052993305e-03,  -3.025510071707339e-02, -1.650797259082604e-02,
                   5.427115973306466e-03, 1.129907743749987e-02,   9.368471680726558e-03, 4.558395431418827e-02, 3.280375235061789e-02, 4.062389512729597e-02,   2.066631810804381e-03, 2.626723163244798e-02, 2.774452907726770e-02, -2.063863343113840e-02,  -3.595872505171130e-02, 2.029374864935050e-02, 2.136678987056488e-02, 3.603562269607963e-02,   3.314736021217613e-02, 1.017017237387012e-01, 6.190156216126481e-02, -1.773802316306989e-02,   3.814616859577024e-02, 4.621641254161668e-02, -4.980221308095197e-02, -6.675721179659072e-02,   3.369045536774096e-02, 4.130685144189203e-02, -4.958713316381244e-03, 4.051243344763724e-02,   6.058862825930973e-02, 1.460320691252673e-01, 3.816010295784626e-02, 8.238469372117155e-02,   7.490738842967729e-02, -3.128470551603742e-02, -8.815469013342841e-02, 5.011828466645936e-02,   5.228684254686619e-02, -3.771021794450590e-02, 1.871976167540614e-03, -1.836832275685898e-02,   3.747856507785408e-02, 7.777884599847706e-02, 3.343835658969509e-02, 1.832863742721764e-02,   2.065230723132376e-02, -1.054559574415737e-02, 1.018436040782437e-02, 4.657144559126088e-03,  -9.374261804086927e-03, 2.590583900934318e-02, 3.672964021987699e-02, 8.159372095570500e-02,   3.376365837028029e-02, 9.159982329704935e-02, 5.235386893977226e-02, -1.700804867673338e-02,  -6.087750638132122e-02, 3.491947217433700e-02, 3.655186424954065e-02, 3.706584632937862e-03,   2.762193385578241e-02, 4.529500351550662e-02, 7.480644392614771e-02, 1.874570516306890e-02,   5.279699375696471e-02, 7.826978858368239e-02, -2.542421968002842e-02, -6.042061816789784e-02,   3.417834429304749e-02, 3.594029878872230e-02, -2.981838385568895e-02, -2.072762962253898e-02,  -4.958733187331650e-02, -3.189369662441750e-02, 2.022131251603409e-02, -1.772680187927171e-02,  -2.583713684315146e-02, 6.535641891581578e-02, 4.013605628080401e-02, -1.971271240355972e-02,  -2.525775459495967e-02, -1.554220373544576e-02, -3.593234884621367e-02, -6.579090420945813e-02,  -8.857126895487996e-02, -1.130330037440581e-02, -6.181344852223668e-02, -6.074183555868048e-02,   3.971589957080009e-02, 1.063527200847973e-01, -4.222072786647622e-02, -4.697345721097137e-02,   4.906000505515151e-03, 2.013886273576465e-02, 3.291988487104464e-02, 4.990965867752790e-02,   1.047895113255585e-02, 3.513485240573717e-02, 3.408181569548899e-02, -1.935409816110587e-02,  -4.188326966608898e-02, 5.321599709480263e-02, 2.433945654042703e-02, 1.078595143384104e-02,   2.131701431139981e-02, 4.070098576631245e-02, 5.238734216631429e-02, 5.018758462460013e-03,   3.700588095131314e-02, 3.604941657965530e-02, -2.501278793480264e-02, -4.689419285747805e-02,   2.449215983380754e-02, 5.737099473931473e-02, 4.526183618795351e-02, 7.665673844456873e-03,   2.881794450533345e-02, -3.261551181558353e-03, -2.943993539169638e-02, -6.954744281908863e-03,   3.332510664320255e-03, -2.364586283360819e-02, -1.264234446976078e-02, 4.148982808667660e-03,   8.740318400775104e-03, 7.870211904746594e-03, 3.508111791633567e-02, 2.643896928586018e-02,   3.203925799093428e-02, 1.368771702775891e-03, 2.046171359085945e-02, 2.184068729259849e-02,  -1.645618781151681e-02, -2.843651626509359e-02, 1.588828600289666e-02, 1.689323410839103e-02,   2.911207109824373e-02, 2.675291147832485e-02, 8.100908912970739e-02, 5.038551958944339e-02,  -1.380071935992088e-02, 3.063944653754757e-02, 3.732410096168766e-02, -3.981167486932103e-02,  -5.371483562182185e-02, 2.700894218446314e-02, 3.319930926471840e-02, -2.714879504075170e-03,   3.291387200211606e-02, 5.087070118370327e-02, 1.171012577721926e-01, 2.994395116357523e-02,   6.612574224829296e-02, 6.069556938805412e-02, -2.613831262943107e-02, -7.202302056748598e-02,   4.048809220015025e-02, 4.260456603547451e-02, -2.908567902687608e-02, 1.896159609204812e-03,  -1.312294659572445e-02, 3.059678783258753e-02, 5.983353310480471e-02, 2.685132540714765e-02,   1.511962138164331e-02, 1.529457310478570e-02, -9.624171902852172e-03, 8.529731055805274e-03,   4.378889913682506e-03, -6.725988002226430e-03, 2.103452539169030e-02, 3.086466525934096e-02,   6.617294965896443e-02, 2.655270867617384e-02, 7.189739940665063e-02, 4.226482670593843e-02,  -1.429253699764935e-02, -4.952472788650944e-02, 2.810299803194967e-02, 2.962247348233331e-02,   3.731520352054745e-03, 2.222399078365352e-02, 3.738280954828765e-02, 6.017273012669969e-02,   1.449489561861092e-02, 4.189606812479307e-02, 6.138237265917312e-02, -2.079751155459385e-02,  -4.871866560795293e-02, 2.726428077378021e-02, 2.890970194996781e-02, -2.362864005106328e-02,  -1.628808306141543e-02, -3.919992865659032e-02, -2.507955074823829e-02, 1.577895345918366e-02,  -1.367983931973828e-02, -2.021801519034482e-02, 5.028969918979309e-02, 3.131379127462802e-02,  -1.531589004208401e-02, -1.972284863380269e-02, -1.279109108752451e-02, -2.870610236706230e-02,  -5.332907080467029e-02, -7.111510341199508e-02, -9.004287142398839e-03, -4.896167659921236e-02,  -4.847857809227776e-02, 3.173608418265530e-02, 8.378487545860008e-02, -3.350762222466432e-02,  -3.747182468365355e-02, 4.336411044825361e-03, 1.604697214430402e-02, 2.685075929646135e-02,   3.991745613447397e-02, 8.098561936240400e-03, 2.772551954646455e-02, 2.710978569273923e-02,  -1.559670119436421e-02, -3.348818690576870e-02, 4.106793310141404e-02, 1.944437400023121e-02,   8.881334713834068e-03, 1.703689868373905e-02, 3.296346019347122e-02, 4.196906892182169e-02,   3.938498589532703e-03, 2.922059994576024e-02, 2.871475530940407e-02, -1.998943767608184e-02,  -3.743029092936706e-02, 1.942722596141690e-02, 4.450334433195047e-02, 3.374952902740708e-02,   5.050082128431718e-03, 2.060331689277165e-02, -5.166859784801608e-03, -2.294158168399699e-02,  -7.157786718291487e-03, 9.075929307689311e-04, -1.722160381753079e-02, -7.461935572840741e-03,   2.097625660506352e-03, 5.365035390822686e-03, 5.513925799914800e-03, 2.574702360620790e-02,   2.172770112056004e-02, 2.799939078528011e-02, 2.587713699706840e-03, 1.808714042631543e-02,   1.867774782646719e-02, -1.288394040216778e-02, -2.383874175848957e-02, 1.331300928569215e-02,   1.418633795451408e-02, 2.142924518576495e-02, 2.180366058061340e-02, 6.244956679203656e-02,   4.449725269249953e-02, -7.659260846523781e-03, 2.751254901736844e-02, 3.190070373418565e-02,  -3.077544542785869e-02, -4.443361076940713e-02, 2.273142878633470e-02, 2.736709973176323e-02,  -3.777016308489704e-03, 2.850216143121332e-02, 4.516708108414490e-02, 1.009248040258607e-01,   2.774915962582525e-02, 5.968718743546080e-02, 5.404406044043840e-02, -2.203605945164074e-02,  -6.366988391608662e-02, 3.580237413681729e-02, 3.767099473359063e-02, -2.245625257619361e-02,   3.115857182576079e-03, -6.730946762726534e-03, 2.883585483240454e-02, 4.468228073929204e-02,   2.411246673934965e-02, 1.479610485580221e-02, 1.001592199681206e-02, -1.148290721048316e-02,   8.629202603768166e-03, 5.815372984280978e-03, -6.267505375731669e-03, 1.852079178654301e-02,   2.810346575001847e-02, 6.000428064971010e-02, 2.351227652633714e-02, 5.915553599738910e-02,   3.765991325223197e-02, -1.247646840809078e-02, -4.387647454390040e-02, 2.487177333237116e-02,   2.617882578482999e-02, 1.758829090137245e-03, 1.893025439240607e-02, 3.219936064797254e-02,   5.387181533158165e-02, 1.406757597053815e-02, 3.735404331025927e-02, 4.939006570913140e-02,  -1.696704640001834e-02,
                   -4.215721194188733e-02, 2.360415456240009e-02, 2.501014583781767e-02,  -1.754698443741364e-02, -1.265648793700457e-02, -3.027446888209739e-02, -2.098211675123005e-02,   1.063398238415632e-02, -1.171505510698138e-02, -1.635921733106832e-02, 3.597363127652592e-02,   2.454961212450161e-02, -1.219995163416130e-02, -1.541741053566213e-02, -8.422921791655026e-03,  -2.396182174911071e-02, -4.444962945283139e-02, -6.297573984164766e-02, -1.049561870058876e-02,  -4.319863908174049e-02, -4.184802032160274e-02, 2.511476423558967e-02, 6.720920982768180e-02,  -2.858149699950673e-02, -3.165417411288931e-02, 2.687150372661513e-03, 1.346080248530041e-02,   2.290073954886267e-02, 3.560710037561211e-02, 8.095532038781553e-03, 2.461514609764216e-02,   2.355856811497433e-02, -1.260408186744463e-02, -2.874398382011796e-02, 3.114114176833455e-02,   1.677378883067963e-02, 5.962809375216370e-03, 1.430044264270208e-02, 2.745462002463862e-02,   3.735585669764093e-02, 5.231401432505755e-03, 2.584015355832465e-02, 2.489175748359811e-02,  -1.580240892841408e-02, -3.174130419923542e-02, 1.672270455934700e-02, 3.387814688997948e-02,   2.015553494417680e-02, 1.498051603830777e-04, 7.781901983050642e-03, -1.207842282551854e-02,  -1.646262879606590e-02, -1.035643989871081e-02, -5.061241148483150e-03, -8.129728567305324e-03,   2.036569671194324e-03, -2.374279217703511e-03, -7.085826787883547e-04, 1.347042682578348e-03,   1.466096178453147e-02, 1.315635097482339e-02, 1.994222512448881e-02, 3.977766290063798e-03,   1.322105700469680e-02, 1.285239679930916e-02, -7.140961031766277e-03, -1.574249129258771e-02,   8.915733655756500e-03, 9.377063150353700e-03, 9.841411938367024e-03, 1.265025762539207e-02,   3.429615905517266e-02, 2.815180351672951e-02, -1.592300688920885e-03, 1.786185733695275e-02,   1.950121223979696e-02, -1.645878618196831e-02, -2.623228939967354e-02, 1.370381549933955e-02,   1.613019182486603e-02, -8.510074949372212e-03, 2.074711863719666e-02, 3.105156786692313e-02,   7.516605075172447e-02, 2.557869838468413e-02, 4.721293815998900e-02, 4.143394474419600e-02,  -1.331571115024241e-02, -4.731382795328192e-02, 2.705146697129486e-02, 2.805840354252991e-02,  -1.551588757935644e-02, 4.992816634911831e-03, 5.608353379334911e-04, 2.797395791158165e-02,   2.942212577556130e-02, 2.173266116171036e-02, 1.529619103951681e-02, 4.185280278174920e-03,  -1.405852839520154e-02, 9.259343909888269e-03, 7.819669188649077e-03, -7.904275391086010e-03,   1.382917179021919e-02, 1.995173320897985e-02, 4.737451806899499e-02, 2.012538165588534e-02,   4.203275940927848e-02, 2.902419882064443e-02, -7.795373927727666e-03, -3.287238343469787e-02,   1.890274734491447e-02, 1.960704873871248e-02, -2.888755982024115e-03, 1.311246628717829e-02,   2.087171111359563e-02, 4.075909760949458e-02, 1.366607850062129e-02, 2.846645072119366e-02,   3.290224875759545e-02, -9.737063989194394e-03, -2.976563596628280e-02, 1.694712505446372e-02,   1.768337972464177e-02, -9.166150806703383e-03, -6.540556671940351e-03, -1.586491990798323e-02,  -1.082737620429092e-02, 5.541611287016619e-03, -6.037318428125004e-03, -8.419633353627273e-03,   1.845705363740568e-02, 1.266350368845964e-02, -6.315808118986953e-03, -7.975934564617353e-03,  -6.655046950655129e-04, -1.582717998465021e-02, -2.752505675294792e-02, -4.574656873769489e-02,  -1.182688033383124e-02, -3.167182166381874e-02, -2.932231576789505e-02, 1.409297974229392e-02,   4.282728383897327e-02, -1.966308069047947e-02, -2.127675010195338e-02, -9.045222284298320e-04,   9.011578594270283e-03, 1.449303023530546e-02, 2.635377853872278e-02, 8.090941092440504e-03,   1.835865335471602e-02, 1.680049542905349e-02, -7.137387149233699e-03, -1.978033640178132e-02,   1.888870580248520e-02, 1.161252521727385e-02, 8.632735253990085e-04, 9.415197813766903e-03,   1.686174826164533e-02, 2.711885010492831e-02, 6.519280817599043e-03, 1.889110500319378e-02,   1.741137182727849e-02, -8.798144096535026e-03, -2.125500276175013e-02, 1.153399728336401e-02,   2.027307245068471e-02, 1.255815682390278e-71, 3.120761776418009e-33, 1.690127438926339e-52,   4.912265739201736e-62, 1.902215771837895e-52, 5.393661190708595e-62, 1.085340706476527e-42,   9.936162325505692e-96, 3.312590664954794e-33, 1.900163900450744e-52, 1.052501767805360e-153,   5.351947576127021e-38, 4.668218491426767e-62, 1.052357246254430e-153, 3.697849833273314e-57,   4.664416511598012e-62, 6.983469604564070e-77, 1.086457829521457e-71, 3.124517446520080e-33,   3.242493677652463e-86, 9.342841564803921e-67, 9.748111629279019e-72, 3.242456763523555e-86,   1.176338272692646e-47, 5.052356831569520e-38, 1.303542889411395e-76, 1.451899249990556e-47,   7.274882192098185e-43, 9.157794221168820e-72, 1.040327401032651e-42, 4.277830253381361e-33,   1.107909194845775e-47, 6.376948037433556e-67, 8.237335405677582e-67, 1.518445854315186e-47,   2.212567631252691e-52, 1.724794811447078e-47, 9.502884875026563e-43, 4.178247210516979e-62,   9.460679430444847e-96, 1.177671486148602e-47, 1.086685824490272e-71, 1.052502905840542e-153,   7.411380980933923e-38, 5.393668768787828e-62, 6.031087448997035e-154, 1.484750269829285e-76,   1.917565462025514e-76, 6.983528800970507e-77, 6.233577342860076e-38, 2.526190095818157e-52,   3.242493737764453e-86, 1.176075172448171e-47, 4.428915318657021e-62, 8.542898680310068e-72,   4.468151593372282e-33, 6.529742386637435e-38, 5.598673946130844e-67, 1.918240147271236e-76,   1.369226701404989e-71, 3.933242668342010e-62, 1.030307178795165e-71, 6.817858336728757e-38,   1.086013903258649e-71, 3.505204276552980e-33, 3.939901041855018e-62, 1.369227544700779e-71,   2.175975792432583e-76, 9.466158710184285e-96, 1.426047488475309e-71, 1.084818621950479e-42,   1.133877932986181e-95, 1.039799169147766e-42, 2.901928657801332e-57, 1.052210433038925e-153,   1.693801134154597e-52, 1.831207750469144e-76, 6.983509189481825e-77, 9.508187747337720e-43,   2.631826414980142e-52, 6.963202151502050e-77, 1.178481696611200e-47, 2.633451349914981e-52,   3.242493701621548e-86, 1.030970422967065e-71, 5.883654843564788e-62, 1.303542889411237e-76,   7.863500170515321e-67, 4.851101169808982e-33, 6.372572635853265e-67, 1.144603401633844e-71,   6.006016191199658e-67, 3.501421881691988e-33, 5.396532203718659e-62, 7.862056789096939e-67,   2.316556667854196e-52, 7.117467141067880e-38, 8.164645055841699e-43, 7.867846675208436e-67,   1.370999706835655e-71, 8.988847343779327e-96, 7.494045288391175e-67, 2.525782258211839e-52,  1.051920240813697e-153, 1.658481712811537e-76, 7.488249721057524e-67, 1.051479798962229e-153,   2.422191456470816e-52, 1.657468364845901e-76, 6.983476245011538e-77, 4.766496306320301e-38,   1.086460420398843e-71, 3.242493665666822e-86, 1.744176599275764e-76, 5.648130486391129e-38,   3.242456763757097e-86, 7.114036745049700e-38, 5.637701078259308e-62, 8.542898680179066e-72,   4.665358650413291e-62, 1.830538274652635e-76 )
               , tolerance = 1e-06)

  expect_equal(c(fit$fixed_effects),
               c(numeric(0) )
               , tolerance = 1e-06)

  expect_equal(c(fit$n_iter),
               c(36 )
               , tolerance = 1e-06)

  expect_equal(c(fit$Q),
               c( 0.0964795586397352023, 0.0259710085813829594, 0.0861514873770032885, 0.0029785469393264685, -0.0734470904707218430, -0.0079444970056993143, 0.0158353085881218006, -0.0681145579444744076, -0.0434521946461296077, 0.0175192132183074854, 0.0281690836471839012, 0.0259710085813829594,  0.0996464398132242551, 0.1659505361229650089, 0.2473589265454134711, 0.0452645587982659359,  0.1650629200052342593, 0.1591209721999270466, -0.0912159272912944075, -0.1980155934583849864,  0.1090477037673234090, 0.1188116877424108264, 0.0861514873770032885, 0.1659505361229650089,  0.3266518405852698592, 0.4156326225594351165, 0.0411115600298587597, 0.2731191589419136312,  0.2739057723716057380, -0.1848525526016872589, -0.3522974676496112845, 0.1903634156141287281,  0.2126909305152624441, 0.0029785469393264685, 0.2473589265454134711, 0.4156326225594351165,  0.7289459364762441718, 0.1917722996321700735, 0.4896766359525511203, 0.4527342836286118444, -0.2114474186276086853, -0.5443981484716752250, 0.3040536984007380927, 0.3253368961717559849, -0.0734470904707218430, 0.0452645587982659359, 0.0411115600298587597, 0.1917722996321700735,  0.1202804592540232392, 0.1389976449393083291, 0.1092860975605699503, -0.0009562913284422634, -0.1113769181380047102, 0.0678987012286646485, 0.0646618746530431276, -0.0079444970056993143,  0.1650629200052342593, 0.2731191589419136312, 0.4896766359525511203, 0.1389976449393083291,  0.3428668290661150975, 0.3063117000530711787, -0.1361783902970406523, -0.3659489627974972792,  0.2050402671264349164, 0.2186242461621808464, 0.0158353085881218006, 0.1591209721999270466,  0.2739057723716057380, 0.4527342836286118444, 0.1092860975605699503, 0.3063117000530711787,  0.2943009075333152813, -0.1430448114450527108, -0.3483672334310296548, 0.1936649426609992619,  0.2084672949460005809, -0.0681145579444744076, -0.0912159272912944075, -0.1848525526016872589, -0.2114474186276086853, -0.0009562913284422634, -0.1361783902970406523, -0.1430448114450527108,  0.1201434794090666391, 0.1902046323264874328, -0.1012488369959617385, -0.1153711372898489351, -0.0434521946461296077, -0.1980155934583849864, -0.3522974676496112845, -0.5443981484716752250, -0.1113769181380047102, -0.3659489627974972792, -0.3483672334310296548, 0.1902046323264874328,  0.4378541003944985688, -0.2371403106609737965, -0.2580872211433691277, 0.0175192132183074854,  0.1090477037673234090, 0.1903634156141287281, 0.3040536984007380927, 0.0678987012286646485,  0.2050402671264349164, 0.1936649426609992619, -0.1012488369959617385, -0.2371403106609737965,  0.1393847966637638547, 0.1418929088018516249, 0.0281690836471839012, 0.1188116877424108264,  0.2126909305152624441, 0.3253368961717559849, 0.0646618746530431276, 0.2186242461621808464,  0.2084672949460005809, -0.1153711372898489351, -0.2580872211433691277, 0.1418929088018516249,  0.1627298447780431978 )
               , tolerance = 1e-06)

  expect_equal(c(fit$Q_0),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$n_risk),
               c(2027, 1978, 1915, 1980, 1912, 1863, 1802, 1661, 1621, 1535 )
               , tolerance = 1e-06)

  expect_equal(c(fit$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 )
               , tolerance = 1e-06)

  expect_equal(c(fit$risk_set),
               c(NULL )
               , tolerance = 1e-06)

  expect_equal(c(fit$data),
               c(NULL )
               , tolerance = 1e-06)

  expect_equal(c(fit$order),
               c(1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$F_),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$method),
               c("UKF" )
               , tolerance = 1e-06)

  expect_equal(c(fit$model),
               c("exponential" )
               , tolerance = 1e-06)

  expect_equal(c(fit$est_Q_0),
               c(FALSE )
               , tolerance = 1e-06)

  expect_equal(c(fit$LR),
               c(1 )
               , tolerance = 1e-06)
})


