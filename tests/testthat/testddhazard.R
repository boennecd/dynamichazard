if(interactive()){
  library(survival); library(dynamichazard); library(testthat)
  source("C:/Users/boennecd/Dropbox/skole_backup/phd/dynamichazard/R/test_utils.R")
} else
  options(warn = -1)

# Test on data set that is one of Farhmiers papers
result = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1, # Use by month intervals
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4),
  a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
  max_T = 45,
  id = head_neck_cancer$id, order = 1
)

# plot(result, cov_index = 1)
# get_expect_equal(result, file = "tmp.txt")

test_that("Testing previous computed values vs. current on head and neck cancer set assuming that the previous is correct", {
  expect_equal(c(result$state_vecs),
               c(-3.5045064165490518, -3.5045656499164295, -3.1329979343435461, -2.7762813620346121, -2.4920444550244687, -2.0475180974079015, -2.1188049966993696, -2.5082342056716649, -2.7400547989246267, -2.8849282879973148, -3.0253327692106984, -3.2406977640747754, -3.3657522145691128, -3.4217728641562681, -3.2739452065172792, -3.3169520925442670, -3.4384370809821552, -3.5426921460127447, -3.5025053437910434, -3.5883353594935170, -3.5579940746115737, -3.6815422153090513, -3.8600459984612017, -3.9790677778298500, -4.0362876817800135, -4.1737949093221500, -4.2663243629831635, -4.3146884533943091, -4.4617089602371571, -4.5811903147914004, -4.6725556962586463, -4.7359352412761311, -4.7714262957243081, -4.7789372894227720, -4.7581748229597807, -4.7086665843191895, -4.6297901735810880, -4.5207994729812713, -4.5209273736810847, -4.6295543473960477, -4.7237081990042649, -4.8005546281779816, -4.8594330723345767, -4.9032101303250126, -4.9320276910045253, -4.9459427144095427, 0.4622523023291275, 0.4622626844924319, 0.4652397589717921,  0.4740783791640956, 0.4672612377158187, 0.4836163262469676, 0.4896990261561225, 0.4863002013615905, 0.5055099547472884, 0.5138992180545477,  0.5195462743890488, 0.5209216389305817, 0.5293995373114516, 0.5447016176064285, 0.5624431287164163, 0.5625250853546695, 0.5619030953182752,  0.5668602203025682, 0.5730242083044264, 0.5781903092189493, 0.5842840398250273, 0.5778996254763145, 0.5761554595155960, 0.5747261154704411,  0.5736150619753867, 0.5773179176988464, 0.5813942440473051, 0.5858804824738809, 0.5952548377211626, 0.6050755551710356, 0.6153047774686421,  0.6259131746245181, 0.6368787546941960, 0.6481852747490043, 0.6598209416049969, 0.6717774284058471, 0.6840491395803701, 0.6966326585520586,  0.7028701970602720, 0.7026435197664337, 0.7024823951448731, 0.7023874356412544, 0.7023576772999551, 0.7023282335255832, 0.7022983939049023,  0.7022677820270420 ))

  expect_equal(c(result$state_vars),
               c( 0.24971481604065104, -0.04845111114383468, -0.04845111114383471, 0.10639152831379761, 0.16311419016912762, -0.05259256270700222, -0.05259256270700224,  0.09789681170500669, 0.15310383223295043, -0.05151399097432499, -0.05151399097432502, 0.09101731796320917, 0.13479229477473645, -0.04918940147026213, -0.04918940147026213, 0.08466734962518582, 0.11552947419685949, -0.04715973326374917, -0.04715973326374917, 0.07906340925166372, 0.10170593315556586, -0.04265467240609434, -0.04265467240609433, 0.07464409218421481, 0.08283283204131768, -0.03958875342966766, -0.03958875342966766, 0.07143014093146663,  0.08574743237753379, -0.03839075515247545, -0.03839075515247545, 0.07064371539854651, 0.09988559962713089, -0.03821046226156710, -0.03821046226156710,  0.07178361577151676, 0.11294823941314228, -0.03883277749515560, -0.03883277749515561, 0.07395046643986163, 0.12372876096303355, -0.03967075418430188, -0.03967075418430188, 0.07678826005975414, 0.13471675164657299, -0.04049594614565687, -0.04049594614565687, 0.08016446211107395, 0.15055875539669883, -0.04160790267880037, -0.04160790267880037, 0.08400586430581332, 0.16472177593961668, -0.04304400781965888, -0.04304400781965888, 0.08808479982944045,  0.17645575575408801, -0.04459796396982182, -0.04459796396982182, 0.09231756249871856, 0.17448916690674271, -0.04613087848951326, -0.04613087848951326,  0.09654727397268645, 0.17718203800291171, -0.04779606323864612, -0.04779606323864612, 0.10106119664367978, 0.18769088622561772, -0.04973601409705623, -0.04973601409705623, 0.10594721243974012, 0.20213723093262348, -0.05184855724861329, -0.05184855724861329, 0.11114422128391810, 0.21041663267921473, -0.05400173185964625, -0.05400173185964624, 0.11649745709426079, 0.22134939039718360, -0.05628334296113834, -0.05628334296113834, 0.12211582796072129,  0.22493462219519089, -0.05859873851338071, -0.05859873851338071, 0.12787957175843259, 0.23551328640885347, -0.06146059220632962, -0.06146059220632962,  0.13398312811521065, 0.25314128225693611, -0.06455439434660187, -0.06455439434660187, 0.14044073932175916, 0.27076904865840157, -0.06781819924878714, -0.06781819924878714, 0.14713904387168714, 0.28433525497363610, -0.07123289371385615, -0.07123289371385615, 0.15400961367578436, 0.30294835012113436, -0.07487234429905440, -0.07487234429905440, 0.16115504760087240, 0.32016040142844482, -0.07848373195886876, -0.07848373195886876, 0.16849145170033528,  0.33314708270447457, -0.08208776164140788, -0.08208776164140788, 0.17597734496306500, 0.35286329198897837, -0.08568163592163081, -0.08568163592163081,  0.18374253693804946, 0.37536940434514132, -0.08926715170003868, -0.08926715170003868, 0.19172907098000486, 0.39873630901420842, -0.09283743440897779, -0.09283743440897779, 0.19989975627046705, 0.42178611638715935, -0.09638204834799534, -0.09638204834799534, 0.20822832732644378, 0.44361733758340671, -0.09988908333111086, -0.09988908333111086, 0.21669518969646151, 0.46339438509377351, -0.10334609693208163, -0.10334609693208163, 0.22528520655358666,  0.48023997913036814, -0.10674058641935472, -0.10674058641935472, 0.23398639917058323, 0.49317130060577541, -0.11006025940374116, -0.11006025940374116,  0.24278911803014888, 0.50105573489729149, -0.11329321873365431, -0.11329321873365431, 0.25168548221153902, 0.50172607734539709, -0.11631830554913909, -0.11631830554913909, 0.26066293360741083, 0.50678929708482690, -0.11934048900315548, -0.11934048900315548, 0.26986042363554874, 0.53530791125108756, -0.12262821748386488, -0.12262821748386488, 0.27950428218778706, 0.58183228951032062, -0.12605788915437280, -0.12605788915437280, 0.28951529241594171,  0.64601004887201596, -0.12955062384606128, -0.12955062384606128, 0.29984925590669426, 0.72461186953629142, -0.13339769709753874, -0.13339769709753874,  0.31041514122822839, 0.82102801119622204, -0.13755295184677210, -0.13755295184677210, 0.32120094422203299, 0.93944483420711966, -0.14198397121295389, -0.14198397121295389, 0.33219697935406944 ))

  expect_equal(c(result$lag_one_cor),
               c( 0.14247809998101518, -0.04562454466206545, -0.05137802355748031, 0.09661104516862873, 0.10431362943324185, -0.04861031163654034, -0.05074624825748811,  0.08896805870054486, 0.09184477343957012, -0.04743564248174101, -0.04837237729819202, 0.08237231450353649, 0.07601053577622742, -0.04523440016109591, -0.04610259157952361, 0.07641902858491645, 0.06272959197830691, -0.04314963214418981, -0.04149989910911214, 0.07143641724934291, 0.04976314071924333, -0.03916616402682748, -0.03796388995851814, 0.06764392356351839, 0.04412181515863559, -0.03676686921781388, -0.03617305844996195, 0.06566569856513924,  0.04957618738263997, -0.03610726607094485, -0.03558333714932022, 0.06583974493543014, 0.05977040559634353, -0.03627850990537859, -0.03594986614217178,  0.06748169847710267, 0.06933620537347324, -0.03710285749548425, -0.03665274888804125, 0.06997113416459577, 0.07835041829150659, -0.03807033153789197, -0.03741195048487035, 0.07306468068633712, 0.08971951983285176, -0.03901663691773311, -0.03845755873594103, 0.07666004173543133, 0.10299946280000147, -0.04022328696742932, -0.03983256037270591, 0.08060952649316513, 0.11472344003258168, -0.04171276859073255, -0.04135647882496760, 0.08475620286942620,  0.11929227532729340, -0.04329940686768807, -0.04286793534146173, 0.08898074017370550, 0.11967540016361046, -0.04488290770616960, -0.04448705764347778,  0.09334307202317987, 0.12568799875170755, -0.04662517968415156, -0.04635577675471133, 0.09803273950070884, 0.13717177867555602, -0.04863182306761198, -0.04841087627937196, 0.10306490538053203, 0.14787275866788996, -0.05078981599588300, -0.05052653767995336, 0.10833293871056307, 0.15688588300380527, -0.05299687476906442, -0.05275883302813247, 0.11381078752011181, 0.16381944021995298, -0.05532004348347869, -0.05503651955148272, 0.11949570041494442,  0.17051149493688239, -0.05773754566103760, -0.05778598536145362, 0.12542132497706640, 0.18385072540899211, -0.06067590518220634, -0.06079972229048869,  0.13169401330722136, 0.20073896438601183, -0.06383554630746020, -0.06399621816514178, 0.13826573627697758, 0.21582321355091066, -0.06715950643846504, -0.06734839553409373, 0.14504508730574223, 0.23131933064088409, -0.07064253158215336, -0.07091460605645269, 0.15204715886760278, 0.24872592002361732, -0.07432234658493433, -0.07448779301050570, 0.15928339919198167, 0.26347881361450842, -0.07797287647187855, -0.07805429107428290, 0.16669060905090019,  0.27935516487531376, -0.08161324395427487, -0.08161445490217697, 0.17431105697061813, 0.29995728123175835, -0.08524123058740807, -0.08517037467433741,  0.18218269157975328, 0.32242897694333783, -0.08885610101288860, -0.08871628145675733, 0.19025769757665478, 0.34523646505841404, -0.09245061048291603, -0.09224163126186219, 0.19850420429615567, 0.36734292418109626, -0.09601464025775200, -0.09573402310310439, 0.20689918554441644, 0.38787792059071813, -0.09953681717678085, -0.09918041114666822, 0.21542520575241722, 0.40598228901295108, -0.10300530125416135, -0.10256766158851258, 0.22406865406081064,  0.42072371232757272, -0.10640821139739171, -0.10588284283039759, 0.23281867490497415, 0.43104305315679342, -0.10973388919853261, -0.10911340663694469,  0.24166647006743927, 0.43529495773743460, -0.11295793488214806, -0.11215243995070286, 0.25060184368002730, 0.43813459195398868, -0.11600224349998906, -0.11515841556353090, 0.25968666926394418, 0.45454851714255162, -0.11908680839297911, -0.11838596957059258, 0.26910284377369931, 0.49138481513646687, -0.12241919814228926, -0.12177557663990653, 0.27892658589834357, 0.54588612234346912, -0.12587850632515779, -0.12524485231908417, 0.28909589138451325,  0.61648577322801246, -0.12942828014459670, -0.12903240981596598, 0.29954356460855475, 0.70313264063392933, -0.13332903190180437, -0.13313154049538278,  0.31021736361643093, 0.80959999753414891, -0.13753564955227368, -0.13750879820300663, 0.32110641441598070 ))

  expect_equal(c(result$order),
               c(1 ))

  expect_equal(c(result$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result$method),
               c("EKF" ))

  expect_equal(c(result$model),
               c("logit" ))

  expect_equal(c(result$est_Q_0),
               c(FALSE ))

  expect_equal(c(result$LR),
               c(1 ))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result$Q_0)), rep(c("(Intercept)", "group1"), 2))
})

suppressMessages(
  result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 1,
    a_0 = rep(0, 2), Q_0 = diag(1, 2),
    Q = diag(1e-3, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential"))

# matplot(result_exp$state_vecs, type = "l")
# plot(result_exp, cov_index = 1)
# get_expect_equal(result_exp, file = "tmp.txt")

test_that("Result of exponential model on head_neck_data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.746423060135996685, -3.746504060013073900, -3.411975048951466860, -3.123640371003203242, -2.982809608911737520, -2.590346163235035526, -2.707462197276075067, -3.063090315919674733, -3.210805574368385873, -3.315742889070746102, -3.426247363612953123, -3.615220620358764236, -3.697315516637163402, -3.694960055771935981, -3.514271049590928619, -3.583085023499657851, -3.710830938614790853, -3.795127010362230990, -3.748048132503383201, -3.815987456462097249, -3.777482704888463161, -3.920316568467759666, -4.088637675068001798, -4.201323487740026508, -4.259461256379053040, -4.367477036724612738, -4.433043652875148233, -4.459456746007150585, -4.550360855046704067, -4.610000022861876268, -4.639325243012230260, 0.267804490680041141, 0.267771787453442156, 0.403121813911384685, 0.520049844804208572,  0.576160248484232418, 0.735892530651090726, 0.689094230510559402, 0.545630086365206601, 0.487798497798527519,  0.446442789310776300, 0.402597030242301868, 0.326664433404419530, 0.294377499738915582, 0.296650845900248650,  0.371113979808708139, 0.343329377363240540, 0.291614728358585928, 0.257804270528158685, 0.277126693289556969,  0.249812884521956741, 0.265542761334367383, 0.206999786494018956, 0.138432166714767713, 0.092322841165753983,  0.068242479179494192, 0.024306252492979658, -0.002487643961411226, -0.013462865355197196, -0.050190793123115238, -0.074287656203643360, -0.086136417649086819 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.220295737757598364, 0.030605438335697444, 0.030605438335697410, 0.107887831584073779, 0.145517332013094386, -0.001660812188336636, -0.001660812188336663, 0.093157593036923003, 0.138465436387046198, -0.005483167613022810, -0.005483167613022810, 0.090459598666057905, 0.121190284462693143, -0.013473739641127053, -0.013473739641127053,  0.086110274476198068, 0.101662279453035381, -0.022908096953915380, -0.022908096953915352, 0.081038208697458758,  0.095867522458459364, -0.023885306692934857, -0.023885306692934843, 0.080689754615085069, 0.077456526357003314, -0.030960843306268769, -0.030960843306268776, 0.077602255823180491, 0.082455078200529969, -0.027693058748322806, -0.027693058748322806, 0.079340402366294610, 0.097620413611103074, -0.019611163477797986, -0.019611163477797990,  0.083536337148846770, 0.108527839469235637, -0.013899742692818465, -0.013899742692818469, 0.086642393140734547,  0.117270064414540853, -0.009209497548788718, -0.009209497548788718, 0.089378028472115539, 0.126593308401248106, -0.004213354226871995, -0.004213354226872004, 0.092352613543143031, 0.142056902973380222, 0.003246515045985453,  0.003246515045985445, 0.096393662153779189, 0.154670481364136941, 0.009174882144043255, 0.009174882144043245,  0.099714166376657809, 0.162243181462978447, 0.012759067407502343, 0.012759067407502333, 0.102003897171627778,  0.154263017275540815, 0.009671257575669605, 0.009671257575669601, 0.101468499748081642, 0.156268829056957770,  0.010708150500953185, 0.010708150500953181, 0.102691939758461775, 0.167351999992699452, 0.015510896273943500,  0.015510896273943500, 0.105530910705355946, 0.180549724125395994, 0.021142568352647155, 0.021142568352647155,  0.108735832386015252, 0.186676114925689196, 0.023696715611691128, 0.023696715611691115, 0.110636132361143863,  0.195132553747604187, 0.027239491848385596, 0.027239491848385589, 0.112988513500728624, 0.195802238977011434,  0.027491757655777889, 0.027491757655777889, 0.113976217186229828, 0.207695680825756651, 0.032192216268221538,  0.032192216268221538, 0.116764105693921788, 0.227752670178947458, 0.040306746418476834, 0.040306746418476841,  0.121009914489442844, 0.249896037576859964, 0.049182391963886199, 0.049182391963886199, 0.125552580822571369,  0.271761552831857933, 0.057783298444313118, 0.057783298444313125, 0.129935708438214170, 0.302118813679059628,  0.069780714362332324, 0.069780714362332324, 0.135696484455231470, 0.338266746322974599, 0.084091957207221874,  0.084091957207221874, 0.142395942290244937, 0.380742938825434474, 0.100879963944609241, 0.100879963944609241,  0.150075305372945611, 0.444466596145961845, 0.126328250804517594, 0.126328250804517594, 0.161299161876744979,  0.531999976361760107, 0.161392148387444728, 0.161392148387444728, 0.176418095681750153 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.1305325959145391401, -0.0052089493607540005, -0.0075031383850821254, 0.0913894897083526447,  0.0978591671701529719, -0.0203818557153340740, -0.0217058587265687997, 0.0840417484078850863,  0.0871027536984031736, -0.0257103145416465728, -0.0270369347110312741, 0.0807535655006016984,  0.0718754960063896775, -0.0328829066769174838, -0.0346988450625990152, 0.0765703420196387208,  0.0627463772255224816, -0.0380957795304226049, -0.0370147748087408940, 0.0744469988478002331,  0.0534583084677090065, -0.0405388837288346293, -0.0403445344437134978, 0.0731890515377511819,  0.0492705124425093788, -0.0419124943754746807, -0.0407381623848610819, 0.0729254967945892063,  0.0550904854250336071, -0.0383720391423312823, -0.0364043474808718667, 0.0751809590749499268,  0.0646818331428645754, -0.0325943697662127510, -0.0311966214735018461, 0.0782561372934883481,  0.0724141563043191466, -0.0281991686317177859, -0.0268963176343049726, 0.0808251541224896952,  0.0797804455158117320, -0.0240883035819247394, -0.0226807861152099471, 0.0833984369065282755,  0.0902067802073275721, -0.0186637920628184469, -0.0172526313929301685, 0.0865748968915695943,  0.1027570922706346063, -0.0123996890580447237, -0.0113394853623166661, 0.0900044737507146586,  0.1120009335986826282, -0.0078479199412655951, -0.0070686026884887627, 0.0926644515694674403,  0.1117860758338085070, -0.0074278045023624222, -0.0069996600687590102, 0.0935353100172285346,  0.1090682377854654689, -0.0083926588204123603, -0.0078661373535679618, 0.0939187007809823837,  0.1149373780978811960, -0.0057987580848425629, -0.0051664548099843565, 0.0958339263893257659,  0.1261263964700668483, -0.0009589618233260475, -0.0003402549749295623, 0.0986949390220481504,  0.1352455177154054111, 0.0030161712941791340, 0.0034358957759992211, 0.1011546983856754234,  0.1420277061961444098, 0.0058339854340718825, 0.0063086834872375895, 0.1031939260325812069,  0.1462827175433172588, 0.0076741504403399670, 0.0080231553129095634, 0.1048109280062911042,  0.1519411620999118750, 0.0099438566889990775, 0.0102138377293466698, 0.1065951511291503562,  0.1666176315574199596, 0.0157746850138400854, 0.0161617988331630089, 0.1098988259206332418,  0.1861105705246031139, 0.0236658863932852279, 0.0239801696551823554, 0.1140313793266586884,  0.2061226601364018196, 0.0316856421716713785, 0.0318505732990983503, 0.1181718022908323784,  0.2291563181873806088, 0.0407703658724542367, 0.0409050349545056896, 0.1227457246785957634,  0.2579916680449954036, 0.0521672187956483610, 0.0522803526400809973, 0.1282610941675531024,  0.2909946363023212523, 0.0652236088850460527, 0.0652628459816799733, 0.1344287983185117885,  0.3343093943042159122, 0.0823757397213063791, 0.0824808492832314333, 0.1422924071107838917,  0.3955358834641173882, 0.1068421339980925033, 0.1069341324460411774, 0.1531238112710233690 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(72 ))

  expect_equal(c(result_exp$Q),
               c(0.11712173734693690, 0.04695251832094549, 0.04695251832094549, 0.01990459209039402 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(0.0877914951989026 ))
})

test_that("exponential model and logit moels hazzard functions differs", {
  expect_true(result_exp$model != result$model)
  expect_true(toString(body(result_exp$hazard_func)) !=
                toString(body(result$hazard_func)))
  expect_true(toString(body(result_exp$hazard_first_deriv)) !=
                toString(body(result$hazard_first_deriv)))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result_exp$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result_exp$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result_exp$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result_exp$Q_0)), rep(c("(Intercept)", "group1"), 2))
})


# Change by argument
suppressMessages(result_exp <- ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 2, Q_0 = diag(1, 2),
  Q = diag(1e-1, 2),
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-3),
  max_T = 30,
  id = head_neck_cancer$id, order = 1,
  verbose = F,
  model = "exponential"
))

# matplot(result_exp$state_vecs, type = "l")
# plot(result_exp, cov_index = 1)
# get_expect_equal(result_exp, file = "tmp.txt")

test_that("Result of exponential model on head_neck_data match previous results with altered by argument", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.87037427961885383, -3.87023087984429326, -1.91221037934947025, -2.43862280740296100, -3.22165530139148526, -3.30681140748686797, -3.89651206337075617, -3.63305833903981856, -3.53490169069086635, -3.92811419830653863, -3.83445633104215533, -4.08572279262521310, -4.38977418588174118, -4.59111421278896614, -4.26627051055878859, -4.65585179523574677, 0.25164279033439135, 0.25144509924460229, 1.37673532204583315, 1.01993204104296042,  0.53459101788916963, 0.54030801834951736, 0.19704401242214445, 0.43237882659576832, 0.45550100210285527,  0.22267296417307317, 0.25618524455277258, 0.00618157586681295, -0.22706286691347843, -0.37988354475124742, -0.23811812709966915, -0.45275960647321628 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.441292543450496955, 0.119914593826589019, 0.119914593826589033, 0.293711418856185458, 0.153610075857844225, -0.028908871706440492, -0.028908871706440492, 0.156586679956091435, 0.173792970426504961, 0.004791443767631409,  0.004791443767631437, 0.141115685933586310, 0.055149694875353913, -0.046529344162667019, -0.046529344162667019,  0.067349697349126936, 0.075678008174908079, -0.038645834720671388, -0.038645834720671381, 0.085822125254475176,  0.132443974179516144, -0.014948731361429442, -0.014948731361429435, 0.129403658956841972, 0.155750605430720168, -0.014692267525394792, -0.014692267525394792, 0.157893280988063045, 0.254860141089101100, 0.034077493139793191,  0.034077493139793191, 0.222756109854566703, 0.238890329496455001, 0.004944733239908717, 0.004944733239908720,  0.232124143223547630, 0.226881610397214217, -0.020933213616808371, -0.020933213616808360, 0.247184584339527252,  0.334349783425151426, 0.024953265993933792, 0.024953265993933771, 0.318490259893117411, 0.340131045559659451,  0.003272646957310301, 0.003272646957310294, 0.348947458402341093, 0.415849736184024044, 0.030333279839828829,  0.030333279839828808, 0.421743984834121899, 0.523382410162643530, 0.072540529768555781, 0.072540529768555739,  0.509325662871255580, 0.641622171871534919, 0.114835421711122015, 0.114835421711121988, 0.599146059513987028,  0.618035296626318953, 0.065811216941824985, 0.065811216941824985, 0.632932302407492875 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.10200382443452685, -0.04571589452880667, -0.05083395148578548, 0.13442239936127454, 0.06035462774283284, -0.04979102175280423, -0.05155823760870992, 0.09270295856323763, 0.03712398729936267, -0.04078366544120141, -0.04690857804759244, 0.05834357792228553, 0.03225048889196058, -0.04068258137312888, -0.03764188588715757,  0.04921007496276691, 0.03774942080843696, -0.04664174346994628, -0.04125586603008025, 0.06532073057893037,  0.05081104228755204, -0.04943994252619141, -0.04680513527685709, 0.09000025813177906, 0.07154819378921567, -0.05108515253310515, -0.04463860675610858, 0.12015084187547252, 0.09629910216893048, -0.04578547530236746, -0.04813716112477871, 0.15067548841267339, 0.09391302444910532, -0.06611524013466885, -0.06657478927713116,  0.16580374647646218, 0.11744037359727003, -0.07184904079874951, -0.06702917474526374, 0.19814277709906072,  0.15664336724252381, -0.06536520591652244, -0.06565715574900269, 0.24087661449129624, 0.18956975446789501, -0.06951695680969300, -0.06103640411174969, 0.28634704100628644, 0.30368102033354683, -0.01795183767719585, -0.00964876074475577, 0.37111142407645392, 0.64812791793174362, 0.16667993986692364, 0.17364424794121208,  0.53733278737797563, 1.55191487037745812, 0.67312143735963870, 0.67754892293272584, 0.89037289933934638 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(16 ))

  expect_equal(c(result_exp$Q),
               c(0.3409762050461504, 0.1803436136440473, 0.1803436136440473, 0.1426526945307628 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(0.1316872427983539 ))
})

# for(s in sample.int(1e6, 100, replace = F)){
# print(s)
# set.seed(s)
set.seed(599479)

sims <- test_sim_func_exp(n_series = 1e3, n_vars = 10, t_0 = 0, t_max = 10,
                          x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                          intercept_start = -5, sds = c(.1, rep(1, 10)))
# tmp_file <- file("exponential.log")
# sink(tmp_file)
suppressMessages(result_exp <- ddhazard(
  formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
  data = sims$res,
  by = (by_ <- 1),
  Q_0 = diag(10, 11),
  Q = diag(1e-2, 11),
  control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^3),
  max_T = 10,
  id = sims$res$id, order = 1,
  verbose = F,
  model = "exponential"))
# sink()
# close(tmp_file)

# matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
# matplot(result_exp$times, result_exp$state_vecs, result_exp$state_vecs, type = "l", lty = 2, add = T)
# get_expect_equal(result_exp, eps = 1e-5, file = "tmp.txt")

if(!interactive())
  test_that("Deal with lag one co-variance in EKF + exponential model!",
            expect_true(F))

test_that("Result of exponential model on simulated data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-5.188203295858222042, -5.192867919169898094, -4.310316958425439715, -4.336320945330846222, -4.064762463526304437, -4.470068713489812495, -4.278183682563193813, -4.738207889373453163, -5.080239744824088355, -4.330098903059813154, -3.512832514783392313, 0.903535714308593918, 0.894331964133800561, 1.816929462718155142, 0.620636215330882868, -1.210916388947183453, -2.124633635549365795, -2.018309280940417949, -2.663985587934378785, -2.388579061828196348, -1.695473603518183658, -0.908981390672407796, -1.764398534960296638, -1.783669340597084485, 0.613675018496285141, -1.259230230844413434, -3.749789731748256916, -5.281844649984472007, -4.760451807749158881, -5.760598422852969414, -4.862687284882237115, -3.721453497357167350, -2.131048877181849210, 0.646734126164619449, 0.645014594742284952,  0.674528187264348711, 0.525849444022213341, 0.419254877067003873, 0.119506867082035007, 0.344312436531998556, -0.151188667141975652, -0.984275580736283739, -0.147218581461528275, 0.643775114143569249, 0.903078090752215124,  0.906729758787989892, 0.869950217759679956, 1.595274505346900407, 2.797467744558432390, 3.253341266223266803,  3.096065389005932644, 3.496517930806801733, 3.662144599252522337, 3.192325862453184726, 2.735585334977329808,  0.678519650708181765, 0.678283654429648220, 0.307016411703131709, 0.022340565125074319, -0.486681248517496334, -0.760715580711739725, -0.664154943419190902, -1.102134793443673821, -1.900241848609568907, -1.240890040051801702, -0.694924949031594075, -0.520770279577914441, -0.521900942890573538, -0.531901667471322948, -0.584528090136232525, -0.547787771140243018, -0.717278086797987546, -0.478133042485134219, -0.786054878228679588, -1.427949733333044646, -0.838069475769509964, -0.265493352688137230, 0.051633853669528731, 0.037845740492234659, 2.924056990572987402,  2.377243559493144698, 2.098266161187867684, 1.786915474205531540, 1.968123287727698845, 2.491452526580773430,  5.761100690828738990, 4.585940059361372612, 3.944717989283841320, 1.113496343379008380, 1.109175268779626355,  1.999820516717627950, 1.860492444907890119, 1.863381980316567210, 1.696891414664366993, 1.769589769007558377,  1.745902104086367590, 2.445779023827046927, 2.361342564113131814, 2.383779024039542449, 1.713304661384221772,  1.717483031231116231, 0.609252124153554675, 0.676695613135207874, 0.634783559424135002, 0.517114549821963809,  0.547429584398183788, -0.011728153257258622, -1.912657666273230195, -0.887684276927991345, -0.007803321122974438, -1.986860410843613423, -1.973053825621926993, -5.027206005632039343, -4.593177841377539039, -4.503053956458455076, -4.187297705728798114, -4.284967037244340027, -4.835946927079818991, -8.222364049774895989, -6.998889221581012343, -6.308863713569206944 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$state_vars),
               c( 0.3564718209647352865, 0.1502042108545438848, 0.3949362494855248595, 0.2124595209322067413, -0.0476819667674404646, 0.1018442896498744504, 0.1609053367419655267, -0.0551357559837619485,  0.0553818409885371565, 0.1688038124507954263, 0.0525114410273263485, 0.1502042108545438848,  0.8663100540189390131, 1.2243281841372029017, 0.1855384361571849883, -0.4604454500014331653,  0.2503434462059512811, 0.0944020402948364534, 0.1617109294087489546, 0.0776916954361121792,  0.0888071993212603689, -0.1143341085457198342, 0.3949362494855247485, 1.2243281841372029017,  2.2197518498388131292, 0.3452033531635448904, -0.6782092839561278952, 0.3280807046148012107,  0.2242126480805420596, 0.5936128917560727913, 0.2212026029497712876, 0.0388679022587088835, -0.5096810431421557874, 0.2124595209322067413, 0.1855384361571850715, 0.3452033531635449459,  0.3066692478863988214, -0.1342364305139721325, 0.1881638378090466635, 0.1847533401768684524, -0.3227674414196349817, -0.0196826386375874331, 0.3038689827745920113, 0.3428542682694438182, -0.0476819667674404438, -0.4604454500014334428, -0.6782092839561280062, -0.1342364305139721325,  0.3831971041731261352, -0.1983124470282424667, -0.0893577393272062814, 0.0735754083882483173,  0.0081059966737519681, -0.1278031294679441432, -0.1368207672945087050, 0.1018442896498744088,  0.2503434462059513921, 0.3280807046148014328, 0.1881638378090466912, -0.1983124470282425222,  0.2648395318915124363, 0.1292535636669398247, -0.3767381053890948017, -0.0608516892457050609,  0.2841805186090277102, 0.4130142849545426764, 0.1609053367419656100, 0.0944020402948365228,  0.2242126480805420874, 0.1847533401768683692, -0.0893577393272062537, 0.1292535636669398247,  0.2069051716891880943, -0.2328161296450839690, -0.0222871352651428378, 0.2155878130752736654,  0.2582611382948359346, -0.0551357559837620109, 0.1617109294087490379, 0.5936128917560725693, -0.3227674414196348707, 0.0735754083882483173, -0.3767381053890944687, -0.2328161296450839690,  1.6980868970208273794, 0.3741475264367888909, -0.8838837043260465709, -1.6803768439410917690,  0.0553818409885371774, 0.0776916954361122347, 0.2212026029497712598, -0.0196826386375874261,  0.0081059966737519508, -0.0608516892457050332, -0.0222871352651428378, 0.3741475264367889464,  0.1742668935710796063, -0.1701766214639477137, -0.3943139678935742021, 0.1688038124507953985,  0.0888071993212603827, 0.0388679022587088488, 0.3038689827745921224, -0.1278031294679440877,  0.2841805186090277102, 0.2155878130752736099, -0.8838837043260469040, -0.1701766214639477137,  0.6422702852407251584, 0.9143797346648711022, 0.0525114410273262791, -0.1143341085457198758, -0.5096810431421558985, 0.3428542682694437627, -0.1368207672945086495, 0.4130142849545427874,  0.2582611382948359346, -1.6803768439410924351, -0.3943139678935742576, 0.9143797346648711022,  1.8316815271254398567, 0.0755229691425798877, 0.0150403026074210494, 0.0638946375928686194,  0.0351240106431329885, -0.0074949398183738331, 0.0161304587455404769, 0.0321454487166744976, -0.0236149149571044485, -0.0005326541614235347, 0.0288320307999519188, 0.0337315221568559587,  0.0150403026074210772, 0.2981174558699241084, 0.3228304959990835332, 0.0344953129534601097, -0.1372271092678233328, 0.0742397421708959060, 0.0063403885773025415, 0.0257094615546330924,  0.0148061443669236445, 0.0227934942289047676, -0.0156411384901818454, 0.0638946375928686056,  0.3228304959990835332, 0.6196144957630375094, 0.0787442000910802686, -0.1973213125090947651,  0.0918764024889000136, 0.0552997613699467011, 0.1333404441914082250, 0.0396603188211801100,  0.0133365015253159927, -0.0964537276866831994, 0.0351240106431329746, 0.0344953129534601305,  0.0787442000910802270, 0.1167558079369673818, -0.0324175248726315673, 0.0455917949012193888,  0.0518455308777304724, -0.0755190431111950611, -0.0029186013783272999, 0.0740225456331340959,  0.0826681140399420644, -0.0074949398183738192, -0.1372271092678234716, -0.1973213125090947095, -0.0324175248726315535, 0.1570409107964362283, -0.0598271800681427837, -0.0246698534529133130,  0.0134623670205698785, 0.0016038981750589776, -0.0262549776604951088, -0.0377437206308154360,  0.0161304587455404561, 0.0742397421708959615, 0.0918764024888999720, 0.0455917949012194026, -0.0598271800681428462, 0.1068986597894454604, 0.0305196659425098875, -0.0876868596859152333, -0.0122322386717625166, 0.0650188680241305939, 0.0981344954545152054, 0.0321454487166745045,  0.0063403885773026056, 0.0552997613699466387, 0.0518455308777304724, -0.0246698534529133269,  0.0305196659425098771, 0.1002929312876404966, -0.0483455202810034387, -0.0073587678894963364,  0.0486543949853659591, 0.0628465635259846528, -0.0236149149571045144, 0.0257094615546331479,  0.1333404441914080862, -0.0755190431111950056, 0.0134623670205699097, -0.0876868596859150529, -0.0483455202810034665, 0.4360614675624030490, 0.0827916630661595376, -0.2075790895970882621, -0.3815261487635674409, -0.0005326541614235208, 0.0148061443669236913, 0.0396603188211800475, -0.0029186013783272999, 0.0016038981750589585, -0.0122322386717624854, -0.0073587678894963347,  0.0827916630661596348, 0.0831112694054743084, -0.0411941736733142522, -0.0879718009141046281,  0.0288320307999518910, 0.0227934942289047607, 0.0133365015253159580, 0.0740225456331341652, -0.0262549776604951088, 0.0650188680241305939, 0.0486543949853659036, -0.2075790895970884287, -0.0411941736733142660, 0.1975923635156064950, 0.2113725903873455714, 0.0337315221568559032, -0.0156411384901818731, -0.0964537276866832965, 0.0826681140399420922, -0.0377437206308153875,  0.0981344954545153719, 0.0628465635259846389, -0.3815261487635673854, -0.0879718009141046836,  0.2113725903873457934, 0.4687297824200610252, 0.0665838676620906927, 0.0240103450712270232,  0.0746656777222383800, 0.0282308130902155091, -0.0051185976596646657, 0.0094948760719356928,  0.0243112416867661482, -0.0026784586780963411, 0.0044776706025215496, 0.0167117216883624770,  0.0074111032529636384, 0.0240103450712270787, 0.2489805992497309828, 0.2792342874294141408,  0.0352925732627961258, -0.1116865708517331829, 0.0616576534203468959, 0.0107238408595546047,  0.0252818072700318856, 0.0155288944648528764, 0.0239352257045015657, -0.0169383416224280631,  0.0746656777222383106, 0.2792342874294141963, 0.5457013104021826155, 0.0710797885264684570, -0.1596615662333365770, 0.0753270916459616163, 0.0471606005163159175, 0.1269335911760236524,  0.0416553978110258405, 0.0117662412202026011, -0.1011621899216662845, 0.0282308130902155230,  0.0352925732627961120, 0.0710797885264684570, 0.0973045213967378420, -0.0258504753440704643,  0.0369075701271407083, 0.0392020325930455410, -0.0629085512103193523, -0.0020002748968701756,  0.0615695376033766062, 0.0653518757391182564, -0.0051185976596646587, -0.1116865708517332523, -0.1596615662333364383, -0.0258504753440704643, 0.1317747947928820107, -0.0496034473063971526, -0.0194817105913085396, 0.0156667791416738936, 0.0025825977493157300, -0.0247686155021507072, -0.0357288773607840962, 0.0094948760719356790, 0.0616576534203469376, 0.0753270916459615747,  0.0369075701271407083, -0.0496034473063971873, 0.0909167520549178931, 0.0242280965298835374, -0.0776568961796967328, -0.0117692317898151471, 0.0562548774313715860,
                  0.0859002947722688481,  0.0243112416867661621, 0.0107238408595546706, 0.0471606005163158967, 0.0392020325930455271, -0.0194817105913085674, 0.0242280965298835235, 0.0804287367937793762, -0.0400308560799835303, -0.0061515315563477509, 0.0389614648486074841, 0.0489123732356284563, -0.0026784586780963706,  0.0252818072700319481, 0.1269335911760236524, -0.0629085512103194078, 0.0156667791416739074, -0.0776568961796966356, -0.0400308560799835789, 0.3943233067047047791, 0.0772406354016890589, -0.1817669108846280968, -0.3466324496471754890, 0.0044776706025215496, 0.0155288944648528937,  0.0416553978110258127, -0.0020002748968701791, 0.0025825977493157109, -0.0117692317898151367, -0.0061515315563477457, 0.0772406354016890728, 0.0745871937166110444, -0.0364307345835694490, -0.0827150111574497526, 0.0167117216883624492, 0.0239352257045015622, 0.0117662412202026220,  0.0615695376033766062, -0.0247686155021507107, 0.0562548774313715652, 0.0389614648486074841, -0.1817669108846281523, -0.0364307345835694629, 0.1692955873293200408, 0.1833135347313854524,  0.0074111032529636106, -0.0169383416224280908, -0.1011621899216662568, 0.0653518757391182564, -0.0357288773607840893, 0.0859002947722689730, 0.0489123732356284563, -0.3466324496471752670, -0.0827150111574497665, 0.1833135347313855079, 0.4246053340460555492, 0.0387760537796417587, -0.0169909441548118760, -0.0108903117950929010, 0.0126151821746198281, 0.0055828161765003933,  0.0055212367982150788, 0.0164488589531234797, -0.0436413042593582767, -0.0111317107817416189,  0.0179372277994738864, 0.0516466798429706386, -0.0169909441548118829, 0.1016353197702104666,  0.0557487799532663392, -0.0025779208616847253, -0.0317791563702843338, 0.0146390304127108940, -0.0107841584214783560, 0.0036688151491958282, 0.0020603573299375543, 0.0005012566281814260, -0.0034079142573841524, -0.0108903117950929062, 0.0557487799532663114, 0.1312436997521687354,  0.0068040207087430877, -0.0395310559406196957, 0.0182932096446945525, 0.0043814103352542684,  0.0119650727182096708, -0.0002520202103322416, 0.0028134915770576243, -0.0015179151982664578,  0.0126151821746198350, -0.0025779208616847340, 0.0068040207087430946, 0.0595230826098082366, -0.0005725541268576887, 0.0103250523360019220, 0.0175939507145214773, -0.0282903096332548232,  0.0004773131897977337, 0.0228984450989259784, 0.0285693089245477039, 0.0055828161765003933, -0.0317791563702844587, -0.0395310559406196055, -0.0005725541268576939, 0.0678419237157850963, -0.0124898786676012584, -0.0020743604155622113, -0.0030020884209542749, -0.0003626007562095371,  0.0015026692516011799, -0.0057701281841637964, 0.0055212367982150632, 0.0146390304127109096,  0.0182932096446945212, 0.0103250523360019462, -0.0124898786676012653, 0.0501054804335923504,  0.0076045511780133881, -0.0183544494140746965, -0.0001569035540571299, 0.0120466860646081062,  0.0215666604177226044, 0.0164488589531234936, -0.0107841584214782953, 0.0043814103352542207,  0.0175939507145214495, -0.0020743604155622338, 0.0076045511780133924, 0.0582271172780115254, -0.0192536594580668373, -0.0034087466249594738, 0.0148771308535675141, 0.0246499686328153812, -0.0436413042593583114, 0.0036688151491958403, 0.0119650727182096864, -0.0282903096332548579, -0.0030020884209542437, -0.0183544494140747451, -0.0192536594580668859, 0.1304588548177526564,  0.0115987641058708339, -0.0502104241362456294, -0.0854887643475530923, -0.0111317107817416328,  0.0020603573299375821, -0.0002520202103322936, 0.0004773131897977380, -0.0003626007562095666, -0.0001569035540571247, -0.0034087466249594538, 0.0115987641058708374, 0.0488695504086170129, -0.0074487659253321872, -0.0145562571281026235, 0.0179372277994738899, 0.0005012566281814308,  0.0028134915770576083, 0.0228984450989259541, 0.0015026692516011803, 0.0120466860646080958,  0.0148771308535675002, -0.0502104241362456571, -0.0074487659253322114, 0.0772272661656021736,  0.0495324927796831349, 0.0516466798429706317, -0.0034079142573841346, -0.0015179151982664700,  0.0285693089245476796, -0.0057701281841637765, 0.0215666604177226842, 0.0246499686328153604, -0.0854887643475529951, -0.0145562571281025854, 0.0495324927796830794, 0.1494750451722671181,  0.0449125881803093333, -0.0030385082500555237, 0.0139286378958670652, 0.0239739645869568724, -0.0045576509389877234, 0.0151656623765085326, 0.0229157926056221817, -0.0495213509964089194, -0.0090577126970655640, 0.0302096181987065206, 0.0597696222430394788, -0.0030385082500555306,  0.1061499393687249521, 0.0829287925900541179, 0.0047357891108694644, -0.0388432401123416302,  0.0171459078343101923, -0.0026658336814929079, 0.0100625218715885874, 0.0044413893099511425,  0.0029441976336309511, -0.0088145215248827888, 0.0139286378958670617, 0.0829287925900541179,  0.1846128284416309606, 0.0205393151016052163, -0.0565037081699213128, 0.0269114816591800414,  0.0153518788845132485, 0.0220704764103038797, 0.0062539912132161847, 0.0083052144992038814, -0.0112908196409780143, 0.0239739645869568654, 0.0047357891108694471, 0.0205393151016052336,  0.0647839367261213162, -0.0050599702561067517, 0.0179240320455897745, 0.0236659665020361384, -0.0402579180197564224, -0.0003044684020162051, 0.0354351789432449590, 0.0417863787628319563, -0.0045576509389877113, -0.0388432401123417620, -0.0565037081699212296, -0.0050599702561067448,  0.0672219051925454364, -0.0138825854884999707, -0.0062348492923361646, -0.0049855027861619196, -0.0016680874050857978, -0.0012941558306047672, -0.0024417686964614506, 0.0151656623765085066,  0.0171459078343101992, 0.0269114816591800067, 0.0179240320455898092, -0.0138825854884999638,  0.0513652380257036412, 0.0140522856235701758, -0.0290250223724292482, -0.0017910230560133004,  0.0227373130637037249, 0.0328229583980094233, 0.0229157926056221956, -0.0026658336814928802,  0.0153518788845132068, 0.0236659665020361107, -0.0062348492923361828, 0.0140522856235701758,  0.0576647292146984930, -0.0287666929366160937, -0.0037828878626689172, 0.0243758281946999007,  0.0344393477392495873, -0.0495213509964089610, 0.0100625218715885700, 0.0220704764103039214, -0.0402579180197564501, -0.0049855027861618832, -0.0290250223724292308, -0.0287666929366161353,  0.1581845565934768549, 0.0184763901823935123, -0.0718232154534486633, -0.1197582357586476076, -0.0090577126970655605, 0.0044413893099511745, 0.0062539912132161483, -0.0003044684020162137, -0.0016680874050858207, -0.0017910230560133082, -0.0037828878626688933, 0.0184763901823935574,  0.0462288017090857761, -0.0100726097387695279, -0.0214583838696109364, 0.0302096181987065240,  0.0029441976336309428, 0.0083052144992038814, 0.0354351789432449660, -0.0012941558306047750,  0.0227373130637037145, 0.0243758281946998764, -0.0718232154534487049, -0.0100726097387695279,  0.0906246749818859498, 0.0730208200767004795, 0.0597696222430394719, -0.0088145215248828044, -0.0112908196409779449, 0.0417863787628319494, -0.0024417686964614020, 0.0328229583980094788,  0.0344393477392496011, -0.1197582357586473162, -0.0214583838696109329, 0.0730208200767005211,  0.1799473863134831986, 0.0357443279952537746, 0.0187838606012037806, 0.0429387234030273734,  0.0176261251563734032, -0.0152229792294686639, 0.0148675101822077667, 0.0154857440867157276, -0.0214966430470702255, -0.0039883535192434287,
                  0.0167431246471781807, 0.0337369367591755787,  0.0187838606012037737, 0.0778269706904730074, 0.0639727861054083802, 0.0121053309485097474, -0.0209035442074435550, 0.0131764627558757525, 0.0032907472068902498, 0.0069057127808981791,  0.0076793272659196488, 0.0058762489017053672, -0.0084163615552328847, 0.0429387234030273734,  0.0639727861054083802, 0.1722244061171773755, 0.0293641126190522968, -0.0395127891929698549,  0.0264900947059089724, 0.0197471666578530360, 0.0185794862660447618, 0.0111964928886216994,  0.0110525994641521991, -0.0110945105152440472, 0.0176261251563733859, 0.0121053309485097300,  0.0293641126190522864, 0.0539825174130073582, -0.0080821076069339526, 0.0144164251877730402,  0.0162099762684597866, -0.0199932020225936438, 0.0016952407749798119, 0.0225998085838039972,  0.0228788705903524084, -0.0152229792294686569, -0.0209035442074436487, -0.0395127891929697647, -0.0080821076069339179, 0.0527449124104252473, -0.0100701985237535221, -0.0082638667666436356, -0.0004251798846757322, -0.0020504191531696115, -0.0031356275968381113, -0.0044641679468201863,  0.0148675101822077407, 0.0131764627558757993, 0.0264900947059089342, 0.0144164251877730264, -0.0100701985237535048, 0.0434876165023446865, 0.0110795395513434980, -0.0138034733974985030,  0.0003691350455453791, 0.0140917377927293752, 0.0174727983491972869, 0.0154857440867157258,  0.0032907472068902602, 0.0197471666578530151, 0.0162099762684597797, -0.0082638667666436391,  0.0110795395513434893, 0.0475514107479612716, -0.0131897259083799331, -0.0021450981864993427,  0.0137072788441822725, 0.0189682050066888562, -0.0214966430470702741, 0.0069057127808981955,  0.0185794862660447341, -0.0199932020225936577, -0.0004251798846757217, -0.0138034733974984319, -0.0131897259083799366, 0.1022591302306897487, 0.0145265441095187731, -0.0376552774647530009, -0.0696458432188979959, -0.0039883535192434304, 0.0076793272659196887, 0.0111964928886216473,  0.0016952407749798127, -0.0020504191531696301, 0.0003691350455453856, -0.0021450981864993236,  0.0145265441095187818, 0.0431195361999233417, -0.0065732146495725207, -0.0177284828576516028,  0.0167431246471781876, 0.0058762489017053941, 0.0110525994641521956, 0.0225998085838039764, -0.0031356275968381004, 0.0140917377927293752, 0.0137072788441822760, -0.0376552774647530564, -0.0065732146495724843, 0.0650572070005597108, 0.0404232744589142975, 0.0337369367591755370, -0.0084163615552328985, -0.0110945105152440177, 0.0228788705903524223, -0.0044641679468201950,  0.0174727983491973909, 0.0189682050066888423, -0.0696458432188979126, -0.0177284828576515924,  0.0404232744589142906, 0.1274342391849143941, 0.0497400297125233926, 0.0382984275745206701,  0.0801492865809485533, 0.0284247973040912816, -0.0271750958208217541, 0.0229845952308154293,  0.0243625131936422747, -0.0231204015153166839, -0.0021464265410875228, 0.0253945806924136090,  0.0356007329299677516, 0.0382984275745206770, 0.0971274741667843416, 0.1048669943089465678,  0.0261777500289367172, -0.0352139561689320674, 0.0234990129122488664, 0.0158696582501341964, -0.0012096087523571224, 0.0072264499781316792, 0.0214663120851960772, 0.0054235132468679744,  0.0801492865809485810, 0.1048669943089464984, 0.2522832155567822920, 0.0549290399534205290, -0.0664555906246877964, 0.0452552697796260311, 0.0414235253253083038, 0.0106586294503339084,  0.0134554620125994298, 0.0350856437250726752, 0.0052294218705090552, 0.0284247973040912850,  0.0261777500289367103, 0.0549290399534205220, 0.0602558703421073177, -0.0175984463566082432,  0.0212140046791610901, 0.0239267039890196792, -0.0249378870779304006, 0.0012275705119672714,  0.0317326753476671469, 0.0291254991919986800, -0.0271750958208217541, -0.0352139561689321159, -0.0664555906246877548, -0.0175984463566082154, 0.0620988573207224975, -0.0174458529282456865, -0.0166724704574235973, 0.0067889854847903172, -0.0010808825310675151, -0.0151257042295398648, -0.0152582267720093694, 0.0229845952308154119, 0.0234990129122488664, 0.0452552697796260381,  0.0212140046791610797, -0.0174458529282456691, 0.0485393530482083127, 0.0177422974484859018, -0.0214509139884192339, -0.0010710819191225996, 0.0241022236121148752, 0.0269471201462424051,  0.0243625131936422677, 0.0158696582501342276, 0.0414235253253082691, 0.0239267039890196688, -0.0166724704574236077, 0.0177422974484858949, 0.0531406847836403892, -0.0199050104736150021, -0.0023105808603491175, 0.0228326972498529707, 0.0261889344272682109, -0.0231204015153166909, -0.0012096087523571311, 0.0106586294503338806, -0.0249378870779303624, 0.0067889854847903146, -0.0214509139884192131, -0.0199050104736149917, 0.1167504717061011443, 0.0182128523560799449, -0.0522358404560015130, -0.0844543233631050438, -0.0021464265410875271, 0.0072264499781316991,  0.0134554620125994125, 0.0012275705119672818, -0.0010808825310675029, -0.0010710819191226278, -0.0023105808603491131, 0.0182128523560799623, 0.0426833910607821027, -0.0092556409354034100, -0.0212507168754150939, 0.0253945806924135882, 0.0214663120851960737, 0.0350856437250726474,  0.0317326753476671330, -0.0151257042295398700, 0.0241022236121149168, 0.0228326972498529637, -0.0522358404560016101, -0.0092556409354034412, 0.0789966867983174503, 0.0559683730612211827,  0.0356007329299677239, 0.0054235132468679345, 0.0052294218705089997, 0.0291254991919987251, -0.0152582267720093902, 0.0269471201462425231, 0.0261889344272682179, -0.0844543233631051271, -0.0212507168754151286, 0.0559683730612212937, 0.1399643616555109049, 0.0451437418893641043,  0.0326318397410594457, 0.0684000498721793887, 0.0240896939469048450, -0.0227255911547396584,  0.0192546239499636548, 0.0200906714261645733, -0.0223369042272443599, -0.0020985296160529769,  0.0230229495833586678, 0.0332510946699020732, 0.0326318397410594457, 0.0934571242913634082,  0.0942065945909704994, 0.0235071725473032164, -0.0311809299044993639, 0.0188066002376489627,  0.0108028774040850716, -0.0054980982823094968, 0.0077626645285846698, 0.0195400123518532851,  0.0050494496084822101, 0.0684000498721793887, 0.0942065945909704994, 0.2252920638151445498,  0.0482242200516460051, -0.0566107946466561443, 0.0355564125993234961, 0.0312206625408393730,  0.0065742515754418467, 0.0142639800920347712, 0.0313604283975427722, 0.0014717104168424557,  0.0240896939469048554, 0.0235071725473032095, 0.0482242200516459982, 0.0558814428730744286, -0.0149192001132770809, 0.0176230906710198067, 0.0199495695635317737, -0.0203706454557164747,  0.0023709225709005123, 0.0268207443729898652, 0.0233438325469937993, -0.0227255911547396688, -0.0311809299044993639, -0.0566107946466561304, -0.0149192001132770532, 0.0588219393797917017, -0.0132503780415975086, -0.0125795553955866512, 0.0084007337752726036, -0.0016386826503587593, -0.0118970067326525236, -0.0137484822995656078, 0.0192546239499636548, 0.0188066002376489801,  0.0355564125993235308, 0.0176230906710198171, -0.0132503780415974878, 0.0447464136289789302,  0.0137044632099095794, -0.0208691518866550609, -0.0003351876550806579, 0.0197249898334622698,  0.0244653511684393629, 0.0200906714261645768, 0.0108028774040850768, 0.0312206625408393730,  0.0199495695635317737, -0.0125795553955866390, 0.0137044632099095707, 0.0495453973227227909, -0.0163513275789484436,
                  -0.0013668044862034541, 0.0185377409173931584, 0.0214656466387778341, -0.0223369042272443669, -0.0054980982823095350, 0.0065742515754418389, -0.0203706454557164539,  0.0084007337752725845, -0.0208691518866549811, -0.0163513275789484262, 0.1130425580251438189,  0.0159314171185934370, -0.0439592640494345932, -0.0808675176050524525, -0.0020985296160529916,  0.0077626645285846707, 0.0142639800920347521, 0.0023709225709005349, -0.0016386826503587467, -0.0003351876550806853, -0.0013668044862034578, 0.0159314171185934821, 0.0417977343078681993, -0.0062325499870330477, -0.0190691896297905707, 0.0230229495833586678, 0.0195400123518532885,  0.0313604283975427861, 0.0268207443729898722, -0.0118970067326525254, 0.0197249898334623079,  0.0185377409173931515, -0.0439592640494346001, -0.0062325499870331223, 0.0704678776215234143,  0.0463790794522256980, 0.0332510946699020732, 0.0050494496084821632, 0.0014717104168424592,  0.0233438325469938063, -0.0137484822995655852, 0.0244653511684394115, 0.0214656466387778272, -0.0808675176050523969, -0.0190691896297905845, 0.0463790794522257258, 0.1360065608489532951,  0.0546304576605902772, 0.0375990972669060647, 0.0773890196976368822, 0.0275921328714588097, -0.0231151790698990028, 0.0211968910349300023, 0.0219537288345612105, -0.0217424950019131577,  0.0003252094864008436, 0.0246105712160570242, 0.0313300336885899006, 0.0375990972669060577,  0.0991648097254292094, 0.1052716628417586786, 0.0200130654324451353, -0.0297937235232060942,  0.0177773428938630094, 0.0115756097306406267, 0.0137342462633987718, 0.0134734891898095187,  0.0095512012060260977, -0.0117226070704510941, 0.0773890196976368822, 0.1052716628417587202,  0.2493899491700051207, 0.0434510043161501006, -0.0563113301401353059, 0.0334255564219990628,  0.0326705047814391109, 0.0434169425367603445, 0.0257554174328705407, 0.0132122321292613594, -0.0311583171679900954, 0.0275921328714588202, 0.0200130654324451318, 0.0434510043161501075,  0.0558350738692290557, -0.0103828514857253942, 0.0159568382130105026, 0.0190939871428896027, -0.0156906283260182210, 0.0041908609297218596, 0.0244197030172092107, 0.0169980081066557764, -0.0231151790698990098, -0.0297937235232060595, -0.0563113301401352989, -0.0103828514857253855,  0.0566762732768699290, -0.0103466628234912157, -0.0107463874032897293, -0.0061710017887048876, -0.0049964889027750989, -0.0028722597681187880, -0.0007669299453107984, 0.0211968910349300023,  0.0177773428938629886, 0.0334255564219990767, 0.0159568382130105130, -0.0103466628234912001,  0.0452857216521891995, 0.0121307342114292810, -0.0170487487125394362, 0.0004488318131049318,  0.0173737932728488809, 0.0205568527461882401, 0.0219537288345612001, 0.0115756097306406215,  0.0326705047814391109, 0.0190939871428896027, -0.0107463874032897172, 0.0121307342114292775,  0.0493688396915473587, -0.0086172114503176508, 0.0007923897701246776, 0.0149617999056284728,  0.0126993571324633247, -0.0217424950019131612, 0.0137342462633987389, 0.0434169425367603862, -0.0156906283260181967, -0.0061710017887049171, -0.0170487487125393980, -0.0086172114503176300,  0.1282277581213895068, 0.0214068131916759601, -0.0476940878659793746, -0.0878079432145598693,  0.0003252094864008388, 0.0134734891898095101, 0.0257554174328705372, 0.0041908609297218770, -0.0049964889027750755, 0.0004488318131049150, 0.0007923897701246703, 0.0214068131916759843,  0.0453304576095742429, -0.0078075588518525391, -0.0234959873372279048, 0.0246105712160570242,  0.0095512012060260942, 0.0132122321292613802, 0.0244197030172092037, -0.0028722597681187928,  0.0173737932728488982, 0.0149617999056284728, -0.0476940878659793815, -0.0078075588518525599,  0.0720955628644402019, 0.0465315145341253927, 0.0313300336885898936, -0.0117226070704511080, -0.0311583171679900364, 0.0169980081066557764, -0.0007669299453108066, 0.0205568527461882436,  0.0126993571324633178, -0.0878079432145599248, -0.0234959873372279221, 0.0465315145341253927,  0.1396375397445625832, 0.0569367895939884711, 0.0174689402170341290, 0.0382330446149549141,  0.0266378206169947500, -0.0163347273436484225, 0.0224945577728042564, 0.0229520719665545943, -0.0589409742542580176, -0.0099898633893295875, 0.0385909340507015475, 0.0689923382417200054,  0.0174689402170341047, 0.0784903820779159628, 0.0544139600311685095, 0.0064385969297837391, -0.0234419321500171467, 0.0139889956667383734, 0.0019371868565814740, -0.0052275423520415903, -0.0014446138870840462, 0.0100526238561383010, 0.0090274770376521773, 0.0382330446149549349,  0.0544139600311685442, 0.1377988393366177122, 0.0197283417538101045, -0.0401280234301886335,  0.0268183675121233638, 0.0152863241943317751, -0.0060241844226272068, -0.0039067615469152005,  0.0199479984756369307, 0.0206774990194668919, 0.0266378206169947396, 0.0064385969297837365,  0.0197283417538100837, 0.0540927516688727780, -0.0063650788609105049, 0.0136027444098753975,  0.0181984493772286045, -0.0296294849898162023, -0.0014484438038021054, 0.0270160628777588070,  0.0315795256012037576, -0.0163347273436484156, -0.0234419321500171397, -0.0401280234301886335, -0.0063650788609105067, 0.0595474596330574368, -0.0103764752947543143, -0.0079486495078420361,  0.0029892748058380370, 0.0024417626361938429, -0.0043657208720186708, -0.0125312859611460999,  0.0224945577728042495, 0.0139889956667383613, 0.0268183675121233568, 0.0136027444098753801, -0.0103764752947543143, 0.0461707196087741065, 0.0114242775934772535, -0.0201469165562363495, -0.0025436526835248890, 0.0169198340694329506, 0.0252379897436075043, 0.0229520719665545839,  0.0019371868565814865, 0.0152863241943317681, 0.0181984493772286079, -0.0079486495078420431,  0.0114242775934772639, 0.0521509134780148015, -0.0217992590011559413, -0.0034348966761655495,  0.0190429109707159726, 0.0268472586397622663, -0.0589409742542580245, -0.0052275423520416198, -0.0060241844226271947, -0.0296294849898162335, 0.0029892748058380613, -0.0201469165562363356, -0.0217992590011559170, 0.1241984013668689657, 0.0129999632958218963, -0.0514718072573056434, -0.0833352641681031625, -0.0099898633893295910, -0.0014446138870840692, -0.0039067615469151936, -0.0014484438038020902, 0.0024417626361938520, -0.0025436526835248929, -0.0034348966761655504,  0.0129999632958219067, 0.0434664114016911352, -0.0078747661449358498, -0.0163822882492316163,  0.0385909340507015267, 0.0100526238561382958, 0.0199479984756369237, 0.0270160628777587758, -0.0043657208720186778, 0.0169198340694329541, 0.0190429109707159760, -0.0514718072573055949, -0.0078747661449358637, 0.0766323868334336522, 0.0520212793196010923, 0.0689923382417200193,  0.0090274770376521929, 0.0206774990194668676, 0.0315795256012037714, -0.0125312859611460790,  0.0252379897436075182, 0.0268472586397622767, -0.0833352641681032041, -0.0163822882492315990,  0.0520212793196011269, 0.1434278137140076737, 0.0562909939056830122, 0.0196663590513499464,  0.0365332437981971750, 0.0271506882958320352, -0.0168763304829981087, 0.0231124162849584043,  0.0222997108781906629, -0.0583612412946969417, -0.0101530861598573847, 0.0379354565877788596,  0.0707553843576516073, 0.0196663590513499464, 0.1017112119894928168, 0.0795687975430821592,  0.0081953837428163298, -0.0269527730858873070, 0.0175866617942643244, -0.0010941151318956980,
                  0.0065521472484384811, 0.0043731579532861565, 0.0044012358779850014, -0.0101689829586428786,  0.0365332437981971750, 0.0795687975430821592, 0.1872142996140080951, 0.0245391939852342700, -0.0482650899122376645, 0.0283976147986434342, 0.0149623116031402173, 0.0237915888172961498,  0.0047596095615986536, 0.0073906541210240709, -0.0155599710364917546, 0.0271506882958320352,  0.0081953837428163298, 0.0245391939852342700, 0.0658047495978103109, -0.0084975032496015391,  0.0178350797448629701, 0.0245144205406488472, -0.0310658881851061559, 0.0003205423296087423,  0.0314003366563680442, 0.0340264235320264855, -0.0168763304829981087, -0.0269527730858873070, -0.0482650899122376645, -0.0084975032496015391, 0.0671370355301118271, -0.0133459334092883870, -0.0097719986686769303, -0.0004388986167159171, 0.0004188327584560874, -0.0015451742021388309, -0.0071619184719495799, 0.0231124162849584043, 0.0175866617942643244, 0.0283976147986434342,  0.0178350797448629701, -0.0133459334092883870, 0.0568120985881462592, 0.0145558338959935109, -0.0286358621712550845, -0.0028228286439883994, 0.0220799505755982506, 0.0332377340302991986,  0.0222997108781906629, -0.0010941151318956980, 0.0149623116031402173, 0.0245144205406488472, -0.0097719986686769303, 0.0145558338959935109, 0.0638420634464143266, -0.0269300306168051735, -0.0044865282866332181, 0.0236656127244495654, 0.0347592340953502485, -0.0583612412946969417,  0.0065521472484384811, 0.0237915888172961498, -0.0310658881851061559, -0.0004388986167159171, -0.0286358621712550845, -0.0269300306168051735, 0.1578884480830564097, 0.0178936816312022691, -0.0658708421953520251, -0.1135061588811079880, -0.0101530861598573847, 0.0043731579532861565,  0.0047596095615986536, 0.0003205423296087423, 0.0004188327584560874, -0.0028228286439883994, -0.0044865282866332181, 0.0178936816312022691, 0.0501116442373916934, -0.0095945293396901155, -0.0215225790245768822, 0.0379354565877788596, 0.0044012358779850014, 0.0073906541210240709,  0.0314003366563680442, -0.0015451742021388309, 0.0220799505755982506, 0.0236656127244495654, -0.0658708421953520251, -0.0095945293396901155, 0.0912626318996398456, 0.0665733520328917194,  0.0707553843576516073, -0.0101689829586428786, -0.0155599710364917546, 0.0340264235320264855, -0.0071619184719495799, 0.0332377340302991986, 0.0347592340953502485, -0.1135061588811079880, -0.0215225790245768822, 0.0665733520328917194, 0.1822712216538368291 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$n_iter),
               c(12 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$Q),
               c( 0.358020556865647044, 0.259277173053352517, 0.561431827494945024, 0.262678695715435395, -0.111608800820350337,  0.148313568851910438, 0.188390145679481924, -0.059464114894498564, 0.069090794969369901, 0.212797394618069624,  0.053432596110293065, 0.259277173053352517, 1.022218180634146822, 1.663235846535923157, 0.251973417735177507, -0.561194077846880246, 0.280168380200381928, 0.133206617639874125, 0.377351007992750731, 0.152108349530929471,  0.059406211648745461, -0.326753089205042757, 0.561431827494945024, 1.663235846535923157, 2.943349440062594358,  0.414909400161958875, -0.854700683215706691, 0.366496970214028162, 0.233543050172938638, 1.053958669454810870,  0.380261325410562567, -0.078231365026017019, -0.994465343013327563, 0.262678695715435395, 0.251973417735177507,  0.414909400161958875, 0.322843318749494568, -0.187692172879099617, 0.259446100470225538, 0.227966751856685718, -0.507652701336491541, -0.056671890881222847, 0.429488120284109209, 0.537496705144619336, -0.111608800820350337, -0.561194077846880246, -0.854700683215706691, -0.187692172879099617, 0.368451462304787480, -0.230173203879265209, -0.112506030994800776, 0.069178516825374320, -0.009813727189810207, -0.175727919508135905, -0.122728178504065116,  0.148313568851910438, 0.280168380200381928, 0.366496970214028162, 0.259446100470225538, -0.230173203879265209,  0.272970722846386515, 0.179112344318567457, -0.556693576898948495, -0.095571959045730417, 0.412149609311622811,  0.601087569471188798, 0.188390145679481924, 0.133206617639874125, 0.233543050172938638, 0.227966751856685718, -0.112506030994800776, 0.179112344318567457, 0.176676662245769028, -0.391759689168048486, -0.049062060866470310,  0.316700214402321656, 0.414341619870716993, -0.059464114894498564, 0.377351007992750731, 1.053958669454810870, -0.507652701336491541, 0.069178516825374320, -0.556693576898948495, -0.391759689168048486, 2.558747603178308516,  0.589878032665847152, -1.368983686466504146, -2.644646444659957574, 0.069090794969369901, 0.152108349530929471,  0.380261325410562567, -0.056671890881222847, -0.009813727189810207, -0.095571959045730417, -0.049062060866470310,  0.589878032665847152, 0.164899055594413479, -0.273921949705384915, -0.614841324051712657, 0.212797394618069624,  0.059406211648745461, -0.078231365026017019, 0.429488120284109209, -0.175727919508135905, 0.412149609311622811,  0.316700214402321656, -1.368983686466504146, -0.273921949705384915, 0.861064444866115664, 1.427900335394751696,  0.053432596110293065, -0.326753089205042757, -0.994465343013327563, 0.537496705144619336, -0.122728178504065116,  0.601087569471188798, 0.414341619870716993, -2.644646444659957574, -0.614841324051712657, 1.427900335394751696,  2.761453393666073008 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$method),
               c("EKF" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$model),
               c("exponential" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$LR),
               c(0.05852766346593507 )
               , tolerance = 1e-05)
})

test_that("Unmacthed control variable throw error",
          expect_error({
            result = ddhazard(
              formula = survival::Surv(start, stop, event) ~ group,
              data = head_neck_cancer,
              by = 1, # Use by month intervals
              a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
              max_T = 45,
              id = head_neck_cancer$id, order = 1,
              control = list("None_existing_parem" = 1)
            )}, regexp = "These control parameters are not recognized"))

test_that("Using alternated inverse covariance matrix in EKF with exponential model yields previously computed values", {
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(10, 11),
    Q = diag(1e-2, 11),
    control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^3,
                   EKF_inv_Cov_method = "not org"),
    max_T = 10,
    id = sims$res$id, order = 1,
    verbose = F,
    model = "exponential"))

  # get_expect_equal(result_exp, eps = 1e-5, file = "tmp.txt")
  # matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
  # matplot(result_exp$times, result_exp$state_vecs, result_exp$state_vecs, type = "l", lty = 2, add = T)

  expect_equal(c(result_exp$state_vecs),
               c(-5.37491499453456711, -5.37838561956256189, -4.82120214005348124, -4.57774126114250723, -4.37250249850003758, -4.36263736954901749, -4.37576778478690009, -4.30796374816606686, -3.96478025282279178, -4.05884163933298581, -4.06139385848421863, 0.62136248372161029, 0.62493458521790513, 0.74299025525156615, -0.39825497767733964, -1.45633073143722536, -2.22559221312591493, -2.06822623767243163, -2.23007683229433917, -1.61701543132215342, -1.53649477936356083, -1.05616071482902862, -1.97749961606802049, -1.97881595587375569, -0.57669067545861985, -2.44822473362939075, -4.13040023170904291, -5.51716864433489995, -4.95402996774829329, -4.95447727752580747, -2.85942847533379929, -3.08189629183477276, -2.23547613479184593, 1.00606836485592921, 1.00849103278899666,  0.75210260342984592, 0.52387510804844872, 0.31800579639583876, 0.19955092367601179, 0.18928931604373625,  0.08735798545854222, -0.04791068228869577, 0.08318004669572661, 0.20389970557152162, 1.54727598954221035,  1.54470660503176260, 1.63482883510482080, 2.28203085502065584, 2.87229618106439766, 3.24987579696851236,  3.13222630689859072, 3.22218833251401549, 2.98440816190581604, 2.93712750847187554, 2.71757049535431960,  0.59058706612362832, 0.59567850250647014, -0.17273648191381219, -0.35954944340969364, -0.54176236481989193, -0.56444649712038220, -0.68368263961922482, -0.86762310541703425, -1.45613685779407054, -1.22641122282940129, -1.16940644097553026, -0.28072525083253491, -0.27944565496356610, -0.45802462223737783, -0.52684459252313376, -0.58014174739532576, -0.59861885567120932, -0.60309878583613863, -0.64693742798975917, -0.78143413541395512, -0.71396365104266191, -0.67560957514061215, 0.79000280334054462, 0.77728444342701419, 3.37211417702639249,  2.74282635801478003, 2.22770624639737225, 1.47810731419400221, 2.09981672313806778, 2.50088432044739539,  5.10103955217750560, 4.44271150512847957, 4.76700198785209395, 1.60243169246471040, 1.60044167530069581,  2.06637056127744057, 1.91842821228627214, 1.79095011951254390, 1.62022624217503308, 1.71565560527511840,  1.75045295235447540, 2.22247147093365394, 2.14085607244094867, 2.23424197427617077, 1.95984215314049925,  1.96869661532479379, 0.44792822962526402, 0.47222385663508121, 0.46641360407964061, 0.67810386562519609,  0.34856655477029530, 0.04460437790988175, -1.34395601438959700, -0.90551110507820032, -0.89425338157076428, -3.37953113305516251, -3.36866884948570311, -5.63146480649819470, -5.10169842348046476, -4.65192237475799164, -3.97254029809158205, -4.47722333050160959, -4.80247779250813167, -7.04845819725316147, -6.51649582508983016, -6.83522567448175256 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$state_vars),
               c( 1.685901075026752e-01, -1.070897760618673e-01, -3.096885226292929e-02, -5.372608171222829e-02,  7.979358310940199e-02, -1.052626824792337e-01, -2.397106648280096e-02, 1.908216832079230e-01,  2.386001664806245e-02, -1.658557147727988e-01, -1.468423540042886e-01, -1.070897760618673e-01,  7.844097705192272e-01, 1.004684839983574e+00, 1.454836518920367e-01, -3.522779569953190e-01,  1.342475149889229e-01, 4.431982326283665e-02, 2.578848485834337e-01, 8.484287847779956e-02,  5.123261640441776e-02, -2.393766247234175e-01, -3.096885226292926e-02, 1.004684839983574e+00,  2.072643731309848e+00, 1.456268288764662e-01, -5.232919952498224e-01, -1.288318797103063e-02,  2.849564824246953e-02, 1.144318904519704e+00, 2.424522842144922e-01, -3.713408427398605e-01, -9.812517375898829e-01, -5.372608171222829e-02, 1.454836518920368e-01, 1.456268288764662e-01,  1.696992320892381e-01, -7.849290648742006e-02, 8.819559813567263e-02, 3.403672747253363e-02, -1.157008258792878e-01, -9.250868836579741e-04, 1.292320715287860e-01, 8.881982438425001e-02,  7.979358310940206e-02, -3.522779569953190e-01, -5.232919952498225e-01, -7.849290648742011e-02,  3.338812234088540e-01, -8.747723842289300e-02, -3.369571099278635e-02, -9.589811561618734e-02, -3.258675345141932e-02, -4.186074846865413e-02, 7.603913700119790e-02, -1.052626824792337e-01,  1.342475149889228e-01, -1.288318797103061e-02, 8.819559813567263e-02, -8.747723842289302e-02,  2.788929347846167e-01, 4.741320576347153e-02, -4.006223724554726e-01, -5.218634728136070e-02,  2.894526357013904e-01, 3.367817704749629e-01, -2.397106648280097e-02, 4.431982326283664e-02,  2.849564824246955e-02, 3.403672747253363e-02, -3.369571099278632e-02, 4.741320576347154e-02,  1.282843499377613e-01, -8.260102188306576e-02, -9.543496908737308e-03, 6.956442930851590e-02,  7.280182634376008e-02, 1.908216832079231e-01, 2.578848485834336e-01, 1.144318904519704e+00, -1.157008258792878e-01, -9.589811561618722e-02, -4.006223724554724e-01, -8.260102188306576e-02,  1.734724108756547e+00, 2.721705015041420e-01, -8.914575824320063e-01, -1.356060016365836e+00,  2.386001664806244e-02, 8.484287847779946e-02, 2.424522842144921e-01, -9.250868836579561e-04, -3.258675345141933e-02, -5.218634728136073e-02, -9.543496908737287e-03, 2.721705015041420e-01,  1.804548238238315e-01, -1.403476694854059e-01, -2.403608596725863e-01, -1.658557147727988e-01,  5.123261640441755e-02, -3.713408427398603e-01, 1.292320715287860e-01, -4.186074846865408e-02,  2.894526357013904e-01, 6.956442930851583e-02, -8.914575824320066e-01, -1.403476694854061e-01,  6.889558392869706e-01, 7.433871846784467e-01, -1.468423540042886e-01, -2.393766247234175e-01, -9.812517375898828e-01, 8.881982438425011e-02, 7.603913700119806e-02, 3.367817704749629e-01,  7.280182634376009e-02, -1.356060016365836e+00, -2.403608596725864e-01, 7.433871846784467e-01,  1.338017294545901e+00, 9.690191945344850e-02, -4.583123740922494e-02, -1.197520394034390e-02, -2.227966864888903e-02, 2.915855870452427e-02, -3.912628012313843e-02, -6.213425953422821e-03,  4.816484172684374e-02, -2.299851312471235e-03, -6.212556731535446e-02, -1.842055221818883e-02, -4.583123740922494e-02, 4.884720350876424e-01, 5.562224096845618e-01, 8.290904954469970e-02, -1.926799792939866e-01, 7.532561596918545e-02, 2.467855815757088e-02, 1.406489148755807e-01,  5.316591543148933e-02, 3.278973877083900e-02, -1.372109692602434e-01, -1.197520394034385e-02,  5.562224096845619e-01, 1.177910946603299e+00, 8.936926289144657e-02, -2.911353779129118e-01,  1.333786887269189e-02, 2.339787232337603e-02, 5.806833259255153e-01, 1.285992259075608e-01, -1.718886475684160e-01, -4.975560630409994e-01, -2.227966864888903e-02, 8.290904954469971e-02,  8.936926289144657e-02, 1.363828192564465e-01, -3.998394548603386e-02, 4.708594890171072e-02,  2.120949780300203e-02, -5.245136767415751e-02, 6.122526644713147e-03, 6.923641129295180e-02,  3.587375607215007e-02, 2.915855870452433e-02, -1.926799792939866e-01, -2.911353779129119e-01, -3.998394548603391e-02, 2.316694853185419e-01, -4.209180433459969e-02, -1.922177441513148e-02, -6.873461472828646e-02, -2.352230969743023e-02, -1.058191004755765e-02, 5.566160955777328e-02, -3.912628012313839e-02, 7.532561596918548e-02, 1.333786887269192e-02, 4.708594890171075e-02, -4.209180433459969e-02, 1.832110838077972e-01, 2.485341741553613e-02, -1.798736353376979e-01, -1.648966357896878e-02, 1.374896099958066e-01, 1.473114258235336e-01, -6.213425953422821e-03,  2.467855815757085e-02, 2.339787232337606e-02, 2.120949780300203e-02, -1.922177441513144e-02,  2.485341741553614e-02, 1.141690676359568e-01, -3.325728867430938e-02, -2.014409109851747e-03,  3.234186448445747e-02, 3.023600737220884e-02, 4.816484172684385e-02, 1.406489148755807e-01,  5.806833259255155e-01, -5.245136767415751e-02, -6.873461472828629e-02, -1.798736353376978e-01, -3.325728867430940e-02, 8.915465251937515e-01, 1.228825757620731e-01, -4.216772385746402e-01, -6.387994758423348e-01, -2.299851312471235e-03, 5.316591543148928e-02, 1.285992259075606e-01,  6.122526644713161e-03, -2.352230969743023e-02, -1.648966357896882e-02, -2.014409109851734e-03,  1.228825757620733e-01, 1.444988371628115e-01, -6.056937951377378e-02, -1.104460499655087e-01, -6.212556731535451e-02, 3.278973877083875e-02, -1.718886475684158e-01, 6.923641129295181e-02, -1.058191004755758e-02, 1.374896099958066e-01, 3.234186448445742e-02, -4.216772385746405e-01, -6.056937951377389e-02, 3.884985073741318e-01, 3.420715684605565e-01, -1.842055221818895e-02, -1.372109692602435e-01, -4.975560630409992e-01, 3.587375607215014e-02, 5.566160955777343e-02,  1.473114258235335e-01, 3.023600737220887e-02, -6.387994758423348e-01, -1.104460499655087e-01,  3.420715684605564e-01, 7.116123272812724e-01, 9.023915367818508e-02, -3.627129709324349e-02,  1.225627587149147e-02, -2.164602391429679e-02, 2.377927469567089e-02, -4.256382299351980e-02, -5.922028084789380e-03, 7.053633038050786e-02, 1.550170418629843e-03, -7.225709209592024e-02, -3.788513649099234e-02, -3.627129709324346e-02, 3.966556874784861e-01, 4.358737548053662e-01,  6.135203923759994e-02, -1.521016092070644e-01, 5.512144172985689e-02, 1.755976322015259e-02,  1.201531154952952e-01, 4.245084210753531e-02, 1.787280746620745e-02, -1.115251741142906e-01,  1.225627587149136e-02, 4.358737548053662e-01, 9.885958991508905e-01, 5.793445928355281e-02, -2.272481061190689e-01, -1.431986657399739e-02, 1.090844522922277e-02, 5.445180364466223e-01,  1.141707504729593e-01, -1.897862434214138e-01, -4.594447077059274e-01, -2.164602391429675e-02,  6.135203923759991e-02, 5.793445928355276e-02, 1.217249961540223e-01, -3.085990481192290e-02,  4.124578449173176e-02, 1.762342083761274e-02, -5.712334476181165e-02, 2.156825717184761e-03,  6.270857902186716e-02, 4.316544391657860e-02, 2.377927469567086e-02, -1.521016092070644e-01, -2.272481061190688e-01, -3.085990481192292e-02, 2.041417032902351e-01, -3.545622333885899e-02, -1.602522051677136e-02, -4.716870873103646e-02, -1.690285756858569e-02, -1.151829084878083e-02,  3.444863127307192e-02, -4.256382299351974e-02, 5.512144172985694e-02, -1.431986657399729e-02,  4.124578449173175e-02, -3.545622333885903e-02, 1.724531985880584e-01, 2.313013108162026e-02, -1.867286893709721e-01, -2.059335679168446e-02, 1.339056038457407e-01,
                  1.573236310566851e-01, -5.922028084789387e-03, 1.755976322015257e-02, 1.090844522922281e-02, 1.762342083761276e-02, -1.602522051677133e-02, 2.313013108162026e-02, 1.057752300046884e-01, -3.658124308890400e-02, -3.603183420223838e-03, 3.067618730227845e-02, 3.406021259133293e-02, 7.053633038050787e-02,  1.201531154952951e-01, 5.445180364466226e-01, -5.712334476181161e-02, -4.716870873103633e-02, -1.867286893709721e-01, -3.658124308890400e-02, 8.799881838100678e-01, 1.231666294547683e-01, -4.215880030201155e-01, -6.404771223220270e-01, 1.550170418629787e-03, 4.245084210753527e-02,  1.141707504729592e-01, 2.156825717184768e-03, -1.690285756858569e-02, -2.059335679168448e-02, -3.603183420223824e-03, 1.231666294547684e-01, 1.363927983270632e-01, -6.392595378476607e-02, -1.104754818040109e-01, -7.225709209592021e-02, 1.787280746620733e-02, -1.897862434214136e-01,  6.270857902186716e-02, -1.151829084878078e-02, 1.339056038457407e-01, 3.067618730227840e-02, -4.215880030201155e-01, -6.392595378476618e-02, 3.718312051175547e-01, 3.488305590648131e-01, -3.788513649099234e-02, -1.115251741142907e-01, -4.594447077059273e-01, 4.316544391657862e-02,  3.444863127307207e-02, 1.573236310566850e-01, 3.406021259133293e-02, -6.404771223220271e-01, -1.104754818040109e-01, 3.488305590648130e-01, 7.088176969835316e-01, 6.284488190864063e-02, -4.346028066257978e-02, -4.958521587454019e-02, -1.040683384812420e-02, 1.872177048541566e-02, -9.019771005222558e-03, 3.106493988726602e-03, -3.748224015312074e-02, -1.745692827497511e-02, -8.576658440203722e-03, 5.663422223084877e-02, -4.346028066257979e-02, 2.405019095789133e-01,  1.705147996569965e-01, 3.474526591672408e-02, -7.446057853758492e-02, 4.375803620898468e-02,  1.002440046387483e-02, -6.592179911688135e-03, 1.048618405571969e-02, 4.540803556443695e-02, -1.719696151469621e-03, -4.958521587454018e-02, 1.705147996569965e-01, 3.710682336946131e-01,  3.989723568079527e-02, -9.799265081611760e-02, 4.938867595039753e-02, 1.516599867996928e-02,  5.422721159423164e-02, 1.441396534424246e-02, 1.880462571912284e-02, -4.277513412958124e-02, -1.040683384812419e-02, 3.474526591672408e-02, 3.989723568079528e-02, 1.011380148144388e-01, -1.468922507563955e-02, 1.918772635357807e-02, 9.966117621068213e-03, -1.869954580901882e-02,  5.575769582164039e-03, 2.839228677223379e-02, 1.193448138348496e-02, 1.872177048541564e-02, -7.446057853758495e-02, -9.799265081611752e-02, -1.468922507563956e-02, 1.530007479406484e-01, -2.209687106619714e-02, -9.740210220810064e-03, -1.396711552442746e-03, -4.624433402535402e-03, -1.477867059695759e-02, -3.043595451545849e-03, -9.019771005222534e-03, 4.375803620898472e-02,  4.938867595039752e-02, 1.918772635357805e-02, -2.209687106619715e-02, 1.118326712704898e-01,  9.541422291274779e-03, -3.028979395094942e-02, 4.292569311585663e-03, 3.440739120073311e-02,  2.555311218089385e-02, 3.106493988726595e-03, 1.002440046387481e-02, 1.516599867996929e-02,  9.966117621068216e-03, -9.740210220810040e-03, 9.541422291274793e-03, 9.481053471821954e-02, -3.994526852966994e-03, 1.158084838159136e-03, 7.237569230068040e-03, 6.410162920769173e-03, -3.748224015312071e-02, -6.592179911688135e-03, 5.422721159423174e-02, -1.869954580901879e-02, -1.396711552442659e-03, -3.028979395094949e-02, -3.994526852967011e-03, 2.444365821399023e-01,  9.980804857206392e-03, -7.882738572197349e-02, -1.089826582324918e-01, -1.745692827497512e-02,  1.048618405571964e-02, 1.441396534424245e-02, 5.575769582164028e-03, -4.624433402535398e-03,  4.292569311585649e-03, 1.158084838159136e-03, 9.980804857206441e-03, 1.079119015534790e-01, -5.636172487602529e-03, -1.371757942220821e-02, -8.576658440203749e-03, 4.540803556443693e-02,  1.880462571912284e-02, 2.839228677223379e-02, -1.477867059695756e-02, 3.440739120073318e-02,  7.237569230068023e-03, -7.882738572197338e-02, -5.636172487602594e-03, 1.620470079363034e-01,  6.104037893981269e-02, 5.663422223084880e-02, -1.719696151469680e-03, -4.277513412958113e-02,  1.193448138348496e-02, -3.043595451545748e-03, 2.555311218089375e-02, 6.410162920769184e-03, -1.089826582324918e-01, -1.371757942220823e-02, 6.104037893981271e-02, 2.508068100394863e-01,  5.086478825882694e-02, -1.437615545880939e-02, -2.300326692847278e-03, -3.402063458148292e-03, -1.355300819270551e-03, -2.650444763573521e-03, 4.802191089902208e-03, -2.248100905697147e-02, -1.274300321540488e-02, -6.662852050356001e-03, 4.637303845994811e-02, -1.437615545880937e-02,  2.179132558964162e-01, 1.911219202326146e-01, 2.315223807540719e-02, -6.341066793286605e-02,  1.323690172605644e-02, 4.695216570335713e-03, 6.453367453362580e-02, 2.198951782082502e-02, -2.505580585372902e-03, -6.484186112220791e-02, -2.300326692847278e-03, 1.911219202326146e-01,  4.785778550893807e-01, 2.974558234305861e-02, -1.072680432057470e-01, 4.605460132691624e-03,  6.010646987408712e-03, 2.017892847998093e-01, 4.440215610707591e-02, -6.311074842739788e-02, -1.746780893009750e-01, -3.402063458148287e-03, 2.315223807540718e-02, 2.974558234305861e-02,  8.998143079995224e-02, -7.472001767747184e-03, 1.132490382732963e-02, 7.347065234801266e-03, -7.776784980322526e-03, 5.562693458021429e-03, 1.657333550942141e-02, 2.795572771253824e-03, -1.355300819270554e-03, -6.341066793286611e-02, -1.072680432057469e-01, -7.472001767747191e-03,  1.383886926517321e-01, -3.085409099260106e-03, -6.157014220843624e-03, -4.306739831373707e-02, -1.172325667837122e-02, 1.328208793887380e-02, 3.601985130228216e-02, -2.650444763573508e-03,  1.323690172605649e-02, 4.605460132691579e-03, 1.132490382732961e-02, -3.085409099260125e-03,  9.943086604647350e-02, 7.978485045359135e-03, -3.889665989638745e-02, -7.458248967881047e-04,  2.905738108601006e-02, 3.276727276149460e-02, 4.802191089902208e-03, 4.695216570335704e-03,  6.010646987408715e-03, 7.347065234801269e-03, -6.157014220843610e-03, 7.978485045359158e-03,  8.875188793680472e-02, -5.568004041340193e-03, 6.626579863793294e-05, 5.413304955916355e-03,  7.610054710372859e-03, -2.248100905697147e-02, 6.453367453362577e-02, 2.017892847998093e-01, -7.776784980322507e-03, -4.306739831373698e-02, -3.889665989638755e-02, -5.568004041340205e-03,  3.289457901727370e-01, 3.534010174370142e-02, -1.062979114837182e-01, -1.893127178943667e-01, -1.274300321540488e-02, 2.198951782082497e-02, 4.440215610707596e-02, 5.562693458021416e-03, -1.172325667837121e-02, -7.458248967881324e-04, 6.626579863793641e-05, 3.534010174370143e-02,  1.077708996114889e-01, -1.656136220223262e-02, -3.547394264640374e-02, -6.662852050356036e-03, -2.505580585372895e-03, -6.311074842739786e-02, 1.657333550942144e-02, 1.328208793887381e-02,  2.905738108601014e-02, 5.413304955916333e-03, -1.062979114837180e-01, -1.656136220223271e-02,  1.542737672233780e-01, 8.628986298142829e-02, 4.637303845994808e-02, -6.484186112220805e-02, -1.746780893009749e-01, 2.795572771253831e-03, 3.601985130228229e-02, 3.276727276149451e-02,  7.610054710372866e-03, -1.893127178943668e-01, -3.547394264640375e-02, 8.628986298142824e-02,  3.147064343337095e-01, 4.547779196864692e-02, 1.008266630767820e-02, 3.430682683042556e-02, -1.753194380871332e-03, -1.413315169959449e-02, -3.034244790183944e-04, 4.990270864346584e-03, -6.763366060044931e-03, -8.176754725460141e-03,
                  -9.241884399160041e-03, 3.363821885462505e-02,  1.008266630767823e-02, 1.615801216705255e-01, 1.350043159073474e-01, 1.535438840490314e-02, -3.413659614083737e-02, 9.068910806383302e-04, 6.056229108982805e-04, 6.011762951755725e-02,  2.088425950846293e-02, -1.658058183748023e-02, -6.226931101169472e-02, 3.430682683042557e-02,  1.350043159073473e-01, 4.060505321096562e-01, 2.121913357079791e-02, -7.149838104549260e-02, -6.113897216784643e-04, -7.953409310319185e-05, 1.735944579102276e-01, 4.319283759732996e-02, -6.928639389670876e-02, -1.539625133293840e-01, -1.753194380871329e-03, 1.535438840490315e-02,  2.121913357079792e-02, 8.439711159640470e-02, -4.878160582752701e-03, 1.032191049777292e-02,  6.416482973251969e-03, -9.784356223219125e-03, 3.669010345864823e-03, 1.486193931994331e-02,  5.468462072421288e-03, -1.413315169959450e-02, -3.413659614083745e-02, -7.149838104549254e-02, -4.878160582752686e-03, 1.177218932807444e-01, 1.624248150614111e-03, -4.589659409489755e-03, -3.173609833274622e-02, -9.593052818820651e-03, 1.492968040637786e-02, 2.808372028647985e-02, -3.034244790184051e-04, 9.068910806383874e-04, -6.113897216785246e-04, 1.032191049777292e-02,  1.624248150614073e-03, 8.853179343434250e-02, 7.425303384412418e-03, -2.562296775818041e-02, -9.410177329120563e-04, 1.941983137371869e-02, 2.205306561910651e-02, 4.990270864346580e-03,  6.056229108982771e-04, -7.953409310318318e-05, 6.416482973251975e-03, -4.589659409489749e-03,  7.425303384412442e-03, 8.398860358180357e-02, -7.041010423633897e-03, -8.345532045147038e-04,  4.664613948771211e-03, 9.005798961866547e-03, -6.763366060044997e-03, 6.011762951755722e-02,  1.735944579102276e-01, -9.784356223219083e-03, -3.173609833274617e-02, -2.562296775818041e-02, -7.041010423633910e-03, 2.738012449789924e-01, 3.383416088765002e-02, -8.371868408126254e-02, -1.495632056543593e-01, -8.176754725460127e-03, 2.088425950846289e-02, 4.319283759733000e-02,  3.669010345864808e-03, -9.593052818820644e-03, -9.410177329120840e-04, -8.345532045146969e-04,  3.383416088765005e-02, 1.037917092406473e-01, -1.738067226977359e-02, -3.450485968126255e-02, -9.241884399160072e-03, -1.658058183748016e-02, -6.928639389670885e-02, 1.486193931994335e-02,  1.492968040637783e-02, 1.941983137371879e-02, 4.664613948771202e-03, -8.371868408126248e-02, -1.738067226977365e-02, 1.345174673820434e-01, 6.947301898952658e-02, 3.363821885462501e-02, -6.226931101169479e-02, -1.539625133293839e-01, 5.468462072421321e-03, 2.808372028647993e-02,  2.205306561910647e-02, 9.005798961866547e-03, -1.495632056543594e-01, -3.450485968126253e-02,  6.947301898952660e-02, 2.777012374046995e-01, 4.555956729160522e-02, 1.895516400118608e-02,  5.625934866396406e-02, -8.359636590631841e-04, -1.850716469985116e-02, -2.677672111993481e-03,  3.124564529103667e-03, 9.596264067002980e-03, -4.227041442935562e-03, -2.040626586407272e-02,  1.622127748024907e-02, 1.895516400118608e-02, 1.435005881927894e-01, 1.030703323640214e-01,  1.416503964085328e-02, -2.902687735647931e-02, 2.280916333912313e-03, 4.036146214537135e-03,  3.060947587792805e-02, 1.376394848307518e-02, 7.346530022958511e-04, -2.652147826348760e-02,  5.625934866396401e-02, 1.030703323640215e-01, 3.460855235853132e-01, 1.752589272433902e-02, -5.703630335593512e-02, -3.780313743740447e-03, 2.832821316110391e-04, 1.336906062198319e-01,  3.508896676297782e-02, -5.530141816413602e-02, -1.055353576257707e-01, -8.359636590631841e-04,  1.416503964085328e-02, 1.752589272433899e-02, 7.965672420824056e-02, -5.512003281350856e-03,  1.024742560699880e-02, 7.099713691077669e-03, -1.222264854374552e-02, 1.854908617283320e-03,  1.770399374774033e-02, 1.080905629168226e-02, -1.850716469985115e-02, -2.902687735647933e-02, -5.703630335593502e-02, -5.512003281350854e-03, 1.135415153108286e-01, -4.058637205292916e-04, -7.039364635175938e-03, -1.466566191778554e-02, -5.702924146615891e-03, 2.278717171180726e-03,  7.964353471919068e-03, -2.677672111993487e-03, 2.280916333912326e-03, -3.780313743740552e-03,  1.024742560699881e-02, -4.058637205293025e-04, 8.907819859838474e-02, 9.992192171770756e-03, -3.339917844852685e-02, -3.720662008459879e-03, 2.946710101315868e-02, 3.217198703133761e-02,  3.124564529103663e-03, 4.036146214537126e-03, 2.832821316110425e-04, 7.099713691077673e-03, -7.039364635175928e-03, 9.992192171770782e-03, 8.214797817783824e-02, -1.269797686137365e-02, -1.881580881368437e-03, 9.795884131100340e-03, 1.481628588139815e-02, 9.596264067002966e-03,  3.060947587792800e-02, 1.336906062198318e-01, -1.222264854374551e-02, -1.466566191778548e-02, -3.339917844852684e-02, -1.269797686137367e-02, 2.526697437317296e-01, 3.197409267414156e-02, -9.302650347809790e-02, -1.329605048044912e-01, -4.227041442935566e-03, 1.376394848307516e-02,  3.508896676297786e-02, 1.854908617283311e-03, -5.702924146615884e-03, -3.720662008459883e-03, -1.881580881368434e-03, 3.197409267414155e-02, 1.003534760077043e-01, -2.050035681792485e-02, -3.220588466903609e-02, -2.040626586407273e-02, 7.346530022958511e-04, -5.530141816413624e-02,  1.770399374774036e-02, 2.278717171180728e-03, 2.946710101315875e-02, 9.795884131100328e-03, -9.302650347809775e-02, -2.050035681792493e-02, 1.496654217393636e-01, 8.071425368086978e-02,  1.622127748024903e-02, -2.652147826348766e-02, -1.055353576257707e-01, 1.080905629168229e-02,  7.964353471919114e-03, 3.217198703133761e-02, 1.481628588139813e-02, -1.329605048044910e-01, -3.220588466903610e-02, 8.071425368086980e-02, 2.590781816684786e-01, 4.621980915850431e-02,  1.482727833806387e-02, 4.530908100310799e-02, -8.092742277761092e-04, -1.591098653765263e-02, -2.139184153848446e-04, 3.783199673691402e-03, 8.252270523331773e-04, -7.097376465901008e-03, -1.220070347636039e-02, 2.498781313144967e-02, 1.482727833806386e-02, 1.538794491986182e-01,  1.218753556400776e-01, 1.840513954506590e-02, -3.529482893916241e-02, -1.954498736526196e-03,  3.837000259261433e-03, 3.445675980933324e-02, 1.791835336934562e-02, -1.960896883188242e-03, -3.845568482906991e-02, 4.530908100310799e-02, 1.218753556400776e-01, 3.698321980489345e-01,  2.711411178725595e-02, -6.566231446541480e-02, -9.465209821436069e-03, -4.821153388783958e-05,  1.406965319289329e-01, 4.016228669210127e-02, -5.143408209274919e-02, -1.253401083782470e-01, -8.092742277761135e-04, 1.840513954506590e-02, 2.711411178725592e-02, 7.772864582615793e-02, -8.692401982816180e-03, 8.040515627902997e-03, 6.278563459027012e-03, -4.767636590945057e-03,  4.102454008032377e-03, 1.184022724709655e-02, 3.087659701359145e-03, -1.591098653765261e-02, -3.529482893916244e-02, -6.566231446541473e-02, -8.692401982816175e-03, 1.159796159796281e-01,  1.156784846848341e-03, -6.886306741842667e-03, -1.365554939783357e-02, -7.784230153185946e-03,  2.525784821832889e-03, 1.232176553662346e-02, -2.139184153848489e-04, -1.954498736526197e-03, -9.465209821436109e-03, 8.040515627902999e-03, 1.156784846848338e-03, 8.618507411006718e-02,  8.613363637181482e-03, -3.751704240595290e-02, -2.921438717550642e-03, 2.430097085319246e-02,  3.423456489071743e-02, 3.783199673691401e-03, 3.837000259261422e-03, -4.821153388784218e-05,  6.278563459027013e-03, -6.886306741842654e-03, 8.613363637181501e-03, 8.019279682170360e-02, -1.109945282748732e-02,
                  -9.106909087092559e-04, 7.148070785490689e-03, 1.297698943133808e-02,  8.252270523331478e-04, 3.445675980933320e-02, 1.406965319289328e-01, -4.767636590945053e-03, -1.365554939783354e-02, -3.751704240595294e-02, -1.109945282748733e-02, 2.646312968589406e-01,  3.167106791070420e-02, -8.252682202562503e-02, -1.474172338412466e-01, -7.097376465901009e-03,  1.791835336934561e-02, 4.016228669210130e-02, 4.102454008032367e-03, -7.784230153185941e-03, -2.921438717550653e-03, -9.106909087092567e-04, 3.167106791070422e-02, 9.890238353083725e-02, -1.622899605738831e-02, -3.282722209073995e-02, -1.220070347636044e-02, -1.960896883188254e-03, -5.143408209274930e-02, 1.184022724709657e-02, 2.525784821832905e-03, 2.430097085319250e-02,  7.148070785490679e-03, -8.252682202562490e-02, -1.622899605738836e-02, 1.300012714900114e-01,  7.152555659065553e-02, 2.498781313144967e-02, -3.845568482906998e-02, -1.253401083782470e-01,  3.087659701359153e-03, 1.232176553662351e-02, 3.423456489071742e-02, 1.297698943133807e-02, -1.474172338412465e-01, -3.282722209073995e-02, 7.152555659065553e-02, 2.742651577415615e-01,  4.824086150194780e-02, 1.851135177309875e-02, 4.919445282763738e-02, 2.026343608529330e-03, -1.931904551997846e-02, 9.567961972648418e-04, 5.586295194090445e-03, -6.021924335562422e-03, -6.508053299023071e-03, -8.460044324054087e-03, 2.958283058369288e-02, 1.851135177309876e-02,  1.530211774429552e-01, 1.306503444528651e-01, 8.565386817628735e-03, -3.294697107164529e-02, -6.983941246038889e-03, 4.541889871427866e-03, 6.651219774041864e-02, 2.240812507035436e-02, -2.168119876121058e-02, -5.841534261623262e-02, 4.919445282763746e-02, 1.306503444528650e-01,  4.009968270422022e-01, 1.546755692650689e-02, -6.987140501986530e-02, -1.712986944456319e-02,  5.208914493073358e-03, 2.031835751339987e-01, 5.286393340247356e-02, -8.726529675140678e-02, -1.630731587972041e-01, 2.026343608529316e-03, 8.565386817628732e-03, 1.546755692650689e-02,  7.221806174111212e-02, -2.956625824138957e-03, 3.964969155321290e-03, 4.455517277886846e-03,  1.962730076385800e-03, 4.143781052237766e-03, 5.156052977788983e-03, -1.968318796819364e-03, -1.931904551997846e-02, -3.294697107164530e-02, -6.987140501986536e-02, -2.956625824138952e-03,  1.128862842732083e-01, 5.834439526125107e-03, -6.122318664896888e-03, -3.676804281683675e-02, -1.114271849306042e-02, 1.674509039579066e-02, 2.803535965627334e-02, 9.567961972648431e-04, -6.983941246038875e-03, -1.712986944456315e-02, 3.964969155321289e-03, 5.834439526125094e-03,  8.503433081649769e-02, 5.123921436402184e-03, -3.532575850175484e-02, -4.945370927768528e-03,  2.195756829848736e-02, 3.209350408514255e-02, 5.586295194090444e-03, 4.541889871427857e-03,  5.208914493073378e-03, 4.455517277886845e-03, -6.122318664896884e-03, 5.123921436402191e-03,  7.861785808925978e-02, 1.250641839785160e-03, 1.037969409675231e-03, 1.075848447909490e-04,  2.221353785030102e-03, -6.021924335562440e-03, 6.651219774041860e-02, 2.031835751339988e-01,  1.962730076385770e-03, -3.676804281683670e-02, -3.532575850175487e-02, 1.250641839785148e-03,  3.018194082508843e-01, 4.454252039582007e-02, -9.613563827741606e-02, -1.662603645558211e-01, -6.508053299023061e-03, 2.240812507035436e-02, 5.286393340247352e-02, 4.143781052237760e-03, -1.114271849306042e-02, -4.945370927768534e-03, 1.037969409675228e-03, 4.454252039582009e-02,  1.021864924449853e-01, -2.303064630620258e-02, -4.158291262103771e-02, -8.460044324054143e-03, -2.168119876121056e-02, -8.726529675140686e-02, 5.156052977788996e-03, 1.674509039579065e-02,  2.195756829848743e-02, 1.075848447909603e-04, -9.613563827741592e-02, -2.303064630620261e-02,  1.329392602904001e-01, 7.843700158703966e-02, 2.958283058369286e-02, -5.841534261623266e-02, -1.630731587972040e-01, -1.968318796819375e-03, 2.803535965627342e-02, 3.209350408514251e-02,  2.221353785030089e-03, -1.662603645558212e-01, -4.158291262103771e-02, 7.843700158703966e-02,  2.826946749206500e-01, 4.789743388848910e-02, 5.022361246522075e-03, 1.002153436320021e-02,  1.896346533360564e-03, -1.167979305628103e-02, 8.662379429434760e-03, 6.755834045531347e-03, -4.712910721179382e-02, -1.186670925647884e-02, 1.119597955684073e-02, 6.217453923458157e-02,  5.022361246522074e-03, 1.252461819913556e-01, 5.394796664055224e-02, 2.924148894385824e-03, -2.318123705364925e-02, 4.465297406100079e-03, 1.152224878720113e-03, 1.119811620759379e-02, -1.385770710675961e-03, 6.424621582570348e-03, -7.063313736800847e-03, 1.002153436320020e-02,  5.394796664055224e-02, 1.888337340835190e-01, 6.253609192063760e-03, -3.879795959386224e-02,  1.826141536829474e-02, -1.481109092385058e-03, 3.926398236740268e-02, -6.572198877471333e-04, -3.916254756103621e-03, -1.811865972202656e-02, 1.896346533360559e-03, 2.924148894385825e-03,  6.253609192063748e-03, 7.228921745774934e-02, -2.369583853768190e-03, 3.963246012894412e-03,  4.470110205076099e-03, -3.310945969490978e-03, 8.647105508165584e-04, 7.028574018687697e-03,  3.672071127273125e-03, -1.167979305628102e-02, -2.318123705364922e-02, -3.879795959386224e-02, -2.369583853768181e-03, 1.118096326996528e-01, -8.031503324605132e-04, -4.679042572868520e-03, -1.163819758968773e-02, 2.163601608566522e-04, 2.394741759387394e-03, 4.084560925757518e-03,  8.662379429434748e-03, 4.465297406100088e-03, 1.826141536829472e-02, 3.963246012894410e-03, -8.031503324605182e-04, 7.898339683533412e-02, 4.967396671384395e-03, -2.368286320066361e-03, -3.670949812920956e-04, 5.151914855139515e-03, 6.023060896646894e-03, 6.755834045531347e-03,  1.152224878720107e-03, -1.481109092385054e-03, 4.470110205076097e-03, -4.679042572868515e-03,  4.967396671384395e-03, 7.993244064723898e-02, -2.747843064232616e-03, 1.324774852304459e-04,  1.756451867057228e-03, 6.240875724027183e-03, -4.712910721179387e-02, 1.119811620759383e-02,  3.926398236740260e-02, -3.310945969490991e-03, -1.163819758968774e-02, -2.368286320066373e-03, -2.747843064232614e-03, 1.691990765058825e-01, 9.166053045845233e-03, -2.546094851573300e-02, -5.159184401030641e-02, -1.186670925647884e-02, -1.385770710675954e-03, -6.572198877471298e-04,  8.647105508165591e-04, 2.163601608566520e-04, -3.670949812921032e-04, 1.324774852304433e-04,  9.166053045845226e-03, 9.443400999348293e-02, -8.022481546586855e-03, -1.125211627477077e-02,  1.119597955684071e-02, 6.424621582570346e-03, -3.916254756103677e-03, 7.028574018687696e-03,  2.394741759387396e-03, 5.151914855139505e-03, 1.756451867057228e-03, -2.546094851573290e-02, -8.022481546586859e-03, 9.811468965818401e-02, 2.015830417931792e-02, 6.217453923458156e-02, -7.063313736800851e-03, -1.811865972202653e-02, 3.672071127273115e-03, 4.084560925757545e-03,  6.023060896646880e-03, 6.240875724027184e-03, -5.159184401030636e-02, -1.125211627477078e-02,  2.015830417931798e-02, 1.905564600888125e-01, 5.713600911939040e-02, 6.499161351604606e-03,  7.766394940110624e-03, 2.527731240385220e-03, -9.012890218966738e-03, 6.949656297538765e-03,  4.568708128856097e-03, -5.141992501894355e-02, -1.309942974773104e-02, 1.489128606970862e-02,  6.662603721662934e-02, 6.499161351604606e-03, 1.866439453909846e-01, 1.572469160149176e-01,  1.353826946481763e-02, -4.687675981588776e-02, 8.221092535367087e-03, 1.704094247595567e-03,
                  6.833467601482637e-02, 1.615934319476086e-02, -1.254415311765016e-02, -6.685420825447476e-02,  7.766394940110624e-03, 1.572469160149176e-01, 4.044522987248722e-01, 2.355332599094641e-02, -8.540714793134269e-02, 1.087058676536043e-02, -3.995860137763657e-03, 1.753795359445343e-01,  3.115307825075266e-02, -5.630696997460040e-02, -1.480108776599309e-01, 2.527731240385220e-03,  1.353826946481763e-02, 2.355332599094641e-02, 8.184537458138239e-02, -6.972965822049454e-03,  7.965705586882893e-03, 7.664576608709173e-03, 1.922270386483471e-03, 4.994564783320641e-03,  8.807249106040631e-03, -4.302802473614574e-03, -9.012890218966738e-03, -4.687675981588776e-02, -8.540714793134269e-02, -6.972965822049454e-03, 1.297660941933373e-01, -3.107382441678720e-03, -5.527035493541979e-03, -3.874422984693320e-02, -7.598436974156865e-03, 1.364945434483522e-02,  3.155904166994288e-02, 6.949656297538765e-03, 8.221092535367087e-03, 1.087058676536043e-02,  7.965705586882893e-03, -3.107382441678720e-03, 9.556422962750245e-02, 9.230571400805677e-03, -2.398497881085540e-02, -7.320558538295129e-04, 1.921534319331807e-02, 2.115345512787638e-02,  4.568708128856097e-03, 1.704094247595567e-03, -3.995860137763657e-03, 7.664576608709173e-03, -5.527035493541979e-03, 9.230571400805677e-03, 8.762922892534317e-02, -1.214975389414722e-02, -7.001404409247565e-04, 8.134689705863144e-03, 1.353791849066216e-02, -5.141992501894355e-02,  6.833467601482637e-02, 1.753795359445343e-01, 1.922270386483471e-03, -3.874422984693320e-02, -2.398497881085540e-02, -1.214975389414722e-02, 2.817380276981974e-01, 2.473262779188702e-02, -7.430124439442239e-02, -1.416035686230538e-01, -1.309942974773104e-02, 1.615934319476086e-02,  3.115307825075266e-02, 4.994564783320641e-03, -7.598436974156865e-03, -7.320558538295129e-04, -7.001404409247565e-04, 2.473262779188702e-02, 1.034931635755103e-01, -1.206142626025931e-02, -2.546537027357219e-02, 1.489128606970862e-02, -1.254415311765016e-02, -5.630696997460040e-02,  8.807249106040631e-03, 1.364945434483522e-02, 1.921534319331807e-02, 8.134689705863144e-03, -7.430124439442239e-02, -1.206142626025931e-02, 1.294249924096733e-01, 5.700429717908129e-02,  6.662603721662934e-02, -6.685420825447476e-02, -1.480108776599309e-01, -4.302802473614574e-03,  3.155904166994288e-02, 2.115345512787638e-02, 1.353791849066216e-02, -1.416035686230538e-01, -2.546537027357219e-02, 5.700429717908129e-02, 2.747854767565665e-01 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$method),
               c("EKF" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$model),
               c("exponential" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$LR),
               c(0.0877914951989026 )
               , tolerance = 1e-05)
})

#############
# Test ukf for exponential model
test_that("UKF and exp models give previous computed results",{
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 2,
    Q_0 = diag(1, 2),
    Q = diag(1e-1, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4,
                   method = "UKF", beta = 0),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential"))

  # plot(result_exp, cov_index = 1)
  # get_expect_equal(result_exp, file = "tmp.txt")

  expect_equal(c(result_exp$state_vecs),
               c(-3.332840740718193029, -3.332822250137025932, -2.923861120303411276, -2.727471174103770934, -3.090988752695992492, -3.293351899951584727, -3.571854150946127238, -3.676317531624117230, -3.742758751761861458, -3.890508361364675149, -3.992619532099787261, -4.130692031140956288, -4.271024152051962730, -4.384717160939776370, -4.414504027922524720, -4.488301855358229453, 0.315493429245171431, 0.315505122698867047,  0.527476450934948771, 0.618254387066295430, 0.428814162175747193, 0.337376258195228484, 0.198315311921173271, 0.159366952811875462,  0.124445816389704589, 0.051091730118293543, -0.001418689767310383, -0.083168697117346202, -0.160342111418638966, -0.221377759050943090, -0.241833209810962124, -0.277633027855855752 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.255409032945308478, 0.041681065472357601, 0.041681065472355908, 0.172259295135547941, 0.173242106820910430, 0.005142424115199579,  0.005142424115197552, 0.139380856414822507, 0.134515978309694084, -0.011311843198764812, -0.011311843198766852, 0.121739185078229090,  0.099426500727042511, -0.029693096334480973, -0.029693096334483055, 0.102992833726633926, 0.082576467765177464, -0.037303838826185841, -0.037303838826187936, 0.096018004006115099, 0.095995170672425675, -0.027511045742579471, -0.027511045742581598, 0.107501992868270196,  0.109171511574576274, -0.020009896050265673, -0.020009896050267800, 0.120842308788353808, 0.127243387144550413, -0.011526137736463582, -0.011526137736465700, 0.136994598552954622, 0.141293103574063328, -0.006254712347011047, -0.006254712347013164, 0.152753297878936406,  0.152647478238323975, -0.003775032406811950, -0.003775032406814049, 0.167951297768813901, 0.172715299507726405, 0.002612068025619866,  0.002612068025617767, 0.186694651494779568, 0.192631304770069289, 0.008483359226008388, 0.008483359226006279, 0.206224972421181374,  0.218793634202863962, 0.016414439381579285, 0.016414439381577189, 0.227519744975829608, 0.257465483830288666, 0.029762223718021098,  0.029762223718018999, 0.252294432127692647, 0.315092923689252680, 0.051936729485181174, 0.051936729485179071, 0.282183511486266192,  0.398047090203280163, 0.085809350672370610, 0.085809350672368501, 0.318253473960030286 ))

  expect_equal(c(result_exp$lag_one_cor),
               c(  1.445126746557714e-01, 8.945368624457689e-03, 7.886695913253167e-03, 1.135990761727050e-01, 9.222067222518762e-02,  -1.217131453386278e-02, -1.305150270724326e-02, 8.999092719677304e-02, 6.069383009547760e-02, -2.371507783711904e-02,  -2.646505045909213e-02, 7.241855703744710e-02, 4.296171379947778e-02, -3.057240612960867e-02, -3.102116078717648e-02,   6.044922494173789e-02, 4.010066275869526e-02, -2.891924125889461e-02, -2.625611520968165e-02, 5.788476009194567e-02,   4.726889325261068e-02, -2.020787567072624e-02, -1.805985106493634e-02, 6.101409088700727e-02, 5.735311464439347e-02,  -1.087929818252009e-02, -9.227010470912927e-03, 6.453440319651915e-02, 6.893235007961124e-02, -1.143479574963614e-03,   1.855359023417158e-05, 6.742511217910636e-02, 7.747004462725686e-02, 6.903039336240691e-03, 7.540368710888208e-03,   6.790946945064889e-02, 8.700459440438385e-02, 1.541463450666930e-02, 1.588986574674081e-02, 6.699866026027476e-02,   9.716668357533065e-02, 2.476111015384290e-02, 2.508816274706679e-02, 6.461887835344704e-02, 1.016622926168836e-01,   3.182606731539421e-02, 3.196006359939520e-02, 5.883177577751661e-02, 9.640586939587964e-02, 3.459380715191045e-02,   3.463735844264018e-02, 4.847601622324874e-02, 6.966116476479006e-02, 2.747529148564239e-02, 2.748679150348263e-02,   3.064264393933053e-02, 0.000000000000000e+00, 0.000000000000000e+00, 1.762826224361568e-320, 1.978423033621121e-316 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(58 ))

  expect_equal(c(result_exp$Q),
               c(0.07125498137081250, 0.03131371745527368, 0.03131371745527368, 0.02525327590571668 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("UKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(1 ))




  set.seed(44334)
  sims <- test_sim_func_exp(n_series = 1e4, n_vars = 10, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                            intercept_start = -5, sds = c(.1, rep(1, 10)))
  # sum(sims$res$event)

  arg_list <- list(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(1, 11),
    Q = diag(1e-2, 11),
    control = list(est_Q_0 = F, n_max = 10^2, eps = 10^-2,
                   method = "UKF", beta = 2),
    max_T = 10,
    id = sims$res$id, order = 1,
    model = "exponential")

  suppressMessages(fit <- do.call(ddhazard, arg_list))

  # matplot(fit$state_vecs, lty = 2, type = "l", ylim = range(fit$state_vecs, sims$betas))
  # matplot(sims$betas, lty = 1, add = T, type = "l")
  # get_expect_equal(fit, eps = 1e-6, file = "tmp.txt")

  expect_equal(c(fit$state_vecs),
               c(-5.46240253347558191, -5.45168759550071957, -5.38959623938731447, -5.23706151947632215, -5.14155371737841538, -5.03737490907076246, -4.93529252010901232, -4.84477156722270585, -4.72562307511566004, -4.72678125964560802, -4.72065297018423458, 1.17430497372487141,  1.17345703617540642, 1.10518049442502275, 1.12575706991393187, 0.83291223617111843, 0.93528156002693574, 1.13658713122011124,  1.60030866301405106, 2.24679972818374507, 2.30549600242659025, 2.21358846154839206, 0.40905390898059413, 0.49874941376529380,  0.87911724571329475, 1.46228739783274264, 2.64197437835178839, 3.44341155167925006, 4.16725443285018216, 4.22136193547643668,  4.15322202236251581, 4.24967775033601303, 4.67236601719690725, -0.20366748406192170, -0.23949422345181220, -0.88896856361455412, -1.16015263287965720, -2.71663104612552431, -2.70456444991329947, -1.11229608084838816, 0.45779357187136077, 1.76326025752168181,  1.80585292882046988, 1.45103264423518352, 0.56385380700761789, 0.49143207472170786, 0.16553587775534606, -0.97121119050395732, -2.15854061485078752, -2.55193745034155395, -3.82720716789826554, -3.19370872619777302, -1.60292030650282435, -1.18734729412350393, -1.26825892390678829, 1.34021637374854108, 1.35422371475913939, 1.18251744549490434, -0.48648413816981162, -0.14056587468209591, -0.10655172139927355, -0.02609661298574396, 0.73281228960972922, 0.59794511114899818, 1.19503348538996090, 2.68881095119945801, -0.59678233826911886, -0.57153716238878827, -0.44757217617740547, -0.51492378547855955, -0.36277562728233670, 0.09572899313142852, -0.16449050508545598, 0.30432008072034011, 1.38831779185943183, 1.66684589869080568, 1.80764285573871342, -0.78687293673162040, -0.84864734805069975, -1.04045987773891868, -1.64979764407108753, -2.40626525459412921, -2.85672326802455068, -3.94158530496458104, -4.05295906233366487, -3.56588378821241081, -3.46429853284320455, -3.72155941943486557, 0.27037775414358883, 0.20763103521750748, -0.24139082798223796, -0.39469506514098845, -1.27764557408804325, -2.11563663465819429, -1.16737945314784519, -1.31221517917641317, -2.77833793521092254, -3.23433362769937771, -3.48804296823782511, 0.07517591256172930, 0.11049575301587966, 0.55942975532738559,  0.61411418594000433, 1.22405109496217279, 1.72908912686229432, 0.31551498805994055, 0.60335641097859183, 2.05691938667287300,  2.37721656460391406, 2.62282940885573090, 0.55690166786144668, 0.56174083746344350, 0.35768473431699849, -0.05554646353874537, -0.10602459470659154, -0.16500597901489772, 0.70809545689742737, 1.18466233559576173, 0.74053414038051701, 0.76299820108216976,  1.25681618746420698 )
               , tolerance = 1e-06)

  expect_equal(c(fit$state_vars),
               c( 3.453009810530305e-02, 1.949987604529555e-02, 2.958366604134210e-02, 1.643198192770131e-02, -1.602499493159935e-02, -1.647688980564990e-02, 1.154493916376954e-02, -2.192656398192337e-02, -1.480269694456874e-02, 1.984675900518476e-02, -8.467373937235565e-04, 1.949987604528225e-02, 6.830847935060613e-02, 1.229779519909277e-02, 1.274390239010902e-01,  4.601121737045934e-02, -2.295460059049657e-02, 4.065717087828236e-02, -1.078818490828994e-02, -2.973424059419157e-02,  3.456175742753459e-02, 4.113575632538169e-03, 2.958366604135485e-02, 1.229779519909259e-02, 2.403308093373304e-01, -1.085038069297111e-02, -1.721272757051971e-01, 3.024930577399809e-02, 5.406189961133567e-02, -1.499555251697321e-01, -1.139302262430531e-01, 3.083243845409894e-02, 2.722515799643564e-02, 1.643198192768846e-02, 1.274390239010902e-01, -1.085038069297120e-02, 5.333889692980064e-01, 1.082489785351010e-01, -1.919691499451117e-02, 8.126844720556729e-02, -2.797930075006177e-02, 3.697513480226255e-02, -5.972634897162055e-02, 8.045535595392270e-02, -1.602499493130539e-02,  4.601121737046943e-02, -1.721272757051936e-01, 1.082489785350986e-01, 3.528463034683618e-01, 7.290530267310016e-02,  6.231393143098884e-02, 1.818184359431934e-01, -5.626511071628514e-02, 1.044178192016277e-01, -4.428839605202327e-02, -1.647688980537106e-02, -2.295460059048643e-02, 3.024930577400262e-02, -1.919691499451179e-02, 7.290530267309289e-02,  4.886769672764985e-01, 2.215301907223956e-02, -3.226336235882996e-03, -5.859987370970182e-03, 4.432103257678729e-03,  1.504809580754422e-01, 1.154493916381362e-02, 4.065717087828372e-02, 5.406189961133528e-02, 8.126844720556779e-02,  6.231393143099468e-02, 2.215301907224591e-02, 1.296204694350750e-01, -4.754099563614876e-03, -1.336126453191278e-01,  1.107998256198637e-01, -1.739693588569343e-02, -2.192656398189764e-02, -1.078818490828925e-02, -1.499555251697315e-01, -2.797930075006108e-02, 1.818184359432005e-01, -3.226336235873855e-03, -4.754099563615886e-03, 1.930702910280921e-01,  9.972787073764625e-03, 2.615493732539064e-02, -5.879478368783018e-02, -1.480269694458617e-02, -2.973424059419161e-02, -1.139302262430547e-01, 3.697513480226426e-02, -5.626511071628639e-02, -5.859987370972386e-03, -1.336126453191276e-01,  9.972787073763596e-03, 2.996309109731123e-01, -2.024450987235071e-01, 7.320683030920871e-02, 1.984675900522615e-02,  3.456175742753528e-02, 3.083243845409895e-02, -5.972634897162101e-02, 1.044178192016262e-01, 4.432103257679848e-03,  1.107998256198623e-01, 2.615493732539011e-02, -2.024450987235064e-01, 3.039653655673444e-01, -6.382064380778059e-02, -8.467373937298554e-04, 4.113575632538250e-03, 2.722515799643548e-02, 8.045535595392231e-02, -4.428839605202732e-02,  1.504809580754379e-01, -1.739693588569288e-02, -5.879478368783012e-02, 7.320683030920890e-02, -6.382064380778141e-02,  1.438238394718865e-01, 2.746651611844830e-02, 1.275307782056348e-02, 1.392562043455358e-02, 6.875046983085657e-03, -6.261940947408616e-03, -8.342909207235256e-03, 4.752078707916160e-03, -9.807242530388045e-03, -4.697354467426824e-03,  1.174141787143396e-02, -7.338700703106086e-04, 1.275307782060020e-02, 3.728701622718356e-02, 8.674327039741799e-03,  3.941309666990114e-02, 1.250508857216865e-02, -1.259941408217743e-02, 1.259078675196801e-02, -8.673125665249894e-03, -1.016226044001107e-02, 1.696400044722127e-02, 6.587154184258240e-04, 1.392562043445291e-02, 8.674327039732491e-03,  1.010831869140925e-01, 3.736788924771041e-03, -5.368460964437274e-02, 1.141708181838928e-02, 2.258925382728431e-02, -5.030052795143819e-02, -4.411159442604720e-02, 9.922735604901400e-03, 7.010356066040379e-03, 6.875046983187616e-03,  3.941309666990736e-02, 3.736788924782021e-03, 1.656293369996487e-01, 2.260090277471075e-02, -1.087472073701466e-02,  2.441367244841967e-02, -1.358711493190750e-02, 6.488271755900089e-03, -1.468884871685780e-02, 2.205500253909078e-02, -6.261940946743400e-03, 1.250508857220340e-02, -5.368460964432472e-02, 2.260090277472739e-02, 1.183989303798452e-01,  2.230546394126819e-02, 1.337369603772526e-02, 5.564818359654843e-02, -1.208940907641096e-02, 2.394733509881211e-02, -1.473427136337815e-02, -8.342909206648128e-03, -1.259941408214855e-02, 1.141708181844239e-02, -1.087472073700193e-02,  2.230546394122299e-02, 2.140678661073485e-01, 4.453984234575292e-03, -2.702256873107878e-03, 4.213240720494914e-03, -6.314653479127987e-03, 6.348150022809505e-02, 4.752078708082202e-03, 1.259078675197611e-02, 2.258925382729565e-02,  2.441367244842363e-02, 1.337369603771578e-02, 4.453984234575272e-03, 6.558912327805103e-02, -4.025410591992838e-03, -4.760878922648916e-02, 3.825823132378588e-02, -7.599140656152134e-03, -9.807242530197940e-03, -8.673125665237412e-03, -5.030052795143165e-02, -1.358711493189306e-02, 5.564818359659023e-02, -2.702256873053419e-03, -4.025410591982661e-03,  9.285887825753536e-02, 6.819904512072199e-03, -1.244791934035617e-03, -2.274894747666524e-02, -4.697354467579615e-03, -1.016226044001496e-02, -4.411159442606440e-02, 6.488271755906853e-03, -1.208940907637966e-02, 4.213240720509810e-03, -4.760878922648366e-02, 6.819904512087010e-03, 1.255873705881322e-01, -6.033858880875962e-02, 2.728015813075587e-02,  1.174141787165894e-02, 1.696400044722912e-02, 9.922735604920876e-03, -1.468884871685881e-02, 2.394733509878361e-02, -6.314653479133906e-03, 3.825823132378114e-02, -1.244791934054979e-03, -6.033858880876151e-02, 1.432827697604097e-01, -1.514762437124692e-02, -7.338700702948214e-04, 6.587154184263665e-04, 7.010356066045050e-03, 2.205500253908856e-02, -1.473427136339504e-02, 6.348150022807938e-02, -7.599140656154248e-03, -2.274894747667230e-02, 2.728015813075806e-02, -1.514762437125219e-02, 7.677007379333387e-02, 2.440408483754156e-02, 1.244387670496883e-02, 1.755499900900388e-02,  1.078754464911230e-02, -8.835410485193519e-03, -1.088289118311306e-02, 7.899469165253862e-03, -1.240149569353039e-02, -9.831833680850235e-03, 1.280959148268844e-02, -1.219363745744852e-03, 1.244387670500238e-02, 4.131940292884040e-02,  1.008103366078422e-02, 6.544165034591494e-02, 2.048549297756684e-02, -1.503742198244185e-02, 2.180689397012826e-02, -8.810853277493523e-03, -1.770236256013895e-02, 2.039482371699928e-02, 1.416191560691287e-03, 1.755499900890827e-02,  1.008103366077541e-02, 1.204079447026467e-01, 2.329765407090475e-03, -7.677492590417148e-02, 1.244861663187208e-02,  2.910269827571809e-02, -7.108982445223318e-02, -5.845796453411528e-02, 1.869006748817403e-02, 1.179810003796378e-02,  1.078754464922067e-02, 6.544165034592199e-02, 2.329765407102502e-03, 2.683245926231891e-01, 5.080509247531026e-02, -9.993411694460240e-03, 4.374048905507721e-02, -1.749842191401249e-02, 1.006349193211648e-02, -2.438194304536413e-02,  3.831887520631518e-02, -8.835410484548844e-03, 2.048549297759959e-02, -7.677492590412771e-02, 5.080509247532381e-02,  1.562332546686047e-01, 2.957215570831439e-02, 2.394962205745076e-02, 7.834920476994545e-02, -1.759494886498948e-02,  3.850611359667158e-02, -1.784329872899347e-02, -1.088289118251277e-02, -1.503742198241154e-02, 1.244861663192837e-02, -9.993411694445665e-03, 2.957215570827068e-02, 2.698520571065491e-01, 5.129621424954493e-03, -4.261737936279863e-03,  9.867083762356900e-03, -9.288684362636171e-03,
                  8.603023527515606e-02, 7.899469165408714e-03, 2.180689397013538e-02,  2.910269827572671e-02, 4.374048905507862e-02, 2.394962205744432e-02, 5.129621424951853e-03, 7.756553558641330e-02, -6.432186254070558e-03, -7.005062106848850e-02, 5.888500322691877e-02, -9.573775792792123e-03, -1.240149569335280e-02, -8.810853277482288e-03, -7.108982445222858e-02, -1.749842191399896e-02, 7.834920476998462e-02, -4.261737936224240e-03, -6.432186254063373e-03, 1.075747931095282e-01, 1.118453587375720e-02, 4.421647530039823e-03, -2.910002664997593e-02, -9.831833680980336e-03, -1.770236256014089e-02, -5.845796453412675e-02, 1.006349193212827e-02, -1.759494886496352e-02,  9.867083762377039e-03, -7.005062106848255e-02, 1.118453587376621e-02, 1.658890412052848e-01, -1.048897725980491e-01,  3.905577864824589e-02, 1.280959148288810e-02, 2.039482371700485e-02, 1.869006748818763e-02, -2.438194304537008e-02,  3.850611359664693e-02, -9.288684362646526e-03, 5.888500322691254e-02, 4.421647530025699e-03, -1.048897725980489e-01,  1.754615411205797e-01, -3.184787144696727e-02, -1.219363745713085e-03, 1.416191560693424e-03, 1.179810003797191e-02,  3.831887520631523e-02, -1.784329872900985e-02, 8.603023527514106e-02, -9.573775792791769e-03, -2.910002664998478e-02,  3.905577864824339e-02, -3.184787144696893e-02, 8.795867491876702e-02, 2.079502525792898e-02, 1.063736808739005e-02,  1.789978888199206e-02, 1.097588254899301e-02, -1.020242051228504e-02, -1.114268690302247e-02, 8.411670351126299e-03, -1.258822287522409e-02, -1.089924975703819e-02, 1.144717590309754e-02, -1.283110576047637e-03, 1.063736808742415e-02,  3.649252599116662e-02, 1.103457101770896e-02, 6.224357373535606e-02, 1.651057060890367e-02, -1.513269377703102e-02,  2.105403186718817e-02, -9.372566661493878e-03, -1.747046989000625e-02, 1.808995107650176e-02, 1.307277663618602e-03,  1.789978888189531e-02, 1.103457101769964e-02, 1.157355034157203e-01, 4.814238077048031e-03, -7.676033357473544e-02,  7.787705619872409e-03, 3.037847238931019e-02, -7.129512606774220e-02, -5.926882769356137e-02, 2.238472545392690e-02,  1.085193630843243e-02, 1.097588254910315e-02, 6.224357373536340e-02, 4.814238077062154e-03, 2.542987199646505e-01,  4.599240333345966e-02, -1.306087180712786e-02, 4.229440537039194e-02, -1.848502085033437e-02, 7.865278284152852e-03, -2.212560391212158e-02, 3.544835812234465e-02, -1.020242051163996e-02, 1.651057060893654e-02, -7.676033357469199e-02,  4.599240333347439e-02, 1.415490380891223e-01, 2.792439796384558e-02, 1.686090491537151e-02, 7.416553602573318e-02, -6.974358143748877e-03, 2.858158952510736e-02, -1.416828206888163e-02, -1.114268690242753e-02, -1.513269377700191e-02,  7.787705619923764e-03, -1.306087180711367e-02, 2.792439796380417e-02, 2.512138666275630e-01, 1.994381446989353e-03, -2.240252968739148e-03, 1.287257756616249e-02, -1.056608485188184e-02, 8.062392013385319e-02, 8.411670351281044e-03,  2.105403186719504e-02, 3.037847238931894e-02, 4.229440537039254e-02, 1.686090491536529e-02, 1.994381446989473e-03,  7.161970430025244e-02, -1.025924074458116e-02, -6.665197465080938e-02, 5.583572732767083e-02, -8.381567200916784e-03, -1.258822287504584e-02, -9.372566661482366e-03, -7.129512606773784e-02, -1.848502085031950e-02, 7.416553602577222e-02, -2.240252968686750e-03, -1.025924074457401e-02, 1.014039629437891e-01, 1.710038520926577e-02, 4.769223142842894e-05, -2.560361015794940e-02, -1.089924975716797e-02, -1.747046989000779e-02, -5.926882769357310e-02, 7.865278284166333e-03, -6.974358143723238e-03, 1.287257756617789e-02, -6.665197465080352e-02, 1.710038520927472e-02, 1.552099463580658e-01, -1.009321672937266e-01, 3.539525899704216e-02, 1.144717590329711e-02, 1.808995107650703e-02, 2.238472545394089e-02, -2.212560391212870e-02, 2.858158952508268e-02, -1.056608485188874e-02, 5.583572732766461e-02, 4.769223141416626e-05, -1.009321672937263e-01, 1.592905658200129e-01, -3.007958268467426e-02, -1.283110576017581e-03, 1.307277663620379e-03,  1.085193630843919e-02, 3.544835812234452e-02, -1.416828206889746e-02, 8.062392013383803e-02, -8.381567200917279e-03, -2.560361015795736e-02, 3.539525899704100e-02, -3.007958268467702e-02, 7.968734853840390e-02, 1.694797409152982e-02,  7.853192151262270e-03, 1.632214892356742e-02, 8.482588577041610e-03, -1.046671197871660e-02, -8.852538420313156e-03,  7.335178631486318e-03, -1.117832703803396e-02, -9.717537873556855e-03, 8.682835238133558e-03, -8.185321062796168e-04,  7.853192151296842e-03, 2.635434437225814e-02, 1.196937771631519e-02, 4.096572752190157e-02, 6.744431102619306e-03, -1.269656858881585e-02, 1.525143269407428e-02, -9.615770286351499e-03, -1.441437185224710e-02, 1.392662618061432e-02,  3.634754918016591e-04, 1.632214892347067e-02, 1.196937771630529e-02, 9.599350845901786e-02, 1.240267448364373e-02, -6.502820912212380e-02, -8.417101027849590e-03, 2.644912729253969e-02, -5.985846142710458e-02, -4.879523611216106e-02,  1.923490697450854e-02, 5.698794123115978e-03, 8.482588577151288e-03, 4.096572752190830e-02, 1.240267448365735e-02,  1.677338956495179e-01, 2.145643312685164e-02, -1.988289107399321e-02, 3.121449236248926e-02, -1.816999618095973e-02, -3.369771280832629e-03, -8.187023019431519e-03, 1.897018616606876e-02, -1.046671197806783e-02, 6.744431102652976e-03, -6.502820912207108e-02, 2.145643312686490e-02, 1.044754999165395e-01, 2.349133764971883e-02, 3.537184383150807e-03,  5.856660599389343e-02, 6.358123260297544e-03, 1.215968915671775e-02, -9.337301296850328e-03, -8.852538419717341e-03, -1.269656858878752e-02, -8.417101027794957e-03, -1.988289107398097e-02, 2.349133764967281e-02, 1.538387651072773e-01, -5.433115765565646e-03, 8.599117967164761e-03, 1.522252013725840e-02, -9.895713883558284e-03, 4.450217669029333e-02,  7.335178631643253e-03, 1.525143269408130e-02, 2.644912729255289e-02, 3.121449236248990e-02, 3.537184383139077e-03, -5.433115765564737e-03, 5.588983643053178e-02, -1.257027008944591e-02, -4.893708830447946e-02, 3.997756088307713e-02, -6.470093751160971e-03, -1.117832703785403e-02, -9.615770286339285e-03, -5.985846142709580e-02, -1.816999618094589e-02,  5.856660599393561e-02, 8.599117967219865e-03, -1.257027008943448e-02, 8.470957735377847e-02, 2.062901718757217e-02, -5.860985255660809e-03, -1.586631696558468e-02, -9.717537873690868e-03, -1.441437185224918e-02, -4.879523611218205e-02, -3.369771280818709e-03, 6.358123260335132e-03, 1.522252013727382e-02, -4.893708830447370e-02, 2.062901718759020e-02,  1.151373136530474e-01, -6.958213343102250e-02, 2.298443628282711e-02, 8.682835238337537e-03, 1.392662618062022e-02,  1.923490697453228e-02, -8.187023019439387e-03, 1.215968915668272e-02, -9.895713883564477e-03, 3.997756088307214e-02, -5.860985255683506e-03, -6.958213343102443e-02, 1.157108455122634e-01, -1.810522813651915e-02, -8.185321062510423e-04,  3.634754918026084e-04, 5.698794123120044e-03, 1.897018616606807e-02, -9.337301296865887e-03, 4.450217669027745e-02, -6.470093751163353e-03, -1.586631696559127e-02, 2.298443628282906e-02, -1.810522813652445e-02, 5.468098186810809e-02,  1.351645858052559e-02, 6.232993119071580e-03, 1.473397351964191e-02, 8.506540232587281e-03, -8.938045532455335e-03, -6.230554182732547e-03, 7.025964576193348e-03, -9.177804715684237e-03, -8.919896932081733e-03,
                  6.329107355587530e-03, -2.902801304974772e-04, 6.232993119107106e-03, 2.297899949063697e-02, 9.017733637137499e-03, 3.998577013269238e-02,  9.086400415409802e-03, -1.024511553959346e-02, 1.442516919628012e-02, -6.604598579423535e-03, -1.284048277861734e-02,  1.196716183862752e-02, 3.141271761487893e-04, 1.473397351954472e-02, 9.017733637127091e-03, 1.174199845107341e-01,  3.418333413635805e-03, -8.737949356340874e-02, -3.512522938517029e-03, 2.975868049606347e-02, -7.440681416741583e-02, -5.796790937824910e-02, 1.994374180095664e-02, 9.267507691357547e-03, 8.506540232698775e-03, 3.998577013269925e-02,  3.418333413653290e-03, 1.631512389498015e-01, 3.055200172124794e-02, -1.775469491027395e-02, 2.994350455408644e-02, -1.154664789178894e-02, -1.583727684556188e-03, -5.731910752129324e-03, 1.680352679911388e-02, -8.938045531800311e-03,  9.086400415444899e-03, -8.737949356334090e-02, 3.055200172125566e-02, 1.160458436081582e-01, 7.510872680170538e-03, -3.816917722810243e-03, 6.930064759531644e-02, 2.235280838760413e-02, 6.177284076274518e-03, -1.305787211892928e-02, -6.230554182133110e-03, -1.024511553955998e-02, -3.512522938454687e-03, -1.775469491026175e-02, 7.510872680136731e-03,  1.023881151227053e-01, -7.238769415576269e-03, 1.893462191115049e-03, 1.443383432496118e-02, -1.189619205726341e-02,  2.989435654219081e-02, 7.025964576353741e-03, 1.442516919628725e-02, 2.975868049608515e-02, 2.994350455408065e-02, -3.816917722835045e-03, -7.238769415590700e-03, 4.934032419501308e-02, -1.631922530668942e-02, -4.343146970557667e-02,  3.315450668267917e-02, -4.468459364935608e-03, -9.177804715502030e-03, -6.604598579410717e-03, -7.440681416740205e-02, -1.154664789177548e-02, 6.930064759536399e-02, 1.893462191168441e-03, -1.631922530667073e-02, 8.761065941077707e-02,  2.922036606778721e-02, -6.282329586288466e-03, -1.670922715786268e-02, -8.919896932221337e-03, -1.284048277861844e-02, -5.796790937828684e-02, -1.583727684527848e-03, 2.235280838767363e-02, 1.443383432500436e-02, -4.343146970556664e-02,  2.922036606782178e-02, 1.028139679721687e-01, -5.853248417412452e-02, 1.705745055820213e-02, 6.329107355797252e-03,  1.196716183863268e-02, 1.994374180099626e-02, -5.731910752150101e-03, 6.177284076212061e-03, -1.189619205729660e-02,  3.315450668267193e-02, -6.282329586325872e-03, -5.853248417413023e-02, 9.319399570726283e-02, -1.608636408150549e-02, -2.902801304698276e-04, 3.141271761515083e-04, 9.267507691358149e-03, 1.680352679911672e-02, -1.305787211893246e-02,  2.989435654218360e-02, -4.468459364933200e-03, -1.670922715786367e-02, 1.705745055819820e-02, -1.608636408150352e-02,  4.444914643446064e-02, 1.035015407409542e-02, 4.946716788020018e-03, 8.298090229220000e-03, 9.472093068024573e-03, -3.765288286372848e-03, -4.873661631174989e-03, 4.765453936645672e-03, -4.189839919114442e-03, -4.252968998585483e-03,  2.625950312448658e-03, -4.681716873312404e-05, 4.946716788053189e-03, 1.716310323001561e-02, 8.340726461371207e-03,  2.989059093202549e-02, 5.007976627049091e-03, -8.916501416686184e-03, 1.104800528921575e-02, -5.597873861959785e-03, -1.019413763816674e-02, 8.722243338933741e-03, -1.675252064662510e-04, 8.298090229125912e-03, 8.340726461367361e-03,  1.000457377019161e-01, 1.266894218007855e-02, -7.197927760396203e-02, 9.610901238293473e-04, 2.421434048126559e-02, -6.088066548014701e-02, -4.349324379165416e-02, 9.315045464901264e-03, 1.173787447630434e-02, 9.472093068123764e-03,  2.989059093202740e-02, 1.266894218007258e-02, 1.268524585389082e-01, 1.037073021301766e-02, -1.782339879057170e-02,  2.457435014328320e-02, -1.782983808361378e-02, -4.608861334939263e-03, -4.551855492269424e-03, 1.336970652933492e-02, -3.765288285721167e-03, 5.007976627079086e-03, -7.197927760389652e-02, 1.037073021301567e-02, 9.194486600283855e-02, -5.902646680067535e-04, -3.835292166949954e-03, 5.532438563902588e-02, 1.393773229527583e-02, 1.149228916111080e-02, -1.585481374831783e-02, -4.873661630580782e-03, -8.916501416653769e-03, 9.610901238704889e-04, -1.782339879054627e-02, -5.902646680264274e-04, 8.425244436789950e-02, -7.585508224857263e-03, -3.111877266591482e-03, 1.301986065404903e-02, -1.221743048956396e-02, 2.578833736885024e-02, 4.765453936805990e-03, 1.104800528922595e-02, 2.421434048128137e-02,  2.457435014329623e-02, -3.835292166968033e-03, -7.585508224862083e-03, 4.068149362229397e-02, -1.231365823857800e-02, -3.395956883400494e-02, 2.431292616980635e-02, -3.948858810894317e-03, -4.189839918932776e-03, -5.597873861950885e-03, -6.088066548012976e-02, -1.782983808361397e-02, 5.532438563907052e-02, -3.111877266550096e-03, -1.231365823856112e-02,  7.253786576215179e-02, 1.857377274659741e-02, 2.114590973438874e-03, -1.761554356252034e-02, -4.252968998731303e-03, -1.019413763817482e-02, -4.349324379170037e-02, -4.608861334936525e-03, 1.393773229534554e-02, 1.301986065407070e-02, -3.395956883400523e-02, 1.857377274664026e-02, 8.146907488566545e-02, -4.346011852491814e-02, 1.426330255295581e-02,  2.625950312664094e-03, 8.722243338943930e-03, 9.315045464949179e-03, -4.551855492270906e-03, 1.149228916104725e-02, -1.221743048958096e-02, 2.431292616980765e-02, 2.114590973394104e-03, -4.346011852492550e-02, 7.221653236616335e-02, -1.534447768766054e-02, -4.681716871036837e-05, -1.675252064651462e-04, 1.173787447629138e-02, 1.336970652933967e-02, -1.585481374831404e-02, 2.578833736883994e-02, -3.948858810899784e-03, -1.761554356251332e-02, 1.426330255296519e-02, -1.534447768766856e-02, 3.936313460617100e-02, 7.822417459845795e-03, 3.696539798434995e-03, -2.026588629097425e-04,  7.300902768407001e-03, 3.735567163184862e-03, -4.743798599843518e-03, 2.654007822619477e-03, 2.688421484353893e-03, -7.577683275779581e-04, 2.079603952840470e-03, -1.748864565662798e-03, 3.696539798461845e-03, 1.348259749488643e-02,  3.303982247249647e-03, 2.247934204752803e-02, 7.273887320744183e-03, -8.317179705417449e-03, 7.637903228699647e-03, -1.117077511799321e-03, -6.466000132900926e-03, 6.207238082792461e-03, -1.434460210859184e-03, -2.026588630142795e-04,  3.303982247294056e-03, 6.534622900562850e-02, 4.007309548284918e-03, -4.140029790522283e-02, 3.352049927533701e-03,  1.566208524473099e-02, -3.256277834666060e-02, -2.857356467767549e-02, 8.122649032404724e-03, 5.112210547474613e-03,  7.300902768487232e-03, 2.247934204752135e-02, 4.007309548123858e-03, 8.065805964830151e-02, 1.729075411603001e-02, -2.227956919214555e-02, 1.955948770044095e-02, -3.578164938988632e-03, -1.186421142828380e-02, 7.297073946030673e-03, -6.266491109572754e-04, 3.735567163834784e-03, 7.273887320722297e-03, -4.140029790525589e-02, 1.729075411588154e-02,  6.363817314316837e-02, 1.622986635347967e-03, 1.442874386029506e-03, 2.967040770034616e-02, 4.828906495164437e-03,  7.849510805050751e-03, -7.224811008712393e-03, -4.743798599257793e-03, -8.317179705386554e-03, 3.352049927508296e-03, -2.227956919210969e-02, 1.622986635391561e-03, 6.924122618268769e-02, -3.406197566860012e-03, -4.005041966812228e-04,  2.346370223854551e-03, -2.365412995676223e-03, 1.615375864213545e-02, 2.654007822770488e-03, 7.637903228715037e-03,  1.566208524468646e-02, 1.955948770048303e-02, 1.442874386087458e-03, -3.406197566851950e-03, 3.264778804392132e-02, -6.126681759821060e-03,
                  -2.359309452965668e-02, 1.630946893477370e-02, -2.729127135887628e-03, 2.688421484542036e-03, -1.117077511829726e-03, -3.256277834666034e-02, -3.578164939111041e-03, 2.967040770032969e-02, -4.005041966899847e-04, -6.126681759854794e-03, 4.529005000739535e-02, 1.072563865059917e-02, -1.375638130959883e-03, -7.428383201467832e-03, -7.577683277144288e-04, -6.466000132924528e-03, -2.857356467767844e-02, -1.186421142834109e-02, 4.828906495153946e-03,  2.346370223846373e-03, -2.359309452967237e-02, 1.072563865060138e-02, 5.691790407791225e-02, -2.552139176614658e-02,  6.575136863608168e-03, 2.079603953050852e-03, 6.207238082803030e-03, 8.122649032415963e-03, 7.297073946039038e-03,  7.849510805029981e-03, -2.365412995684278e-03, 1.630946893477257e-02, -1.375638130974350e-03, -2.552139176614310e-02,  4.742436237941343e-02, -5.318271579656537e-03, -1.748864565645138e-03, -1.434460210849909e-03, 5.112210547436856e-03, -6.266491109212964e-04, -7.224811008668476e-03, 1.615375864213398e-02, -2.729127135887523e-03, -7.428383201439263e-03,  6.575136863621402e-03, -5.318271579661504e-03, 2.659052598816781e-02, 7.206001791066984e-03, 2.883076649127722e-03, -1.377987052245928e-03, 3.942748078008837e-03, 3.877096071933263e-03, -5.457963170261286e-03, 1.721951901517207e-03,  3.636580979564572e-03, -6.153000780635886e-04, 2.150152129845007e-03, -2.825969861894225e-03, 2.883076649151774e-03,  1.016732857367922e-02, 3.361277085057714e-04, 1.508309357684102e-02, 6.419874865517846e-03, -8.132944830850686e-03,  4.667441460770865e-03, 9.107200067261051e-04, -3.640376003629560e-03, 4.652599312860626e-03, -2.330316407511834e-03, -1.377987052350073e-03, 3.361277085679854e-04, 6.169592455193858e-02, -5.790091730821744e-03, -4.175385540128873e-02,  2.801672252680657e-03, 1.169944098487780e-02, -3.054718777694099e-02, -2.655573275145545e-02, 6.393353583336644e-03,  2.985405591355393e-03, 3.942748078078313e-03, 1.508309357682688e-02, -5.790091731053151e-03, 6.089137659580409e-02,  1.745367637195470e-02, -1.870744803714399e-02, 1.077238260028678e-02, 2.886170643145055e-03, -1.839928978035116e-03,  2.323756849804910e-03, -1.405633412413144e-03, 3.877096072580487e-03, 6.419874865482697e-03, -4.175385540133338e-02,  1.745367637175875e-02, 5.950970435388010e-02, -7.139401641434507e-04, -2.820515508945029e-04, 2.899221201904565e-02,  9.666981182226989e-03, 4.983581485744576e-03, -5.766884118742442e-03, -5.457963169675771e-03, -8.132944830819356e-03,  2.801672252662414e-03, -1.870744803710027e-02, -7.139401641117864e-04, 7.102701034959270e-02, -5.358571335139193e-03, -1.452034865097986e-03, 7.451941734716980e-03, -7.557970070279172e-03, 1.938988266629418e-02, 1.721951901666487e-03,  4.667441460792302e-03, 1.169944098482305e-02, 1.077238260035603e-02, -2.820515508242891e-04, -5.358571335128979e-03,  2.778043345269401e-02, -3.907274349226168e-03, -1.891247652846030e-02, 1.328051667003131e-02, -4.048217310445433e-03,  3.636580979753302e-03, 9.107200066845444e-04, -3.054718777693452e-02, 2.886170642975222e-03, 2.899221201901782e-02, -1.452034865098097e-03, -3.907274349264360e-03, 4.317395258040685e-02, 1.039394734749144e-02, -7.091323921274105e-04, -5.932832905094549e-03, -6.153000782008220e-04, -3.640376003667068e-03, -2.655573275146506e-02, -1.839928978142380e-03,  9.666981182210873e-03, 7.451941734702853e-03, -1.891247652848607e-02, 1.039394734750252e-02, 5.280635049730072e-02, -2.275669826403445e-02, 8.704678955369699e-03, 2.150152130057031e-03, 4.652599312880092e-03, 6.393353583361971e-03,  2.323756849841591e-03, 4.983581485719231e-03, -7.557970070277671e-03, 1.328051667003886e-02, -7.091323921546535e-04, -2.275669826403628e-02, 4.402296672901732e-02, -7.350458831597552e-03, -2.825969861878480e-03, -2.330316407503231e-03,  2.985405591306773e-03, -1.405633412370819e-03, -5.766884118694081e-03, 1.938988266628712e-02, -4.048217310451016e-03, -5.932832905060445e-03, 8.704678955395246e-03, -7.350458831613210e-03, 2.698508899902871e-02, 6.723109842824121e-03,  1.906269022268067e-03, -5.192158143798590e-03, 1.272450796254819e-03, 5.124496922329141e-03, -4.303307133836110e-03, -9.115502621474034e-04, 5.657820065292401e-03, 3.297769337642992e-03, -4.816395065841420e-04, -2.455100768033260e-03,  1.906269022290822e-03, 8.158610420671264e-03, -3.015213156393306e-03, 1.076214189232004e-02, 6.810286326636298e-03, -5.474370807210471e-03, 1.588836322104373e-03, 2.905971730194251e-03, 3.395162400505079e-04, 1.509917468905303e-03, -1.637681249563447e-03, -5.192158143904887e-03, -3.015213156335607e-03, 3.437114555706263e-02, -9.633503856512028e-03, -2.338091912081933e-02, 9.496479290796092e-03, -8.014014511968619e-05, -1.458677892676302e-02, -5.301225475956223e-03, -5.371110998827197e-03, 5.193607919214502e-03, 1.272450796318982e-03, 1.076214189228457e-02, -9.633503856712342e-03,  4.787528178476200e-02, 1.704801796310903e-02, -1.360650332973754e-02, 6.046027835742834e-03, 6.724939013642090e-03,  1.911825511952630e-03, -2.416481363237979e-04, -1.529866900497738e-03, 5.124496922977980e-03, 6.810286326618032e-03, -2.338091912086037e-02, 1.704801796301575e-02, 4.573828470894970e-02, -5.679622288729118e-03, 5.672538406764036e-03,  1.847137172351402e-02, -2.420035771492429e-03, 1.056295197265196e-02, -7.299489707715618e-03, -4.303307133249059e-03, -5.474370807187570e-03, 9.496479290809051e-03, -1.360650332973072e-02, -5.679622288736377e-03, 6.101510221727482e-02, -2.079714747426218e-03, -6.741248447790080e-03, 2.382371245392187e-03, -5.171929915993943e-03, 1.712663209795163e-02, -9.115502619988387e-04, 1.588836322134528e-03, -8.014014517265336e-05, 6.046027835861059e-03, 5.672538406832414e-03, -2.079714747414466e-03, 2.236860840149897e-02, 3.356055082089930e-03, -8.748254046424023e-03, 6.829118631357301e-03, -3.142663059286930e-03, 5.657820065483527e-03, 2.905971730165687e-03, -1.458677892676177e-02, 6.724939013530323e-03,  1.847137172350664e-02, -6.741248447767722e-03, 3.356055082061409e-03, 3.475737893030167e-02, -1.809476994779045e-03,  6.124947894902648e-03, -7.595680997642821e-03, 3.297769337505934e-03, 3.395162399904042e-04, -5.301225475951920e-03,  1.911825511759757e-03, -2.420035771546565e-03, 2.382371245391534e-03, -8.748254046465641e-03, -1.809476994776207e-03,  3.612122452572119e-02, -1.166226025278743e-02, 6.695614838699029e-03, -4.816395063707840e-04, 1.509917468952183e-03, -5.371110998814723e-03, -2.416481361838549e-04, 1.056295197267164e-02, -5.171929915996819e-03, 6.829118631386451e-03,  6.124947894882831e-03, -1.166226025279113e-02, 3.756010245593984e-02, -6.075286382763968e-03, -2.455100768018243e-03, -1.637681249570884e-03, 5.193607919187452e-03, -1.529866900511503e-03, -7.299489707711761e-03, 1.712663209794507e-02, -3.142663059306261e-03, -7.595680997626864e-03, 6.695614838726681e-03, -6.075286382787295e-03, 2.687679617398631e-02,  7.718140100242923e-03, 2.089104828763649e-03, -6.712098235509181e-03, 1.713729152843062e-04, 5.606301875247261e-03, -4.781888001980594e-03, -2.200409815279140e-03, 6.402819810177256e-03, 5.415202699503525e-03, -1.200402788993186e-03, -2.623735127085050e-03, 2.089104828785170e-03, 8.472481069079399e-03, -3.074489376586572e-03, 9.152787295987896e-03,  5.690915425792920e-03, -4.075316307677775e-03, 3.823367623415064e-04,
                  2.056081759925943e-03, 1.818597750090356e-03,  7.355248698503042e-04, -7.172362931269090e-04, -6.712098235610003e-03, -3.074489376517997e-03, 3.744221178849111e-02, -8.400085477996588e-03, -2.359802246767601e-02, 9.640468579735904e-03, 5.452948526650930e-04, -1.538274874846518e-02, -6.058752677051416e-03, -7.014727757562983e-03, 5.137708737266003e-03, 1.713729153400220e-04, 9.152787295947706e-03, -8.400085478245306e-03, 4.603420183136619e-02, 1.315602508861058e-02, -1.047568516488864e-02, 5.119763436874258e-03,  4.689278225392661e-03, 2.561677533633733e-03, -1.111694649025441e-03, 5.972830633058923e-04, 5.606301875892644e-03,  5.690915425768328e-03, -2.359802246771608e-02, 1.315602508848307e-02, 4.852998694158939e-02, -8.807887244448032e-04,  4.665711964263686e-03, 1.937322617760717e-02, -2.375786649300715e-03, 1.079497111000927e-02, -6.777363018568183e-03, -4.781888001390809e-03, -4.075316307649138e-03, 9.640468579762022e-03, -1.047568516487406e-02, -8.807887244519086e-04,  6.756445691489543e-02, 5.625749401101804e-04, -4.967279333687311e-03, 2.746308287184737e-04, -3.506627899146214e-03,  1.669227989314653e-02, -2.200409815128642e-03, 3.823367623760898e-04, 5.452948526107754e-04, 5.119763437010427e-03,  4.665711964331715e-03, 5.625749401107077e-04, 2.481491839832026e-02, 2.867622886467060e-03, -8.910512233292311e-03,  6.130098027772701e-03, -2.136033723724146e-03, 6.402819810365827e-03, 2.056081759890704e-03, -1.538274874845708e-02,  4.689278225246639e-03, 1.937322617759496e-02, -4.967279333658588e-03, 2.867622886440109e-03, 3.896563184473645e-02, -1.514189884454897e-03, 5.535738954985547e-03, -7.979847211159297e-03, 5.415202699359904e-03, 1.818597750020787e-03, -6.058752677060880e-03, 2.561677533407983e-03, -2.375786649341599e-03, 2.746308287360916e-04, -8.910512233339274e-03, -1.514189884437182e-03, 4.023709018416843e-02, -9.468704232266201e-03, 6.491139727944073e-03, -1.200402788774830e-03,  7.355248699035671e-04, -7.014727757536726e-03, -1.111694648866568e-03, 1.079497111001632e-02, -3.506627899163575e-03,  6.130098027807118e-03, 5.535738954953018e-03, -9.468704232274083e-03, 4.320035636178443e-02, -4.533906134630672e-03, -2.623735127071010e-03, -7.172362931330270e-04, 5.137708737231184e-03, 5.972830632983428e-04, -6.777363018554292e-03,  1.669227989314176e-02, -2.136033723743651e-03, -7.979847211137064e-03, 6.491139727974521e-03, -4.533906134654403e-03,  2.921249261063369e-02 )
               , tolerance = 1e-06)

  expect_equal(c(fit$lag_one_cor),
               c( 2.472740420908293e-02, 1.097161902790955e-02, 8.350217386061974e-03, 3.602343136002563e-03, -2.469364923800602e-03, -4.739687568928409e-03, 1.069396218614465e-03, -5.957355563913115e-03, 5.988890881948629e-04, 8.314819456377649e-03, -2.622422738693883e-04, 1.064841713759625e-02, 2.780101112728584e-02, 6.408698333775180e-03, 1.536042172888178e-02,  3.582533487986569e-03, -7.863761685388259e-03, 2.819830565210943e-03, -8.146892609251249e-03, -1.820859962129007e-03,  9.092506869737105e-03, 1.034840791590624e-03, 7.118171200370207e-03, 5.581413207700400e-03, 5.570195083422813e-02,  6.535297316743525e-03, -1.711910014886070e-02, 5.420469677740071e-03, 1.061288204016042e-02, -1.605050184639757e-02, -1.980670395193341e-02, -2.323331525388368e-03, -4.021405953273521e-04, 2.511005822221425e-03, 1.359082968548287e-02,  7.224318293463587e-03, 6.936127719627527e-02, -4.402567939685784e-04, -9.469796478883590e-03, 9.637139202366890e-03, -9.137973767253752e-03, -1.351090605715862e-03, -3.338691594304753e-03, 6.140597155134483e-03, -1.968518777889710e-03,  3.317346932578220e-03, -1.642063427249831e-02, 3.665094328050358e-04, 4.996827098435852e-02, 7.778754067419860e-03, -1.662646311973704e-03, 1.576964785822883e-02, 2.312916282906675e-04, -2.891884465408723e-03, -5.254848279633639e-03, -4.154273998727208e-03, -7.553922274578517e-03, 6.040670393564667e-03, -8.579107073084638e-03, 8.339018503818966e-03,  1.099492269970276e-01, 7.787879548492868e-04, -1.002960865245116e-03, 2.958460428772067e-03, -5.813445466527543e-03,  2.808082593751712e-02, 3.058208024409692e-04, 2.230661560079911e-03, 1.121522772314395e-02, 9.206071415797591e-03, -9.415479250100660e-05, 1.176202408577859e-03, 4.084057448004633e-02, -1.768442274245598e-03, -1.747879787622880e-02,  9.373009488337265e-03, -3.458938958351283e-03, -5.388462210292748e-03, -7.898436615106579e-03, -1.786517196235847e-02, -9.491200639254078e-03, 1.830465233252784e-02, -8.634287067403033e-04, -2.481706253444422e-03, 5.523459329756336e-02,  3.715543565706973e-03, -9.831268317531144e-03, -1.120821490509762e-02, 1.820982680674893e-03, -8.292806953472207e-04, -2.037005697026434e-02, 1.028924633120591e-04, -1.371876625896539e-03, 1.903770476657362e-03, -1.618867024821854e-02,  2.837126580882672e-03, 6.468043817611543e-02, -4.415749676389788e-03, 1.118627188281882e-02, 7.862714118805327e-03,  9.204145656549808e-03, -7.015496103634326e-04, -4.324181183631478e-03, 5.151808174208017e-04, -4.520833067107446e-03,  1.019711233314970e-02, -9.435678892514553e-03, -8.006520707889070e-03, 8.504305929383998e-02, 4.484783495903521e-03, -1.217713974798452e-04, 1.121346571466154e-03, 2.426546381791312e-04, 7.382419746093723e-03, -6.246802875769229e-03,  2.845997370710365e-02, -2.956681714621563e-03, -1.139253228301462e-02, 1.132216455050394e-02, 5.061468189561026e-03,  4.943109502386844e-02, 2.038049628526231e-02, 8.383010850606810e-03, 6.335516342446341e-03, 2.662094182477794e-03, -2.038257262007258e-03, -3.577924129677898e-03, 6.591729241514147e-04, -4.366171146633015e-03, 1.001859295607456e-03,  5.624165632741283e-03, -2.296404815398754e-04, 8.254715546835992e-03, 2.159992562678764e-02, 4.354058413314022e-03,  7.228674903496060e-03, 1.839732611979911e-03, -4.698454223504071e-03, 7.312365913906362e-04, -5.826611246666664e-03, -5.271349493805692e-05, 6.086391354456301e-03, 8.046525313908183e-04, 5.318051213349224e-03, 4.017096596104888e-03,  3.281716040384181e-02, 5.680671903020107e-03, -5.906598741524306e-03, 8.484895421833026e-04, 3.573730281793270e-03, -5.962796802468372e-03, -6.045294136851578e-03, -5.832919829558459e-03, -1.259967924877902e-03, 2.166709023578531e-03,  7.802092184314042e-03, 4.096356751842613e-03, 3.667123908513092e-02, -3.723051625153656e-04, -4.519270961357803e-03,  5.071227663615953e-03, -4.346224104238361e-03, -2.856235198348054e-03, 9.737852779576305e-04, 2.063006904622352e-03, -1.299220969229216e-03, 1.603666671462798e-03, -6.120344188749651e-03, -1.535708535188732e-03, 2.504951097776770e-02,  2.172558401913386e-03, -3.805840912153073e-03, 5.036220777355514e-03, 4.166150989316518e-03, -7.400027504932072e-03, -1.769971024307437e-03, -3.137653270038548e-03, -5.021683681860662e-03, 1.788594975993776e-03, -5.019323259969517e-03,  2.682584403722141e-03, 6.480874172756629e-02, -6.127312695997002e-04, -1.010076830889476e-04, 3.079676825288752e-03, -5.045293958686657e-03, 1.500146525926974e-02, 4.604435847720550e-04, 8.266301000349188e-04, 4.946939077511037e-03,  4.657785533980245e-03, -1.903719695708741e-03, -6.086685195180947e-05, 3.100154056790494e-02, -3.643458591713513e-04, -7.829554480763116e-03, 4.645195336552208e-03, -2.201452989366722e-03, -3.833785037193541e-03, -5.941761502323368e-03, -7.195158515315228e-03, -5.032291993710056e-03, 5.812781589616504e-03, -3.440697447340928e-04, -1.040188047072065e-03,  4.075730038929648e-02, 2.259445998529269e-03, -8.785020698401914e-03, -6.706686408968630e-03, 1.086978901182173e-03, -4.100846282298039e-04, -9.990038601276764e-03, -2.594833953757380e-03, 1.295346997473192e-03, 3.293685369414203e-03, -8.649112462663425e-03, 1.653067085078976e-03, 4.300625485934474e-02, 1.391702390912020e-03, 6.733840431738027e-03,  6.085659918747221e-03, 6.500161395468869e-03, -2.013428946831600e-03, -8.414744125756352e-04, -4.065159177083943e-03, -3.906898533373474e-03, 5.861740968556026e-03, -8.194142697719755e-03, -1.050356804866426e-04, 6.437349337681923e-02,  5.401405808152895e-03, -2.536031807997734e-04, 7.687272135661909e-04, -1.374600232381474e-03, 1.971215787775135e-03, -2.494910800615476e-03, 1.558364090871234e-02, -1.982690453978141e-03, -6.849542804810508e-03, 5.748985198970271e-03,  6.456616805425320e-03, 3.703106921665955e-02, 1.683729962201592e-02, 6.936332573649085e-03, 7.197510894489917e-03,  3.774986480851252e-03, -3.534429906516270e-03, -4.441123300195570e-03, 1.711376304919467e-03, -5.056450626284840e-03, -1.054732842513943e-03, 4.822547694354612e-03, -3.858422104305691e-04, 6.927472201981385e-03, 1.929042533986791e-02,  5.472925129454228e-03, 1.205868569340543e-02, 1.410700667887590e-03, -5.535922627618485e-03, 2.992727983830434e-03, -6.175764639022125e-03, -2.695285698948772e-03, 5.812389157967853e-03, 7.032927788957986e-04, 6.371984158599480e-03,  4.901032741943367e-03, 3.393587821255343e-02, 6.997994901886736e-03, -1.176015944894545e-02, 4.332421361686288e-05,  5.800087193679790e-03, -1.199900872328728e-02, -1.045457020836269e-02, -1.286825637987227e-03, 5.385900634622396e-04,  3.629746616516459e-03, 1.255271463525738e-02, 7.206648211507775e-03, 5.442704416754989e-02, 2.441765029097886e-03, -6.385904548400391e-03, 9.364262573645289e-03, -7.223834489720201e-03, -3.805741205938252e-03, -1.097852574070551e-03,  4.622662194695435e-03, -2.636328858735165e-03, 1.679369716978722e-03, -1.148590140714268e-02, 2.560708647302286e-03,  2.704059910761971e-02, 3.483646493880659e-03, -3.029948925218299e-03, 9.337002155790072e-03, 5.357457581367790e-03, -5.357997849510993e-03, -1.673043073585231e-03, -4.048932088709906e-03, -5.877049762166219e-03, 5.178186052495117e-04, -6.565862613219082e-03, 4.007062143796493e-03, 7.497167507199827e-02, -1.143927535133941e-03, -8.676775292523666e-05,  5.615233418720331e-03, -5.381283615573716e-03,
                  2.030638526954215e-02, 1.759314331721216e-03, 3.144024646586038e-03,  7.214852132179056e-03, 8.944056066823899e-03, -2.527279082851348e-03, -1.228071434615801e-03, 3.071132363900103e-02, -3.160507478292190e-03, -1.369386541128604e-02, 1.018666897810354e-02, -2.201200945014112e-03, -4.486839492667575e-03, -5.984119869661393e-03, -1.242330318414671e-02, -6.981000661617272e-03, 9.727592790008215e-03, -5.042734113834893e-04, -3.059743147602105e-03, 4.049007932612705e-02, 5.542666936092408e-03, -7.846962571058675e-03, -7.260769513255742e-03, -1.020178867106078e-03, -2.745177388868934e-03, -1.254704036464560e-02, -3.176968730122406e-03, 4.202544702190326e-03,  5.798843645165723e-03, -1.339430562770748e-02, 5.408284624191129e-03, 4.892900397763220e-02, -1.117605227203313e-02,  7.901225436346321e-03, 5.498492152649385e-03, 6.453827494575317e-03, 1.503566755883451e-03, -1.510899290490543e-03, -4.160744869925626e-03, -5.198010741524477e-03, 1.083094425557931e-02, -8.192419526304711e-03, -1.271641296494179e-02,  6.515362651024230e-02, 1.170632699542822e-03, -4.613312047929887e-04, 6.018330628894827e-04, 2.904512042499236e-04,  4.606591842319898e-03, -1.768073395011097e-03, 2.078631766781636e-02, -1.971636180522973e-03, -7.108662840829941e-03,  7.548181619945527e-03, 1.654010421058354e-03, 3.560443231085791e-02, 1.317661112705510e-02, 4.794320372102145e-03,  6.709020952607558e-03, 2.492561731977407e-03, -4.038528277078164e-03, -3.180909357811776e-03, 1.711496984201113e-03, -4.452386836087048e-03, -1.587814399090809e-03, 3.414700409002670e-03, -2.897367784680914e-04, 4.968673326655989e-03,  1.414101091200786e-02, 5.323628778997251e-03, 6.964373161514754e-03, -8.607501415755616e-04, -3.898556608592160e-03,  2.068900102471445e-03, -5.415149591086759e-03, -2.586103458581986e-03, 4.217185953813920e-03, 4.316479485123580e-04,  6.057861405478555e-03, 4.699974524614333e-03, 2.765929809168736e-02, 7.055714224460849e-03, -1.148991016190070e-02, -4.054443324766318e-03, 5.185562850733550e-03, -1.092718907406760e-02, -8.788290211292179e-03, 1.654527433076237e-04, -3.362311217781514e-04, 3.302870623294750e-03, 8.134372720089595e-03, 8.441328122253521e-03, 3.590254790156966e-02, -1.808130035550413e-03, -7.472763196312323e-03, 7.052833736514942e-03, -6.908375420467342e-03, -5.681777058658464e-03,  1.529945277696622e-03, 1.486280373513218e-03, -3.299950554226256e-03, -2.062263818282568e-04, -1.068255531244815e-02, -7.142780488269386e-04, 1.963920343659077e-02, 3.596281327188615e-03, -4.773512256457144e-03, 7.523200886088547e-03,  7.391345130707570e-03, -6.703710553173502e-03, -4.291586761345032e-04, -3.646608753577711e-03, -4.599489810612118e-03, -5.053033202433435e-03, -7.951004716644625e-03, 4.020866214754489e-03, 4.513655553471529e-02, -2.842750120660519e-03,  3.493574579882829e-03, 5.744692953874169e-03, -3.844221193065020e-03, 9.945459255205149e-03, 1.836501400631432e-03,  2.403166988412490e-03, 6.217319812562096e-03, 7.034518205475923e-03, -5.200954356473018e-03, -2.844171244517061e-03,  2.503367871374836e-02, -4.157766581727613e-03, -1.078841638808203e-02, 8.403811027561141e-03, -1.697738281506555e-03, -4.050729806053956e-03, -5.084949462697750e-03, -1.080135633015933e-02, -5.823780050507492e-03, 7.979204288874201e-03,  2.534728705149749e-03, -3.588444921292185e-03, 3.382252110305158e-02, 6.517195782234786e-03, -7.687542852037830e-03, -4.399168811272041e-03, -1.365779716121868e-03, -2.533979260455094e-03, -9.666822335206909e-03, -5.057577227809155e-03,  7.512639460873461e-03, 5.457100563975122e-03, -1.042845442196181e-02, 6.797065068641852e-03, 3.834314519536536e-02, -8.645581326443339e-03, 4.819811571110799e-03, 3.805453327449871e-03, 4.832613941859195e-03, 1.895531426300372e-03,  2.013425769600402e-03, -6.967492720516090e-03, -4.361751862126784e-03, 8.906043222501294e-03, -8.522000243676024e-03, -9.714880863390129e-03, 5.092942416936216e-02, 2.148863218387767e-03, -3.928499309037850e-04, 3.327759107923456e-04, -7.036890793860225e-04, 1.242056704235685e-03, -4.105464363624439e-04, 1.036434440854716e-02, -1.641647746668528e-03, -4.131655219135433e-03, 4.713027152272569e-03, 2.458527215558920e-03, 2.582602217689105e-02, 9.661539623050806e-03,  3.245763279402584e-03, 3.552617788416504e-03, 2.929866446457432e-03, -1.383177602951207e-03, -2.053795092651037e-03,  1.299339512970074e-03, -1.758413217773815e-03, -5.379833512861171e-04, 1.586998361748017e-03, -3.583728887752763e-04,  3.080832510742918e-03, 1.001092552052635e-02, 3.748427472336348e-03, 4.320491168491202e-03, -2.874951950748196e-05, -2.033311684519358e-03, 1.799080817738856e-03, -3.269360127590999e-03, -2.474736900821379e-03, 3.376143185544138e-03,  9.219170691716471e-05, 5.715358380155337e-03, 3.971563636936455e-03, 2.719333284072277e-02, 5.651820739857607e-03, -1.416712210287849e-02, -4.247654232507108e-03, 5.594911229669122e-03, -1.261759863105971e-02, -9.449205444196435e-03,  1.554246526503523e-03, 2.428357078815424e-04, 2.136985084618336e-03, 4.662251328601969e-03, 7.723763886088305e-03,  2.419290304930604e-02, -2.813184558728180e-03, -5.409581738769141e-03, 5.685792216104559e-03, -5.759211826630215e-03, -5.860104844182052e-03, 3.158719675959234e-03, 5.992067898619117e-04, -3.428630828754095e-03, -9.200143094506704e-04, -1.254571034958293e-02, -1.857848039687199e-03, 1.723699473274469e-02, 1.790454110198539e-03, -5.808092674641639e-03,  8.137536580777722e-03, 8.950159386712519e-03, -6.753926279798133e-03, -6.515756409570172e-04, -2.223939786518791e-03, -2.749783852254979e-03, -5.916440562226294e-03, -6.743168634816769e-03, 1.847132318665267e-03, 2.028601818755447e-02, -3.530700309453184e-03, 3.684145206893414e-03, 4.939032259191850e-03, -3.555270433459403e-03, 2.344149199504899e-03,  1.715804342237921e-03, 1.476559601826195e-03, 6.437708286672096e-03, 5.094233957903847e-03, -7.134181217717819e-03, -2.514260288231030e-03, 1.977899796969491e-02, -5.121254459762472e-03, -8.078196293653363e-03, 6.111240932346211e-03, -6.005239162477757e-04, -3.120720605057848e-03, -3.818173379974785e-03, -9.987584017541289e-03, -5.184093094870736e-03,  6.770758027724207e-03, 2.469846358506207e-03, -3.831502731052430e-03, 2.772058048870710e-02, 6.525086601816126e-03, -6.228901061928051e-03, -3.128636254373398e-03, -1.599743937160135e-03, -1.857802604302153e-03, -9.540008526568642e-03, -5.024566800862980e-03, 1.033642872350942e-02, 3.660281245505537e-03, -7.753916473821360e-03, 8.272294937293843e-03,  2.910477086246727e-02, -5.642652296650124e-03, 1.803473670635848e-03, 2.024110805885645e-03, 3.002714458553141e-03,  2.742237508538531e-04, 3.895645943271983e-03, -5.827247533088747e-03, -2.906728524462070e-03, 6.110060523549954e-03, -5.985251829562867e-03, -5.399617197963773e-03, 3.629515679593094e-02, 2.458382003854152e-03, -3.085817949195044e-04,  1.804283972404142e-04, -9.406345169856493e-04, -2.727091538880198e-04, -5.164330464453668e-05, 2.318988894181400e-03, -1.277788050924023e-03, -2.317570994543704e-03, 2.630306524810188e-03, 2.265015221810138e-03, 1.783608242219881e-02,  6.669171942029213e-03, 2.176963582326134e-03, 5.451564452339671e-04, 3.473354096191168e-03, 1.041401610255939e-03, -1.327799297443097e-03, 4.975968198553185e-04, 6.995484747490711e-04, 1.176290363749486e-03,
                  -3.851143767956569e-04, -3.224369888739030e-04, 1.925363992272522e-03, 6.854817087513811e-03, 2.118851556332145e-03, 2.549403555265484e-03,  2.702907213587810e-04, -9.769011287608540e-04, 8.259292429286077e-04, -1.701222350883898e-03, -1.111506130558995e-03,  1.695356357358338e-03, 5.420893130716857e-06, 3.092709970242821e-03, 2.947348185038770e-03, 2.818087729805249e-02,  6.383211755572711e-03, -1.594949141490958e-02, -2.516967878116331e-03, 6.416117180412680e-03, -1.290534862036135e-02, -1.002366246444857e-02, -3.393550606874563e-05, 1.169715681407049e-03, 2.295963052900008e-03, 3.395680276584938e-03,  4.948743506601280e-03, 1.941877133610102e-02, -2.041501663868878e-03, -4.603298431679564e-03, 3.984318166284133e-03, -4.545849992717918e-03, -3.748042659030797e-03, 2.490915550618497e-03, 2.799777297227725e-04, -1.139433194281598e-03, -1.645837339797238e-04, -1.517208886614220e-02, -3.553418382672686e-03, 1.698941962900095e-02, -2.553331381075543e-04, -6.412066929548774e-03, 8.302692105958666e-03, 9.282785365321579e-03, -3.575508081515781e-03, -1.525704231112330e-03, -1.368606242129044e-03, -1.540136773095424e-03, -2.866868915887338e-03, -4.562896707939604e-03, -3.846970598360884e-04,  1.182128459065378e-02, -2.322326988813618e-03, 1.208199776914332e-03, 2.946371500371538e-03, -2.494175872848176e-03,  6.926680938207450e-04, 1.027317946575199e-03, 1.392387744271867e-03, 5.765057177918696e-03, 5.159898966887416e-03, -6.189478435055247e-03, -2.267689439461486e-03, 1.541380108620704e-02, -4.238104868841896e-03, -5.804861169803386e-03,  3.668911566238896e-03, -2.330529829814254e-04, -8.187088684247674e-04, -2.115241321594728e-03, -1.073838684871923e-02, -5.525944727295892e-03, 7.203945655391210e-03, 6.553153652763159e-04, -3.793263889854949e-03, 2.233510209214490e-02,  5.633505158419583e-03, -2.440439294173659e-03, -3.074970928250645e-03, -3.520277638723639e-04, -1.812499482244769e-03, -9.396986176050502e-03, -5.411009596305743e-03, 9.492395862052336e-03, 2.669578120411026e-03, -6.233239637408291e-03,  6.920010872411711e-03, 2.231686092110929e-02, -2.909458550789984e-03, 7.420688784126348e-04, 2.789871007934349e-04,  2.062486627172202e-03, -1.445262095125265e-03, 3.895608266057027e-03, -3.238164748719101e-03, -2.495489075276679e-03,  3.502089761678751e-03, -2.527196478851085e-03, -1.847425787028066e-03, 2.440600024786580e-02, 1.713334454623129e-03, -3.310725562012524e-04, -1.269503376121381e-04, 5.460789300208808e-04, -2.011755278698811e-05, -1.100699245922740e-03,  7.875792127567185e-04, -5.756494330447158e-04, -2.549584112179569e-03, 1.229968241214547e-03, 1.391882268837568e-03,  1.340693807605784e-02, 4.377448807786890e-03, 1.407616249309266e-03, -2.498928231423955e-03, 2.444078402517783e-03,  3.915175925235149e-03, -1.412155247006556e-03, -1.077143819642330e-04, 3.278400413394294e-03, 1.870978716454345e-03, -3.306141162060512e-04, -1.083754688458696e-03, 1.178164914357865e-03, 4.454676838678901e-03, 1.275242249255456e-04,  2.246017660508789e-03, 9.024558159862568e-04, -1.084890478911046e-03, -4.801735854349266e-05, -1.148525964617725e-04,  6.145187022647480e-04, 5.286785718542969e-05, -9.687363317709399e-05, -4.753069514672721e-04, 1.111628566434517e-03,  1.924343278631480e-02, 3.158901207152519e-03, -8.370653407871496e-03, -6.709448866720740e-04, 4.427259437332717e-03, -5.552679831451825e-03, -7.124750311610261e-03, -9.069561115784653e-04, -8.287640004279919e-05, 2.060421401858676e-03,  1.067413290772611e-03, 1.922996589593329e-03, 1.077630252930607e-02, -2.891276157816873e-04, -4.127234710437895e-03,  2.945277524095872e-03, -1.276330758170992e-03, -3.657612422940016e-03, 3.506380102542184e-03, -1.672390921210156e-03,  1.546317027603765e-03, 7.284633519982734e-04, -1.018391361065888e-02, -1.037692003603847e-03, 1.128877369982476e-02, -8.718069678110023e-04, -4.077028115508344e-03, 3.687821197223363e-03, 6.118022858688352e-03, -1.502303822233432e-03, -6.273395413099940e-04, -9.061101233989682e-04, -7.746788189946770e-04, -1.185542550606619e-03, -3.907782594768212e-03, -9.992626161671064e-04, 8.101015606938879e-03, -1.504851269768944e-03, -1.076807362559822e-05, 1.376959539618035e-03, -1.435934734398007e-03, 2.935704158082055e-04, -8.605269349969840e-05, 1.588935281579811e-04, 3.456088074315348e-03,  2.539045720722966e-03, -4.141339038857563e-03, -1.479218449086173e-03, 1.079386031605090e-02, -1.780236907969584e-03, -3.386325745229384e-03, 1.423510120947578e-03, -4.327187065359886e-04, 1.542143967272557e-03, -4.177758170539642e-04, -5.703666573530431e-03, -1.955210529722883e-03, 2.611164787141973e-03, 4.304265753622652e-04, -2.096742012578257e-03,  1.327267372027779e-02, 3.490402310800486e-03, -1.206547583518692e-03, -1.086659620362776e-03, 1.600306548709209e-03, -2.946460880876408e-04, -5.564466844670319e-03, -3.150219523196406e-03, 5.782338961860067e-03, 1.084094951039167e-03, -3.415189550216205e-03, 2.804250356504872e-03, 1.470027121136158e-02, 4.131739427962115e-04, 4.186431982216123e-04, -7.068732440091044e-04, 5.717225541089553e-04, -1.324687363908557e-03, 2.049776084951863e-03, -3.528619351985375e-03, -1.595999773886827e-03, 8.543246712831238e-04, -1.568686269050701e-03, 1.147913209280303e-03, 1.450493288377663e-02,  1.876977833745200e-03, -4.350507667666119e-04, -2.884428850381866e-04, 8.074212910965392e-06, -1.042349110974517e-03, -3.884248954036879e-04, -2.479063631017154e-04, -3.837682082454135e-04, -1.341275239203034e-03, 4.218480267780035e-04,  1.527979103232542e-03, 9.175385252086384e-03, 2.958039566545634e-03, 8.954580249724434e-04, -2.386352445384808e-03,  1.006437359749904e-03, 3.217904696966674e-03, -1.301901468415081e-03, -3.988346988414158e-04, 2.825606250740086e-03,  1.646755748782806e-03, -5.233584453984293e-05, -1.089458739896992e-03, 9.212532176876093e-04, 2.901597081873596e-03, -3.911243083549972e-04, 6.095933890325610e-04, 1.043570539592559e-03, -8.765983485921347e-04, -5.034911995273314e-04,  4.248305107378955e-04, 8.779218349935964e-04, -1.835943385797550e-04, -3.001494813290028e-04, -2.170785137364067e-03, -6.164058086152372e-04, 1.423725847166148e-02, -1.046169284562564e-04, -7.360903772624312e-03, 1.748951404266063e-04,  2.616692451544736e-03, -3.841568414437054e-03, -4.831054733532996e-03, -1.203750449061609e-03, -2.434855505060456e-04,  1.412857304272979e-03, 1.093119718635347e-03, 2.692324773757534e-04, 5.290142090339245e-03, 7.867232946647048e-04, -3.665445756887007e-03, 1.148638637699673e-03, 4.363824014971792e-04, -1.835360109831024e-03, 1.857881579468100e-03, -1.876645660089008e-03, 3.025562540681129e-03, 1.222669784741571e-03, -6.943520095943116e-03, 7.079599484661747e-04,  9.576258248019359e-03, -1.458110319559993e-03, -2.777292406912482e-03, 2.690914702702113e-03, 4.145075050660107e-03, -1.747328317260071e-03, -7.130277288011058e-04, -9.825604271245017e-04, -8.338747091875576e-04, 3.720729427951898e-04, -2.758324614846703e-03, -1.300266955903735e-03, 6.855025415830377e-03, -8.795478955771703e-04, -3.564674801187482e-04,  5.898725443754415e-04, -1.329562313612617e-03, 4.513300294972122e-04, -3.816572182195619e-04, -4.687680466289236e-04,  2.651481160266796e-03, 1.014280572012085e-03, -2.713646436382503e-03, -1.050755177229744e-03, 7.258304003433949e-03, -9.084291460752970e-04,
                  -2.267104078693200e-03, 3.298104619596626e-04, -5.872809414494535e-04, 2.552380015583633e-03,  4.510864141421256e-04, -3.881645951814196e-03, 3.433591638987688e-04, 2.981575923700302e-03, -9.630575051323845e-05, -9.940423520744504e-04, 9.182217844795820e-03, 1.998125325463534e-03, -1.020155793479472e-03, -7.939677194942566e-04,  1.690154821554580e-03, 1.046175893321960e-03, -5.371257696263680e-03, -1.205312705894463e-03, 4.860027765573026e-03,  6.250202605440267e-04, -2.238882751924223e-03, 2.399596418307832e-03, 1.061734864904230e-02, 1.330626298066318e-03,  4.849285230330630e-04, -2.699589472561770e-04, -1.326354741581872e-04, -1.314419013663385e-03, 1.943199070827127e-03, -1.376890533621705e-03, -1.278733871958512e-03, 3.841473319287384e-04, -8.377529927228482e-04, 1.336359309503658e-03,  9.906239036659600e-03, 1.257499698944539e-03, -8.454335885127097e-04, -1.701898888636298e-04, -4.253740743348970e-04, -1.265551682803647e-03, -3.107625503116020e-04, 3.386293131238186e-04, -4.609807589279976e-04, -5.983473306924996e-04,  5.670383722533229e-04, 1.290678706724705e-03, 6.436887011636444e-03, 1.732920732181738e-03, 5.039671025161081e-04, -1.516541812950638e-03, 1.692439168134068e-04, 1.690870175890776e-03, -8.589572393929274e-04, -5.675496885803857e-04,  1.556545598188143e-03, 1.320076552447330e-03, -1.797169896169458e-04, -6.316701909036251e-04, 6.232470467361137e-04,  1.615347704760915e-03, -5.656153047288645e-04, 2.738043088579453e-04, 5.873458766379056e-04, -6.369034871305671e-04, -5.555609461745626e-04, 2.527671595990282e-04, 9.679870598626851e-04, -1.391388440499909e-04, -1.005508678634725e-04, -1.833295244575109e-03, -8.906992265993346e-04, 6.900314599326763e-03, -4.148753124739061e-04, -3.053561898899672e-03,  9.593525912537627e-04, 9.191783544803500e-04, -1.103322997378922e-03, -2.230208531755232e-03, -2.258378147026349e-03, -3.293227846393084e-04, 4.074733462750514e-04, 2.894981505682869e-04, -1.083539848244292e-03, 2.919111284969661e-03,  1.120291085076801e-03, -2.241462296166126e-03, 3.031999205370952e-04, 9.376891408562019e-04, -1.695070852548408e-04,  9.831370056617972e-04, -1.050526105872578e-03, 2.138633848903252e-03, 9.879870128359186e-04, -3.588962732864000e-03,  5.438860917730357e-04, 5.123367332810110e-03, -1.396974495200708e-03, -1.327651075278139e-03, 1.299375092698709e-03,  2.293966030101189e-03, -1.189928018009855e-04, -4.037600701146067e-04, -6.857323427616323e-04, -5.423705700780350e-04,  1.118994493259767e-03, -1.889476201579276e-03, -1.531434727352050e-03, 5.634675268678463e-03, -3.973808349048515e-04, -8.699935746994411e-04, 1.724233157622384e-04, -9.674623040884409e-04, 1.084649452410337e-03, -5.273454887843692e-04, -5.465474348588629e-04, 6.144461931209268e-04, 4.392132659087866e-04, -8.727403467701626e-04, -5.614029553403378e-04,  3.867834467223732e-03, 2.429611197095412e-04, -9.662625852441243e-04, -9.358216594748995e-05, -5.264087589239021e-04,  1.725165930627881e-03, 5.229939778878345e-04, -2.005119168356142e-03, 5.386672737744248e-04, 1.690546869453740e-03, -7.196466677702514e-04, -2.448944520233387e-04, 5.027607218744973e-03, 9.806234738130488e-04, -2.745949064804235e-05, -5.979303690396264e-04, 1.337669900603535e-03, 9.401257083361014e-04, -2.107224991924950e-03, -5.135333002255899e-04,  1.768719676590093e-03, 3.735171197423278e-04, -1.107673799528889e-03, 3.275801853722244e-04, 5.955966963824876e-03,  1.528001260579274e-03, 7.381752450543354e-04, -4.985359576653255e-05, -4.517192839826115e-05, -1.918103689833672e-03,  8.291061978500415e-04, -3.120574246043605e-04, -1.196187405932597e-03, -1.292599180011968e-05, -3.964506178186461e-05,  1.367927694376239e-03, 6.570566447413499e-03, 6.958782088147178e-04, -5.787465656274214e-04, -1.443803356993296e-04,  1.040177849559998e-04, -8.365927382632003e-04, -7.102948218216615e-04, 1.068997377548338e-03, -2.930476915287683e-04, -8.552330402190023e-04, 3.900469325419070e-04, 8.923556864746217e-04, 4.078441389801851e-03, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00 )
               , tolerance = 1e-06)

  expect_equal(c(fit$fixed_effects),
               c(numeric(0) )
               , tolerance = 1e-06)

  expect_equal(c(fit$n_iter),
               c(19 )
               , tolerance = 1e-06)

  expect_equal(c(fit$Q),
               c( 0.015244346172653587, 0.019290400272122067, 0.053936727385310398, 0.033160763419218822, -0.032153012711678669, -0.025738919646089771,  0.028382289737654949, -0.040842074344938487, -0.043163942602263722, 0.030019111046850219, -0.001538689754944926, 0.019290400272122067,  0.105365931963089229, -0.011106109070712201, 0.311406835676287352, 0.162518864634217913, -0.011033655023395580, 0.110556409355881999,  0.019874628059270587, -0.082843607201464164, 0.081350905222818598, 0.007725433828982299, 0.053936727385310398, -0.011106109070712201,  0.456107190208661861, -0.127000783511973803, -0.455599862337534744, 0.031206317909447608, 0.075976290139438130, -0.355217988142333074, -0.207736370130899073, 0.061144429940771045, 0.063727679272592902, 0.033160763419218822, 0.311406835676287352, -0.127000783511973803,  1.246736746963372555, 0.405375738797954188, 0.044150581513115530, 0.188096494424591282, 0.014735264341074677, 0.124835351388194682, -0.145946179887811806, 0.206888179582554399, -0.032153012711678669, 0.162518864634217913, -0.455599862337534744, 0.405375738797954188,  0.947509722662987941, 0.209199606486100226, 0.238717406400025450, 0.502743973982804793, -0.223879607527512292, 0.376520748595535415, -0.117240667127850945, -0.025738919646089771, -0.011033655023395580, 0.031206317909447608, 0.044150581513115530, 0.209199606486100226,  0.851026091012941466, 0.073481064839489296, 0.017865912347525867, -0.037621631860038418, 0.043210634533322564, 0.275620318343373527,  0.028382289737654949, 0.110556409355881999, 0.075976290139438130, 0.188096494424591282, 0.238717406400025450, 0.073481064839489296,  0.237022602111303243, 0.034600918649512771, -0.337996998770151547, 0.319811234617278228, -0.054445529304646724, -0.040842074344938487,  0.019874628059270587, -0.355217988142333074, 0.014735264341074677, 0.502743973982804793, 0.017865912347525867, 0.034600918649512771,  0.360053819838712430, -0.029078755373008636, 0.147402839883771231, -0.127892992747867418, -0.043163942602263722, -0.082843607201464164, -0.207736370130899073, 0.124835351388194682, -0.223879607527512292, -0.037621631860038418, -0.337996998770151547, -0.029078755373008636,  0.652976165369459904, -0.605114147828078375, 0.190279700182582306, 0.030019111046850219, 0.081350905222818598, 0.061144429940771045, -0.145946179887811806, 0.376520748595535415, 0.043210634533322564, 0.319811234617278228, 0.147402839883771231, -0.605114147828078375,  0.653818336432870462, -0.218321706185423570, -0.001538689754944926, 0.007725433828982299, 0.063727679272592902, 0.206888179582554399, -0.117240667127850945, 0.275620318343373527, -0.054445529304646724, -0.127892992747867418, 0.190279700182582306, -0.218321706185423570,  0.223042564567503904 )
               , tolerance = 1e-06)

  expect_equal(c(fit$order),
               c(1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$F_),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$method),
               c("UKF" )
               , tolerance = 1e-06)

  expect_equal(c(fit$model),
               c("exponential" )
               , tolerance = 1e-06)

  expect_equal(c(fit$est_Q_0),
               c(FALSE )
               , tolerance = 1e-06)

  expect_equal(c(fit$LR),
               c(1 )
               , tolerance = 1e-06)
})


