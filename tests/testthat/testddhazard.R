if(interactive()){
  library(survival); library(dynamichazard); library(testthat)
  source("C:/Users/boennecd/Dropbox/skole_backup/phd/dynamichazard/R/test_utils.R")
}

# Test on data set that is one of Farhmiers papers
result = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1, # Use by month intervals
  control = list(est_Q_0 = T, n_max = 10^4, eps = 10^-4),
  a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
  max_T = 45,
  id = head_neck_cancer$id, order = 1
)

test_that("Testing previous computed values vs. current on head and neck cancer set assuming that the previous is correct", {
  expect_equal(c(result$state_vecs),
               c(-3.5084644693000375, -3.5148844600373153, -3.1891314791814929, -2.8181185126716946, -2.5133150253138181, -2.0686431883814391, -2.1337664829927272, -2.5088816216986980, -2.7261252524003838, -2.8656346839715456, -3.0022690651419150, -3.2103909019454631, -3.3296886621454438, -3.3797024676574670, -3.2387762301797576, -3.2832268974011902, -3.4010378429506498, -3.4996364628495664, -3.4640927580381167, -3.5454306632739097, -3.5193437650355053, -3.6429455602328522, -3.8148529400485618, -3.9315760725295390, -3.9912270162929087, -4.1221212755199144, -4.2111505273306804, -4.2593181086540230, -4.3955501412991156, -4.5056360495292482, -4.5891834181979796, -4.6463491829253352, -4.6772452961075963, -4.6818100380470060, -4.6597979866888570, -4.6108005184078964, -4.5342715329240795, -4.4295511232451679, -4.4288880723551687, -4.5320293776581728, -4.6212298063525905, -4.6940739120459574, -4.7499759978712248, -4.7915369057959181, -4.8188789577153992, -4.8320508432930724, 0.4360755600018228, 0.4376620032308990,  0.4489331535887380, 0.4629877155198045, 0.4717967889720516, 0.4892432325019014, 0.4906015100905337, 0.4811672226212869, 0.4812410655726153, 0.4807008058089728,  0.4795022646846021, 0.4752694673136330, 0.4750540102025831, 0.4782488768524199, 0.4871715112202827, 0.4868843094919623, 0.4843562325887174, 0.4835935130835331,  0.4867226287750569, 0.4863614783282632, 0.4891031221907462, 0.4848002061937289, 0.4802281967614200, 0.4772168219924643, 0.4758176353352087, 0.4735558899381061,  0.4724962572592801, 0.4726240459881104, 0.4714467634180154, 0.4710489177360688, 0.4714390992094060, 0.4726106938155138, 0.4745588596923577, 0.4772841101671843,  0.4807925107278950, 0.4850950220887917, 0.4902067111479924, 0.4961460340659207, 0.4977474633246664, 0.4949782740709857, 0.4925889375015259, 0.4906451477362695,  0.4891628332671372, 0.4880589755764653, 0.4873303205106824, 0.4869755787235325 ))

  expect_equal(c(result$state_vars),
               c( 0.0011007577913296656, -0.0001733451115550633, -0.0001733451115550633, 0.0004392322044566420, 0.0682991240249047060, 0.0003834452042018443,  0.0003834452042018442, 0.0029230271218272539, 0.0912395007549733350, -0.0003397914632747466, -0.0003397914632747466, 0.0052119615712443315,  0.0932049749695377378, -0.0016092541197089715, -0.0016092541197089711, 0.0073429567284740965, 0.0849686813506122934, -0.0030571106681653009, -0.0030571106681653005, 0.0093460739808944281, 0.0774928836229536178, -0.0044064881508436658, -0.0044064881508436658, 0.0112576788942480542,  0.0625786071371585012, -0.0058040178177705924, -0.0058040178177705924, 0.0131038581718835520, 0.0663037854506360463, -0.0066152078662832037, -0.0066152078662832037, 0.0149859903532218054, 0.0802636516361565355, -0.0072606054091964422, -0.0072606054091964422, 0.0169064138433351260,  0.0925945303565963995, -0.0077694160284284882, -0.0077694160284284891, 0.0188521666403896025, 0.1028653949187706279, -0.0082893243691400179, -0.0082893243691400196, 0.0208108298970566402, 0.1134521022635953669, -0.0087341231657698665, -0.0087341231657698665, 0.0227878464846351519,  0.1282127482321499812, -0.0091281359070864241, -0.0091281359070864224, 0.0247818173504978020, 0.1412262999503804406, -0.0096021138204995977, -0.0096021138204995960, 0.0267801536095240260, 0.1518039844431364749, -0.0100679733114127437, -0.0100679733114127437, 0.0287860644548110257,  0.1503781552817381462, -0.0107654864975719258, -0.0107654864975719258, 0.0307850681462566306, 0.1529892913432942814, -0.0114268209514253039, -0.0114268209514253039, 0.0328022104304094425, 0.1623989951758836869, -0.0119988254560485837, -0.0119988254560485837, 0.0348470071785677502,  0.1751405465177472420, -0.0124767948762201323, -0.0124767948762201323, 0.0369196593146410082, 0.1826262222670714253, -0.0130763410888457762, -0.0130763410888457762, 0.0390042849193854013, 0.1921213871302026865, -0.0136031573461606395, -0.0136031573461606395, 0.0411148217076838310,  0.1952137792451406062, -0.0142700820537257390, -0.0142700820537257390, 0.0432374522277687856, 0.2045009115946196943, -0.0150037228119862687, -0.0150037228119862670, 0.0453817496599724785, 0.2197992615605408318, -0.0156403530269492337, -0.0156403530269492302, 0.0475580384562985375,  0.2351742387248771660, -0.0163387197002041323, -0.0163387197002041323, 0.0497535112080704153, 0.2471786691448959739, -0.0171983898818672161, -0.0171983898818672196, 0.0519599789846230259, 0.2633406508519972045, -0.0179758501250396573, -0.0179758501250396607, 0.0541928396098181331,  0.2783570585162779554, -0.0187578421049752302, -0.0187578421049752336, 0.0564447233177911220, 0.2898617445280329274, -0.0196256986326030711, -0.0196256986326030711, 0.0587095922537396175, 0.3070089074201384216, -0.0202566671302706752, -0.0202566671302706752, 0.0610078966170546910,  0.3265517822464923947, -0.0207566923998554545, -0.0207566923998554545, 0.0633316746524540397, 0.3468613597848555496, -0.0211777326575118136, -0.0211777326575118136, 0.0656762424587988280, 0.3669330349624608245, -0.0215496836790728778, -0.0215496836790728778, 0.0680384930107222063,  0.3859999570458617635, -0.0218930814893318545, -0.0218930814893318545, 0.0704161786213701735, 0.4033580584084034970, -0.0222249753911356145, -0.0222249753911356145, 0.0728075543038044365, 0.4182756228156945255, -0.0225620115551172298, -0.0225620115551172298, 0.0752111771525787870,  0.4299395711487184468, -0.0229222709068044872, -0.0229222709068044872, 0.0776257813361121429, 0.4374185315654753881, -0.0233265169857653290, -0.0233265169857653290, 0.0800501930267311507, 0.4389396398028437285, -0.0237873509608388274, -0.0237873509608388274, 0.0824839842388029043,  0.4444370473634537966, -0.0241089985969926528, -0.0241089985969926528, 0.0849399776770060483, 0.4705099679725334716, -0.0239711015900734327, -0.0239711015900734327, 0.0874386019174675511, 0.5127677482774826156, -0.0234537793009185619, -0.0234537793009185619, 0.0899729190136854540,  0.5710035270105234817, -0.0225390051857156867, -0.0225390051857156867, 0.0925406272428825755, 0.6422966612793774566, -0.0213827332568293886, -0.0213827332568293886, 0.0951287192064125264, 0.7296350793987446126, -0.0198916154467032036, -0.0198916154467032036, 0.0977389611802057523,  0.8366982297826955906, -0.0179580979280018482, -0.0179580979280018482, 0.1003735699436583140 ))

  expect_equal(c(result$lag_one_cor),
               c( 0.0006319914823851234, -0.0001813450353835426, -0.0002126117899357636, 0.0004231047677557611, 0.0374926594959537965, -0.0005380017294018889, -0.0005485720017780360, 0.0027985731084827336, 0.0481658093802995874, -0.0016000013589881627, -0.0015949751696787691, 0.0050048137282718962,  0.0456878855983472026, -0.0029587363809467785, -0.0029189483751894322, 0.0070703673493283329, 0.0396604087798715019, -0.0043033008270456190, -0.0042589644753056816, 0.0090269214295090917, 0.0312294200116858406, -0.0056445383104769611, -0.0055052058435728288, 0.0109053718415916372,  0.0277604858121243067, -0.0066868592103896726, -0.0065493515470886115, 0.0127664150516888786, 0.0339237983194087267, -0.0074374459108181770, -0.0074140515313897131, 0.0146609784134950454, 0.0440622779829562689, -0.0081876860923845354, -0.0080158162771978795, 0.0165879425442369867,  0.0532613145041970354, -0.0087846810550449832, -0.0085842409359943670, 0.0185356890963747287, 0.0620030758351880484, -0.0093425048092310777, -0.0091025684196418474, 0.0204997891156617623, 0.0728513701255290580, -0.0097823345080032802, -0.0096128728534951753, 0.0224819052110776137,  0.0852163441699832769, -0.0102462632327539986, -0.0101088730406997656, 0.0244754314202132520, 0.0959330788853532263, -0.0107781511795978276, -0.0105860202161019556, 0.0264754322364910526, 0.1002061921916009707, -0.0114127390024465029, -0.0111391949292140822, 0.0284766937737128793,  0.1007636418466745787, -0.0120573912090688583, -0.0118570640836160000, 0.0304836792486671525, 0.1062366995263799574, -0.0126455551196479089, -0.0125325810037256995, 0.0325131894616143557, 0.1164479435890595910, -0.0131968007123752003, -0.0130824399573795571, 0.0345702739070011394,  0.1259739156939710947, -0.0137649784666452300, -0.0136274381705102868, 0.0366477215003125287, 0.1339397670426479281, -0.0143510749271825982, -0.0141996145156178810, 0.0387441154191005901, 0.1399397952275374390, -0.0149739632061277085, -0.0147895226744024933, 0.0408598614778161312,  0.1457693177465160805, -0.0155839512939056103, -0.0155955638120855878, 0.0429925035951635587, 0.1573951226983123508, -0.0162626012661845898, -0.0163227628857992857, 0.0451516935211992362, 0.1720884528462469087, -0.0169267713220890778, -0.0170279042024082637, 0.0473366336214868441,  0.1853207193021612631, -0.0176966192481461081, -0.0178397971217273306, 0.0495369101392598918, 0.1988822844190729910, -0.0185218493681163360, -0.0186795043672042492, 0.0517557651622434362, 0.2140265293846420891, -0.0193324169287155505, -0.0194536391053007109, 0.0539974391987324484,  0.2269743551126637005, -0.0201775348081844191, -0.0202760450098242243, 0.0562552827877792691, 0.2408827346519127055, -0.0209761004349988504, -0.0210013621236798051, 0.0585361402693362204, 0.2587873461391665963, -0.0215840832784766519, -0.0215509137876134238, 0.0608464935722820149,  0.2783108156512931197, -0.0220822328593056443, -0.0219982908028953338, 0.0631800531920647668, 0.2981521380750243311, -0.0225129962129074074, -0.0223819658897505894, 0.0655329263193361600, 0.3174279954979510876, -0.0229027366724126047, -0.0227258619326826256, 0.0679024304099249548,  0.3354014001863034333, -0.0232710946107934427, -0.0230480112171346438, 0.0702865626215162104, 0.3513521643906739600, -0.0236355450370131226, -0.0233647677843556098, 0.0726837231452698296, 0.3645059125021066215, -0.0240139196073090484, -0.0236931428694739724, 0.0750925529047788837,  0.3739890959881940757, -0.0244259932862989082, -0.0240522839920852098, 0.0775118285517998884, 0.3784535347735979438, -0.0249012435710693411, -0.0244462789870596130, 0.0799407418619832999, 0.3819151740934059180, -0.0253026050600785556, -0.0248317275156184590, 0.0823853873046871965,  0.3973498624532323387, -0.0253572058863496402, -0.0249807749061207209, 0.0848621500522364069, 0.4309121681052292541, -0.0250169074096886247, -0.0246995171538831222, 0.0873779395067437042, 0.4804161596009360879, -0.0243022568530614422, -0.0240233709749064703, 0.0899281997898045693,  0.5444877914482062486, -0.0232369005433537522, -0.0230542772574000854, 0.0925054925093105329, 0.6230475261289992739, -0.0218919395921305972, -0.0217917741796725788, 0.0951040211830674886, 0.7194167882990079033, -0.0201652844689610457, -0.0201377013624211842, 0.0977257666720493107 ))

  # expect_equal(c(result$n_iter),
  #              c(274 ))

  expect_equal(c(result$Q),
               c(0.129221898731263357, 0.002475034806031055, 0.002475034806031055, 0.002645631948634509 ))

  expect_equal(c(result$Q_0),
               c( 0.0011007577913296656, -0.0001733451115550633, -0.0001733451115550633, 0.0004392322044566420 ))

  expect_equal(c(result$n_risk),
               c(96, 95, 91, 84, 78, 65, 53, 49, 46, 43, 39, 37, 36, 36, 33, 31, 30, 30, 25, 25, 23, 21, 21, 21, 20, 19, 19, 18, 18, 18, 18, 18, 18, 18, 18, 18, 17, 15, 14, 14, 14, 12, 12, 12, 11 ))

  expect_equal(c(result$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45 ))

  # expect_equal(c(result$hazard_func),
  #              c([[1]]function (eta) {    exp_ = exp(eta)    exp_/(1 + exp_)}<environment: 0x000000001fb07d38> ))
  #
  # expect_equal(c(result$hazard_first_deriv),
  #              c([[1]]function (beta, x_) {    exp_ = exp(beta %*% x_)    x_ * exp_/(exp_ + 1)^2}<environment: 0x000000001fb07d38> ))

  expect_equal(c(result$order),
               c(1 ))

  expect_equal(c(result$F_),
               c(1, 0, 0, 1 ))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result$Q_0)), rep(c("(Intercept)", "group1"), 2))
})

result_exp = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1,
  a_0 = rep(0, 2), Q_0 = diag(1, 2),
  Q = diag(1e-3, 2),
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4),
  max_T = 30,
  id = head_neck_cancer$id, order = 1,
  verbose = F,
  model = "exponential"
)

# matplot(result_exp$state_vecs, type = "l")
# get_expect_equal(result_exp)

test_that("Result of exponential model on head_neck_data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.97670917333694840, -3.97674594528922842, -3.67822723844953225, -3.38186160670887448, -3.20803125783379928, -2.81150733914823459, -2.86991583304613229, -3.19339409542700414, -3.33884572499217747, -3.44488663489353897, -3.55468195135890896, -3.74276473988639058, -3.83879589030475188, -3.85491280083719179, -3.69206869970224005, -3.74688315457354149, -3.86422464743509453, -3.94733561401569233, -3.90529955776537419, -3.96708964150362231, -3.92627936981884496, -4.05352095843694382, -4.21056855197516100, -4.31870528617516136, -4.37554856865496156, -4.48030141196976395, -4.54582342572652021, -4.57305289422576866, -4.66140004517541939, -4.72082090785410191, -4.75069382389330297, 0.23643942429448270, 0.23642538963461671, 0.35119909608991445, 0.46549545046933199, 0.53138482409557175,  0.68486304659599784, 0.66299911692218005, 0.53892413086915458, 0.48510875095794093, 0.44552674674974957, 0.40424312760390879,  0.33246258946182772, 0.29654462841347456, 0.29181540205284756, 0.35597679374548952, 0.33497520088953925, 0.28981802576768462,  0.25819314969811624, 0.27468066357009663, 0.25112029063171620, 0.26699776975209677, 0.21721608197843270, 0.15629576896568312,  0.11412921530635921, 0.09164410510332197, 0.05109346037346890, 0.02559506518920458, 0.01479926108810842, -0.01912463326287420, -0.04194359001789783, -0.05341608209319967 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.1832051868721281673, 0.0278848469490704347, 0.0278848469490704381, 0.0803177213322829875, 0.1132034251783800571, -0.0002825347413270007, -0.0002825347413270007, 0.0681138636429205468, 0.1057893643022574104, -0.0037108490430141639, -0.0037108490430141639, 0.0657813363200184242, 0.0933234388646140278, -0.0089983708866558654, -0.0089983708866558654,  0.0628183664969049760, 0.0788715600332714067, -0.0155162728380365406, -0.0155162728380365128, 0.0592778241516741244,  0.0734428605985888855, -0.0165822472363131579, -0.0165822472363131579, 0.0587135297616458440, 0.0591657019120934505, -0.0217911346933305147, -0.0217911346933305217, 0.0563985065119824158, 0.0614045817202078167, -0.0201269492208758713, -0.0201269492208758713, 0.0571887451287438134, 0.0723425094484046460, -0.0145208873097363092, -0.0145208873097363092,  0.0599501350321204399, 0.0803567973399948177, -0.0104885005098428984, -0.0104885005098429001, 0.0620705206328553000,  0.0869387047105238953, -0.0071134417298352650, -0.0071134417298352659, 0.0640036899753111677, 0.0939937589466598167, -0.0034894844498765754, -0.0034894844498765763, 0.0661485628168010653, 0.1056352965671321503, 0.0018561382382013911,  0.0018561382382013894, 0.0690194618275779270, 0.1154879277980833396, 0.0062299728951861078, 0.0062299728951861026,  0.0714630155033750963, 0.1222252055365240092, 0.0092166054186206374, 0.0092166054186206409, 0.0733443351545733369,  0.1171870821646983502, 0.0074167417118372499, 0.0074167417118372429, 0.0733164859929927581, 0.1186200073373010061,  0.0080962739829031592, 0.0080962739829031558, 0.0742920260983656322, 0.1267252242886504343, 0.0113714342440382615,  0.0113714342440382511, 0.0763302459132520761, 0.1368320431509568169, 0.0154106707763921706, 0.0154106707763921637,  0.0787023904830222026, 0.1418229945213846377, 0.0173294366900338045, 0.0173294366900338011, 0.0802302232935526993,  0.1484277775914494280, 0.0199114476530654755, 0.0199114476530654685, 0.0820632817930946612, 0.1488018943776022174,  0.0200040322972981702, 0.0200040322972981771, 0.0829277355347014244, 0.1570037340272072146, 0.0229661973712110210,  0.0229661973712110210, 0.0848786434078876301, 0.1710859655268716084, 0.0282664666087455024, 0.0282664666087455094,  0.0877901216774502752, 0.1865428085371889089, 0.0340275035065738946, 0.0340275035065738946, 0.0908764893254096623,  0.2014834476666247376, 0.0394535520998959832, 0.0394535520998959902, 0.0938003636583288197, 0.2229019052396607470,  0.0473425660283096975, 0.0473425660283097044, 0.0976811265666991113, 0.2487790398587779450, 0.0569349094050815366,  0.0569349094050815435, 0.1022282780020242754, 0.2799374204675383337, 0.0684956253291079536, 0.0684956253291079675,  0.1075214163665750289, 0.3289519028931106037, 0.0869897747611888261, 0.0869897747611888261, 0.1155225124818885507,  0.3996377264490825754, 0.1138172549902054936, 0.1138172549902054936, 0.1267411842245389220 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.1031151556577854234, -0.0025673007890856248, -0.0041177019347565513, 0.0671738953591519139, 0.0729285502330940805, -0.0153665974737224043, -0.0163223793842787457, 0.0611807158610895852, 0.0644065921154819421, -0.0192288355867880623, -0.0200771554947000441, 0.0587459567274195293, 0.0535427330021189529, -0.0239158942554452691, -0.0251883169614478958,  0.0558824984363825716, 0.0464796572600867930, -0.0275860737664426203, -0.0268684891017166583, 0.0542637414978720672,  0.0392122788902791175, -0.0294064481771485198, -0.0293297471017429506, 0.0532084301672932219, 0.0356480065351482064, -0.0305448770356387816, -0.0298416548856658831, 0.0528117325314924682, 0.0391007556490918923, -0.0284712115615889730, -0.0270759696825927688, 0.0541164525517244047, 0.0455860098549121379, -0.0246247696130386419, -0.0236000239726060282,  0.0561089074393790813, 0.0509999785363083741, -0.0216239631152422562, -0.0206527528940453828, 0.0578530091473455632,  0.0562916820073403254, -0.0187677945664524483, -0.0176931041764787911, 0.0596626970982066657, 0.0638551422142593222, -0.0149661074687492766, -0.0139066474561677852, 0.0619031698774247519, 0.0731667066769392804, -0.0105326229049919270, -0.0097298238679709072, 0.0643460593649873014, 0.0805695408224628151, -0.0071133009784132770, -0.0064778750491979904,  0.0663753078027907867, 0.0813318588316555291, -0.0064375392389208665, -0.0060344261003749443, 0.0672889043995953118,  0.0797084297205427755, -0.0069327416786996027, -0.0065228958987601513, 0.0677886978908447263, 0.0839155137757939540, -0.0051944934955948895, -0.0047410661895154194, 0.0692114369860178241, 0.0921739318284499620, -0.0018678257622304888, -0.0014075992625329978, 0.0712902662011879601, 0.0992140159350134720, 0.0009836567781669348, 0.0013068741186968123,  0.0731646605524272076, 0.1045839525483038546, 0.0030432240366696992, 0.0034174257987806232, 0.0747811495072748106,  0.1078806901256837703, 0.0043465972131570517, 0.0046400514000073771, 0.0761011970976562674, 0.1118466302783495819,  0.0058133786026677743, 0.0059801473520385215, 0.0774610865836157098, 0.1222694919469353436, 0.0096261272420231150,  0.0098751951619719461, 0.0797852602660696492, 0.1363267096938496348, 0.0149120552743186169, 0.0151021452356542747,  0.0826785580752974619, 0.1509511601798297353, 0.0203473430664968327, 0.0204124280247277787, 0.0855987685722870567,  0.1683981812721982996, 0.0267338143382507831, 0.0267771885593782767, 0.0888925354534749884, 0.1913172634181187770,  0.0351973298712989283, 0.0352340798926058796, 0.0929984973894393968, 0.2191117948941448679, 0.0455237478712123000,  0.0455043952847125482, 0.0978116210372377975, 0.2579818125849921984, 0.0600511874735620288, 0.0600949580273164030,  0.1042783059265411510, 0.3163625819533421035, 0.0821479346489345230, 0.0821887053999010020, 0.1136704668433825699 ))

  expect_equal(c(result_exp$n_iter),
               c(66 ))

  expect_equal(c(result_exp$Q),
               c(0.09946932732012863, 0.03783300224988726, 0.03783300224988726, 0.01543663831742442 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))
})

test_that("exponential model and logit moels hazzard functions differs", {
  expect_true(result_exp$model != result$model)
  expect_true(toString(body(result_exp$hazard_func)) !=
                toString(body(result$hazard_func)))
  expect_true(toString(body(result_exp$hazard_first_deriv)) !=
                toString(body(result$hazard_first_deriv)))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result_exp$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result_exp$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result_exp$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result_exp$Q_0)), rep(c("(Intercept)", "group1"), 2))
})


# Change by argument
result_exp = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 2,
  a_0 = rep(0, 2), Q_0 = diag(1, 2),
  Q = diag(1e-3, 2),
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4),
  max_T = 30,
  id = head_neck_cancer$id, order = 1,
  verbose = F,
  model = "exponential"
)

# matplot(result_exp$state_vecs, type = "l")
# get_expect_equal(result_exp)

test_that("Result of exponential model on head_neck_data match previous results with altered by argument", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.66470254910492965, -3.66474706370252523, -2.76810021608623336, -2.37016905577829462, -2.88527701004363868, -3.09784986345455149, -3.48266257367868359, -3.53409599869474356, -3.50452999032306378, -3.68733386046285716, -3.75440297910365439, -3.92931420996290637, -4.13536817561038994, -4.31353242824072147, -4.29415086207046315, -4.44742781342733640, 0.14460881063442274, 0.14458966333745016,  0.54220314703993744, 0.71686313456859296, 0.48814165025303158, 0.39660025957471889, 0.22674612731683766, 0.20698865962895394,  0.22015367692421495, 0.13937097843449658, 0.10943794134073426, 0.02931587668643268, -0.06355936873028328, -0.14352365432290462, -0.13606103184196280, -0.20391357029043852 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.2239954769849443750, 0.0655923866343257334, 0.0655923866343257472, 0.0856850342803099352, 0.0701094856476841277, -0.0038922715688509135, -0.0038922715688509135, 0.0523721592627481858, 0.0755056468311222084, -0.0019795481071096244, -0.0019795481071096105, 0.0514742546248752875, 0.0459893287640510268, -0.0168002899428832814, -0.0168002899428832814,  0.0428520247345924449, 0.0395383065657095717, -0.0176668807846101159, -0.0176668807846101159, 0.0427380304585478071,  0.0554849050799214386, -0.0083268844417649975, -0.0083268844417650027, 0.0482405628816991311, 0.0685881166264916964, -0.0008915346260135876, -0.0008915346260135910, 0.0530967481749607603, 0.0917314760624167724, 0.0105768571207504984,  0.0105768571207505019, 0.0598970756325017256, 0.1029505276277184328, 0.0162964559289216979, 0.0162964559289216944,  0.0641352931380022306, 0.1037258639501149188, 0.0164485880804922657, 0.0164485880804922657, 0.0656497098810895630,  0.1265921801941821134, 0.0268701800644146269, 0.0268701800644146269, 0.0721116488290027280, 0.1394313143521199172,  0.0328068306908046725, 0.0328068306908046725, 0.0766830420360093551, 0.1583797329998488101, 0.0408462387555405329,  0.0408462387555405260, 0.0820262021138331576, 0.1897619001198406763, 0.0541928541421161369, 0.0541928541421161369,  0.0897223868891949550, 0.2404909896530670887, 0.0760800199433048219, 0.0760800199433048219, 0.1012582172983322176,  0.3106678049553517895, 0.1062117278334599041, 0.1062117278334599041, 0.1163272984336688326 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.0581028385172765310, -0.0072444734259627663, -0.0091541950837004671, 0.0507854295613683060, 0.0305719789171202405, -0.0205541704126560032, -0.0217954718525925212, 0.0429534684036514680, 0.0256335909301954809, -0.0232916444899874189, -0.0256021168272291474, 0.0396164859822722010, 0.0217562109295342289, -0.0268049576003472970, -0.0251706803089071125,  0.0380668354484768462, 0.0208436994532727946, -0.0254916865534527692, -0.0231220640448812874, 0.0396078590805537395,  0.0243612892264773936, -0.0218239875294321505, -0.0198641722726530523, 0.0425826594850195056, 0.0314033017870680442, -0.0171719045857336335, -0.0155045036084438571, 0.0462019832669743127, 0.0410358093169969629, -0.0117507577680532344, -0.0104671739924645686, 0.0502204627419419736, 0.0447135283650619969, -0.0094214520125273163, -0.0089886987863954937,  0.0526366994782183420, 0.0519460678887981378, -0.0064314589218757625, -0.0054966721024843051, 0.0557115478144272411,  0.0648237411726153845, -0.0004605667099179742, 0.0004626102810896780, 0.0602421445696742427, 0.0767237353479582607,  0.0050357523477366044, 0.0053979315269180438, 0.0644122809169798000, 0.0966036776555502241, 0.0134711383782364705,  0.0136579634961798840, 0.0698906297153868428, 0.1309471159607265567, 0.0281201853999506271, 0.0282851940496364022,  0.0781842396764870357, 0.1847772952660913237, 0.0513669286489622026, 0.0511865485567550155, 0.0901853413511809893 ))

  expect_equal(c(result_exp$n_iter),
               c(24 ))

  expect_equal(c(result_exp$Q),
               c(0.11112544355142200, 0.04881121798770979, 0.04881121798770979, 0.02253873603135799 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))
})

set.seed(93143)
sims <- test_sim_func_exp(n_series = 1e4, n_vars = 10, t_0 = 0, t_max = 10,
                          x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                          intercept_start = -5, sds = c(.1, rep(1, 10)))
# sum(sims$res$event)

# tmp_file <- file("exponential.log")
# sink(tmp_file)
result_exp = ddhazard(
  formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
  data = sims$res,
  by = (by_ <- 1),
  a_0 = rep(0, 11),
  Q_0 = diag(100, 11),
  Q = diag(1e-3, 11),
  control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^4),
  max_T = 10,
  id = sims$res$id, order = 1,
  verbose = F,
  model = "exponential")
# sink()
# close(tmp_file)

# matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
# matplot(result_exp$times, result_exp$state_vecs, result_exp$state_vecs, type = "l", lty = 2, add = T)

# get_expect_equal(result_exp, eps = 1e-5)

test_that("Result of exponential model on simulated data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-4.640329405134799856, -4.640311753033250497, -4.550993676355096440, -4.614838331453409381, -4.590891263593396943, -4.483467834203791469, -4.620637225223312328, -4.769813602659032092, -4.834326610436247229, -4.420605507792734201, -4.522868807375266087, 0.108345856623181483, 0.108472795125826027, -0.574982916927637366, 0.790821640745971055,  0.462522036415194293, 0.741176298026809399, 1.662081364913982062, 1.218647628166879660, 0.520025831153103968,  1.520853557961363789, 1.342364923930897902, -0.980910085743341487, -0.980905061739793971, -1.362996146535492059, -1.943979654182654837, -0.896711098952415075, -0.796535076465116232, -1.112661744265869279, -0.841716143355960900, -0.550477428190033868, -0.642644241717819087, -0.618138352265630742, -0.754224996519244240, -0.754200636722159978, -0.788904560683495237, -0.557115104472100331, 0.415567855955318921, 0.321219248124490764, 1.461815612851971480,  0.484343278806682709, -0.193083050393075162, -0.653738117576162181, -0.382721385625171329, 0.153847125773718257,  0.153984046463610275, -0.445255584136557969, 0.006278664829784838, -0.568872661326660811, -2.274651509082111556, -2.093718773630194541, -2.649177835456377750, -2.805889910384340880, -2.278609683924260665, -2.186761164929071022, -0.410154709465906375, -0.410028346979107838, -1.147912290627437271, 0.438669608556708446, 0.988621633420491475,  1.612682205399136981, 1.853587385876428462, 1.765024527304743573, 1.396795105813775306, 2.527779124417545820,  2.916099555303439672, 0.455369124267649195, 0.455539051019537622, -0.344643514586943089, 0.432820718716785346, -0.851967045601863093, -2.126495249079666916, -1.160812336921535959, -2.030507637731666648, -2.659564988482902237, -1.697804879556161772, -2.300761298414539802, 1.213981224195006536, 1.213739198413361198, 2.785634095539524235,  3.080709489979086779, 3.825089937085193625, 6.857321525636687731, 6.641668945722361883, 7.318533384207877468,  7.225595809580330098, 6.278779981634886376, 6.783357427076307289, 1.054974641402492974, 1.055110880850077537,  1.243015922940435392, 2.275009638561004799, 1.092902464443648247, -2.088097646377398586, -2.179778619868952827, -3.374668267329385962, -3.547010898297880743, -3.417122825498341676, -2.345477634436053727, 1.580096988417657444,  1.580058697888393038, 2.679552519163173052, 3.982926944948607328, 3.297410936237010315, 2.812735591660662227,  2.542557990903537846, 2.202226032885876705, 2.042681299478185331, 1.749984428338345444, 3.033427120207983663,  0.466858700876877086, 0.466911795897652970, 0.478847861547527565, 0.173653500956974266, -0.192344252785665193, -2.241004355217061317, -2.053260023873269002, -2.887074051761574722, -2.926252072866655674, -3.318223572221809192, -3.077882548546999608 )
               , tolerance = 1e-04)

  expect_equal(c(result_exp$state_vars),
               c( 5.047975948167505e-02, 5.942093828958669e-02, -5.223201377746592e-03, -9.078735283094752e-03, 1.266231447175955e-02,  5.489764205358191e-02, 5.640342268082262e-02, -3.154765268794783e-02, -3.131431713406402e-02, -4.146555238992166e-02, -3.256352757946952e-02, 5.942093828958669e-02, 4.979812620349549e-01, -8.979729757552542e-02, 2.120135064993148e-01,  1.917236816140378e-01, 4.618185741251177e-01, 4.084232800072548e-01, -1.926353654606558e-01, 1.429560150418533e-01,  3.000267865647285e-02, -4.847807352362802e-02, -5.223201377746592e-03, -8.979729757552543e-02, 1.597035543192931e-01, -2.040892727082370e-02, -9.997937751026453e-02, 1.845119208178305e-02, -1.909167715825232e-01, 6.748490098777751e-02, -2.729711094854725e-01, -1.898270676688834e-01, -1.095219961399517e-01, -9.078735283094755e-03, 2.120135064993148e-01, -2.040892727082370e-02, 4.870326692025913e-01, 5.876781592420766e-02, 1.320482373528137e-01, 1.614384955526937e-01, -2.261354108287317e-03, 1.141456253904126e-01, 3.814379102957656e-02, 1.312530772246732e-01, 1.266231447175954e-02,  1.917236816140377e-01, -9.997937751026453e-02, 5.876781592420761e-02, 5.256318248168839e-01, 7.345871854383944e-02,  5.600437030362873e-01, -8.570693892199855e-01, 8.508738912468918e-01, 1.250938424143880e-01, 4.573233416698958e-01,  5.489764205358191e-02, 4.618185741251176e-01, 1.845119208178306e-02, 1.320482373528137e-01, 7.345871854383947e-02,  6.705981942804016e-01, 1.373236981280395e-01, 6.895993817153295e-02, -1.790456961404168e-02, 1.031465962697830e-01, -2.451062658969403e-01, 5.640342268082261e-02, 4.084232800072547e-01, -1.909167715825231e-01, 1.614384955526936e-01,  5.600437030362873e-01, 1.373236981280395e-01, 8.267809500356975e-01, -9.376876650530684e-01, 7.745236130174368e-01,  7.777643839308380e-03, 4.336885130615124e-01, -3.154765268794783e-02, -1.926353654606558e-01, 6.748490098777750e-02, -2.261354108287325e-03, -8.570693892199858e-01, 6.895993817153294e-02, -9.376876650530687e-01, 1.658260820419002e+00, -1.206333718670131e+00, 1.349318534245949e-01, -7.834079263300995e-01, -3.131431713406402e-02, 1.429560150418533e-01, -2.729711094854724e-01, 1.141456253904125e-01, 8.508738912468921e-01, -1.790456961404171e-02, 7.745236130174370e-01, -1.206333718670131e+00, 1.792118331543165e+00, 6.484736219309734e-01, 9.166942713300039e-01, -4.146555238992167e-02,  3.000267865647282e-02, -1.898270676688834e-01, 3.814379102957655e-02, 1.250938424143880e-01, 1.031465962697830e-01,  7.777643839308400e-03, 1.349318534245949e-01, 6.484736219309732e-01, 6.613112469245124e-01, 1.716240644395416e-01, -3.256352757946953e-02, -4.847807352362801e-02, -1.095219961399517e-01, 1.312530772246732e-01, 4.573233416698959e-01, -2.451062658969403e-01, 4.336885130615126e-01, -7.834079263300995e-01, 9.166942713300039e-01, 1.716240644395416e-01,  6.264803382479585e-01, 5.818727694530993e-03, 1.262434247839518e-04, 3.600061832586285e-03, 1.544004646231348e-03, -2.694622984963810e-04, 1.780996048658342e-03, -1.763971080060848e-04, -3.419081955957699e-03, -4.533237115174301e-03, -6.771287612233757e-03, -1.118990507899058e-03, 1.262434247839506e-04, 2.274151070188434e-02, -6.140952261919180e-03,  6.373292604458581e-03, 2.856359490292001e-03, 1.357075090352910e-02, 1.397134593020066e-02, 3.857383887199649e-04, -3.172829176176333e-03, 7.436126611488605e-04, -6.519806065106059e-03, 3.600061832586285e-03, -6.140952261919174e-03,  1.948346695735961e-02, 3.185185549220352e-03, 2.006727362649218e-03, 8.312244865581063e-03, -1.211684493078814e-02, -6.558657733858693e-03, -1.170460962761933e-03, -8.147541524822265e-03, 4.208733732235680e-04, 1.544004646231348e-03,  6.373292604458567e-03, 3.185185549220352e-03, 4.303636041078360e-02, -1.854622894201968e-03, 1.110811123724006e-03,  1.889561478476624e-03, 5.375135224908081e-03, -5.759932615009264e-04, -2.515464535622403e-03, 1.003964822333853e-02, -2.694622984963850e-04, 2.856359490291996e-03, 2.006727362649194e-03, -1.854622894201997e-03, 1.211187104401433e-02,  4.069369918414062e-03, 4.876906173212451e-03, -1.132975553372742e-02, 9.435343916313125e-03, 2.694424900630720e-04,  2.975823911728644e-03, 1.780996048658343e-03, 1.357075090352911e-02, 8.312244865581074e-03, 1.110811123724006e-03,  4.069369918414027e-03, 3.713165024307027e-02, -2.769526445222321e-03, -1.210748136596670e-03, 2.160192957135325e-03,  3.591625893952773e-03, -9.804859406200125e-03, -1.763971080060846e-04, 1.397134593020065e-02, -1.211684493078816e-02,  1.889561478476619e-03, 4.876906173212474e-03, -2.769526445222310e-03, 2.815231203529590e-02, -7.655435576924819e-03,  5.760003609458909e-04, -5.627500502079490e-03, 1.840945492570843e-03, -3.419081955957699e-03, 3.857383887199901e-04, -6.558657733858700e-03, 5.375135224908074e-03, -1.132975553372740e-02, -1.210748136596677e-03, -7.655435576924857e-03,  3.643622896967093e-02, -7.677998898588273e-03, 1.200073679590909e-02, -6.993576619813216e-03, -4.533237115174301e-03, -3.172829176176322e-03, -1.170460962761900e-03, -5.759932615009304e-04, 9.435343916313236e-03, 2.160192957135295e-03,  5.760003609458997e-04, -7.677998898588242e-03, 3.214829245103272e-02, 1.671854253286217e-02, 1.148131198994442e-02, -6.771287612233756e-03, 7.436126611488392e-04, -8.147541524822289e-03, -2.515464535622397e-03, 2.694424900630155e-04,  3.591625893952793e-03, -5.627500502079475e-03, 1.200073679590908e-02, 1.671854253286217e-02, 3.187824640448887e-02,  1.775690417618387e-04, -1.118990507899060e-03, -6.519806065106039e-03, 4.208733732235786e-04, 1.003964822333854e-02,  2.975823911728491e-03, -9.804859406200114e-03, 1.840945492570850e-03, -6.993576619813228e-03, 1.148131198994446e-02,  1.775690417618283e-04, 1.784634073777389e-02, 4.867520305766744e-03, 2.931847866884757e-04, 2.782233457505667e-03,  9.694568771615181e-04, -2.215118221463823e-04, 1.125021165635903e-03, 2.484396221675906e-04, -2.526969138520719e-03, -3.652284904685300e-03, -5.716716357720491e-03, -1.160623048466219e-03, 2.931847866884707e-04, 2.008113405558928e-02, -4.910540378546796e-03, 5.951875607792318e-03, 2.704175628016832e-03, 1.259927755159152e-02, 1.227604760691119e-02, -2.361875507516764e-05, -2.563108919382580e-03, 2.534328958999531e-04, -5.631465859710423e-03, 2.782233457505666e-03, -4.910540378546777e-03, 1.593673585584901e-02, 2.037002557778719e-03, 1.524699363833515e-03, 7.065953263535162e-03, -9.932596254743062e-03, -5.267049354698215e-03, -1.144758601628579e-03, -6.429227914931035e-03, 6.461245619138959e-05,  9.694568771615203e-04, 5.951875607792322e-03, 2.037002557778725e-03, 3.775327200494077e-02, -1.431569107778048e-03,  1.078555520651130e-03, 2.158588553649940e-03, 5.174148643707768e-03, 5.704763813994596e-04, -1.033015573843987e-03,  9.140157603378633e-03, -2.215118221463911e-04, 2.704175628016844e-03, 1.524699363833482e-03, -1.431569107778064e-03,  1.061307076290024e-02, 3.772317198046931e-03, 4.643085034106344e-03, -1.023000586389470e-02, 8.525592298988595e-03,  3.119991943577435e-04, 2.882150086181081e-03, 1.125021165635905e-03, 1.259927755159154e-02, 7.065953263535178e-03,  1.078555520651131e-03, 3.772317198046914e-03, 3.295139280924468e-02, -2.117219991686664e-03, -7.976033096236247e-04,  1.995030295064883e-03, 3.636494547175710e-03,
                  -9.003897034044389e-03, 2.484396221675902e-04, 1.227604760691117e-02, -9.932596254743045e-03, 2.158588553649942e-03, 4.643085034106395e-03, -2.117219991686660e-03, 2.458318867675056e-02, -7.762317061330720e-03, 5.970050466413108e-04, -5.672928100387728e-03, 1.844243214673131e-03, -2.526969138520723e-03, -2.361875507515685e-05, -5.267049354698209e-03, 5.174148643707757e-03, -1.023000586389467e-02, -7.976033096236248e-04, -7.762317061330731e-03, 3.219188617434443e-02, -6.750364602371356e-03, 1.101542832280132e-02, -6.305185092962245e-03, -3.652284904685298e-03, -2.563108919382553e-03, -1.144758601628564e-03, 5.704763813994542e-04, 8.525592298988631e-03,  1.995030295064869e-03, 5.970050466413133e-04, -6.750364602371340e-03, 2.895269703081715e-02, 1.546828263562824e-02,  1.059954128876980e-02, -5.716716357720489e-03, 2.534328958999224e-04, -6.429227914931036e-03, -1.033015573843976e-03,  3.119991943576916e-04, 3.636494547175714e-03, -5.672928100387714e-03, 1.101542832280130e-02, 1.546828263562824e-02,  2.845624620099264e-02, 6.468519413203523e-04, -1.160623048466218e-03, -5.631465859710416e-03, 6.461245619138721e-05,  9.140157603378629e-03, 2.882150086180999e-03, -9.003897034044389e-03, 1.844243214673139e-03, -6.305185092962237e-03,  1.059954128876985e-02, 6.468519413203271e-04, 1.600617231468669e-02, 4.915916787184749e-03, 1.504643005626389e-03,  2.267186682097929e-03, 5.532011064514411e-04, 1.057525564778818e-03, 2.244022541579382e-03, 2.082403700336909e-03, -5.047553719091759e-03, -2.475863348206220e-03, -5.900170472124340e-03, -6.349546848943945e-04, 1.504643005626391e-03,  1.274964127539531e-02, -3.405034544265678e-03, 3.361588925725755e-03, 1.468356362272462e-03, 7.104694938315585e-03,  7.526941926970353e-03, 3.503582061575955e-04, -1.349075884440124e-03, 5.146711541520031e-04, -3.269033652205085e-03,  2.267186682097929e-03, -3.405034544265667e-03, 1.092858370966046e-02, 1.277368280207335e-03, 9.433256555572572e-04,  4.262370782732362e-03, -6.380382574803251e-03, -3.254652489141184e-03, -3.902434092099395e-04, -3.995906828176032e-03,  2.091406544886446e-04, 5.532011064514418e-04, 3.361588925725758e-03, 1.277368280207338e-03, 2.347046735059407e-02, -1.081935382089981e-03, 5.700353684652192e-04, 8.702488978847630e-04, 3.685545936261450e-03, 3.226564646687326e-04, -3.614432653611995e-04, 5.337615754756074e-03, 1.057525564778818e-03, 1.468356362272504e-03, 9.433256555572464e-04, -1.081935382089998e-03, 7.545593683418348e-03, 2.167018229837417e-03, 2.918632976052802e-03, -6.498802160052769e-03,  5.687503008642750e-03, 3.572040421644799e-04, 1.879661306860234e-03, 2.244022541579383e-03, 7.104694938315576e-03,  4.262370782732363e-03, 5.700353684652276e-04, 2.167018229837407e-03, 2.074958631184434e-02, -1.442035135854949e-03, -3.239547596239987e-04, 1.719236066288758e-03, 2.440286196566272e-03, -5.090238997586127e-03, 2.082403700336908e-03,  7.526941926970345e-03, -6.380382574803221e-03, 8.702488978847655e-04, 2.918632976052815e-03, -1.442035135854954e-03,  1.650330547637754e-02, -5.184851310817672e-03, 5.236014373423388e-04, -3.762408270026506e-03, 1.198083598138835e-03, -5.047553719091757e-03, 3.503582061576041e-04, -3.254652489141191e-03, 3.685545936261451e-03, -6.498802160052755e-03, -3.239547596239980e-04, -5.184851310817692e-03, 2.252565700038116e-02, -4.850534230417002e-03, 7.034946582151588e-03, -4.168791533456805e-03, -2.475863348206216e-03, -1.349075884440118e-03, -3.902434092099333e-04, 3.226564646687366e-04,  5.687503008642755e-03, 1.719236066288730e-03, 5.236014373423256e-04, -4.850534230416980e-03, 1.913497876047766e-02,  9.523639406716326e-03, 6.534760863689522e-03, -5.900170472124345e-03, 5.146711541519989e-04, -3.995906828176020e-03, -3.614432653612063e-04, 3.572040421645051e-04, 2.440286196566289e-03, -3.762408270026495e-03, 7.034946582151598e-03,  9.523639406716338e-03, 1.933521437604682e-02, 2.426219609897873e-04, -6.349546848943970e-04, -3.269033652205081e-03,  2.091406544886394e-04, 5.337615754756071e-03, 1.879661306860161e-03, -5.090238997586101e-03, 1.198083598138849e-03, -4.168791533456811e-03, 6.534760863689554e-03, 2.426219609897674e-04, 1.048291960230588e-02, 5.108583874781357e-03, -9.619324392118617e-04, 2.869094283017517e-03, 2.185799573431607e-04, -3.065364239073200e-05, -4.634072296219266e-04,  3.497186232845632e-04, -4.428130740502247e-03, -3.807944089417333e-03, -7.071367241031386e-03, -1.571970008329255e-04, -9.619324392118625e-04, 9.587336089282302e-03, -2.524797469346702e-03, 2.619180595710671e-03, 1.195173204791621e-03,  4.773154188423483e-03, 5.308568084433797e-03, 1.603633035986418e-04, -8.358577534740209e-04, 5.718921801136426e-04, -2.050730861983625e-03, 2.869094283017515e-03, -2.524797469346703e-03, 9.169859261421606e-03, 1.074814257930839e-03,  6.590021040088184e-04, 3.646743012056495e-03, -4.978404305900876e-03, -2.752572183200138e-03, -7.705457231063428e-04, -3.832010572789925e-03, -4.839942753563779e-05, 2.185799573431623e-04, 2.619180595710674e-03, 1.074814257930844e-03,  1.789191442238420e-02, -6.283242750014973e-04, 2.940267998030254e-04, 7.597844123945673e-04, 2.393959632954830e-03, -8.047201514836399e-05, -7.516854490760082e-04, 3.920115105418159e-03, -3.065364239072645e-05, 1.195173204791652e-03,  6.590021040088019e-04, -6.283242750014932e-04, 6.063263371989336e-03, 1.885205321736346e-03, 1.973162574468401e-03, -4.653784101393383e-03, 4.602477133026226e-03, 7.838504630587588e-04, 1.472012280053421e-03, -4.634072296219292e-04,  4.773154188423468e-03, 3.646743012056494e-03, 2.940267998030222e-04, 1.885205321736355e-03, 1.538933485233007e-02, -1.690925272461544e-03, -7.399868143364220e-04, 1.668709599059493e-03, 1.903260178789129e-03, -3.289864683394371e-03,  3.497186232845607e-04, 5.308568084433809e-03, -4.978404305900882e-03, 7.597844123945667e-04, 1.973162574468448e-03, -1.690925272461562e-03, 1.245794824869602e-02, -3.551230068571343e-03, 1.752682514657436e-04, -2.752906371773081e-03,  1.021334276583191e-03, -4.428130740502249e-03, 1.603633035986498e-04, -2.752572183200164e-03, 2.393959632954838e-03, -4.653784101393362e-03, -7.399868143364350e-04, -3.551230068571360e-03, 1.741812193022950e-02, -3.260102558299864e-03,  5.639084367351682e-03, -2.876806529258289e-03, -3.807944089417336e-03, -8.358577534740109e-04, -7.705457231063404e-04, -8.047201514837122e-05, 4.602477133026240e-03, 1.668709599059498e-03, 1.752682514657501e-04, -3.260102558299817e-03,  1.608758238042197e-02, 9.003046615699100e-03, 5.055315272152246e-03, -7.071367241031386e-03, 5.718921801136280e-04, -3.832010572789910e-03, -7.516854490760136e-04, 7.838504630587802e-04, 1.903260178789135e-03, -2.752906371773074e-03,  5.639084367351691e-03, 9.003046615699129e-03, 1.745928909011691e-02, 5.778267903180102e-04, -1.571970008329238e-04, -2.050730861983633e-03, -4.839942753564930e-05, 3.920115105418152e-03, 1.472012280053367e-03, -3.289864683394364e-03,  1.021334276583189e-03, -2.876806529258292e-03, 5.055315272152261e-03, 5.778267903179719e-04, 7.930325674239586e-03,  5.306697615274841e-03, -4.207951748688224e-04, 1.473200245954826e-03, -1.065960774997609e-03, 1.054635213009053e-03, -1.327392725445797e-03, 2.633607756549910e-03, -6.450369329740881e-03, -2.117054498217323e-03,
                  -6.616428880130591e-03,  5.904911198299176e-04, -4.207951748688239e-04, 1.047163662205208e-02, -2.768305733133774e-03, 2.871332252157681e-03,  1.376930991150897e-03, 5.908352630322409e-03, 6.341573487072659e-03, -6.396578866026619e-05, -8.472555999893704e-04,  3.900513166472981e-04, -2.408204736652332e-03, 1.473200245954826e-03, -2.768305733133762e-03, 9.594589616253157e-03,  1.534366326046866e-03, 6.115180987930165e-04, 4.088193781206045e-03, -5.906168923613580e-03, -3.120733244271767e-03, -1.146778426133650e-03, -4.139111158651668e-03, -6.941923080614192e-05, -1.065960774997610e-03, 2.871332252157683e-03,  1.534366326046868e-03, 1.933880294515046e-02, -6.093745214985063e-04, 5.411842083926656e-04, 6.674818183987333e-04,  2.400321235845886e-03, -9.906210937021598e-05, -1.041682185564864e-03, 4.483951661946302e-03, 1.054635213009060e-03,  1.376930991150888e-03, 6.115180987930097e-04, -6.093745214985133e-04, 5.851552416216334e-03, 2.211667322598326e-03,  2.398565861124786e-03, -5.301378004383525e-03, 4.604708863213577e-03, 4.769999388171731e-04, 1.515955295324490e-03, -1.327392725445797e-03, 5.908352630322415e-03, 4.088193781206054e-03, 5.411842083926699e-04, 2.211667322598331e-03,  1.719016733987985e-02, -1.798270663322407e-03, -9.824489842026290e-04, 1.661604279306539e-03, 2.067494878274305e-03, -4.111382826803308e-03, 2.633607756549911e-03, 6.341573487072674e-03, -5.906168923613579e-03, 6.674818183987378e-04,  2.398565861124829e-03, -1.798270663322419e-03, 1.432705930954794e-02, -4.579797741885368e-03, 4.450465476560140e-04, -3.037126813241425e-03, 1.145029051941536e-03, -6.450369329740886e-03, -6.396578866028506e-05, -3.120733244271763e-03,  2.400321235845879e-03, -5.301378004383434e-03, -9.824489842026295e-04, -4.579797741885372e-03, 1.929903905112439e-02, -3.274351192887636e-03, 6.951923610527912e-03, -3.155676383281182e-03, -2.117054498217326e-03, -8.472555999893654e-04, -1.146778426133655e-03, -9.906210937021669e-05, 4.604708863213580e-03, 1.661604279306542e-03, 4.450465476560074e-04, -3.274351192887599e-03, 1.625393780942136e-02, 9.479091610981562e-03, 5.198352962592835e-03, -6.616428880130586e-03,  3.900513166473085e-04, -4.139111158651676e-03, -1.041682185564868e-03, 4.769999388171302e-04, 2.067494878274310e-03, -3.037126813241420e-03, 6.951923610527900e-03, 9.479091610981594e-03, 1.788958751070524e-02, 4.633162423545619e-04,  5.904911198299231e-04, -2.408204736652312e-03, -6.941923080613436e-05, 4.483951661946307e-03, 1.515955295324490e-03, -4.111382826803323e-03, 1.145029051941531e-03, -3.155676383281216e-03, 5.198352962592840e-03, 4.633162423545592e-04,  8.209868287940328e-03, 3.854657369720539e-03, -5.686801612823696e-04, 6.810355322591918e-04, -3.775574484899172e-04,  1.866487138837922e-03, -1.059779340357428e-03, 2.107395579362536e-03, -6.014022851151826e-03, 1.671695742379527e-03, -2.558292852630543e-03, 1.925385900096035e-03, -5.686801612823681e-04, 4.752469609219967e-03, -1.052892751105685e-03,  8.289911509831230e-04, 2.985237458926527e-04, 1.928877008586000e-03, 1.847148045688815e-03, 5.414552045065572e-04, -5.789673934461365e-04, 3.581235896638404e-04, -1.105440924422376e-03, 6.810355322591908e-04, -1.052892751105682e-03,  4.499992914074597e-03, 4.342877046953566e-04, 4.140139083272279e-04, 1.113709773976238e-03, -1.774518039456494e-03, -1.579268795384761e-03, -1.078539606722037e-04, -1.498594521242225e-03, 2.107078099894311e-04, -3.775574484899155e-04,  8.289911509831197e-04, 4.342877046953585e-04, 7.551997474754380e-03, -3.295623759276253e-04, 3.608047392423957e-05,  1.204739379019995e-04, 1.114544748553781e-03, -1.995039972940652e-04, -2.244478928262831e-04, 1.427262042714594e-03,  1.866487138837928e-03, 2.985237458926350e-04, 4.140139083272173e-04, -3.295623759276087e-04, 3.753061817105888e-03,  3.145117907024246e-04, 1.355658598907268e-03, -3.119502839690842e-03, 1.625659740717336e-03, -7.793908913743563e-04,  8.132451721434100e-04, -1.059779340357430e-03, 1.928877008585999e-03, 1.113709773976238e-03, 3.608047392423867e-05,  3.145117907024170e-04, 7.022066125504206e-03, -8.483669138104566e-04, 5.250793930772202e-04, 2.518535682085644e-04,  9.027799707231202e-04, -1.669348966867374e-03, 2.107395579362534e-03, 1.847148045688799e-03, -1.774518039456482e-03,  1.204739379020022e-04, 1.355658598907250e-03, -8.483669138104571e-04, 6.605294462803868e-03, -2.823226689196793e-03,  6.376493891688362e-04, -1.621977662346391e-03, 8.861650578083876e-04, -6.014022851151825e-03, 5.414552045065594e-04, -1.579268795384760e-03, 1.114544748553797e-03, -3.119502839690804e-03, 5.250793930772106e-04, -2.823226689196788e-03,  1.371616901157336e-02, -2.149358347460071e-03, 4.102056194143566e-03, -2.377237023666580e-03, 1.671695742379520e-03, -5.789673934461217e-04, -1.078539606721985e-04, -1.995039972940794e-04, 1.625659740717377e-03, 2.518535682085663e-04,  6.376493891688291e-04, -2.149358347460025e-03, 6.672637448822698e-03, 1.862313317592763e-03, 2.004508281922749e-03, -2.558292852630544e-03, 3.581235896638317e-04, -1.498594521242218e-03, -2.244478928262818e-04, -7.793908913743782e-04,  9.027799707231175e-04, -1.621977662346391e-03, 4.102056194143557e-03, 1.862313317592777e-03, 7.450474524197572e-03, -7.312801888544825e-04, 1.925385900096032e-03, -1.105440924422364e-03, 2.107078099894318e-04, 1.427262042714591e-03,  8.132451721433922e-04, -1.669348966867372e-03, 8.861650578083996e-04, -2.377237023666550e-03, 2.004508281922728e-03, -7.312801888544777e-04, 4.676169784748782e-03, 4.640626629758356e-03, -1.548185203643514e-03, 1.129419574168320e-03, -1.805156860240046e-03, 2.175028670690686e-03, -1.593957342438420e-03, 1.808027413949110e-03, -7.248191177636722e-03,  2.126622167339851e-03, -3.013929543440114e-03, 2.160854877632629e-03, -1.548185203643509e-03, 6.513508523794198e-03, -1.782057933825631e-03, 1.603564103603939e-03, 3.308633463569602e-04, 3.237883030632939e-03, 2.800505135688540e-03,  1.277140799386546e-03, -8.269463886753514e-04, 1.058199298941537e-03, -1.728768366171977e-03, 1.129419574168319e-03, -1.782057933825625e-03, 5.737016117360426e-03, 4.047907361719276e-04, 5.385029031425046e-04, 1.588633035808894e-03, -2.726935752029762e-03, -2.346488518143846e-03, -2.942102676078686e-04, -2.353054303100111e-03, 3.023716756806401e-04, -1.805156860240046e-03, 1.603564103603937e-03, 4.047907361719333e-04, 1.081300546112730e-02, -8.605618655402504e-04,  4.535006717036770e-04, -3.932616657290010e-05, 2.884073843912784e-03, -4.310783863084422e-04, 4.374325994257164e-04,  1.751463541657706e-03, 2.175028670690698e-03, 3.308633463569600e-04, 5.385029031424936e-04, -8.605618655402442e-04,  4.259076658063421e-03, 6.014676991397797e-04, 1.642338592448235e-03, -4.111646963957454e-03, 2.347287093853225e-03, -7.588929615097151e-04, 1.003338865516207e-03, -1.593957342438421e-03, 3.237883030632948e-03, 1.588633035808895e-03,  4.535006717036835e-04, 6.014676991397859e-04, 9.517731120948997e-03, -1.091065430200141e-03, 8.291693966606863e-04,  1.784974639046213e-04, 1.541910902193153e-03, -2.509059378432408e-03, 1.808027413949111e-03, 2.800505135688560e-03, -2.726935752029761e-03, -3.932616657290012e-05, 1.642338592448247e-03, -1.091065430200152e-03, 8.040298461701963e-03, -3.258463112377493e-03,
                  8.886992831647489e-04, -1.523655590056090e-03, 9.215333923499148e-04, -7.248191177636719e-03,  1.277140799386555e-03, -2.346488518143850e-03, 2.884073843912787e-03, -4.111646963957390e-03, 8.291693966606832e-04, -3.258463112377481e-03, 1.673318133777436e-02, -3.006728746707523e-03, 5.410656681020656e-03, -2.923699372610822e-03,  2.126622167339851e-03, -8.269463886753526e-04, -2.942102676078729e-04, -4.310783863084484e-04, 2.347287093853211e-03,  1.784974639046192e-04, 8.886992831647367e-04, -3.006728746707512e-03, 8.448379675974834e-03, 2.790122365324870e-03,  2.725576668026144e-03, -3.013929543440111e-03, 1.058199298941539e-03, -2.353054303100114e-03, 4.374325994257156e-04, -7.588929615097205e-04, 1.541910902193157e-03, -1.523655590056092e-03, 5.410656681020625e-03, 2.790122365324862e-03,  9.243654713313213e-03, -7.996988235613900e-04, 2.160854877632626e-03, -1.728768366171958e-03, 3.023716756806417e-04,  1.751463541657706e-03, 1.003338865516238e-03, -2.509059378432398e-03, 9.215333923499269e-04, -2.923699372610803e-03,  2.725576668026120e-03, -7.996988235613911e-04, 5.418841394689141e-03, 5.100255017841792e-03, -1.148821367683666e-03,  8.325470169529014e-04, -9.437084130612613e-04, 2.788672836837985e-03, -1.410460727570880e-03, 2.608846041493194e-03, -8.018353159587438e-03, 3.547713433765109e-03, -2.457034187352060e-03, 3.038343971364788e-03, -1.148821367683663e-03,  6.245433731708981e-03, -1.568093942781384e-03, 1.188238043560727e-03, 1.549966979198142e-04, 3.054975868665874e-03,  2.553598910907167e-03, 1.166306733028428e-03, -1.208833192749068e-03, 6.450710016540870e-04, -1.851479793139301e-03,  8.325470169529028e-04, -1.568093942781374e-03, 5.413445070286483e-03, 6.218464009728692e-04, 5.478415235266261e-04,  1.322909719529815e-03, -2.447488516041189e-03, -2.175179963371411e-03, -1.605264616353362e-04, -2.062582215821487e-03,  4.191716752492399e-04, -9.437084130612651e-04, 1.188238043560727e-03, 6.218464009728773e-04, 1.041144805474787e-02, -9.084796287913876e-04, 1.122495695289383e-04, -1.602906040470361e-04, 2.541628564484283e-03, -7.102761461552356e-04, -1.949756405287082e-04, 1.708100087817343e-03, 2.788672836837987e-03, 1.549966979198185e-04, 5.478415235266243e-04, -9.084796287913763e-04, 4.743038366438000e-03, 4.063805785984841e-04, 1.985449835368905e-03, -4.826936401960707e-03,  3.131049331275103e-03, -7.217655855474725e-04, 1.554384063343529e-03, -1.410460727570879e-03, 3.054975868665867e-03,  1.322909719529817e-03, 1.122495695289405e-04, 4.063805785984995e-04, 9.164597903045578e-03, -1.005058752381785e-03,  8.963246704821286e-04, 2.902989246481288e-05, 1.476641371950832e-03, -2.520441111353626e-03, 2.608846041493192e-03,  2.553598910907178e-03, -2.447488516041177e-03, -1.602906040470458e-04, 1.985449835368911e-03, -1.005058752381791e-03,  8.293452660821338e-03, -4.066239711964678e-03, 1.596542603750265e-03, -1.675798663907266e-03, 1.418926398281215e-03, -8.018353159587436e-03, 1.166306733028426e-03, -2.175179963371396e-03, 2.541628564484269e-03, -4.826936401960706e-03,  8.963246704821371e-04, -4.066239711964670e-03, 1.829637743350105e-02, -4.487952671679995e-03, 5.083755445708125e-03, -3.976905255682586e-03, 3.547713433765104e-03, -1.208833192749053e-03, -1.605264616353262e-04, -7.102761461552469e-04,  3.131049331275054e-03, 2.902989246481803e-05, 1.596542603750271e-03, -4.487952671679974e-03, 1.000429133489709e-02,  2.567737159220596e-03, 3.654165055652365e-03, -2.457034187352057e-03, 6.450710016540766e-04, -2.062582215821494e-03, -1.949756405286996e-04, -7.217655855474583e-04, 1.476641371950829e-03, -1.675798663907269e-03, 5.083755445708104e-03,  2.567737159220606e-03, 8.759053108584906e-03, -9.762003773143757e-04, 3.038343971364793e-03, -1.851479793139324e-03,  4.191716752492242e-04, 1.708100087817356e-03, 1.554384063343578e-03, -2.520441111353623e-03, 1.418926398281207e-03, -3.976905255682591e-03, 3.654165055652371e-03, -9.762003773143716e-04, 6.164208481740704e-03, 5.575373955994528e-03, -4.156492027240681e-04, 5.094915691404281e-04, -3.595093127861186e-04, 3.112080689453196e-03, -1.103825037160373e-03,  3.522604042975399e-03, -8.426098067267185e-03, 3.780236181610190e-03, -2.589029853130440e-03, 3.199686841384068e-03, -4.156492027240685e-04, 6.637071906328625e-03, -1.684998418235978e-03, 1.099655379831000e-03, 4.275782572057473e-04,  2.858405311186254e-03, 3.199552837240269e-03, 5.488002282892819e-04, -1.018834809008192e-03, 3.958075255878449e-04, -1.747199873335928e-03, 5.094915691404299e-04, -1.684998418235973e-03, 6.152022231041379e-03, 9.252382193454473e-04,  5.160190437771144e-04, 1.829308063224474e-03, -3.061914365215486e-03, -1.996613303141084e-03, -3.055871023134516e-04, -2.109922612722500e-03, 2.703813578437837e-04, -3.595093127861170e-04, 1.099655379831002e-03, 9.252382193454472e-04,  1.146498924173261e-02, -7.411549171653562e-04, 1.266459609741665e-04, -2.834911080046682e-04, 2.044311182460921e-03, -5.459280173151845e-04, -4.450199462878806e-04, 2.192631430575495e-03, 3.112080689453195e-03, 4.275782572057499e-04,  5.160190437771113e-04, -7.411549171653536e-04, 5.229862751227673e-03, 4.669246130737145e-04, 2.336132551845356e-03, -5.056346830996837e-03, 3.252404952781656e-03, -8.504256458849183e-04, 1.573960599506499e-03, -1.103825037160374e-03,  2.858405311186248e-03, 1.829308063224475e-03, 1.266459609741669e-04, 4.669246130737219e-04, 9.639490123900099e-03, -1.130783378423785e-03, 4.888426664771233e-04, 1.663513040376678e-04, 1.263951986342222e-03, -2.438774634715573e-03,  3.522604042975400e-03, 3.199552837240271e-03, -3.061914365215478e-03, -2.834911080046693e-04, 2.336132551845345e-03, -1.130783378423784e-03, 9.837297103876118e-03, -4.590423546092526e-03, 1.739370853349221e-03, -2.096888021992005e-03,  1.479959250311149e-03, -8.426098067267183e-03, 5.488002282892897e-04, -1.996613303141088e-03, 2.044311182460917e-03, -5.056346830996839e-03, 4.888426664771326e-04, -4.590423546092529e-03, 1.920034988469207e-02, -4.294191614852350e-03,  5.433057287089212e-03, -3.872802344963173e-03, 3.780236181610193e-03, -1.018834809008192e-03, -3.055871023134465e-04, -5.459280173151757e-04, 3.252404952781618e-03, 1.663513040376674e-04, 1.739370853349226e-03, -4.294191614852338e-03,  1.064333219420427e-02, 2.863451691285411e-03, 3.829178199489513e-03, -2.589029853130442e-03, 3.958075255878397e-04, -2.109922612722499e-03, -4.450199462878856e-04, -8.504256458848836e-04, 1.263951986342224e-03, -2.096888021992004e-03,  5.433057287089212e-03, 2.863451691285396e-03, 9.635412649293185e-03, -8.976693477796191e-04, 3.199686841384062e-03, -1.747199873335942e-03, 2.703813578437871e-04, 2.192631430575492e-03, 1.573960599506530e-03, -2.438774634715568e-03,  1.479959250311156e-03, -3.872802344963200e-03, 3.829178199489524e-03, -8.976693477796279e-04, 6.704550440016808e-03,  5.449422871993479e-03, -1.824230960942514e-03, 8.051298387122686e-04, 5.805893163301620e-04, 2.729455820554754e-03, -2.727125634720567e-03, 2.386852480790637e-03, -7.848625981810459e-03, 4.051914669271276e-03, -2.328840448197257e-03,  4.104687666584884e-03, -1.824230960942514e-03, 6.960726914459664e-03, -1.582545811444816e-03, 9.679879436000345e-04,  3.462526193525673e-05, 3.216485163053134e-03, 2.227199063296835e-03,
                  1.608482327704206e-03, -1.612321118008116e-03,  9.808987310658329e-04, -2.421400698533511e-03, 8.051298387122686e-04, -1.582545811444816e-03, 6.474785593483134e-03,  9.779909866380497e-04, 7.811662562572214e-04, 1.716244164193434e-03, -2.661832708953140e-03, -2.094657104885695e-03,  7.626395523992467e-05, -2.193085408084343e-03, 4.849645551280490e-04, 5.805893163301620e-04, 9.679879436000345e-04,  9.779909866380497e-04, 1.147789162363155e-02, -4.427974676115855e-04, -1.682441384478243e-04, 3.203164012256918e-04,  7.733784126073943e-04, 8.010500141165228e-05, -7.523943480266782e-04, 2.611438482452499e-03, 2.729455820554754e-03,  3.462526193525673e-05, 7.811662562572214e-04, -4.427974676115855e-04, 5.680485198206473e-03, -1.549154390857071e-04,  1.850034153918082e-03, -4.745609287112699e-03, 3.253038288715120e-03, -7.548801699653191e-04, 1.674852667294193e-03, -2.727125634720567e-03, 3.216485163053134e-03, 1.716244164193434e-03, -1.682441384478243e-04, -1.549154390857071e-04,  1.102939598106410e-02, -1.704845776794994e-03, 1.852986026791974e-03, -6.516679444785287e-04, 1.548182991394530e-03, -3.204643935646622e-03, 2.386852480790637e-03, 2.227199063296835e-03, -2.661832708953140e-03, 3.203164012256918e-04,  1.850034153918082e-03, -1.704845776794994e-03, 8.780133110189532e-03, -3.277692406923634e-03, 1.561402090415551e-03, -1.578204946265054e-03, 1.574157252789993e-03, -7.848625981810459e-03, 1.608482327704206e-03, -2.094657104885695e-03,  7.733784126073943e-04, -4.745609287112699e-03, 1.852986026791974e-03, -3.277692406923634e-03, 1.893520992674189e-02, -4.643684012384253e-03, 4.356131097142306e-03, -4.517487356065475e-03, 4.051914669271276e-03, -1.612321118008116e-03,  7.626395523992467e-05, 8.010500141165228e-05, 3.253038288715120e-03, -6.516679444785287e-04, 1.561402090415551e-03, -4.643684012384253e-03, 1.124374076905916e-02, 2.384490702812941e-03, 4.476529610556557e-03, -2.328840448197257e-03,  9.808987310658329e-04, -2.193085408084343e-03, -7.523943480266782e-04, -7.548801699653191e-04, 1.548182991394530e-03, -1.578204946265054e-03, 4.356131097142306e-03, 2.384490702812941e-03, 9.397616611322115e-03, -1.140679732918131e-03,  4.104687666584884e-03, -2.421400698533511e-03, 4.849645551280490e-04, 2.611438482452499e-03, 1.674852667294193e-03, -3.204643935646622e-03, 1.574157252789993e-03, -4.517487356065475e-03, 4.476529610556557e-03, -1.140679732918131e-03,  7.979421498921608e-03 )
               , tolerance = 1e-04)

  expect_equal(c(result_exp$lag_one_cor),
               c( 5.810831180226140e-03, 9.480024130184214e-05, 3.601466494228279e-03, 1.546611549385707e-03, -2.771632975546439e-04,  1.752703147830099e-03, -2.039420814245619e-04, -3.401188609103559e-03, -4.516262831996648e-03, -6.749422128172681e-03, -1.102927532374348e-03, 1.167771404439490e-04, 2.249595475713230e-02, -6.105765530430705e-03, 6.263375289724798e-03,  2.753491963362198e-03, 1.333576590063404e-02, 1.376978409818320e-02, 5.016406292606692e-04, -3.246577545292979e-03,  7.375203858098212e-04, -6.500203590811529e-03, 3.571874236075140e-03, -6.099974901050071e-03, 1.941889048847017e-02,  3.198652484801994e-03, 2.064352395300799e-03, 8.310308286234162e-03, -1.203304012318674e-02, -6.607066605698150e-03, -1.025370130734774e-03, -8.052070861865025e-03, 4.808056968673457e-04, 1.545519372100297e-03, 6.266160715117741e-03,  3.199543382045909e-03, 4.281945783997947e-02, -1.887708643589888e-03, 1.041234336728788e-03, 1.804039113172729e-03,  5.384432536872899e-03, -6.353722539584375e-04, -2.535811684882461e-03, 9.981095684355467e-03, -2.437985231564256e-04,  2.760172709723038e-03, 2.049675079433942e-03, -1.883634279329973e-03, 1.182820822791394e-02, 4.031634894676080e-03,  4.586384729404491e-03, -1.084838720423255e-02, 8.978960842192373e-03, 2.096554344368813e-04, 2.726595524195232e-03,  1.769691086734804e-03, 1.333627070030365e-02, 8.308107617720327e-03, 1.038515808838993e-03, 4.034460704741702e-03,  3.680772238558806e-02, -2.843243224353105e-03, -1.246324446443456e-03, 2.178889688354609e-03, 3.544524552801433e-03, -9.681609382401590e-03, -1.667702191266041e-04, 1.376997161251521e-02, -1.204352443177996e-02, 1.805572737111773e-03,  4.568842848624016e-03, -2.849671454911980e-03, 2.774132202091349e-02, -7.122136486371148e-03, 1.574241683773501e-04, -5.621545237402153e-03, 1.603299397616679e-03, -3.424173500771165e-03, 4.835587241130364e-04, -6.579625580669142e-03,  5.376871545671165e-03, -1.086087489125918e-02, -1.242561522492598e-03, -7.161577805023923e-03, 3.552208590641412e-02, -7.021756281938194e-03, 1.192139640692011e-02, -6.566997462569103e-03, -4.428037558282016e-03, -3.244753745240705e-03, -1.042885880023445e-03, -6.248660906782226e-04, 8.968836139183355e-03, 2.170349468485749e-03, 1.775333253027065e-04, -6.989021605127078e-03, 3.119737898719838e-02, 1.638464663451853e-02, 1.098982142437517e-02, -6.687331187391067e-03,  7.303683036583325e-04, -8.053431277945784e-03, -2.531909797429057e-03, 2.005431597061088e-04, 3.543247347466589e-03, -5.623483618513688e-03, 1.194180564815670e-02, 1.638307029566806e-02, 3.153704136019623e-02, 8.582403118023642e-05, -1.075889667757663e-03, -6.495933094471075e-03, 4.708846005417240e-04, 9.987134882363987e-03, 2.722653648120115e-03, -9.685285238378815e-03, 1.614443150544417e-03, -6.551661520983562e-03, 1.098800100578570e-02, 8.738067921883511e-05,  1.751950442449389e-02, 9.365590960305128e-04, -4.760340429454109e-04, 1.104813721009560e-03, 8.678948659160951e-04, -7.995334534944613e-05, 1.931627462136264e-04, -8.063867552287377e-04, -7.278186404432221e-04, -4.279173697031820e-04, -9.625739034401653e-04, 9.419306629636923e-05, -3.936179124967811e-04, 3.349958419705024e-03, -7.896587818705674e-04, -5.365916800756246e-04, 6.571650168201316e-05, -1.177412177408974e-03, 1.158201079153199e-04, 1.260473293848312e-04, -1.948555438117832e-04, 7.708517633668652e-04, -3.247114529352012e-04, 1.276040840711081e-03, -7.638689710354504e-04,  5.589722492243238e-03, 8.849563638047145e-04, 6.995769488624880e-04, 9.111797371709712e-04, -1.331770634654654e-03, -2.172078503087063e-04, 5.665475641791189e-04, -8.856033831403654e-04, 2.959039296332410e-04, 8.404297541592819e-04, -5.445535143939720e-04, 8.483700103413775e-04, 4.905858650582693e-03, -1.943910435074002e-04, -3.256568049937786e-04, -9.753987249341964e-04, -5.591110088873068e-04, -3.802608745231407e-04, -4.125201695978889e-04, 3.541630115774181e-04, -2.182846532015686e-05, 8.128109804702481e-05, 6.863134668504823e-04, -2.094379305571345e-04, 4.055722397144197e-03, -2.652514537112994e-04, -4.521144943869506e-04, 9.122970148921026e-04, -2.815679865718450e-04, -5.866122830794346e-05, -6.829955874825910e-04, 1.102229586337043e-04, -1.201604077313990e-03, 8.970917095705026e-04, -2.674089380925077e-04, -2.948130323921919e-04, 3.929497384644418e-03, -9.609593034209491e-04, -4.266110054043470e-04, 4.636132945923262e-04, -5.786191187864900e-04, 7.195893262715676e-04, -7.354905417495750e-04, 1.013210478098114e-04, -1.320442275394900e-03, -9.897300201910004e-04, -4.720034273096013e-04, -9.011108043349923e-04, 4.433125541236236e-03, 1.825004280285061e-03, -3.161229610263933e-04, -1.637051535550603e-05, -2.570097827098718e-04, -6.069273020245527e-04, 2.084770022101474e-04, -3.549981472155419e-04, -6.195403955797213e-04, 9.216319307338208e-04, -3.660706785654794e-04, 1.967221151157854e-03,  4.019681317474981e-03, 1.185785613365084e-03, -1.115328139745006e-03, 7.480397286308972e-04, -2.780125591675850e-04, -1.104196711535690e-04, 4.319777604087236e-04, -5.053197025654047e-04, -3.673978329067559e-04, 5.433094737129411e-04, -1.922231096238380e-04, 1.230192405724870e-03, 2.846239825159837e-03, -8.771006364371257e-04, -5.823199421913445e-04, -1.157655595201620e-03, 7.682572529624602e-04, -9.959823085812672e-04, -5.549341476149469e-04, -1.094168030829670e-04, -5.264756572718706e-04, -3.266420173597597e-05, -1.070819456963870e-03, -8.183425416724080e-04, 4.893376273618202e-03, -8.133499343652818e-04, -4.407935520129918e-05, -3.602854111645994e-04, 3.577925781961452e-04, 3.842734860147051e-04, -6.614260859251697e-04, 6.510771315459091e-04, -2.520677029186466e-04, 6.795880609085630e-04, -4.952103006205782e-04, -8.642605333918853e-04, 3.759684410562677e-03, 7.500009023362857e-04, 1.490313159678911e-05, 7.882503761535915e-04,  4.373111045448920e-04, 1.638335556194818e-04, 2.075354803828014e-04, -9.969481727660720e-05, -7.945786372145903e-04, -8.431143679082340e-05, -9.502376316960553e-04, -9.124117152348274e-05, -3.056430657736249e-04, 2.358018343220705e-03, -3.263025214291660e-04, -3.759595677734187e-04, -6.370912495800728e-05, -1.118775336620890e-03, -4.021316825990324e-04,  2.737937625714342e-04, 1.559682349987223e-05, 5.752075854885955e-04, -7.324040461173325e-05, 7.780659884261940e-04, -1.170121825608040e-04, 3.813181615045604e-03, 3.302253097206938e-04, 5.601815395365447e-04, 4.660463651413663e-04, -1.636690326975482e-04, -2.497169140952223e-04, 4.068405898173695e-04, -4.902643505938086e-04, 2.052996716504333e-04,  6.007169104397104e-04, -2.713582467762038e-04, 3.772435555038426e-04, 2.770083184239899e-03, 6.096803314727074e-05, -4.347831428280020e-05, -3.812036979909996e-04, -8.598958137954289e-04, -2.187256861261990e-04, -3.193062373576866e-04, -4.136980073088945e-05, -6.864330073816919e-05, -7.492470249219991e-06, 3.393439216621890e-04, -7.226726186462660e-05,  3.204801608665079e-03, -3.294333297417874e-04, -3.843258813331304e-04, 1.030610309560444e-03, -3.115591225442962e-04,  9.029983586262229e-05, -4.545293423000572e-04, 1.722097113380430e-04, -9.562118174675587e-04, 3.051957675414742e-04, -2.180803378449407e-04, -3.019143773243484e-04, 2.530649798698470e-03, -3.891502610323436e-04, -1.214686704934165e-04,  2.415588035878812e-04, -4.410154655784026e-04,
                  5.869791676402015e-04, -6.019193836044059e-04, -4.182031159264375e-04, -4.300189566740181e-04, -5.256902852127769e-04, -4.843164083949720e-04, -5.357805254356847e-04, 2.699413104969042e-03,  1.723417668903788e-03, -1.186272146635000e-04, 1.736154861719018e-04, -1.909085635963272e-04, -6.163861296947508e-04, -3.545922608673400e-05, 9.063589659789352e-05, -3.371489921659935e-04, 6.578189054547248e-04, -2.238735829512756e-04,  1.034601588282266e-03, 3.281840848102763e-03, 8.233013902200373e-04, -8.883274347668171e-04, 4.883276251484816e-04, -3.258641367725028e-04, -1.336361251081424e-04, 3.715503648614082e-04, -1.334966192547042e-04, -4.313018296942732e-04,  1.416695626114423e-04, -2.867457253597733e-04, 1.145755665949062e-03, 2.028589056692884e-03, -8.169981558619503e-04, -4.967047543891732e-04, -8.501125430221987e-04, 2.318227396324649e-04, -4.024450556294979e-04, -1.360812702546637e-04, -1.668727924819605e-04, -6.384619371525341e-04, -3.051083498515474e-04, -7.677773173183867e-04, -8.012781049562935e-04,  3.859283255871536e-03, -5.152075329666358e-04, 3.251790223254483e-05, 1.618614180002296e-05, 1.537314726683533e-04, -6.092854167801887e-05, -4.589062082515369e-04, 7.515742142893090e-04, -9.057168360506005e-05, 5.671241320653439e-04, -6.381066190562158e-04, -6.205790116480142e-04, 2.853867896142628e-03, 8.094306211662024e-04, -2.867719488800560e-04,  6.135628815607812e-04, 2.687132017299733e-04, -2.296397170408096e-05, -5.101845309204752e-05, -2.883661876952961e-04, -8.191906946072222e-04, -4.337842261673869e-04, -1.057830267156045e-03, 2.759138091761670e-05, -5.796358809939741e-05,  1.782786871117307e-03, 1.031274924201643e-04, -1.979125092344860e-04, -2.610130034408543e-05, -7.907456257430145e-04, -5.874948721107940e-04, -8.750378810029151e-05, -3.107730775047540e-06, 1.182012298029809e-04, 1.678439976951476e-04,  6.272498718016533e-04, -1.674412083770160e-04, 2.858818540920486e-03, 8.017112204296501e-05, 1.595939505418538e-04, -8.640719849664874e-05, 1.840116716883469e-05, 5.455599050210023e-05, 5.548190814290825e-05, -4.333260798584681e-04,  7.650939477803784e-05, 4.474212416874016e-04, -3.829726094449017e-04, 1.867706253963561e-04, 1.430107846951027e-03,  2.663057404096839e-05, -2.248816585680786e-04, -2.636407656471179e-04, -6.220694087381485e-04, -2.054966753163548e-04, -3.177344493549908e-04, -2.808366880828342e-04, 9.684174535638983e-05, -8.362413423524268e-05, 3.109237897548474e-04,  1.848244307495900e-04, 2.541699714887010e-03, -3.242290574379393e-04, -3.690776915246362e-04, 7.245988919227764e-04, -4.482724642694326e-04, -1.184549603003129e-04, -3.025852850680365e-04, 3.031297785807699e-04, -9.273802236555843e-04,  9.928518714796028e-05, -1.317576852909837e-04, -2.895263490412050e-04, 1.559966033120767e-03, -1.199965376803119e-04, -2.233138966743396e-04, -9.624025248598323e-05, -6.994937610063977e-04, 6.364762717880684e-04, -1.883416294686044e-04, -5.316919893821974e-04, 1.614965717098916e-04, -2.426352137427446e-04, -3.278386483632704e-04, -9.992094609792459e-05,  1.779257630112397e-03, 9.129210840249721e-04, -1.168294108134310e-04, 9.798851104788958e-06, -1.010700149719925e-04, -1.016286309890427e-03, 2.408662803303809e-04, -1.180364580756647e-04, -4.901619161995466e-04, 7.591701651547293e-04,  1.643300453986507e-04, 9.819554434841843e-04, 3.084486309632496e-03, 1.000489232673840e-03, -2.011357202905909e-04,  3.851108012253448e-04, -2.191578763508756e-04, 7.799259424924512e-05, 2.742632924164265e-04, -5.779624762443981e-05, -3.399142553119185e-04, 8.457735202101722e-05, -8.044435647870798e-05, 7.333126892083489e-04, 1.541754381111976e-03, -7.422642507507234e-04, -5.671005803012490e-04, -1.012792159364924e-03, 4.508781683389237e-04, -3.996316366519626e-04, -5.864505533867482e-05, 7.278366436099339e-05, -2.421166480177001e-04, 9.050715142860152e-05, -4.599579873149579e-04, -3.920660967036754e-04, 3.572662846112370e-03, -3.885924793610894e-04, 5.317682547637621e-05, 1.487116230219619e-04,  1.091518478968658e-04, -3.495662271632406e-04, -3.453159617279264e-04, 6.440690434323267e-04, -9.407144933562214e-05,  4.636991817111017e-04, -5.959719340453880e-04, -4.035715759668008e-04, 2.113787933389224e-03, 8.757060160258833e-04, -3.074960026654848e-04, 4.957625189970793e-04, 1.323467016607693e-04, 1.157420894008666e-04, -2.267774357048572e-04, -3.020624692291496e-05, -1.216040175525040e-03, -2.132674175804166e-04, -1.161399265943639e-03, 2.081214146803381e-04, -3.376924448040287e-04, 1.615267603990021e-03, -7.671043662428340e-05, -2.043454355719181e-04, -1.150016012988855e-04, -5.623503180898243e-04, -5.540000505936905e-04, 3.412710838654307e-04, 7.221284382723562e-05, 4.327867860978619e-04,  1.046886394841348e-04, 5.270854330168966e-04, -8.382244421464055e-05, 2.367758578024529e-03, 1.178663396357089e-05,  1.765636103350152e-04, -2.718435800227775e-04, 2.029317980040265e-04, -2.122462611924370e-04, 1.143256081587288e-04, -4.885679278757348e-04, 1.837868291270516e-04, 2.562127319137238e-04, -2.687589564475517e-04, 9.111264843744970e-05,  1.113657749844756e-03, 1.929026902649722e-04, -2.374718784819241e-04, -1.515071313298545e-04, -6.201706712251539e-04, -5.516381767827565e-05, -2.142338854202172e-04, -2.395141565047094e-04, -9.239217003479980e-05, -9.391917385113621e-05,  9.038506486344839e-05, 8.955303443637078e-05, 2.095042020393086e-03, -2.744728582633907e-04, -3.248161039967667e-04,  7.517174403526949e-04, -3.209936445826339e-04, 6.974213338024009e-05, -2.266904809501869e-04, -1.606652903997201e-04, -5.955655706929418e-04, -5.632545853347549e-05, -1.482410829451756e-04, -2.319603777509673e-04, 1.399293337186332e-03, -1.243821894706690e-04, 1.924620445928895e-04, 5.822983275706066e-05, -1.220217680940205e-04, 4.759501270734638e-04, -2.641704825359190e-04, -4.089734403590389e-04, -6.282632641074445e-05, -1.679164210872589e-04, -3.526787467356734e-04, -1.940705003927945e-05, 1.528133794625756e-03, 1.029893693570281e-03, -6.690509294204815e-05, 2.891482933798837e-04, -1.658339888444698e-04, -9.678273490919576e-04, 1.694299848485381e-04, -2.380667948475863e-05, -2.769795291003132e-04,  4.708852759789345e-04, 1.805805252413960e-04, 5.733482759892530e-04, 3.197435272431237e-03, 5.251844013696755e-04,  1.327992094059044e-05, 1.829036705050651e-04, -5.284672451468925e-04, 1.864340845354051e-04, 8.252668186763563e-05, -1.675764902240277e-05, -4.577366249147395e-04, 2.576076920772079e-04, -2.539899050886683e-04, 1.119303423614941e-03,  1.236614055618549e-03, -1.600155474835211e-04, -6.921974732031974e-04, -1.099234277599207e-03, 3.748221101754890e-04, -2.914076587719410e-04, 6.238330477016131e-06, -7.328656555380015e-05, 4.509773298056754e-06, -3.349436133677735e-05,  9.614504059496463e-05, -4.651478826875140e-04, 3.364934991731087e-03, -4.344787422027689e-04, 2.230301472276358e-05,  1.525149151064290e-04, 3.782426489793916e-05, -2.775364275299994e-04, -2.319868298844485e-04, 4.364306245955137e-04, -8.445056589040324e-05, 3.662473667516359e-04, -4.993091712573207e-04, -2.998261763590302e-04, 1.806078567741523e-03,  6.770674743636616e-04, -1.755491097298083e-04, 1.204792255832101e-04, 4.544197857161534e-05, 2.425286981237523e-04, -2.112337816036065e-04, 1.667485559678940e-04, -1.202779311931053e-03, 3.291313468762834e-04,
                  -4.432120202069131e-04,  3.055369563592893e-04, -2.015072668778564e-04, 1.246953311491918e-03, 1.152620925769193e-04, -2.352464084741401e-04, -2.121285926373220e-04, -4.859280558523970e-04, -6.166212635991256e-04, 2.497157055127128e-04, -2.034116436914013e-05,  1.503403112773817e-04, 1.068087564958753e-04, 2.482574688969269e-04, 9.334134899446379e-05, 1.524249900668949e-03, -6.507929435191614e-05, 8.226837303021809e-05, -3.767149548542301e-04, 4.167737053345830e-04, 3.472610941546893e-05,  2.945486807149237e-04, 7.069041627052265e-05, 1.504788375986558e-04, 1.124692213975409e-04, -1.932473913842699e-04, -4.780953362492325e-05, 5.434077774868892e-04, 1.496490655350400e-04, -1.010713467671266e-04, -5.276857182290333e-05, -4.287884998704944e-04, 4.060876012703905e-05, -1.044052506238068e-05, -3.274109749617453e-04, 9.077105517360145e-05, -8.821029306810251e-05, -2.099981037410209e-05, 1.151915810319158e-04, 1.821769048880079e-03, -3.031691234769913e-04, -1.077591648601644e-04, 3.733711767590571e-04, -3.596448905012224e-04, -9.244571007798481e-05, -1.080104633063996e-04, -2.661348191902107e-04, -4.884529530020087e-04, -2.996813642543898e-04, -6.414640177988453e-05, -3.783812257650109e-04,  9.585380836796438e-04, -5.124708784800396e-05, 4.359468118102978e-04, -1.122586672054933e-04, -8.067395706551960e-05,  2.790120125666677e-04, -6.471205167644009e-05, -5.386233085723610e-04, 3.126345735118306e-04, -3.299591160799801e-05, -2.553077826556732e-04, 4.882588884502927e-05, 1.128483764288236e-03, 5.423676826620309e-04, -8.758075398435965e-05,  1.588037293929390e-04, -6.494370759425769e-05, -1.241590488903486e-03, 1.946414347033211e-04, 1.058706844298291e-04, -2.619509943900768e-04, 1.144466691563998e-04, 3.131251850402757e-04, 1.815377415922848e-04, 3.704822504566119e-03, -4.142863846544545e-05, -1.358772677763327e-04, -1.569927399536717e-04, -2.542349266504041e-04, 1.083705360639305e-04,  6.895841863746753e-05, -4.013568796470433e-06, -4.477721900994998e-04, 5.825587926985380e-05, -1.764034761311291e-04,  7.350185974906570e-04, 7.857518025505911e-04, -4.053588323062580e-04, -6.121458122921170e-04, -5.790186702711163e-04,  1.646093275872087e-04, 1.635774702339050e-04, 4.967657853579718e-05, -2.498286337673999e-04, -5.786956670019512e-05, -1.193965202683951e-05, 3.542130959130517e-06, -1.181045365014604e-03, 1.765304069374909e-03, -4.734920827526300e-04,  1.049168339220696e-04, 1.462732769963111e-04, 2.740870767544750e-06, -2.891585753133902e-04, -1.000159731733634e-04,  3.026959252021811e-04, -4.946516114640717e-05, 1.936813582005651e-04, -3.723090027608437e-04, -1.108305680714221e-04,  1.636379294057422e-03, 6.788687535361173e-04, -2.643230632837980e-04, 1.494516849531108e-04, -8.733273149564908e-05,  2.518231807406468e-04, -2.755043695444857e-04, 1.300146384502248e-06, -1.368974096354331e-03, 2.397728696704159e-04, -2.518104079309203e-04, 2.613469814163913e-04, -1.493519956008284e-04, 1.147723221157146e-03, 1.032447764668232e-04, -2.223972468285859e-04, -1.230888532368612e-04, -4.346917874449950e-04, -5.146023998502013e-04, 1.854841925105988e-04,  2.603774400285075e-05, 6.849362758889951e-05, 1.205662231815831e-04, 1.307218040159349e-04, 1.041814149852040e-04,  1.279778070783657e-03, -9.868466937804230e-05, -4.060526073139315e-05, -3.876948577880928e-04, 4.106200038717892e-04,  1.049063018286746e-04, 1.105021554870979e-04, 1.921629355033740e-04, 5.354948834858349e-05, 5.861320769878038e-05, -2.215544960636690e-04, -8.406132784180109e-05, 3.630940143620898e-04, 1.296794997314780e-04, -4.319911174235055e-05,  5.041284412141355e-06, -2.978434624632216e-04, 2.143657933859544e-05, 4.889428508470049e-05, -3.023214051819549e-04,  2.516753263617838e-04, -2.094256939686286e-04, -1.005473010822203e-05, 1.889095560722318e-05, 1.753900435489585e-03, -3.227184654328276e-04, -1.513861183633788e-04, 4.286276080578074e-05, -2.164121499681525e-04, -1.191201815530603e-04, -2.097636741600783e-05, -2.424201794446056e-04, -4.233460669868531e-04, -3.770577815308310e-04, 1.543482588675956e-05, -3.500818247275702e-04, 7.705382037367051e-04, 3.317655892722301e-05, 4.467039189032715e-04, -1.331844645337082e-04, -9.336485893813090e-05, 2.216762543814760e-04, 9.243460816336433e-05, -6.381662286990741e-04, 4.700458724649518e-04,  2.530646778409803e-05, -7.618361153917688e-05, 1.181789783769865e-05, 9.105455457344692e-04, 1.809050258107364e-04, -4.738536977658890e-05, 1.061793344209368e-04, -2.916379307921563e-06, -1.380556747898688e-03, 3.557982576859995e-04,  9.637715924155519e-05, -5.848572627184263e-05, 1.637152529641717e-05, 4.546553196273290e-04, 2.781523040475207e-04,  4.034330617438881e-03, -6.824485407619942e-05, -2.118950189403092e-04, -1.208442587332724e-04, 2.364285922121088e-04, -5.943609282487491e-05, 1.455132139352687e-04, -5.156090427579236e-05, -2.836539733996519e-04, -1.993069168152840e-04, -7.942660278301208e-05, -4.258701073490108e-05, 9.981164070200046e-04, -7.968281562323135e-04, -2.697423273233241e-04, -2.593390462260309e-04, 1.924771538551555e-04, 2.210012820529920e-04, 1.356662563257479e-04, -1.691600160644854e-04, -8.375613128343317e-06, 2.099500173990642e-04, -1.890920838641808e-04, -7.799941279767166e-04, 1.144726069781955e-03, -1.832795351612314e-04, 2.647628462352207e-04, 7.128016409126413e-05, 8.121193743151621e-05, -4.518210343171661e-04, -1.977209678865047e-05, 2.414848878808895e-04, -8.907446832014310e-05, -1.421625428781325e-04, -3.279009578644256e-04, -1.879818350646910e-04, 1.562203297995863e-03, 8.834034058486191e-04, -2.685493123968890e-04, 1.839880874926897e-04, -1.393153637119489e-05, 3.912276044751279e-04, -3.018532591789201e-04, 1.312507207979308e-04, -1.710230346046720e-03,  5.195215564277789e-04, -2.574559482859511e-04, 4.406484499403373e-04, -3.644826408863668e-04, 1.266961413741611e-03,  6.504046654584920e-05, -2.352680662049059e-04, -2.769760159400256e-04, -3.887490673862195e-04, -6.162496030271412e-04,  4.598363837127061e-04, -2.684976890732473e-04, 1.312206343764175e-04, -5.012957381411240e-05, 2.340982920466742e-04,  4.115158678463556e-05, 1.350233952387473e-03, -7.458003530994410e-05, 6.418577641858986e-05, -4.135141905532182e-04,  5.023220617371871e-04, -5.794381388965760e-05, 2.670205896271935e-04, 1.546253909127493e-04, 1.874813058506479e-04, -1.499628204958115e-04, -2.064905178732357e-04, -9.981163329313858e-05, 4.709689061551631e-04, -3.651962219498829e-05,  2.112483298064689e-05, -2.392988450855386e-05, 6.447848448929107e-05, -1.303984593863522e-04, 1.547894347075835e-04, -4.935696770237301e-04, 3.289120217865456e-04, -2.286374100663634e-04, 3.443195100561324e-06, 7.201832595082815e-05,  1.862090383099073e-03, -3.816814172902600e-04, -1.364179762751949e-04, -5.841414354462734e-05, -8.661396537365813e-05, -7.220210490394363e-05, 6.503337869958338e-05, -3.411943718591850e-04, -3.920284906082297e-04, -3.875799841551680e-04, -2.534886803088155e-05, -3.713297332257079e-04, 8.596131241520681e-04, -2.257704678815105e-05, 5.618598715444155e-04, -2.861659833817433e-04, 6.279552445349658e-06, 1.771183785583135e-04, 1.686754184313854e-05, -5.292765715336503e-04,  3.927174028187304e-04, 2.548447588535780e-05, -1.338124487966024e-04, -2.808962817979882e-06, 9.679290967836364e-04,  2.675742074680777e-04,
                  -2.183288874339589e-05, 2.103591910001050e-04, -4.382737948907457e-05, -1.696275276394584e-03,  3.169028749350221e-04, 1.838651091394709e-05, -1.567385501054272e-04, -1.476363760696424e-04, 4.716237216666787e-04,  1.340312426445250e-04, 4.631972235401564e-03, -3.766689375769675e-04, -1.548319859048828e-04, -3.345597475903857e-04,  3.495179617373121e-04, -6.789014715869421e-05, 1.256565052315604e-04, 3.382126537247585e-05, -1.543841866548845e-04, -2.278742006361665e-04, -1.970905008919905e-05, -1.971812683080179e-04, 1.209440102081724e-03, -7.600729275106855e-04, -1.964693078243406e-04, -3.697693679441926e-04, 1.827632201937012e-04, 1.661897870124363e-04, 5.831233196295610e-05, -2.016865198555313e-04, 4.649222043774252e-07, 8.508056411622477e-05, -6.620171780643858e-05, -1.035003318731643e-03,  1.122495890449116e-03, -3.480332970642888e-04, 3.963974009227487e-04, 7.362611557509972e-05, 9.417350282182749e-05, -3.790576053975316e-04, 8.138510248607831e-05, 2.253942062192135e-04, 6.101765804934301e-05, -3.578848712795355e-04, -1.073003739034014e-04, -2.273624264384007e-04, 1.705165121244163e-03, 1.020234144734328e-03, -1.838680048395731e-04,  1.514462973734414e-04, 1.342208503630824e-04, 4.626955641707806e-04, -2.592390877108384e-04, 2.449495596696546e-04, -1.925880587176293e-03, 5.924011730727287e-04, -2.833082081367539e-04, 5.555638314098089e-04, -3.073859031743858e-04,  1.297963655281501e-03, 8.821915220955537e-05, -2.914535880952497e-04, -2.821997639514451e-04, -4.847067537163339e-04, -6.649305704365163e-04, 3.660911645007986e-04, -1.792243727037808e-04, 1.542600094518858e-04, 2.956084081890787e-05,  1.808862813405471e-04, 1.764608567083708e-04, 1.408385591805056e-03, -7.917131725841557e-05, 5.821271917386834e-05, -3.309056783121025e-04, 5.000801954293195e-04, 7.972967843300526e-05, 2.236115797426612e-04, 2.599707142518879e-04,  8.324372947166183e-05, -1.131037290820769e-06, -2.687941837582708e-04, -5.460429359826000e-05, 4.925878137176069e-04,  6.724365685625823e-05, -3.332509129164969e-05, -9.834404943230750e-06, -1.752445477647071e-04, -1.147752924382058e-05,  3.371110514527316e-05, -4.416612777267981e-04, 4.904630503427814e-04, -2.020596978780029e-04, 3.628165021705809e-05,  1.671608281836145e-04, 2.137511714221627e-03, -4.388297853369894e-04, -3.834796541844955e-06, -2.332668967240751e-04,  5.771527545844612e-06, -1.479684267141010e-04, 1.987152760786514e-04, -3.394156678145392e-04, -5.232913395987362e-04, -4.209776274411218e-04, -6.909251354083812e-05, -4.710471993032859e-04, 8.869890910955113e-04, -6.906180642772114e-05,  5.067397008650950e-04, -2.903674939680637e-04, -4.928133186245221e-05, 2.584338921541833e-04, 1.698392709142544e-04, -5.749920953942202e-04, 4.859273775102583e-04, -3.461367763305723e-05, -1.032149781661503e-04, 7.094612847837842e-05,  1.153169607144801e-03, 1.554168100814351e-04, 7.912591284763173e-05, 1.369247290454524e-04, 7.153230129399579e-05, -1.905158496302024e-03, 1.621595197577892e-04, 7.013643409997470e-05, -4.282264429782440e-04, -1.612855407771002e-04,  4.150032502525959e-04, 3.791289417927652e-05, 5.178645181291172e-03, -3.735830311598355e-04, -2.127317907661143e-04, -5.132398302806093e-04, 6.118501704630801e-04, -1.271023438182828e-04, 1.948087640710575e-04, 4.901934381642371e-05,  4.245279952315852e-06, -2.145113374653830e-04, 1.970416525777977e-04, -4.277302098942571e-04, 1.546518881039718e-03, -1.001937581981173e-03, -1.528324544839370e-05, -3.257922582883080e-04, 6.712581451534435e-05, 2.252395231330326e-04,  2.319089027252039e-05, -1.451648983014424e-04, -1.671963436043315e-05, 6.679716990463103e-05, -1.331115064617444e-04, -1.013699773523904e-03, 1.144477371557353e-03, -3.644667834313610e-04, 5.762032360884513e-04, 5.263712256904749e-05,  1.114084131227703e-04, -3.066102272185724e-04, 1.648075745356259e-04, 2.489855005047370e-04, 1.725481812712845e-04, -4.788989185015319e-04, 5.761405881514105e-05, -2.882727906866076e-04, 2.059020438780677e-03, 1.134035791251656e-03, -3.816390462855123e-04, 1.218092389949018e-04, 3.346491484159337e-04, 6.689767182578098e-04, -6.301589794604326e-04,  3.291199711723788e-04, -2.355653802491596e-03, 1.009355683981342e-03, -2.605424661923142e-04, 9.793635447827818e-04, -2.017357219762983e-04, 1.511996144940448e-03, 1.950242510344186e-04, -3.266562712129032e-04, -1.879954092851022e-04, -6.099885018312147e-04, -6.992224801098310e-04, 1.957107090271042e-04, -1.013369836048288e-04, 2.043732938652432e-04,  1.271076238271642e-05, 1.842135471812144e-04, 1.110642706855703e-04, 1.660980477326274e-03, 6.959178011626643e-06,  1.094241971483785e-04, -4.992973639794539e-04, 5.539268203636293e-04, 1.179337094495349e-04, 2.952347374910997e-04,  2.556927078749221e-04, 1.482566089646524e-04, 1.943597061017818e-04, -3.185238687487736e-04, -9.566410877177820e-05,  5.956852117775318e-04, 2.012357553845409e-04, -1.230605818115438e-04, -2.057882372124558e-05, -5.432273753983229e-04,  2.892360084671706e-05, -7.253068950064045e-07, -3.524162484661992e-04, 6.047936320576905e-04, -2.977320451028598e-04,  8.114945480869679e-05, 1.626869490917051e-04, 2.700298922960626e-03, -7.956506779534115e-04, 1.015212940722774e-04, -5.314703113736360e-04, 2.081963899925553e-04, -2.562210538356640e-04, 3.589999701509526e-04, -3.377090258693196e-04, -5.681750788410875e-04, -3.686693768635184e-04, -1.078659355835539e-04, -6.353737855293835e-04, 1.190554659903124e-03,  1.662419443695697e-05, 6.111244939329136e-04, -3.730998962354022e-04, -6.576165603049685e-05, 2.204810441541190e-04,  2.786543837532762e-04, -7.561322637514397e-04, 5.708332053767391e-04, 7.557331628034419e-05, 9.953658296813998e-05, -9.463908294413440e-05, 1.469203568486036e-03, -9.405713897549641e-05, 4.300865227891186e-04, 1.467301377064688e-05,  3.693921926130819e-04, -2.048204169587326e-03, 4.101146709149285e-04, 3.490688083555346e-04, -8.444352159916229e-04, -3.555919917246250e-04, 1.011127761618601e-03, 4.453641061772321e-05, 6.200643073164720e-03, -9.071992075356864e-04, -5.254597385186766e-04, -1.025949802481986e-03, 6.869326575505404e-04, -2.424973490837602e-04, 2.491068780715959e-04,  1.842319714849902e-04, 1.386454148793382e-04, -4.545744471211350e-04, 2.558580354089639e-04, -5.619811300949062e-04,  2.093576844832985e-03, -1.150976049189638e-03, 3.233883348810533e-04, -3.501919336740179e-04, 2.326778720709993e-04,  2.737685068878488e-04, -3.808302738489848e-05, -2.250164460710994e-04, -1.433610198573942e-06, 4.615488064963743e-05, -1.616423938301492e-04, -1.300936505301571e-03, 1.386410660517525e-03, -4.869785257530072e-04, 6.333964820379454e-04, -8.960764463779812e-05, 4.842672080890235e-05, -2.715203832649553e-04, 2.121671885653589e-04, 2.108456783292260e-04,  1.077882747673853e-04, -5.851153628964232e-04, 2.470075785971115e-04, -3.053827990123771e-04, 2.664710466076432e-03 )
               , tolerance = 1e-04)

  expect_equal(c(result_exp$n_iter),
               c(10 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$Q),
               c( 0.0370208270496525521, 0.0346840926680007100, -0.0004928779816188159, -0.0208571032825212027, 0.0032854282856621874,  0.0392785014732876317, 0.0300047848033845876, -0.0156116944627311353, -0.0303768038725642994, -0.0311840211447406909, -0.0309083315201731240, 0.0346840926680007100, 0.5712629967579799795, -0.1689344093010227144, 0.1699914835929129120,  0.1983733101401181087, 0.4806195987055216223, 0.4963628620686454385, -0.1729705731558539850, 0.1411367394694021393,  0.0644335866834747639, -0.0831725427823917229, -0.0004928779816188159, -0.1689344093010227144, 0.2115076920424869833,  0.0109238726305051301, -0.1197455822665021152, -0.0231882511377370579, -0.2716548921509870373, 0.0656020832698623879, -0.2844790696689095677, -0.2181303836645035465, -0.0779258832363137338, -0.0208571032825212027, 0.1699914835929129120,  0.0109238726305051301, 0.4761910948474132321, 0.0408496881372439752, 0.1205034139007761657, 0.1023631519271150508,  0.0230601134492632656, 0.0907121344067435692, 0.0289888572070898451, 0.1265560992934248730, 0.0032854282856621874,  0.1983733101401181087, -0.1197455822665021152, 0.0408496881372439752, 0.5039644232533018187, 0.0663979580953672766,  0.5556907179749319692, -0.8218663676375470573, 0.8227518667627117255, 0.1403383762078424524, 0.4366440030504439296,  0.0392785014732876317, 0.4806195987055216223, -0.0231882511377370579, 0.1205034139007761657, 0.0663979580953672766,  0.6282413067881401636, 0.1833564816616718995, 0.0723787442229581746, -0.0429103816489497802, 0.0907190520515378240, -0.2506464040073169697, 0.0300047848033845876, 0.4963628620686454385, -0.2716548921509870373, 0.1023631519271150508,  0.5556907179749319692, 0.1833564816616718995, 0.8898901653505084663, -0.8828762449881620844, 0.7554263349056651311,  0.0672677737089865113, 0.3700241869638206116, -0.0156116944627311353, -0.1729705731558539850, 0.0656020832698623879,  0.0230601134492632656, -0.8218663676375470573, 0.0723787442229581746, -0.8828762449881620844, 1.5895096451001182736, -1.1563569106933839770, 0.1147556586157781056, -0.7513598795528899643, -0.0303768038725642994, 0.1411367394694021393, -0.2844790696689095677, 0.0907121344067435692, 0.8227518667627117255, -0.0429103816489497802, 0.7554263349056651311, -1.1563569106933839770, 1.7257264747912395286, 0.6473135056890816363, 0.8836805847952471371, -0.0311840211447406909,  0.0644335866834747639, -0.2181303836645035465, 0.0289888572070898451, 0.1403383762078424524, 0.0907190520515378240,  0.0672677737089865113, 0.1147556586157781056, 0.6473135056890816363, 0.6423093016675405220, 0.1696617618062133404, -0.0309083315201731240, -0.0831725427823917229, -0.0779258832363137338, 0.1265560992934248730, 0.4366440030504439296, -0.2506464040073169697, 0.3700241869638206116, -0.7513598795528899643, 0.8836805847952471371, 0.1696617618062133404,  0.6093937531651503203 )
               , tolerance = 1e-04)

  expect_equal(c(result_exp$Q_0),
               c(100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0,   0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0,   0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0,   0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0,   0, 0, 0, 0, 100 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$n_risk),
               c(20188, 19718, 19208, 18895, 18093, 17286, 16014, 14766, 13487, 12518 )
               , tolerance = 1e-04)

  expect_equal(c(result_exp$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 )
               , tolerance = 1e-04)

  expect_equal(c(result_exp$order),
               c(1 )
               , tolerance = 1e-04)

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 )
               , tolerance = 1e-04)

  expect_equal(c(result_exp$method),
               c("EKF" )
               , tolerance = 1e-04)

  expect_equal(c(result_exp$model),
               c("exponential" )
               , tolerance = 1e-04)

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE )
               , tolerance = 1e-04)
})

test_that("Unmacthed control variable throw error",
          expect_error({
            result = ddhazard(
              formula = survival::Surv(start, stop, event) ~ group,
              data = head_neck_cancer,
              by = 1, # Use by month intervals
              a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
              max_T = 45,
              id = head_neck_cancer$id, order = 1,
              control = list("None_existing_parem" = 1)
            )}, regexp = "These control parameters are not recognized"))

test_that("Decreasing learning rate in NR can get method to convergece",{
  set.seed(28650)
  sims <- test_sim_func_exp(n_series = 1e4, n_vars = 10, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                            intercept_start = -5, sds = c(.1, rep(1, 10)))
  arg_list <- list(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    a_0 = rep(0, 11),
    Q_0 = diag(100, 11),
    Q = diag(1e-3, 11),
    control = list(est_Q_0 = F, n_max = 10^2, eps = 10^-2),
    max_T = 10,
    id = sims$res$id, order = 1,
    model = "exponential")

  expect_error(do.call(ddhazard, arg_list))

  arg_list$control <- c(arg_list$control, list(LR = .75))

  result_exp <- do.call(ddhazard, arg_list)
  expect_equal(mean((result_exp$state_vecs - sims$betas)^2), 0.7661225948671551, tolerance  = 1e-6)

  arg_list$control <- c(arg_list$control, list(NR_eps = 1e-2))
  result_exp <- do.call(ddhazard, arg_list)
  expect_equal(mean((result_exp$state_vecs - sims$betas)^2), 0.4086950124175361)
})


set.seed(1059721)
sims <- test_sim_func_exp(n_series = 1e4, n_vars = 10, t_0 = 0, t_max = 10,
                          x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                          intercept_start = -3, sds = c(.1, rep(1, 10)))
test_that("Not suppling a_0 for exponential yields message and different results", {
  arg_list <- list(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(100, 11),
    Q = diag(1e-3, 11),
    control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^4),
    max_T = 10,
    id = sims$res$id, order = 1,
    verbose = F,
    model = "exponential")

  expect_message(fit_no_start <- do.call(ddhazard, arg_list),
                 regexp = "a_0 not supplied. One iteration IWLS of static glm model is used")

  arg_list$a_0 <- rep(-1, 11)
  suppressMessages(fit_with_start <- do.call(ddhazard, arg_list))

  expect_equal(mean(fit_no_start$state_vecs - fit_with_start$state_vecs),
               0.0003084506686478310)
})


test_that("EKF method with exponential yields previous computed results on PBC dataset", {
  # First order random walk
  suppressMessages(pbc_fit <- ddhazard(
    formula = survival::Surv(tstart, tstop, status == 2) ~ log(bili) + log(protime),
    data = pbc2, model = "exponential", by = 100, max_T = 3600,
    Q_0 = diag(10, 3), Q = diag(1e-3, 3), verbose = F,
    id = pbc2$id,
    control = list(LR = .5, eps = 1e-3, save_risk_set = F)))

  # get_expect_equal(pbc_fit, eps = 1e-4)
  expect_equal(c(pbc_fit$state_vecs),
               c(-11.44602717283422599, -11.44587975484109243, -10.44385629908731694, -10.56235304542852482, -10.76538445619658191, -10.87662306408265067, -11.03551104329713795, -11.15984397584252541, -10.98206631588560889, -11.18371058441632115, -11.42793760604186382, -11.59353577396207058, -11.70338126048991967, -11.94737914059979289, -12.17364757663448316, -12.13769168123553754, -12.29418675590076582, -12.45154824546508188, -12.58645963700949721, -12.49708528558155507, -12.60749808884934708, -12.75803696044800439, -12.86041367704365967, -12.89771465144659857, -13.07087509448669849, -13.19803671487673036, -13.12574844337657254, -13.25490457575628866, -13.37567417089612043, -13.50221844701546559, -13.48212487450610908, -13.60343981818300918, -13.77372725868726455, -13.75673804888968377, -13.89036461140896606, -13.96304326115610195, -13.93996377658154806, 0.55111703835168224, 0.55110481398428501, 0.06983760032725589, 0.14892740537081811, 0.19164571560440125,   0.26713588776988906, 0.34428202811187703, 0.40461892998798543, 0.31656322728805975, 0.39391944005024560, 0.46133737565901267,   0.47201857973682959, 0.46556905054422343, 0.52092502270092866, 0.56779825614052792, 0.50848348004272492, 0.54904645212554892,   0.59302357869593403, 0.62438701778046779, 0.54762571956054573, 0.56876105150378264, 0.60747162175569758, 0.61701276323867560,   0.58724688300658789, 0.62017159549703371, 0.64018533502412245, 0.56757557707039730, 0.59676633756008768, 0.63067055606861022,   0.66077091102175112, 0.61954247766661263, 0.64294518550661894, 0.68627835360599687, 0.62977403386399333, 0.66789189246368130,   0.68930929267895746, 0.67722712133449325, 1.30384352322374020, 1.30380449651708008, 2.20881936560692527, 2.03129318107660373,   2.04267870466432999, 1.86528951659126108, 1.73549964265039569, 1.65088521307359382, 1.85370214445717729, 1.76136687156927474,   1.72200262042195273, 1.79965333648473869, 1.88569112341069234, 1.86846374046720332, 1.87161242909430570, 2.04136915622005510,   2.00426957048772536, 1.96622335739285559, 1.95503058184912049, 2.14629582650143425, 2.14177376548307219, 2.11857522228876016,   2.15552469564257354, 2.27857702405309670, 2.28189412521563506, 2.29838079783860705, 2.48492110562471336, 2.46896521775270861,   2.43512222051498917, 2.41604459907238178, 2.53210639332781273, 2.53075107606545924, 2.49707393943484313, 2.66891752384557401,   2.63432499663054775, 2.61591862473600134, 2.64223223415943886 )
               , tolerance = 1e-04)
  expect_equal(c(pbc_fit$state_vars),
               c( 0.8094988478989879610, -0.0316214139068375158, -0.2691092784756375922, -0.0316214139068374742, 0.0168433703524009104, -0.0223531662721164481, -0.2691092784756375922, -0.0223531662721164585, 0.1772895720250708962, 0.6615562504967265056, -0.0063190092009932225, -0.2668778295100837639, -0.0063190092009931809, 0.0050224404616256921, -0.0028473341252440582, -0.2668778295100837639, -0.0028473341252440651, 0.1190025979508648746,  0.5629239976774975673, -0.0039408154778783067, -0.2240604058415045508, -0.0039408154778784177, 0.0043694934742669368, -0.0041506286085083999, -0.2240604058415045508, -0.0041506286085083721, 0.1019845073724636730, 0.4539379892284644002, 0.0034123194652359509, -0.1895842433962982576,  0.0034123194652359301, 0.0015151041003406405, -0.0019710711782130429, -0.1895842433962982576, -0.0019710711782130550, 0.0800144598114621020,  0.4365929670435191867, 0.0026387567561060527, -0.1822430953719975377, 0.0026387567561060518, 0.0014572286491726727, -0.0017993619558253618, -0.1822430953719975655, -0.0017993619558253618, 0.0772903045797302957, 0.4420743481058074242, 0.0019863438862240722, -0.1856143758688436896,  0.0019863438862240922, 0.0015773377267870689, -0.0017235060262755049, -0.1856143758688437173, -0.0017235060262754988, 0.0795593583020391681,  0.4438668405902131964, 0.0008753374977306452, -0.1853437620310502965, 0.0008753374977306513, 0.0018294110875077083, -0.0016377558376180269, -0.1853437620310502687, -0.0016377558376180189, 0.0798923663620838692, 0.4354890387840968380, 0.0001472939119055573, -0.1804816375327714384,  0.0001472939119055517, 0.0021235062572349060, -0.0018282159019037264, -0.1804816375327714106, -0.0018282159019037158, 0.0784430868641049911,  0.4187150334903791404, -0.0007840478243697659, -0.1696891581010487038, -0.0007840478243697647, 0.0023564794433804589, -0.0018427125577666313, -0.1696891581010487038, -0.0018427125577666287, 0.0730627504027751146, 0.4080556059339980335, 0.0005125612918412794, -0.1674407777240427275,  0.0005125612918412863, 0.0020987119547773254, -0.0017221952046135077, -0.1674407777240427553, -0.0017221952046135073, 0.0715043902447711488,  0.4250399772716669244, -0.0002954104477920487, -0.1729388284596871106, -0.0002954104477920433, 0.0024157883060804729, -0.0019051067403587124, -0.1729388284596871106, -0.0019051067403587150, 0.0743624663212517634, 0.4588207368605390357, -0.0012810457257762947, -0.1856414740862713242, -0.0012810457257762886, 0.0027814889205392069, -0.0020840277406205944, -0.1856414740862713242, -0.0020840277406205935, 0.0803986608301564959,  0.5019552083263795206, -0.0010652408738035274, -0.2062218395211010691, -0.0010652408738035316, 0.0029204464427138718, -0.0022481289585949411, -0.2062218395211010413, -0.0022481289585949416, 0.0901729841265149074, 0.5426119878831860976, -0.0013202953156653437, -0.2236013345804824803, -0.0013202953156653471, 0.0029904851042386743, -0.0021067435038687470, -0.2236013345804824803, -0.0021067435038687431, 0.0975082531076780779,  0.5784771000865822632, -0.0023003437444518559, -0.2363256560671165574, -0.0023003437444518550, 0.0033821014521109045, -0.0024153525546599659, -0.2363256560671165574, -0.0024153525546599672, 0.1035330599836434828, 0.6153557031490735074, -0.0040610872303990155, -0.2472181713352647470, -0.0040610872303990094, 0.0037835013740582183, -0.0023981501952178783, -0.2472181713352647470, -0.0023981501952178765, 0.1077374882130271716,  0.6635383163392039041, -0.0028289451480681795, -0.2725951006368037555, -0.0028289451480681743, 0.0034827447833174143, -0.0020177497215126809, -0.2725951006368037555, -0.0020177497215126761, 0.1185369946271096486, 0.7142510785858865452, -0.0039430578754930806, -0.2924346032494591907, -0.0039430578754930459, 0.0038527166801746596, -0.0022443840774236945, -0.2924346032494592462, -0.0022443840774236867, 0.1279940845897142576,  0.7608504030600502510, -0.0052088810065621148, -0.3094533405493877787, -0.0052088810065620793, 0.0042780149286897329, -0.0025631526927222363, -0.3094533405493877787, -0.0025631526927222307, 0.1361465790620706717, 0.8042798255866292489, -0.0066954504085737490, -0.3238757365237932007, -0.0066954504085737099, 0.0046776635987525426, -0.0027110401005292608, -0.3238757365237932007, -0.0027110401005292495, 0.1422078105061150843,  0.8397739172928859741, -0.0055230686893483838, -0.3411386658429896857, -0.0055230686893483569, 0.0041392814787529495, -0.0017571543032201668, -0.3411386658429896857, -0.0017571543032201555, 0.1468207386809222970, 0.8833108755747789420, -0.0057621454108694797, -0.3586801041391523004, -0.0057621454108694632, 0.0043848968531814952, -0.0021334253946560179, -0.3586801041391522449, -0.0021334253946560106, 0.1550153329196369001,  0.9305556654697154650, -0.0062383331307982346, -0.3775180371144207792, -0.0062383331307982182, 0.0047798824039641781, -0.0027527258560162810, -0.3775180371144207792, -0.0027527258560162667, 0.1645019395119540484, 0.9790089891964689484, -0.0069778726736367301, -0.3961076299216453878, -0.0069778726736367085, 0.0050593697265767894, -0.0028399450552788609, -0.3961076299216453878, -0.0028399450552788500, 0.1721250570782925371,  1.0246379505436582491, -0.0063571714990254304, -0.4171996702106140487, -0.0063571714990254147, 0.0049266257065893959, -0.0025764552059777180, -0.4171996702106140487, -0.0025764552059777150, 0.1806608899195240592, 1.0747753382904816633, -0.0068717384768190882, -0.4382654748928641042, -0.0068717384768190778, 0.0053568423295325676, -0.0031801237811020645, -0.4382654748928641042, -0.0031801237811020623, 0.1918972223509834152,  1.1257487724635750759, -0.0080484959965952951, -0.4577553692986263689, -0.0080484959965952604, 0.0058441157599886263, -0.0035320171405467124, -0.4577553692986264244, -0.0035320171405466964, 0.2014125827125385904, 1.1711816976645423871, -0.0074347068638087460, -0.4787451354637427547, -0.0074347068638087113, 0.0054308637535617713, -0.0023350397081715016, -0.4787451354637426992, -0.0023350397081714869, 0.2072107971482625433,  1.2181044949640706943, -0.0083124475097730299, -0.4963948098803740439, -0.0083124475097730126, 0.0059893926120312456, -0.0029361656746312859, -0.4963948098803739883, -0.0029361656746312781, 0.2160932169717232343, 1.2655243388182582098, -0.0098305077375682066, -0.5123630323363845829, -0.0098305077375681962, 0.0067093729635383514, -0.0035468651004911629, -0.5123630323363845829, -0.0035468651004911594, 0.2239345296296032795,  1.3134024212514443519, -0.0119168399792524433, -0.5269349330224046835, -0.0119168399792524277, 0.0074120323943128227, -0.0037397079247606354, -0.5269349330224046835, -0.0037397079247606267, 0.2298594307528735725, 1.3567413405711099550, -0.0124839803977951080, -0.5432045700787653253, -0.0124839803977950942, 0.0073186856720340128, -0.0025472075110281305, -0.5432045700787653253, -0.0025472075110281331, 0.2331036097639175853,  1.4084866346807052295, -0.0157226382591338365, -0.5563217239280263682, -0.0157226382591338400, 0.0080814097451577492, -0.0023771048306105965, -0.5563217239280263682, -0.0023771048306106043, 0.2379577841545614525, 1.4887141622528541340, -0.0259908154661818366, -0.5627565654495892966, -0.0259908154661818366, 0.0090287782124849527, 0.0006006870035486526, -0.5627565654495892966, 0.0006006870035486509, 0.2318196976706644596,  1.5527219235313824974,
                  -0.0202506352547166188, -0.6082188816229042727, -0.0202506352547166188, 0.0093778818872143795, -0.0013626526478017619, -0.6082188816229042727, -0.0013626526478017636, 0.2562844286399209026, 1.6601784614825891850, -0.0250130408747203034, -0.6458059488643513868, -0.0250130408747203034, 0.0111758673191819646, -0.0021071949057032717, -0.6458059488643513868, -0.0021071949057032717, 0.2740427865920352368,  1.7799769429258134323, -0.0299461482782829649, -0.6916470751252379312, -0.0299461482782829649, 0.0135454777952739303, -0.0043523073559269361, -0.6916470751252379312, -0.0043523073559269361, 0.3023489167194555738 )
               , tolerance = 1e-04)
  expect_equal(c(pbc_fit$lag_one_cor),
               c( 6.499943369918135e-01, -6.200224818476166e-03, -2.622177760931144e-01, -5.056044480953342e-03, 4.994204590195617e-03, -3.328812263598158e-03, -2.646846373056984e-01, -2.826340543522141e-03, 1.180392809949486e-01, 5.440433466414216e-01, -4.651798879264091e-04, -2.244701996013108e-01,  2.833096559451409e-04, 2.825581572663716e-03, -1.945770957483828e-03, -2.263488892400431e-01, -1.537123027088555e-03, 9.551996912436256e-02,  4.424021220346803e-01, 3.649762360052856e-03, -1.852671063046183e-01, 4.135284414779034e-03, 1.513012861094225e-03, -2.047631925755453e-03, -1.854726793861597e-01, -2.256173690706518e-03, 7.791613397750900e-02, 3.881299433154224e-01, 4.632806543154134e-03, -1.632028098504223e-01,  5.045604213911148e-03, 9.709564342451526e-04, -2.316533865881397e-03, -1.629564369153767e-01, -2.116486550070008e-03, 6.856687465779117e-02,  3.819998281520473e-01, 4.299119683773980e-03, -1.619035325703958e-01, 4.163847260156402e-03, 9.497880001840518e-04, -1.985336760616491e-03, -1.605383115993122e-01, -2.003946815502101e-03, 6.810748471309694e-02, 3.849648881000427e-01, 3.577815882992158e-03, -1.628787625985442e-01,  3.548559506195599e-03, 1.043259732983214e-03, -1.782386742221195e-03, -1.629620976237402e-01, -1.768715816404212e-03, 6.905649406251130e-02,  3.808291912119355e-01, 3.123137630251602e-03, -1.607091670113274e-01, 2.829652722776715e-03, 1.177703856789001e-03, -1.568897971291987e-03, -1.608942964389839e-01, -1.658708778259033e-03, 6.808748778630784e-02, 3.673820438654425e-01, 2.346361580175132e-03, -1.522335196520815e-01,  2.671744917779349e-03, 1.310416886156284e-03, -1.650699993377112e-03, -1.548325486700849e-01, -1.433416390949041e-03, 6.447453126118019e-02,  3.539292831259391e-01, 2.908158990930095e-03, -1.474073524933963e-01, 2.404335962259477e-03, 1.342453203305676e-03, -1.464407973188711e-03, -1.467068061268822e-01, -1.748640531892031e-03, 6.138853969195063e-02, 3.571155478874662e-01, 2.834770743029052e-03, -1.483392287591388e-01,  2.865199295135342e-03, 1.392422066849039e-03, -1.691917057346188e-03, -1.487256375954893e-01, -1.654690836206263e-03, 6.204390874468696e-02,  3.810587808679901e-01, 2.271515799359841e-03, -1.579343676738988e-01, 2.419538615669660e-03, 1.571517927948801e-03, -1.654062827947465e-03, -1.579980695908458e-01, -1.544754024065721e-03, 6.590748927396897e-02, 4.186256171307797e-01, 2.322955127029307e-03, -1.757043719245817e-01,  1.880664450250254e-03, 1.740742284941247e-03, -1.522974238597805e-03, -1.732695316896017e-01, -1.702857978318258e-03, 7.326747689026450e-02,  4.604024685987834e-01, 1.928199259574759e-03, -1.933948047594025e-01, 2.178382970580050e-03, 1.847520937662090e-03, -1.659066871562592e-03, -1.931692857039514e-01, -1.580168257412414e-03, 8.168836279318492e-02, 4.980090814612999e-01, 1.483490349432296e-03, -2.082027851252715e-01,  1.842268581698725e-03, 1.983260140017493e-03, -1.655332223504990e-03, -2.090544190866486e-01, -1.445295605612172e-03, 8.806530285042691e-02,  5.330431732422733e-01, 2.694994152486973e-04, -2.197218721808388e-01, 1.280530650196697e-03, 2.193513132749826e-03, -1.665792587222615e-03, -2.225188342764387e-01, -1.160068150075880e-03, 9.271135518685189e-02, 5.752318978806288e-01, 7.046779591419179e-04, -2.404901534981730e-01,  1.526681233889327e-04, 2.271800273875997e-03, -1.058771531702975e-03, -2.371307488604205e-01, -1.446717720948978e-03, 1.000703135481371e-01,  6.247611551266294e-01, 2.442150236041027e-04, -2.612439211841737e-01, 5.910418517815347e-04, 2.325325413732171e-03, -1.273483239840615e-03, -2.612473137196304e-01, -1.107104887672210e-03, 1.101196411868766e-01, 6.723565755293573e-01, -5.630342538662974e-04, -2.800367783726710e-01, -8.539303241700269e-05, 2.517627996137306e-03, -1.220708041716458e-03, -2.808058844323973e-01, -9.719065197381450e-04, 1.182270084466372e-01,  7.162787860752110e-01, -1.680405693147773e-03, -2.957724143764978e-01, -8.309495986728241e-04, 2.741092756802653e-03, -1.256238928287072e-03, -2.979434608312915e-01, -7.737266438476809e-04, 1.247924312715852e-01, 7.559556374668546e-01, -1.755689574870547e-03, -3.121194562947281e-01, -1.413229486647509e-03, 2.768921318639446e-03, -8.234841489689372e-04, -3.124798227042950e-01, -8.032039717115846e-04, 1.305191836357149e-01,  7.958979820995594e-01, -1.424584476022194e-03, -3.292320657412781e-01, -1.365420552520404e-03, 2.755231515469950e-03, -8.006651601781024e-04, -3.289875157050379e-01, -7.417436417457371e-04, 1.373379623191698e-01, 8.404804172123466e-01, -1.388459300869144e-03, -3.481557548555299e-01, -1.455139037280423e-03, 2.913533109871084e-03, -9.824343043458098e-04, -3.475243085999838e-01, -9.553732312693292e-04, 1.455781811574708e-01,  8.876206945747520e-01, -1.950867314352722e-03, -3.665035527522115e-01, -1.545715069023373e-03, 3.125834643465922e-03, -1.261255876114972e-03, -3.674719126623508e-01, -9.629489676661182e-04, 1.537552157348571e-01, 9.346976626291812e-01, -1.785494653465056e-03, -3.872088018324030e-01, -1.953845783302405e-03, 3.229170182432681e-03, -9.799488862223850e-04, -3.860879476078757e-01, -1.186268641209940e-03, 1.619077567513740e-01,  9.823499783955798e-01, -1.501326275195958e-03, -4.088126190276250e-01, -1.950817696497228e-03, 3.316662369597610e-03, -9.705062145531282e-04, -4.069321701529526e-01, -1.249249251881372e-03, 1.714039008805966e-01, 1.031986633427283e+00, -2.191927850268155e-03, -4.288920675095730e-01, -2.106434024688499e-03, 3.567085416942269e-03, -1.207982467537387e-03, -4.289379090769664e-01, -1.169914991815265e-03, 1.809763359129393e-01,  1.080428225930233e+00, -2.736788507015012e-03, -4.484713163619291e-01, -2.414852943561738e-03, 3.678329931521614e-03, -9.186647952557081e-04, -4.492292611219977e-01, -8.972194834774077e-04, 1.888773864921902e-01, 1.126835434485115e+00, -2.764224197221573e-03, -4.678315232424036e-01, -2.934439388218503e-03, 3.822110146111157e-03, -7.399147491077077e-04, -4.678804483088890e-01, -7.627042337198155e-04, 1.964668979213534e-01,  1.172880802798638e+00, -3.609700140969650e-03, -4.848436801482096e-01, -3.476935617542087e-03, 4.228714777501828e-03, -1.034891294275413e-03, -4.862414088910298e-01, -8.492613039963602e-04, 2.040643626589912e-01, 1.219442748974010e+00, -5.206460741524704e-03, -4.999922690734283e-01, -4.552800284926412e-03, 4.737468630902268e-03, -1.218150968580183e-03, -5.031883296529680e-01, -7.834371189415941e-04, 2.103487935409296e-01,  1.264965530289237e+00, -6.596745620621952e-03, -5.152739413077809e-01, -5.856443056886859e-03, 5.076030160040572e-03, -7.183509904885171e-04, -5.185036549285789e-01, -4.738382240854415e-04, 2.151463924733731e-01, 1.312190953795251e+00, -8.759279210821973e-03, -5.289584677554087e-01, -7.363763805279845e-03, 5.408569683825246e-03, -2.261918668960451e-04, -5.342469698303530e-01, 3.341452917064044e-04, 2.192823562095550e-01,  1.376468079649658e+00, -1.787869731861235e-02, -5.311535774182058e-01, -1.052424542306634e-02, 6.063410373246952e-03, 2.740895435129342e-04, -5.534296954312102e-01, 3.523235611427660e-03, 2.183025993652965e-01, 1.448583637970218e+00, -1.321435939246597e-02, -5.769518767847455e-01, -2.004571496035632e-02, 6.736248571430334e-03, 3.714697226723176e-03, -5.584709989124266e-01, 1.054388281490501e-03, 2.273205967852478e-01,  1.533467241278009e+00,
                  -1.577501719357366e-02, -6.091874215150131e-01, -1.595775684573626e-02, 7.703527059280490e-03, 9.683683958080242e-04, -6.098405092571636e-01, 1.375234662817868e-03, 2.481771470685415e-01, 1.644797299700800e+00, -1.854859031712502e-02, -6.564149658820666e-01, -2.083249669717655e-02, 9.254822864582183e-03, 1.255126063755993e-03, -6.495603419710737e-01, 1.904246577263957e-04, 2.689519545260303e-01 )
               , tolerance = 1e-03)
  expect_equal(c(pbc_fit$n_iter),
               c(32 )
               , tolerance = 1e-04)
  expect_equal(c(pbc_fit$Q),
               c( 1.788195885559583e-03, -2.819741173260375e-04, -9.175631099729068e-05, -2.819741173260375e-04, 1.218549735155075e-04, -1.909915168052052e-04, -9.175631099729068e-05, -1.909915168052052e-04, 6.029527036737297e-04 )
               , tolerance = 1e-04)

  # par(mfcol = c(2, 2))
  # plot(pbc_fit, type = "cov", cov_index = 1)
  # plot(pbc_fit, type = "cov", cov_index = 2)
  # plot(pbc_fit, type = "cov", cov_index = 3)

  # Second order random walk
  suppressMessages(pbc_fit <- ddhazard(
    formula = survival::Surv(tstart, tstop, status == 2) ~ log(bili) + log(protime),
    data = pbc2, model = "exponential", by = 100, max_T = 3600,
    Q_0 = diag(10, 6), Q = diag(c(rep(1e-3, 3), rep(0, 3))),
    id = pbc2$id, order = 2,
    control = list(LR = .35, eps = 1e-2, save_risk_set = F)))
  # get_expect_equal(pbc_fit, eps = 1e-4)

  expect_equal(c(pbc_fit$state_vecs),
               c( -6.76552414444747630, -6.06767078494769141, -5.37049468452187462, -4.96224510710030753, -5.23944406073685176, -6.00454500911177647,  -7.05436277747078133, -8.26147940577476803, -9.19848862911108967, -10.21091001499778095, -11.17114227671325111, -11.91314113289889853, -12.55554654856485186, -13.22243715020859334, -13.86181095733759605, -14.36276393125461581, -14.87267391432093255, -15.37423587475835340, -15.79422971253780972, -16.04520174350080453, -16.29234228767482051, -16.54427785623954605, -16.75071282207353462, -16.89614037601379337, -17.04854671423132473, -17.15739099938486589, -17.17422434755080474, -17.23396437885219257, -17.34874023260400122, -17.49634937794590073, -17.63285579174540274, -17.82143763462735109, -18.04931837718652332, -18.24864893667819388, -18.47339994994791113, -18.69208142260630723, -18.88171256443573753, 1.34832327839957067, 0.93253961647310257, 0.51688268594377207, 0.18237100557596608, 0.04179486133253989,   0.02340865410864350, 0.09096433054151305, 0.22334659970278106, 0.29835447346697164, 0.40669948805097078, 0.50642502751544016,   0.54548054213064245, 0.56008782168769378, 0.59123994338116748, 0.62589223748212819, 0.63202280291624580, 0.65192797605022956,   0.68226478650121658, 0.70077691864295322, 0.68117098654428132, 0.66948920422653435, 0.67050993869987041, 0.66772590879616278,   0.65564866091939455, 0.65200135832680906, 0.64233595173612801, 0.61148461539822241, 0.59598703118855534, 0.59898806025744977,   0.61256936395580830, 0.62351908566714498, 0.64947626083307519, 0.68699179001317412, 0.71708699962110878, 0.75406965612546029,   0.79014203232565572, 0.81850073593556316, -1.99275642930739494, -1.30261668263345487, -0.61250474795528276, -0.02423870143245993,   0.36095829408864072, 0.55087911432822811, 0.66666643795902092, 0.76245021032263849, 0.98483258443675037, 1.19141856756385001,   1.42458286665119949, 1.73421387783938341, 2.06239603891115308, 2.35395372224394261, 2.61572026496224286, 2.87523193081880590,   3.07327019470453955, 3.21797906805556000, 3.34188131097302321, 3.48418907724245708, 3.59360064650129463, 3.67309519440533094,   3.74951826058526239, 3.83544572268448603, 3.90802331213301368, 3.98313582581989234, 4.07915668314820845, 4.14866980197497170,   4.18927273490579299, 4.21607907751452782, 4.25005153239705891, 4.27350012304202576, 4.29410863820810462, 4.33795563197902112,   4.38138652300785392, 4.42882049099337038, 4.48625751180831589, -7.46360772515930027, -6.76552414444747630, -6.06767078494772516,  -5.37049468452196166, -4.96224510710016808, -5.23944406073684910, -6.00454500911175071, -7.05436277747078488, -8.26147940577477335,  -9.19848862911108789, -10.21091001499778272, -11.17114227671328486, -11.91314113289891630, -12.55554654856486252, -13.22243715020859511, -13.86181095733761559, -14.36276393125460160, -14.87267391432085439, -15.37423587475837827, -15.79422971253797670, -16.04520174350088979, -16.29234228767488091, -16.54427785623959934, -16.75071282207359857, -16.89614037601379692, -17.04854671423126788, -17.15739099938470602, -17.17422434755071237, -17.23396437885247678, -17.34874023260408649, -17.49634937794586875, -17.63285579174544893, -17.82143763462735819, -18.04931837718653753, -18.24864893667821875, -18.47339994994790757, -18.69208142260631789, 1.76415123947139696, 1.34832327839957067,   0.93253961647310057, 0.51688268594376185, 0.18237100557596816, 0.04179486133253989, 0.02340865410864329, 0.09096433054151305,   0.22334659970278123, 0.29835447346697153, 0.40669948805097045, 0.50642502751544016, 0.54548054213064245, 0.56008782168769367,   0.59123994338116759, 0.62589223748212885, 0.63202280291624613, 0.65192797605023123, 0.68226478650121680, 0.70077691864295222,   0.68117098654428165, 0.66948920422653302, 0.67050993869987052, 0.66772590879616245, 0.65564866091939422, 0.65200135832680950,   0.64233595173612812, 0.61148461539822341, 0.59598703118855423, 0.59898806025744888, 0.61256936395580719, 0.62351908566714498,   0.64947626083307552, 0.68699179001317545, 0.71708699962110867, 0.75406965612546073, 0.79014203232565572, -2.68290871379701290,  -1.99275642930739494, -1.30261668263339336, -0.61250474795522059, -0.02423870143251514, 0.36095829408863628, 0.55087911432822734,   0.66666643795901137, 0.76245021032262406, 0.98483258443674193, 1.19141856756385356, 1.42458286665120637, 1.73421387783939673,   2.06239603891116019, 2.35395372224394439, 2.61572026496222998, 2.87523193081878992, 3.07327019470448715, 3.21797906805554534,   3.34188131097305519, 3.48418907724247706, 3.59360064650133149, 3.67309519440530607, 3.74951826058527038, 3.83544572268449047,   3.90802331213300302, 3.98313582581981995, 4.07915668314813296, 4.14866980197505786, 4.18927273490595198, 4.21607907751458111,   4.25005153239706868, 4.27350012304201421, 4.29410863820810462, 4.33795563197904066, 4.38138652300785747, 4.42882049099337038 )
               , tolerance = 1e-04)

  expect_equal(c(pbc_fit$state_vars),
               c( 1.668730738719484e+00, -1.775637102338487e-02, -6.428298926646075e-01, 2.081459537339814e+00, -3.074337338176357e-02, -7.842518148091027e-01, -1.775637102338657e-02, 4.014313158764082e-02, -3.783403323630435e-02, -4.512026525076675e-02, 5.855592634666528e-02, -5.236166333211992e-02, -6.428298926646070e-01, -3.783403323630508e-02, 3.347567359926060e-01, -7.546924791307751e-01, -5.789374494642793e-02, 4.263844431513667e-01,  2.081459537339820e+00, -4.512026525076436e-02, -7.546924791307766e-01, 2.805499652694603e+00, -9.509515310851752e-02, -9.366996427284972e-01, -3.074337338176599e-02, 5.855592634666532e-02, -5.789374494642687e-02, -9.509515310852093e-02, 9.408191108134822e-02, -8.794249268486273e-02, -7.842518148091026e-01, -5.236166333212089e-02, 4.263844431513667e-01, -9.366996427284957e-01, -8.794249268486416e-02, 5.759473767421266e-01,  1.017240635172893e+00, 5.266623697450568e-03, -4.217399241979471e-01, 1.233522020504923e+00, 1.018868350484059e-02, -5.229220474620360e-01,  5.266623697450012e-03, 1.417752697908257e-02, -1.397364752241559e-02, -1.540932871839762e-03, 2.158585257466863e-02, -1.882298170031130e-02, -4.217399241979471e-01, -1.397364752241584e-02, 1.921869192903713e-01, -4.999301251578063e-01, -2.319401316508745e-02, 2.423250391047229e-01,  1.233522020504929e+00, -1.540932871838790e-03, -4.999301251578072e-01, 1.668730738719491e+00, -1.775637102338487e-02, -6.428298926646069e-01,  1.018868350483959e-02, 2.158585257466865e-02, -2.319401316508697e-02, -1.775637102338658e-02, 4.014313158762750e-02, -3.783403323630435e-02, -5.229220474620364e-01, -1.882298170031169e-02, 2.423250391047229e-01, -6.428298926646063e-01, -3.783403323630508e-02, 3.347567359926282e-01,  6.422088671621644e-01, 6.706598785115384e-03, -2.684350214261979e-01, 7.568146834386984e-01, 1.239905196496898e-02, -3.259720842823031e-01,  6.706598785115411e-03, 4.444813341483477e-03, -5.772768934852936e-03, 6.517798652204532e-03, 6.651695381437032e-03, -7.117347135987113e-03, -2.684350214261984e-01, -5.772768934852915e-03, 1.161224359312021e-01, -3.172256572256362e-01, -8.975150394977753e-03, 1.404837737420335e-01,  7.568146834387011e-01, 6.517798652204462e-03, -3.172256572256353e-01, 1.017240635174457e+00, 5.266623697497655e-03, -4.217399241994555e-01,  1.239905196496866e-02, 6.651695381437032e-03, -8.975150394977628e-03, 5.266623697497079e-03, 1.417752697908357e-02, -1.397364752244923e-02, -3.259720842823037e-01, -7.117347135987082e-03, 1.404837737420332e-01, -4.217399241994548e-01, -1.397364752244946e-02, 1.921869192913758e-01,  4.381328935950756e-01, 5.695285122239737e-03, -1.847087222252614e-01, 4.845015528964866e-01, 8.390616454616247e-03, -2.063331296815185e-01,  5.695285122239813e-03, 1.223318296833331e-03, -2.761000446210310e-03, 6.113534880302560e-03, 1.619211343151949e-03, -3.306972565247006e-03, -1.847087222252614e-01, -2.761000446210295e-03, 7.837780302520758e-02, -2.046568301873059e-01, -3.853608202154312e-03, 8.740799513963274e-02,  4.845015528964867e-01, 6.113534880302487e-03, -2.046568301873060e-01, 6.422088671624057e-01, 6.706598785132700e-03, -2.684350214263429e-01,  8.390616454616320e-03, 1.619211343151941e-03, -3.853608202154322e-03, 6.706598785132734e-03, 4.444813341483956e-03, -5.772768934860898e-03, -2.063331296815186e-01, -3.306972565246975e-03, 8.740799513963277e-02, -2.684350214263430e-01, -5.772768934860881e-03, 1.161224359312815e-01,  3.726839792208012e-01, 4.305623180521389e-03, -1.577418105413936e-01, 3.619995865168053e-01, 5.176049612656023e-03, -1.531633882509278e-01,  4.305623180521442e-03, 7.873952385988316e-04, -2.025210058270271e-03, 4.629018036375917e-03, 5.694387412743822e-04, -2.041925093809247e-03, -1.577418105413936e-01, -2.025210058270249e-03, 6.708294355547151e-02, -1.536112575692317e-01, -2.260764839096642e-03, 6.501809070687359e-02,  3.619995865168052e-01, 4.629018036375857e-03, -1.536112575692317e-01, 4.381328935952488e-01, 5.695285122242498e-03, -1.847087222253333e-01,  5.176049612656062e-03, 5.694387412743828e-04, -2.260764839096655e-03, 5.695285122242574e-03, 1.223318296833377e-03, -2.761000446211478e-03, -1.531633882509279e-01, -2.041925093809223e-03, 6.501809070687357e-02, -1.847087222253333e-01, -2.761000446211463e-03, 7.837780302523743e-02,  4.020738456800419e-01, 4.274921653318178e-03, -1.706095001555209e-01, 3.508021815043045e-01, 4.300793960434876e-03, -1.488528325432004e-01,  4.274921653318131e-03, 9.505318372121294e-04, -2.101663442501913e-03, 4.182661911776532e-03, 5.272412651602575e-04, -1.839159707355567e-03, -1.706095001555208e-01, -2.101663442501916e-03, 7.285014888985990e-02, -1.493642571570348e-01, -1.903517185975381e-03, 6.340176970584899e-02,  3.508021815043043e-01, 4.182661911776537e-03, -1.493642571570349e-01, 3.726839792208101e-01, 4.305623180521576e-03, -1.577418105413919e-01,  4.300793960434903e-03, 5.272412651602630e-04, -1.903517185975402e-03, 4.305623180521629e-03, 7.873952385988362e-04, -2.025210058270284e-03, -1.488528325432004e-01, -1.839159707355569e-03, 6.340176970584901e-02, -1.577418105413920e-01, -2.025210058270262e-03, 6.708294355546848e-02,  4.829800277979953e-01, 5.022656869428811e-03, -2.044346330407350e-01, 4.096866043137881e-01, 4.779394451865413e-03, -1.744009474198039e-01,  5.022656869428693e-03, 1.384334699492664e-03, -2.590311144287604e-03, 4.800045446620658e-03, 7.700488730893826e-04, -2.157087577861147e-03, -2.044346330407349e-01, -2.590311144287654e-03, 8.728441314770846e-02, -1.741948011620270e-01, -2.153244423975645e-03, 7.420365538564802e-02,  4.096866043137879e-01, 4.800045446620807e-03, -1.741948011620270e-01, 4.020738456801363e-01, 4.274921653318386e-03, -1.706095001555429e-01,  4.779394451865344e-03, 7.700488730893863e-04, -2.153244423975622e-03, 4.274921653318338e-03, 9.505318372121205e-04, -2.101663442501790e-03, -1.744009474198038e-01, -2.157087577861212e-03, 7.420365538564805e-02, -1.706095001555429e-01, -2.101663442501793e-03, 7.285014888986154e-02,  5.819089305991614e-01, 6.125200858813181e-03, -2.450171899798278e-01, 5.008785045091222e-01, 5.781602563305462e-03, -2.128519831063953e-01,  6.125200858813171e-03, 2.236100447350379e-03, -3.589949742743390e-03, 6.319168447652360e-03, 1.277379689093018e-03, -2.914804211307375e-03, -2.450171899798280e-01, -3.589949742743392e-03, 1.049286779174563e-01, -2.126950995379354e-01, -2.721969701362854e-03, 9.054564836107618e-02,  5.008785045091224e-01, 6.319168447652367e-03, -2.126950995379352e-01, 4.829800277979669e-01, 5.022656869428785e-03, -2.044346330407524e-01,  5.781602563305436e-03, 1.277379689093020e-03, -2.721969701362826e-03, 5.022656869428667e-03, 1.384334699492672e-03, -2.590311144287926e-03, -2.128519831063955e-01, -2.914804211307378e-03, 9.054564836107609e-02, -2.044346330407523e-01, -2.590311144287976e-03, 8.728441314772833e-02,  6.827651850226224e-01, 6.620476647065856e-03, -2.835563399394413e-01, 5.995527112918098e-01, 7.151527806147591e-03, -2.539229870050606e-01,  6.620476647065734e-03, 3.448895007392910e-03, -4.906987703447685e-03, 7.716845999916587e-03, 2.121650914445205e-03, -3.880242755139733e-03, -2.835563399394413e-01, -4.906987703447741e-03, 1.216439163950471e-01, -2.525861027120800e-01, -3.748402546256767e-03, 1.076924807820012e-01,  5.995527112918100e-01,
                  7.716845999916715e-03, -2.525861027120800e-01, 5.819089305991596e-01, 6.125200858814250e-03, -2.450171899798753e-01,  7.151527806147598e-03, 2.121650914445207e-03, -3.748402546256753e-03, 6.125200858814239e-03, 2.236100447350400e-03, -3.589949742744260e-03, -2.539229870050606e-01, -3.880242755139785e-03, 1.076924807820012e-01, -2.450171899798754e-01, -3.589949742744263e-03, 1.049286779174968e-01,  7.718767474024368e-01, 8.385174046217032e-03, -3.198949131404992e-01, 6.932860664391696e-01, 8.572142227627585e-03, -2.913989865973221e-01,  8.385174046216838e-03, 4.206807277467726e-03, -5.844273498847431e-03, 9.047557044030662e-03, 3.025855074529806e-03, -4.964494725337129e-03, -3.198949131404990e-01, -5.844273498847532e-03, 1.362624401305669e-01, -2.899893132117970e-01, -4.827136258089223e-03, 1.232186957191284e-01,  6.932860664391696e-01, 9.047557044030870e-03, -2.899893132117971e-01, 6.827651850224650e-01, 6.620476647064104e-03, -2.835563399393819e-01,  8.572142227627543e-03, 3.025855074529799e-03, -4.827136258089159e-03, 6.620476647063982e-03, 3.448895007392910e-03, -4.906987703446528e-03, -2.913989865973219e-01, -4.964494725337222e-03, 1.232186957191284e-01, -2.835563399393818e-01, -4.906987703446584e-03, 1.216439163950244e-01,  8.606421335198569e-01, 8.623018421145011e-03, -3.536013287782032e-01, 7.802345093318523e-01, 9.885864602225677e-03, -3.260082273569856e-01,  8.623018421144768e-03, 5.306769010353658e-03, -7.124171088866876e-03, 1.037403213562396e-02, 3.843116121596801e-03, -5.931546004776182e-03, -3.536013287782032e-01, -7.124171088866970e-03, 1.509364981397385e-01, -3.250731505191122e-01, -5.922986106766328e-03, 1.375995912967628e-01,  7.802345093318521e-01, 1.037403213562424e-02, -3.250731505191121e-01, 7.718767474024093e-01, 8.385174046215735e-03, -3.198949131404659e-01,  9.885864602225458e-03, 3.843116121596808e-03, -5.922986106766271e-03, 8.385174046215541e-03, 4.206807277467724e-03, -5.844273498846577e-03, -3.260082273569853e-01, -5.931546004776295e-03, 1.375995912967627e-01, -3.198949131404656e-01, -5.844273498846678e-03, 1.362624401305435e-01,  9.432003016473447e-01, 8.845808002396892e-03, -3.863555317254186e-01, 8.642933554458112e-01, 1.027416604326523e-02, -3.583811977467432e-01,  8.845808002396784e-03, 6.227145255590268e-03, -8.426319504378922e-03, 1.089837126184292e-02, 4.773846099829855e-03, -7.126000686005732e-03, -3.863555317254188e-01, -8.426319504378936e-03, 1.658714976644649e-01, -3.589312630574092e-01, -7.126095918593025e-03, 1.521211768116905e-01,  8.642933554458117e-01, 1.089837126184303e-02, -3.589312630574089e-01, 8.606421335197078e-01, 8.623018421143408e-03, -3.536013287781620e-01,  1.027416604326507e-02, 4.773846099829861e-03, -7.126095918592970e-03, 8.623018421143165e-03, 5.306769010353696e-03, -7.124171088866692e-03, -3.583811977467434e-01, -7.126000686005765e-03, 1.521211768116904e-01, -3.536013287781620e-01, -7.124171088866786e-03, 1.509364981397303e-01,  1.009509170828474e+00, 1.133273271519495e-02, -4.187420383929888e-01, 9.379691812487003e-01, 1.158838923571946e-02, -3.895282397967664e-01,  1.133273271519510e-02, 6.202822592536060e-03, -9.249686221670751e-03, 1.231210892243265e-02, 5.204093215023515e-03, -8.274485255886376e-03, -4.187420383929893e-01, -9.249686221670689e-03, 1.804548811386402e-01, -3.923463352947755e-01, -8.062296526852551e-03, 1.667154641926515e-01,  9.379691812487005e-01, 1.231210892243253e-02, -3.923463352947751e-01, 9.432003016472679e-01, 8.845808002395601e-03, -3.863555317253703e-01,  1.158838923571942e-02, 5.204093215023515e-03, -8.062296526852541e-03, 8.845808002395494e-03, 6.227145255590281e-03, -8.426319504378058e-03, -3.895282397967665e-01, -8.274485255886317e-03, 1.667154641926514e-01, -3.863555317253705e-01, -8.426319504378072e-03, 1.658714976644378e-01,  1.071938619750370e+00, 1.352225432109946e-02, -4.482265741004809e-01, 1.001708612421134e+00, 1.448881501927925e-02, -4.210791801077922e-01,  1.352225432109991e-02, 5.659713177793960e-03, -9.325565787026376e-03, 1.397298586276656e-02, 4.919520145835948e-03, -8.604035972052795e-03, -4.482265741004816e-01, -9.325565787026174e-03, 1.925263023824881e-01, -4.216561502229242e-01, -8.711521964094807e-03, 1.799717572823741e-01,  1.001708612421135e+00, 1.397298586276615e-02, -4.216561502229237e-01, 1.009509170828230e+00, 1.133273271519075e-02, -4.187420383928702e-01,  1.448881501927938e-02, 4.919520145835948e-03, -8.711521964094880e-03, 1.133273271519089e-02, 6.202822592536026e-03, -9.249686221668578e-03, -4.210791801077928e-01, -8.604035972052624e-03, 1.799717572823741e-01, -4.187420383928706e-01, -9.249686221668515e-03, 1.804548811385834e-01,  1.139722832366066e+00, 1.303583220946447e-02, -4.743060949302649e-01, 1.065938303613338e+00, 1.563048903233002e-02, -4.494987732585717e-01,  1.303583220946521e-02, 5.625530162860919e-03, -9.278676155997805e-03, 1.439405164422586e-02, 4.645657468490577e-03, -8.435730591190901e-03, -4.743060949302653e-01, -9.278676155997499e-03, 2.028160624217806e-01, -4.474967603784692e-01, -9.013319243866249e-03, 1.910104586997569e-01,  1.065938303613339e+00, 1.439405164422507e-02, -4.474967603784686e-01, 1.071938619750384e+00, 1.352225432110200e-02, -4.482265741004677e-01,  1.563048903233052e-02, 4.645657468490574e-03, -9.013319243866461e-03, 1.352225432110245e-02, 5.659713177794005e-03, -9.325565787027215e-03, -4.494987732585726e-01, -8.435730591190575e-03, 1.910104586997567e-01, -4.482265741004683e-01, -9.325565787027014e-03, 1.925263023824745e-01,  1.212988438472984e+00, 1.118414059881934e-02, -5.019529896103953e-01, 1.134953107526347e+00, 1.471363552095082e-02, -4.757541331332947e-01,  1.118414059882013e-02, 5.863651821090984e-03, -8.938856459024997e-03, 1.311017661670459e-02, 4.732016372451913e-03, -8.145809040365180e-03, -5.019529896103956e-01, -8.938856459024674e-03, 2.139004411860209e-01, -4.739181407516575e-01, -8.908366296039836e-03, 2.014325581096787e-01,  1.134953107526347e+00, 1.311017661670365e-02, -4.739181407516574e-01, 1.139722832366393e+00, 1.303583220946482e-02, -4.743060949302854e-01,  1.471363552095144e-02, 4.732016372451906e-03, -8.908366296040068e-03, 1.303583220946557e-02, 5.625530162860773e-03, -9.278676155995766e-03, -4.757541331332953e-01, -8.145809040364795e-03, 2.014325581096787e-01, -4.743060949302859e-01, -9.278676155995457e-03, 2.028160624217391e-01,  1.288725402001657e+00, 1.035899663973364e-02, -5.355314675532397e-01, 1.208368581433156e+00, 1.325301057942116e-02, -5.044357131891579e-01,  1.035899663973387e-02, 5.883316541120238e-03, -8.322634298271406e-03, 1.190968142217082e-02, 4.851675720961493e-03, -7.798622131936000e-03, -5.355314675532392e-01, -8.322634298271289e-03, 2.280811477206786e-01, -5.055683300760260e-01, -8.277255749666699e-03, 2.138479654407379e-01,  1.208368581433155e+00, 1.190968142217039e-02, -5.055683300760265e-01, 1.212988438472903e+00, 1.118414059881797e-02, -5.019529896103294e-01,  1.325301057942161e-02, 4.851675720961502e-03, -8.277255749666932e-03, 1.118414059881876e-02, 5.863651821090994e-03, -8.938856459023575e-03, -5.044357131891579e-01, -7.798622131935821e-03, 2.138479654407381e-01, -5.019529896103297e-01, -8.938856459023254e-03, 2.139004411859797e-01,  1.378011954291667e+00, 8.000296848975446e-03,
                  -5.706804999743946e-01, 1.289800691627710e+00, 1.193889503744381e-02, -5.396544459881107e-01,  8.000296848974978e-03, 6.296641698201594e-03, -7.705143936926520e-03, 1.013683650332787e-02, 5.047593515516858e-03, -7.026184583764000e-03, -5.706804999743940e-01, -7.705143936926661e-03, 2.424919377690933e-01, -5.385008600811472e-01, -7.788537058614518e-03, 2.280327557739522e-01,  1.289800691627709e+00, 1.013683650332816e-02, -5.385008600811481e-01, 1.288725402001385e+00, 1.035899663972855e-02, -5.355314675530900e-01,  1.193889503744376e-02, 5.047593515516874e-03, -7.788537058614530e-03, 1.035899663972878e-02, 5.883316541120024e-03, -8.322634298268149e-03, -5.396544459881105e-01, -7.026184583764104e-03, 2.280327557739524e-01, -5.355314675530897e-01, -8.322634298268031e-03, 2.280811477206000e-01,  1.480584883407852e+00, 4.449793863482661e-03, -6.065370019795737e-01, 1.384002946600070e+00, 9.420792879815416e-03, -5.766039093794850e-01,  4.449793863482220e-03, 6.997428157479722e-03, -7.101492241289416e-03, 7.113503325011768e-03, 5.554079183304750e-03, -6.209517090484487e-03, -6.065370019795735e-01, -7.101492241289665e-03, 2.560505302163856e-01, -5.721502431387331e-01, -7.292656429389099e-03, 2.418429265865538e-01,  1.384002946600071e+00, 7.113503325012371e-03, -5.721502431387337e-01, 1.378011954291745e+00, 8.000296848974877e-03, -5.706804999743809e-01,  9.420792879814885e-03, 5.554079183304731e-03, -7.292656429388847e-03, 8.000296848974409e-03, 6.296641698201646e-03, -7.705143936926067e-03, -5.766039093794848e-01, -6.209517090484755e-03, 2.418429265865540e-01, -5.706804999743802e-01, -7.705143936926208e-03, 2.424919377690681e-01,  1.594969952749808e+00, 1.185436545948593e-03, -6.451922784605943e-01, 1.490704112521724e+00, 6.263115465704072e-03, -6.145823180384473e-01,  1.185436545948656e-03, 7.598877683864308e-03, -6.506507798364210e-03, 3.731635237153183e-03, 6.170825306563568e-03, -5.531648744713023e-03, -6.451922784605948e-01, -6.506507798364205e-03, 2.696153505361321e-01, -6.079692071099565e-01, -6.717850412398934e-03, 2.551852456384114e-01,  1.490704112521725e+00, 3.731635237153333e-03, -6.079692071099565e-01, 1.480584883408505e+00, 4.449793863486137e-03, -6.065370019797760e-01,  6.263115465703737e-03, 6.170825306563574e-03, -6.717850412398809e-03, 4.449793863485697e-03, 6.997428157479639e-03, -7.101492241290562e-03, -6.145823180384478e-01, -5.531648744713090e-03, 2.551852456384114e-01, -6.065370019797759e-01, -7.101492241290809e-03, 2.560505302164409e-01,  1.707601764427662e+00, 2.200100977014497e-03, -6.909493842011949e-01, 1.602959602373678e+00, 4.290996022854925e-03, -6.539212730972379e-01,  2.200100977015226e-03, 7.547969051049840e-03, -6.488762741926654e-03, 3.513842822096344e-03, 6.430924401231309e-03, -5.718848400076853e-03, -6.909493842011958e-01, -6.488762741926371e-03, 2.872257915644240e-01, -6.520474247421207e-01, -5.910376530409299e-03, 2.705460144379800e-01,  1.602959602373679e+00, 3.513842822095685e-03, -6.520474247421201e-01, 1.594969952750400e+00, 1.185436545950071e-03, -6.451922784607861e-01,  4.290996022855310e-03, 6.430924401231313e-03, -5.910376530409392e-03, 1.185436545950134e-03, 7.598877683864523e-03, -6.506507798364452e-03, -6.539212730972388e-01, -5.718848400076591e-03, 2.705460144379799e-01, -6.451922784607865e-01, -6.506507798364447e-03, 2.696153505361893e-01,  1.831044666857025e+00, 4.794077066611732e-03, -7.443856242205091e-01, 1.720115323987497e+00, 5.309513807536954e-03, -7.011203584854986e-01,  4.794077066612429e-03, 7.624299177014024e-03, -7.531658228306055e-03, 6.182006137658745e-03, 6.426483130331415e-03, -6.542816443750647e-03, -7.443856242205094e-01, -7.531658228305720e-03, 3.103297884803724e-01, -7.032639416747164e-01, -6.126594887621920e-03, 2.907495090730896e-01,  1.720115323987498e+00, 6.182006137657901e-03, -7.032639416747162e-01, 1.707601764427888e+00, 2.200100977020429e-03, -6.909493842013105e-01,  5.309513807537707e-03, 6.426483130331434e-03, -6.126594887622219e-03, 2.200100977021158e-03, 7.547969051049828e-03, -6.488762741929745e-03, -7.011203584854993e-01, -6.542816443750310e-03, 2.907495090730896e-01, -6.909493842013111e-01, -6.488762741929462e-03, 2.872257915644814e-01,  1.967417128815092e+00, 7.261512837885562e-03, -8.037169479736992e-01, 1.849609969150886e+00, 7.617151597061439e-03, -7.566339010644677e-01,  7.261512837885861e-03, 7.988224551723013e-03, -9.107306625853665e-03, 9.113311380900815e-03, 6.618763322591665e-03, -7.898858305346774e-03, -8.037169479736987e-01, -9.107306625853418e-03, 3.371528348653696e-01, -7.604263311881879e-01, -7.364485350220266e-03, 3.156232676046715e-01,  1.849609969150886e+00, 9.113311380900373e-03, -7.604263311881883e-01, 1.831044666857290e+00, 4.794077066611467e-03, -7.443856242204987e-01,  7.617151597061835e-03, 6.618763322591710e-03, -7.364485350220585e-03, 4.794077066612164e-03, 7.624299177014083e-03, -7.531658228305533e-03, -7.566339010644676e-01, -7.898858305346562e-03, 3.156232676046717e-01, -7.443856242204989e-01, -7.531658228305199e-03, 3.103297884803192e-01,  2.108344477380820e+00, 8.947674602281953e-03, -8.644538803467219e-01, 1.988407784476444e+00, 1.012173697689268e-02, -8.174122089094022e-01,  8.947674602282258e-03, 8.350988788336497e-03, -1.021813873557684e-02, 1.093170692324890e-02, 6.960491179768961e-03, -9.096570178286117e-03, -8.644538803467217e-01, -1.021813873557665e-02, 3.638481301953979e-01, -8.200858294007496e-01, -8.851625560053325e-03, 3.423969423194507e-01,  1.988407784476445e+00, 1.093170692324859e-02, -8.200858294007500e-01, 1.967417128815610e+00, 7.261512837890192e-03, -8.037169479738436e-01,  1.012173697689295e-02, 6.960491179768985e-03, -8.851625560053516e-03, 7.261512837890491e-03, 7.988224551723131e-03, -9.107306625855729e-03, -8.174122089094018e-01, -9.096570178285976e-03, 3.423969423194509e-01, -8.037169479738432e-01, -9.107306625855483e-03, 3.371528348654013e-01,  2.234225222915134e+00, 1.019624421986783e-02, -9.201529265915058e-01, 2.122385235280832e+00, 1.210248888683644e-02, -8.759168322319859e-01,  1.019624421986847e-02, 8.470047784728631e-03, -1.048318561524379e-02, 1.200314106491587e-02, 7.183119457467716e-03, -9.732042690662138e-03, -9.201529265915065e-01, -1.048318561524346e-02, 3.879685647089315e-01, -8.786132836981226e-01, -9.588930387988737e-03, 3.678614847483592e-01,  2.122385235280832e+00, 1.200314106491521e-02, -8.786132836981220e-01, 2.108344477380544e+00, 8.947674602282824e-03, -8.644538803466175e-01,  1.210248888683679e-02, 7.183119457467745e-03, -9.588930387988959e-03, 8.947674602283129e-03, 8.350988788336774e-03, -1.021813873557870e-02, -8.759168322319864e-01, -9.732042690661833e-03, 3.678614847483591e-01, -8.644538803466173e-01, -1.021813873557850e-02, 3.638481301953608e-01,  2.333667206282570e+00, 9.283799924660135e-03, -9.628435480657389e-01, 2.235530314773650e+00, 1.272863704467412e-02, -9.256650849644337e-01,  9.283799924660829e-03, 8.819764740756325e-03, -1.019507526340063e-02, 1.180050579554744e-02, 7.403158280972648e-03, -9.562651164214311e-03, -9.628435480657389e-01, -1.019507526340039e-02, 4.068883757811318e-01, -9.278794898143605e-01, -9.708286068891410e-03, 3.894470697682563e-01,  2.235530314773649e+00, 1.180050579554665e-02, -9.278794898143603e-01,
                  2.234225222914372e+00, 1.019624421986043e-02, -9.201529265912798e-01,  1.272863704467485e-02, 7.403158280972655e-03, -9.708286068891663e-03, 1.019624421986107e-02, 8.470047784728450e-03, -1.048318561524154e-02, -9.256650849644339e-01, -9.562651164214005e-03, 3.894470697682564e-01, -9.201529265912805e-01, -1.048318561524122e-02, 3.879685647088749e-01,  2.395449319494060e+00, 6.516547818282079e-03, -9.870208004183199e-01, 2.316388667830267e+00, 1.133627434122684e-02, -9.606110802680354e-01,  6.516547818282287e-03, 9.207008181288955e-03, -9.160361102370142e-03, 9.430777522052056e-03, 7.778465890115478e-03, -8.644693676538532e-03, -9.870208004183194e-01, -9.160361102370011e-03, 4.166988970899981e-01, -9.600027267993285e-01, -9.288259281570257e-03, 4.038427523762457e-01,  2.316388667830266e+00, 9.430777522051820e-03, -9.600027267993290e-01, 2.333667206281028e+00, 9.283799924656437e-03, -9.628435480650710e-01,  1.133627434122732e-02, 7.778465890115511e-03, -9.288259281570399e-03, 9.283799924657131e-03, 8.819764740756363e-03, -1.019507526339876e-02, -9.606110802680350e-01, -8.644693676538442e-03, 4.038427523762458e-01, -9.628435480650708e-01, -1.019507526339852e-02, 4.068883757808429e-01,  2.402978107126996e+00, 4.488618095626035e-03, -9.902582619843119e-01, 2.350550813702844e+00, 8.825792415295589e-03, -9.744042640536614e-01,  4.488618095626395e-03, 9.228623092744491e-03, -7.723085570635651e-03, 7.025754528128696e-03, 7.980112531431049e-03, -7.409920904482399e-03, -9.902582619843119e-01, -7.723085570635439e-03, 4.166033449716926e-01, -9.730793597820284e-01, -8.022266710935286e-03, 4.085737865337487e-01,  2.350550813702843e+00, 7.025754528128422e-03, -9.730793597820284e-01, 2.395449319492324e+00, 6.516547818268811e-03, -9.870208004172780e-01,  8.825792415295748e-03, 7.980112531431110e-03, -8.022266710935450e-03, 6.516547818269016e-03, 9.207008181288768e-03, -9.160361102361000e-03, -9.744042640536614e-01, -7.409920904482233e-03, 4.085737865337487e-01, -9.870208004172776e-01, -9.160361102360869e-03, 4.166988970894283e-01,  2.361826920230202e+00, 2.095048934128381e-03, -9.714124053655939e-01, 2.331874705187062e+00, 6.138493115681758e-03, -9.656429336430126e-01,  2.095048934128846e-03, 9.608677597457822e-03, -6.957219966725291e-03, 5.198323126598840e-03, 8.166500175215025e-03, -6.400597704751574e-03, -9.714124053655939e-01, -6.957219966725199e-03, 4.082472342929528e-01, -9.644827010470256e-01, -6.823213969232118e-03, 4.040204859007930e-01,  2.331874705187062e+00, 5.198323126598337e-03, -9.644827010470256e-01, 2.402978107129261e+00, 4.488618095640360e-03, -9.902582619851263e-01,  6.138493115682514e-03, 8.166500175215041e-03, -6.823213969232245e-03, 4.488618095640721e-03, 9.228623092744500e-03, -7.723085570639224e-03, -9.656429336430130e-01, -6.400597704751390e-03, 4.040204859007930e-01, -9.902582619851263e-01, -7.723085570639013e-03, 4.166033449719764e-01,  2.290444805192564e+00, -7.586343954395745e-04, -9.374290025605787e-01, 2.271474362093575e+00, 3.381392575073808e-03, -9.383608926327098e-01, -7.586343954389570e-04, 1.040702435737297e-02, -6.674665030043020e-03, 2.797328042452852e-03, 8.712893788339761e-03, -5.827314481468339e-03, -9.374290025605796e-01, -6.674665030042732e-03, 3.936215318415481e-01, -9.358357205877592e-01, -6.276089019182394e-03, 3.918524507078371e-01,  2.271474362093576e+00, 2.797328042452057e-03, -9.358357205877583e-01, 2.361826920231403e+00, 2.095048934143740e-03, -9.714124053670110e-01,  3.381392575074235e-03, 8.712893788339794e-03, -6.276089019182324e-03, 2.095048934144205e-03, 9.608677597457871e-03, -6.957219966732677e-03, -9.383608926327107e-01, -5.827314481468015e-03, 3.918524507078367e-01, -9.714124053670110e-01, -6.957219966732585e-03, 4.082472342939205e-01,  2.225162896247582e+00, -3.827203458873054e-03, -9.026607534311903e-01, 2.196132065544351e+00, 8.023531213444193e-04, -9.031074745933636e-01, -3.827203458872193e-03, 1.140751551244078e-02, -6.443828511803189e-03, -3.936989928579014e-04, 9.563823024780881e-03, -5.382638757911376e-03, -9.026607534311903e-01, -6.443828511802883e-03, 3.774063265407319e-01, -8.972647595986873e-01, -6.111661906173547e-03, 3.753459924304652e-01,  2.196132065544349e+00, -3.936989928586161e-04, -8.972647595986873e-01, 2.290444805192291e+00, -7.586343954251902e-04, -9.374290025609544e-01,  8.023531213447177e-04, 9.563823024780940e-03, -6.111661906173786e-03, -7.586343954245726e-04, 1.040702435737299e-02, -6.674665030049858e-03, -9.031074745933636e-01, -5.382638757911071e-03, 3.753459924304652e-01, -9.374290025609553e-01, -6.674665030049569e-03, 3.936215318419065e-01,  2.224239899927149e+00, -6.276661031267967e-03, -8.906611131116158e-01, 2.152022495484118e+00, -1.094482510482969e-03, -8.781362462174478e-01, -6.276661031267287e-03, 1.221166148273076e-02, -5.912458813209936e-03, -3.708070583490663e-03, 1.041007379897268e-02, -4.792706734074521e-03, -8.906611131116149e-01, -5.912458813209710e-03, 3.681868611527617e-01, -8.678028739224590e-01, -5.893945876908453e-03, 3.611288411281421e-01,  2.152022495484117e+00, -3.708070583491065e-03, -8.678028739224599e-01, 2.225162896251006e+00, -3.827203458867758e-03, -9.026607534322104e-01, -1.094482510481720e-03, 1.041007379897273e-02, -5.893945876908627e-03, -3.827203458866897e-03, 1.140751551244058e-02, -6.443828511807519e-03, -8.781362462174478e-01, -4.792706734074344e-03, 3.611288411281421e-01, -9.026607534322104e-01, -6.443828511807213e-03, 3.774063265409939e-01,  2.387399548463659e+00, -1.042720966949511e-02, -9.343530802197000e-01, 2.217222234822950e+00, -2.819847522898239e-03, -8.925471938953993e-01, -1.042720966949457e-02, 1.328451774079822e-02, -5.101669715274249e-03, -7.906735168258211e-03, 1.123384459168919e-02, -3.626926868062340e-03, -9.343530802197000e-01, -5.101669715274013e-03, 3.783769866501974e-01, -8.744305604306768e-01, -5.691832350146933e-03, 3.596043020572117e-01,  2.217222234822954e+00, -7.906735168258780e-03, -8.744305604306768e-01, 2.224239899926954e+00, -6.276661031256736e-03, -8.906611131118884e-01, -2.819847522896990e-03, 1.123384459168920e-02, -5.691832350147100e-03, -6.276661031256056e-03, 1.221166148273084e-02, -5.912458813214599e-03, -8.925471938953988e-01, -3.626926868062100e-03, 3.596043020572117e-01, -8.906611131118880e-01, -5.912458813214373e-03, 3.681868611530170e-01,  2.817709945678190e+00, -1.450388353542326e-02, -1.080117499288814e+00, 2.494700710297991e+00, -6.593643325239255e-03, -9.812817176013215e-01, -1.450388353542288e-02, 1.527031465832298e-02, -5.173815928721064e-03, -1.175093133581481e-02, 1.253147041922823e-02, -3.005440423305762e-03, -1.080117499288814e+00, -5.173815928720911e-03, 4.282913123142651e-01, -9.610207010552358e-01, -5.362082745746705e-03, 3.867611770390765e-01,  2.494700710297991e+00, -1.175093133581524e-02, -9.610207010552361e-01, 2.387399548463733e+00, -1.042720966947233e-02, -9.343530802197566e-01, -6.593643325238756e-03, 1.253147041922823e-02, -5.362082745746906e-03, -1.042720966947179e-02, 1.328451774079811e-02, -5.101669715280344e-03, -9.812817176013215e-01, -3.005440423305574e-03, 3.867611770390766e-01, -9.343530802197568e-01, -5.101669715280108e-03, 3.783769866502249e-01,  3.543165173022089e+00, -2.758852937814110e-03, -1.386196655250460e+00, 3.053800468905655e+00,
                  -1.092204380438495e-02, -1.177814029398424e+00, -2.758852937814006e-03, 2.009925108306845e-02, -1.397449374506968e-02, 1.367507623303982e-04, 1.543022027603587e-02, -9.843173220200903e-03, -1.386196655250460e+00, -1.397449374506964e-02, 5.608340495143975e-01, -1.198811613150271e+00, -6.361426036179750e-03, 4.734107848736053e-01,  3.053800468905655e+00, 1.367507623302178e-04, -1.198811613150271e+00, 2.817709945678120e+00, -1.450388353542345e-02, -1.080117499288775e+00, -1.092204380438468e-02, 1.543022027603587e-02, -6.361426036179845e-03, -1.450388353542307e-02, 1.527031465832331e-02, -5.173815928722159e-03, -1.177814029398424e+00, -9.843173220200835e-03, 4.734107848736053e-01, -1.080117499288775e+00, -5.173815928722007e-03, 4.282913123142473e-01,  4.759862838968736e+00, 7.442006360615363e-03, -1.894332256459402e+00, 3.998012538856002e+00, 4.025870795422307e-05, -1.572769752418068e+00,  7.442006360615363e-03, 3.141201905037562e-02, -2.781441144113816e-02, 1.413882673502924e-02, 2.259501990576546e-02, -2.111820086806469e-02, -1.894332256459402e+00, -2.781441144113816e-02, 7.825341920940795e-01, -1.600433482224308e+00, -1.688630258733292e-02, 6.460745644989856e-01,  3.998012538856003e+00, 1.413882673502924e-02, -1.600433482224308e+00, 3.543165173022110e+00, -2.758852937813254e-03, -1.386196655250455e+00,  4.025870795423044e-05, 2.259501990576546e-02, -1.688630258733292e-02, -2.758852937813154e-03, 2.009925108306802e-02, -1.397449374507037e-02, -1.572769752418068e+00, -2.111820086806469e-02, 6.460745644989856e-01, -1.386196655250455e+00, -1.397449374507032e-02, 5.608340495143914e-01,  6.613422886951490e+00, 1.987865311916196e-03, -2.639678001914427e+00, 5.497464511552415e+00, 5.604608725362462e-03, -2.189812677683134e+00,  1.987865311916196e-03, 5.554006453836860e-02, -4.929197226554621e-02, 2.121464253203889e-02, 3.859865303686770e-02, -3.797936420798983e-02, -2.639678001914427e+00, -4.929197226554621e-02, 1.116664298898779e+00, -2.223905341184246e+00, -3.296607381874869e-02, 9.180301678541364e-01,  5.497464511552415e+00, 2.121464253203889e-02, -2.223905341184246e+00, 4.759862838968756e+00, 7.442006360614699e-03, -1.894332256459405e+00,  5.604608725362462e-03, 3.859865303686770e-02, -3.296607381874869e-02, 7.442006360614699e-03, 3.141201905037554e-02, -2.781441144113810e-02, -2.189812677683134e+00, -3.797936420798983e-02, 9.180301678541364e-01, -1.894332256459405e+00, -2.781441144113810e-02, 7.825341920940796e-01 )
               , tolerance = 1e-04)

  expect_equal(c(pbc_fit$lag_one_cor),
               c( 1.233521896436965e+00, -1.540936860028513e-03, -4.999300700581615e-01, 1.668730575607940e+00, -1.775637778247153e-02, -6.428298169860635e-01,  1.018867792227959e-02, 2.158585239521495e-02, -2.319401068579231e-02, -1.775637836677597e-02, 4.014313128338731e-02, -3.783402982922536e-02, -5.229219898770281e-01, -1.882297984920714e-02, 2.423250135307258e-01, -6.428298169592285e-01, -3.783403009913876e-02, 3.347567008677306e-01,  1.434370365091578e+00, -8.212208985957439e-03, -5.720072555424580e-01, 2.081459397039224e+00, -4.512027107891525e-02, -7.546924140299436e-01,  1.726572959149474e-02, 2.894870288344776e-02, -3.323320430171106e-02, -3.074338277074641e-02, 5.855592595740999e-02, -5.789374059015728e-02, -6.229308859104914e-01, -2.361888259140110e-02, 2.919102493763011e-01, -7.842517445783255e-01, -5.236166041560373e-02, 4.263844105639789e-01,  7.568145951103462e-01, 6.517796370052190e-03, -3.172256191938541e-01, 1.017240495384753e+00, 5.266619207363897e-03, -4.217398621144894e-01,  1.239904932377612e-02, 6.651695313207170e-03, -8.975149257767365e-03, 5.266619525870049e-03, 1.417752684503897e-02, -1.397364566971175e-02, -3.259720454548396e-01, -7.117346132825622e-03, 1.404837570240139e-01, -4.217398627629230e-01, -1.397364554901715e-02, 1.921868920055254e-01,  8.426730509839349e-01, 6.188954818948687e-03, -3.539525824964824e-01, 1.233521896437255e+00, -1.540936860016768e-03, -4.999300700585877e-01,  2.203426197874600e-02, 8.855178158654539e-03, -1.382008545613611e-02, 1.018867792228436e-02, 2.158585239521521e-02, -2.319401068579931e-02, -3.811432420494577e-01, -8.397915426062292e-03, 1.638240807968518e-01, -5.229219898771447e-01, -1.882297984921206e-02, 2.423250135309048e-01,  4.845015235211508e-01, 6.113534018996876e-03, -2.046568176992297e-01, 6.422087718210860e-01, 6.706596318800617e-03, -2.684349803723974e-01,  8.390615814502131e-03, 1.619211324541829e-03, -3.853607930047484e-03, 6.706596739823265e-03, 4.444813288588218e-03, -5.772768054168162e-03, -2.063331171094528e-01, -3.306972196716879e-03, 8.740798979499301e-02, -2.684349806406749e-01, -5.772767879808637e-03, 1.161224183689950e-01,  5.092046460522602e-01, 6.325452217794771e-03, -2.152936636154039e-01, 7.568145951103906e-01, 6.517796370059360e-03, -3.172256191938963e-01,  1.296919063014526e-02, 1.977256395789069e-03, -5.775414269186052e-03, 1.239904932377392e-02, 6.651695313207289e-03, -8.975149257767368e-03, -2.230292914985776e-01, -3.811486975792331e-03, 9.441352158095681e-02, -3.259720454548286e-01, -7.117346132828357e-03, 1.404837570240197e-01,  3.619996385026110e-01, 4.629018529654344e-03, -1.536112796240832e-01, 4.381328641326095e-01, 5.695284239889786e-03, -1.847087096978757e-01,  5.176050486861115e-03, 5.694387495228037e-04, -2.260765209973090e-03, 5.695284609077172e-03, 1.223318281598801e-03, -2.761000228030747e-03, -1.531634102693736e-01, -2.041925302729770e-03, 6.501810004814518e-02, -1.847087097440917e-01, -2.761000072439112e-03, 7.837779771823973e-02,  3.372562248799644e-01, 4.592051895956207e-03, -1.431894620450509e-01, 4.845015235211747e-01, 6.113534018997190e-03, -2.046568176992388e-01,  6.579997058991750e-03, 3.738118287496546e-04, -2.810641850322781e-03, 8.390615814501574e-03, 1.619211324541819e-03, -3.853607930047211e-03, -1.440237095974167e-01, -2.064454438040059e-03, 6.113486414856151e-02, -2.063331171094598e-01, -3.306972196716941e-03, 8.740798979499553e-02,  3.508023331360791e-01, 4.182664108219528e-03, -1.493643217832174e-01, 3.726840335716277e-01, 4.305623704288625e-03, -1.577418336001558e-01,  4.300796294870337e-03, 5.272412990365398e-04, -1.903518180931561e-03, 4.305624011817679e-03, 7.873952465779999e-04, -2.025210410952243e-03, -1.488528969464560e-01, -1.839160640266849e-03, 6.340179715482325e-02, -1.577418336255778e-01, -2.025210280724896e-03, 6.708295334911660e-02,  2.846476250780004e-01, 3.621948043418282e-03, -1.212515863706467e-01, 3.619996385025724e-01, 4.629018529653868e-03, -1.536112796240650e-01,  4.198859887660912e-03, 1.811959007227233e-04, -1.803868127104930e-03, 5.176050486860507e-03, 5.694387495227953e-04, -2.260765209972807e-03, -1.204873528548809e-01, -1.548761387656488e-03, 5.132112403335461e-02, -1.531634102693585e-01, -2.041925302729574e-03, 6.501810004813796e-02,  4.096868519687665e-01, 4.800049592183033e-03, -1.741949066813515e-01, 4.020739880286396e-01, 4.274923704353019e-03, -1.706095608235829e-01,  4.779397964988097e-03, 7.700489317941242e-04, -2.153245920809543e-03, 4.274923675401770e-03, 9.505318663093062e-04, -2.101664304295632e-03, -1.744010529576550e-01, -2.157089344472849e-03, 7.420370035257050e-02, -1.706095608175791e-01, -2.101664316548090e-03, 7.285017474364047e-02,  3.137847408096835e-01, 3.885717961836183e-03, -1.334908393008978e-01, 3.508023331360965e-01, 4.182664108219259e-03, -1.493643217832162e-01,  4.000375519224704e-03, 2.858457923729550e-04, -1.735948192362209e-03, 4.300796294870526e-03, 5.272412990365357e-04, -1.903518180931531e-03, -1.331931166609729e-01, -1.677077314071151e-03, 5.666254825817593e-02, -1.488528969464680e-01, -1.839160640266788e-03, 6.340179715482472e-02,  5.008787739806522e-01, 6.319173583840862e-03, -2.126952143629634e-01, 4.829802114145906e-01, 5.022659894639335e-03, -2.044347112673937e-01,  5.781604903328063e-03, 1.277379731815321e-03, -2.721970698100038e-03, 5.022658501240949e-03, 1.384334725196744e-03, -2.590311839307900e-03, -2.128520975701315e-01, -2.914806392717880e-03, 9.054569713537877e-02, -2.044347110417095e-01, -2.590312429223011e-03, 8.728444637863891e-02,  3.895783647607569e-01, 5.283333960225168e-03, -1.656387892035880e-01, 4.096868519687282e-01, 4.800049592182829e-03, -1.741949066813524e-01,  4.823824231351262e-03, 5.539327570598346e-04, -2.134628524971952e-03, 4.779397964988166e-03, 7.700489317941287e-04, -2.153245920809798e-03, -1.659401548842244e-01, -2.313641910792132e-03, 7.055086790429237e-02, -1.744010529576489e-01, -2.157089344472880e-03, 7.420370035257524e-02,  5.995527853781426e-01, 7.716847361407195e-03, -2.525861341009979e-01, 5.819089907987047e-01, 6.125201835055464e-03, -2.450172155976974e-01,  7.151522358427000e-03, 2.121650794725200e-03, -3.748400233141208e-03, 6.125197026880989e-03, 2.236100366478556e-03, -3.589948108353919e-03, -2.539230172682930e-01, -3.880243307551250e-03, 1.076924936029777e-01, -2.450172146838987e-01, -3.589950139791683e-03, 1.049286884295464e-01,  4.838091299299448e-01, 7.073109656378092e-03, -2.046708099545496e-01, 5.008787739806603e-01, 6.319173583841689e-03, -2.126952143629988e-01,  6.029824474334471e-03, 1.036599070906504e-03, -2.783550609747087e-03, 5.781604903328018e-03, 1.277379731815326e-03, -2.721970698100372e-03, -2.058478509697574e-01, -3.143380443860098e-03, 8.709229987703393e-02, -2.128520975701202e-01, -2.914806392718040e-03, 9.054569713538758e-02,  6.932854977134175e-01, 9.047544911916838e-03, -2.899890730213200e-01, 6.827647543300842e-01, 6.620467340166020e-03, -2.835561571102822e-01,  8.572116216746920e-03, 3.025854521941180e-03, -4.827125273296737e-03, 6.620456753493544e-03, 3.448894581349906e-03, -4.906979259495684e-03, -2.913987421700656e-01, -4.964489511816748e-03, 1.232185924900720e-01, -2.835561547972314e-01, -4.906983703382740e-03, 1.216438378022546e-01,  5.772019498147504e-01,
                  8.868944469980993e-03, -2.428437669947855e-01, 5.995527853780882e-01, 7.716847361406227e-03, -2.525861341009790e-01,  7.838458772489128e-03, 1.698664292228662e-03, -3.779752904029380e-03, 7.151522358426072e-03, 2.121650794725188e-03, -3.748400233140690e-03, -2.452894943040153e-01, -4.090515667757697e-03, 1.033347230384501e-01, -2.539230172682513e-01, -3.880243307550684e-03, 1.076924936029620e-01,  7.802325403689874e-01, 1.037399164609405e-02, -3.250723212904090e-01, 7.718751613643235e-01, 8.385140185709915e-03, -3.198942432732468e-01,  9.885800204705985e-03, 3.843114810004556e-03, -5.922958990943019e-03, 8.385122098159552e-03, 4.206806172308319e-03, -5.844251559572942e-03, -3.260073900625823e-01, -5.931528791161900e-03, 1.375992386720457e-01, -3.198942386722461e-01, -5.844259100749973e-03, 1.362621552675355e-01,  6.648755071183008e-01, 1.046480622899449e-02, -2.788768726125023e-01, 6.932854977134322e-01, 9.047544911916131e-03, -2.899890730213104e-01,  9.546910484168331e-03, 2.420089927863127e-03, -4.829075159932409e-03, 8.572116216747116e-03, 3.025854521941171e-03, -4.827125273296575e-03, -2.809902623637184e-01, -5.033688440146316e-03, 1.180958076910328e-01, -2.913987421700702e-01, -4.964489511816693e-03, 1.232185924900674e-01,  8.642889174216186e-01, 1.089828309232720e-02, -3.589293906543171e-01, 8.606383706274976e-01, 8.622940415754850e-03, -3.535997437685913e-01,  1.027404139731813e-02, 4.773843666906690e-03, -7.126043350460937e-03, 8.622912704391378e-03, 5.306766837882083e-03, -7.124126566602997e-03, -3.583793160369746e-01, -7.125963318461210e-03, 1.521203829254721e-01, -3.535997333072088e-01, -7.124138021563350e-03, 1.509358260966299e-01,  7.459367614512300e-01, 1.188841725813111e-02, -3.129259922771607e-01, 7.802325403689393e-01, 1.037399164609421e-02, -3.250723212904046e-01,  1.087820456432352e-02, 3.092209467874558e-03, -5.919600438177000e-03, 9.885800204705364e-03, 3.843114810004567e-03, -5.922958990943111e-03, -3.132957732795085e-01, -5.967947497228393e-03, 1.320550837129032e-01, -3.260073900625738e-01, -5.931528791162124e-03, 1.375992386720488e-01,  9.379610598741743e-01, 1.231195201891409e-02, -3.923428874306253e-01, 9.431930454870525e-01, 8.845662483212346e-03, -3.863524697622229e-01,  1.158818243665778e-02, 5.204089273580898e-03, -8.062208756503458e-03, 8.845623047410614e-03, 6.227141576950128e-03, -8.426241471209007e-03, -3.895247879821848e-01, -8.274418587334780e-03, 1.667139987617323e-01, -3.863524475301511e-01, -8.426257663582747e-03, 1.658701961975120e-01,  8.207520873621514e-01, 1.326605183278436e-02, -3.463824228893564e-01, 8.642889174216308e-01, 1.089828309232824e-02, -3.589293906543111e-01,  1.202677236732574e-02, 3.612248085660041e-03, -6.844740156754096e-03, 1.027404139731723e-02, 4.773843666906689e-03, -7.126043350460331e-03, -3.432082562333038e-01, -7.056772695077691e-03, 1.460073641937815e-01, -3.583793160369682e-01, -7.125963318461423e-03, 1.521203829254648e-01,  1.001695764039182e+00, 1.397276041430084e-02, -4.216506966815565e-01, 1.009497052882504e+00, 1.133249625268358e-02, -4.187368928069807e-01,  1.448851465638579e-02, 4.919514787640465e-03, -8.711394435979895e-03, 1.133244850683204e-02, 6.202816990511657e-03, -9.249565515745363e-03, -4.210736958458977e-01, -8.603939703100048e-03, 1.799694294516598e-01, -4.187368654781455e-01, -9.249585256467886e-03, 1.804526845781767e-01,  8.892387505489698e-01, 1.419259350366630e-02, -3.764355903433442e-01, 9.379610598741022e-01, 1.231195201891418e-02, -3.923428874305841e-01,  1.399281896194433e-02, 3.678056406950357e-03, -7.533899940985436e-03, 1.158818243665532e-02, 5.204089273580880e-03, -8.062208756502105e-03, -3.731238895242226e-01, -7.641269821469473e-03, 1.589844974260953e-01, -3.895247879821619e-01, -8.274418587334889e-03, 1.667139987617180e-01,  1.065920427830776e+00, 1.439378818021668e-02, -4.474892207874333e-01, 1.071920555048764e+00, 1.352193373041074e-02, -4.482189049137436e-01,  1.563012738892195e-02, 4.645651501850962e-03, -9.013166415327140e-03, 1.352188549867865e-02, 5.659706175334782e-03, -9.325409010837756e-03, -4.494911678266162e-01, -8.435618229311413e-03, 1.910072507800000e-01, -4.482188868817886e-01, -9.325429170725669e-03, 1.925230387685744e-01,  9.516353671485738e-01, 1.451925532672940e-02, -4.016187441571281e-01, 1.001695764039232e+00, 1.397276041430278e-02, -4.216506966815636e-01,  1.618234287025629e-02, 3.513570368453994e-03, -8.311659416186286e-03, 1.448851465638670e-02, 4.919514787640492e-03, -8.711394435980041e-03, -4.029510456411630e-01, -7.659972634491863e-03, 1.708113598852065e-01, -4.210736958459261e-01, -8.603939703101008e-03, 1.799694294516657e-01,  1.134931718708131e+00, 1.310993499161153e-02, -4.739091829205596e-01, 1.139698828843098e+00, 1.303547334798317e-02, -4.742959684161530e-01,  1.471328718965001e-02, 4.732010618644655e-03, -8.908219535823929e-03, 1.303543052620481e-02, 5.625522619508175e-03, -9.278505982290203e-03, -4.757451026452441e-01, -8.145706181379178e-03, 2.014287756531059e-01, -4.742959555619653e-01, -9.278523855756407e-03, 2.028117845334769e-01,  1.015092202701569e+00, 1.403070386182179e-02, -4.265101975993445e-01, 1.065920427830898e+00, 1.439378818021357e-02, -4.474892207873924e-01,  1.676302299249442e-02, 3.396343975377415e-03, -8.617280659604723e-03, 1.563012738892418e-02, 4.645651501850897e-03, -9.013166415326269e-03, -4.302006104721409e-01, -7.344487060669340e-03, 1.815529979279130e-01, -4.494911678266754e-01, -8.435618229310212e-03, 1.910072507799858e-01,  1.208348543001897e+00, 1.190952740625878e-02, -5.055599529117638e-01, 1.212960857709530e+00, 1.118382278557077e-02, -5.019414356034059e-01,  1.325277726925874e-02, 4.851670993444615e-03, -8.277156904278602e-03, 1.118378485226655e-02, 5.863644342605936e-03, -8.938705801426968e-03, -5.044273074475486e-01, -7.798556113482720e-03, 2.138444507500046e-01, -5.019414031290680e-01, -8.938721320501214e-03, 2.138955866455469e-01,  1.082702016205967e+00, 1.313202333487972e-02, -4.555201851253318e-01, 1.134931718708035e+00, 1.310993499160966e-02, -4.739091829204955e-01,  1.601551524944003e-02, 3.434751802832408e-03, -8.313787078890201e-03, 1.471328718965073e-02, 4.732010618644674e-03, -8.908219535823587e-03, -4.562835672930146e-01, -7.099249334731656e-03, 1.928859120350029e-01, -4.757451026452504e-01, -8.145706181379012e-03, 2.014287756530983e-01,  1.289791988840715e+00, 1.013684449452835e-02, -5.384972452746328e-01, 1.288700613499207e+00, 1.035880051741469e-02, -5.355211023890482e-01,  1.193888464272137e-02, 5.047592635417702e-03, -7.788532345617804e-03, 1.035876799393978e-02, 5.883310159030520e-03, -8.322536643367691e-03, -5.396508234044015e-01, -7.026187514744537e-03, 2.280312509146009e-01, -5.355210569908765e-01, -8.322549848761678e-03, 2.280767936741074e-01,  1.158697288357937e+00, 1.137024511613697e-02, -4.863012686615467e-01, 1.208348543001827e+00, 1.190952740625651e-02, -5.055599529117072e-01,  1.441268575559772e-02, 3.609444194744594e-03, -7.683656904013410e-03, 1.325277726925793e-02, 4.851670993444543e-03, -8.277156904277574e-03, -4.861964485433532e-01, -6.488525135948418e-03, 2.049722169481255e-01, -5.044273074475386e-01, -7.798556113482003e-03, 2.138444507499891e-01,  1.384022659920146e+00, 7.113645628994438e-03,
                  -5.721583516141269e-01, 1.378001902014668e+00, 8.000309624870246e-03, -5.706763261176881e-01,  9.421135745445369e-03, 5.554088711367626e-03, -7.292801998204186e-03, 8.000311705388750e-03, 6.296640332558901e-03, -7.705149509244374e-03, -5.766122526294224e-01, -6.209580590902215e-03, 2.418463604354625e-01, -5.706763332003535e-01, -7.705148602647387e-03, 2.424902073829291e-01,  1.243130475954162e+00, 8.968763689494744e-03, -5.171993859602120e-01, 1.289791988840820e+00, 1.013684449452880e-02, -5.384972452746415e-01,  1.292133032750626e-02, 3.892274874316244e-03, -7.300134764263602e-03, 1.193888464272319e-02, 5.047592635417760e-03, -7.788532345618250e-03, -5.223722404530247e-01, -5.556659576788065e-03, 2.183901905399149e-01, -5.396508234044635e-01, -7.026187514745205e-03, 2.280312509146122e-01,  1.490777902066384e+00, 3.731710301140934e-03, -6.079992709075790e-01, 1.480608961662779e+00, 4.449985599941808e-03, -6.065469191853278e-01,  6.263882010804616e-03, 6.170855011371932e-03, -6.718178359833116e-03, 4.450132728390789e-03, 6.997438695097343e-03, -7.101636766236409e-03, -6.146131084038000e-01, -5.531694382818632e-03, 2.551977981772328e-01, -6.065470917242702e-01, -7.101576461031059e-03, 2.560546883603448e-01,  1.339141665658650e+00, 6.123799750030251e-03, -5.499793978082942e-01, 1.384022659920394e+00, 7.113645628995309e-03, -5.721583516141752e-01,  1.078017986636509e-02, 4.325097932464416e-03, -6.851605816834735e-03, 9.421135745447940e-03, 5.554088711367595e-03, -7.292801998204855e-03, -5.604738933144312e-01, -4.702546352957540e-03, 2.317132192262017e-01, -5.766122526295462e-01, -6.209580590902645e-03, 2.418463604354910e-01,  1.603120951136473e+00, 3.513645901510019e-03, -6.521130784539017e-01, 1.595055607021382e+00, 1.185609293012375e-03, -6.452272236229628e-01,  4.292201263460241e-03, 6.430974180144489e-03, -5.910892743440742e-03, 1.186115476475379e-03, 7.598903209679026e-03, -6.506797777111679e-03, -6.539877909164028e-01, -5.718794672205750e-03, 2.705730947274436e-01, -6.452276107848798e-01, -6.506591992425817e-03, 2.696297723440029e-01,  1.442126289395931e+00, 5.516791324589810e-03, -5.898441906420807e-01, 1.490777902066498e+00, 3.731710301140098e-03, -6.079992709075857e-01,  8.735403454641277e-03, 4.657999906619298e-03, -6.159581492455247e-03, 6.263882010806006e-03, 6.170855011372003e-03, -6.718178359833316e-03, -5.981127888035743e-01, -4.828173379691096e-03, 2.464523120507502e-01, -6.146131084038732e-01, -5.531694382818392e-03, 2.551977981772460e-01,  1.720401266517988e+00, 6.181479973299641e-03, -7.033805866459125e-01, 1.707781425356130e+00, 2.200139897896691e-03, -6.910226193763598e-01,  5.311638525790426e-03, 6.426497691315755e-03, -6.127470947242306e-03, 2.201396212968575e-03, 7.547979407698093e-03, -6.489295770463761e-03, -7.012379804151032e-01, -6.542610802716039e-03, 2.907974962116958e-01, -6.910232684924794e-01, -6.488784681866312e-03, 2.872559119911792e-01,  1.555678603600711e+00, 7.334447958074910e-03, -6.387393535348737e-01, 1.603120951136443e+00, 3.513645901510992e-03, -6.521130784539049e-01,  7.229520952676656e-03, 4.825641917552227e-03, -5.502509548883642e-03, 4.292201263461869e-03, 6.430974180144453e-03, -5.910892743441757e-03, -6.385481072428733e-01, -5.719161161580186e-03, 2.639131507751871e-01, -6.539877909164116e-01, -5.718794672206431e-03, 2.705730947274540e-01,  1.850053345824598e+00, 9.112832910298862e-03, -7.606080375832226e-01, 1.831349995870421e+00, 4.794161358116448e-03, -7.445105028653241e-01,  7.621514581805657e-03, 6.618552764816195e-03, -7.366166224104989e-03, 4.796891865249111e-03, 7.624164791177974e-03, -7.532741419844190e-03, -7.568173031032494e-01, -7.898551511286043e-03, 3.156983734726820e-01, -7.445118253591966e-01, -7.531621611494193e-03, 3.103813683867906e-01,  1.677867732197091e+00, 1.040494693252253e-02, -6.931727073284067e-01, 1.720401266518020e+00, 6.181479973297661e-03, -7.033805866458339e-01,  8.099109152313159e-03, 4.904061557784887e-03, -5.944668893141067e-03, 5.311638525789072e-03, 6.426497691315761e-03, -6.127470947241309e-03, -6.874909900986802e-01, -6.867531419705244e-03, 2.857241460520273e-01, -7.012379804151035e-01, -6.542610802714937e-03, 2.907974962116581e-01,  1.989023951504798e+00, 1.093244722907000e-02, -8.203398126146471e-01, 1.967868017764525e+00, 7.262466244063917e-03, -8.039024827841805e-01,  1.013074457634592e-02, 6.959658414516753e-03, -8.854897091281304e-03, 7.267696606844540e-03, 7.987617688811562e-03, -9.109528527092063e-03, -8.176697355673563e-01, -9.096422315385272e-03, 3.425028552080365e-01, -8.039051787927146e-01, -9.107368641215119e-03, 3.372301144835961e-01,  1.810463188660457e+00, 1.266418828002877e-02, -7.506638565784510e-01, 1.850053345824706e+00, 9.112832910299365e-03, -7.606080375832129e-01,  1.041102962349501e-02, 5.091970913891865e-03, -7.169584734073201e-03, 7.621514581808155e-03, 6.618552764816208e-03, -7.366166224105915e-03, -7.444278978322125e-01, -7.928522939802032e-03, 3.106605619124063e-01, -7.568173031033802e-01, -7.898551511286907e-03, 3.156983734727138e-01,  2.123152590395178e+00, 1.200726817628433e-02, -8.789323207663411e-01, 2.108932255888644e+00, 8.951198909808764e-03, -8.646976371542652e-01,  1.211937860297243e-02, 7.181180395406708e-03, -9.594973280889756e-03, 8.960117162071929e-03, 8.349357458460688e-03, -1.022240639040879e-02, -8.762413728439302e-01, -9.732716407900473e-03, 3.679958993744562e-01, -8.647022098858697e-01, -1.021872697198903e-02, 3.639506434091465e-01,  1.943779127065634e+00, 1.390370601688981e-02, -8.085795914288829e-01, 1.989023951504510e+00, 1.093244722906886e-02, -8.203398126145351e-01,  1.321703464043899e-02, 5.294969092844813e-03, -8.337905070527828e-03, 1.013074457634412e-02, 6.959658414516799e-03, -8.854897091281256e-03, -8.035006411007817e-01, -8.686790575646808e-03, 3.363696113955335e-01, -8.176697355672879e-01, -9.096422315385006e-03, 3.425028552080115e-01,  2.236367804710893e+00, 1.180952979459358e-02, -9.282304189142163e-01, 2.234889198152773e+00, 1.020458476304570e-02, -9.204312812763908e-01,  1.275706530898457e-02, 7.399992708126054e-03, -9.718664035765073e-03, 1.021855055606700e-02, 8.466902318261610e-03, -1.049088426944648e-02, -9.260244255557009e-01, -9.564873059281224e-03, 3.895969134531244e-01, -9.204377004896598e-01, -1.048513454536651e-02, 3.880871633651046e-01,  2.065877948395198e+00, 1.382094274458590e-02, -8.615733902292202e-01, 2.123152590394971e+00, 1.200726817628286e-02, -8.789323207663264e-01,  1.482629968464621e-02, 5.533984113745953e-03, -8.875408096354887e-03, 1.211937860296772e-02, 7.181180395406599e-03, -9.594973280888597e-03, -8.569166796829064e-01, -8.825332695022323e-03, 3.594425615822382e-01, -8.762413728438383e-01, -9.732716407899179e-03, 3.679958993744473e-01,  2.317129594815754e+00, 9.442460842057632e-03, -9.603143255578201e-01, 2.334269526120779e+00, 9.297795998590125e-03, -9.630992197909936e-01,  1.137892426572115e-02, 7.775166605597484e-03, -9.304494511221641e-03, 9.319469300494064e-03, 8.815196721851291e-03, -1.020783000792928e-02, -9.609365654764521e-01, -8.648116373994895e-03, 4.039789042201103e-01, -9.631085655214224e-01, -1.019890967415675e-02, 4.069998427146342e-01,  2.161832831712793e+00, 1.204690206774253e-02, -9.006430167228940e-01,
                  2.236367804710462e+00, 1.180952979459473e-02, -9.282304189140169e-01,  1.483237796891944e-02, 5.814269142353611e-03, -8.895336810238231e-03, 1.275706530898099e-02, 7.399992708126097e-03, -9.718664035763311e-03, -8.991443895374893e-01, -8.074188563784362e-03, 3.767596875035957e-01, -9.260244255554784e-01, -9.564873059281541e-03, 3.895969134530234e-01,  2.350917096646279e+00, 7.027713692211283e-03, -9.732315804398213e-01, 2.395747632357766e+00, 6.531382659951179e-03, -9.871504094655368e-01,  8.880932869855966e-03, 7.980298803290245e-03, -8.045060489954264e-03, 6.566623319919997e-03, 9.202696895545339e-03, -9.179221876093172e-03, -9.745790633440889e-01, -7.410809162440178e-03, 4.086463779483036e-01, -9.871652949321654e-01, -9.164759272609024e-03, 4.167604885014801e-01,  2.215593089285679e+00, 9.718236566532926e-03, -9.213210166175978e-01, 2.317129594815349e+00, 9.442460842049655e-03, -9.603143255573896e-01,  1.339791405433860e-02, 6.071071269368884e-03, -8.277183061138747e-03, 1.137892426571586e-02, 7.775166605597390e-03, -9.304494511216493e-03, -9.233009566158581e-01, -6.995156197521956e-03, 3.860535487488631e-01, -9.609365654762936e-01, -8.648116373991597e-03, 4.039789042199341e-01,  2.331461704579588e+00, 5.156827672249856e-03, -9.642949658577953e-01, 2.402601612274347e+00, 4.485844723585136e-03, -9.901010767131297e-01,  6.196110229965392e-03, 8.176598043338540e-03, -6.851165260503221e-03, 4.547480143565912e-03, 9.228761289892830e-03, -7.747355274477662e-03, -9.654951883958343e-01, -6.387309142317409e-03, 4.039539669971426e-01, -9.901261465021380e-01, -7.721978805585561e-03, 4.165480496335600e-01,  2.219630741533195e+00, 7.761918171130776e-03, -9.218244919955043e-01, 2.350917096647494e+00, 7.027713692215713e-03, -9.732315804402181e-01,  1.052279388680837e-02, 6.310015791428065e-03, -7.081356868764582e-03, 8.880932869867162e-03, 7.980298803290280e-03, -8.045060489957234e-03, -9.242566527497953e-01, -6.033128818300143e-03, 3.856462996751578e-01, -9.745790633447022e-01, -7.410809162443067e-03, 4.086463779485133e-01,  2.269747961341382e+00, 2.643822660908794e-03, -9.350551154438067e-01, 2.360263181226796e+00, 2.031096822469557e-03, -9.707382706076175e-01,  3.421606427298930e-03, 8.739008710622618e-03, -6.304631414114269e-03, 2.147624982275186e-03, 9.618477036074016e-03, -6.982975827728234e-03, -9.376628751002940e-01, -5.774063151653373e-03, 3.915410869088569e-01, -9.707871498610419e-01, -6.934564273333221e-03, 4.079788705158065e-01,  2.175283561167880e+00, 5.755718264961671e-03, -9.006422271429697e-01, 2.331461704579758e+00, 5.156827672251573e-03, -9.642949658586160e-01,  7.391834531848378e-03, 6.649007121365746e-03, -6.088922485767437e-03, 6.196110229970363e-03, 8.176598043338578e-03, -6.851165260507653e-03, -9.041609860861932e-01, -5.203238386465520e-03, 3.761953233721282e-01, -9.654951883959471e-01, -6.387309142319187e-03, 4.039539669975015e-01,  2.192438576789263e+00, -7.688442927042301e-04, -8.955625630011790e-01, 2.287049484100296e+00, -9.642220931573124e-04, -9.359304318897732e-01,  8.010678963829912e-04, 9.599994531785932e-03, -6.130596290953232e-03, -7.376701634900368e-04, 1.042557097242184e-02, -6.692389073619687e-03, -9.015776759706884e-01, -5.243361861212888e-03, 3.746499608852281e-01, -9.360330454890198e-01, -6.597732381831546e-03, 3.930092409216062e-01,  2.099133872476305e+00, 2.828099064920084e-03, -8.627082397305994e-01, 2.269747961341102e+00, 2.643822660911753e-03, -9.350551154440936e-01,  4.796867064991606e-03, 7.234431283836956e-03, -5.615216651334656e-03, 3.421606427300480e-03, 8.739008710622640e-03, -6.304631414116234e-03, -8.706522089956565e-01, -4.401482582774617e-03, 3.602064613170926e-01, -9.376628750999370e-01, -5.774063151654735e-03, 3.915410869088769e-01,  2.145539633968042e+00, -4.424782204229857e-03, -8.647948363675257e-01, 2.219160320048932e+00, -4.286296666552260e-03, -8.999548875838053e-01, -1.135506891741321e-03, 1.041041161426605e-02, -5.883710797783107e-03, -3.857342111411408e-03, 1.140748851725126e-02, -6.435350626523735e-03, -8.754357381277567e-01, -4.500378821343669e-03, 3.598777885880491e-01, -9.001618655047419e-01, -6.256433812804763e-03, 3.762810107191128e-01,  2.026007923965872e+00, -8.436673908382014e-04, -8.222179086367629e-01, 2.192438576790754e+00, -7.688442927041503e-04, -8.955625630014659e-01,  3.195001672215259e-03, 7.917237607201123e-03, -5.415220337844112e-03, 8.010678963852186e-04, 9.599994531785880e-03, -6.130596290954620e-03, -8.374508805459198e-01, -3.513140998919737e-03, 3.427817897061178e-01, -9.015776759711907e-01, -5.243361861212801e-03, 3.746499608852998e-01,  2.206743080282177e+00, -8.993221365839861e-03, -8.697413708470298e-01, 2.214615922279417e+00, -7.076351382376354e-03, -8.863172415159606e-01, -2.804172387115687e-03, 1.106676002899431e-02, -5.619821315733010e-03, -6.319543296142330e-03, 1.209996254368914e-02, -5.848945100123508e-03, -8.882144686120981e-01, -3.118776170220845e-03, 3.576363115288927e-01, -8.866712777562040e-01, -5.536465506144353e-03, 3.663515130894375e-01,  2.018207120029450e+00, -5.703149675868602e-03, -8.012913502028911e-01, 2.145539633967629e+00, -4.424782204220906e-03, -8.647948363676567e-01,  2.431060407415919e-03, 8.549944751804220e-03, -5.391451116120861e-03, -1.135506891741057e-03, 1.041041161426615e-02, -5.883710797784009e-03, -8.283125184342990e-01, -2.081986200668712e-03, 3.321649761363539e-01, -8.754357381276585e-01, -4.500378821345876e-03, 3.598777885881315e-01,  2.478133336418018e+00, -1.293990963215978e-02, -9.544082781961269e-01, 2.372582782170990e+00, -1.149567322080878e-02, -9.279440245393001e-01, -6.238987865858747e-03, 1.193248424609445e-02, -5.188208748984714e-03, -1.029056733239578e-02, 1.284834622091938e-02, -4.950640731921095e-03, -9.744019788797447e-01, -2.336727604701693e-03, 3.840889930986032e-01, -9.283339754535311e-01, -4.476147822498836e-03, 3.756796584161186e-01,  2.158922472160646e+00, -9.720563011347459e-03, -8.361298406357724e-01, 2.206743080282226e+00, -8.993221365828294e-03, -8.697413708470629e-01,  1.817259382737507e-03, 9.113101506121485e-03, -5.609099817068273e-03, -2.804172387113163e-03, 1.106676002899430e-02, -5.619821315732357e-03, -8.736186760224152e-01, -8.510495396255868e-04, 3.422138601232206e-01, -8.882144686120463e-01, -3.118776170226145e-03, 3.576363115288773e-01,  3.026671152613680e+00, -6.708312533216382e-05, -1.190695871694169e+00, 2.794561074959514e+00, -1.524062669707286e-02, -1.071497976294831e+00, -9.444365143044496e-03, 1.390882224070260e-02, -5.941600509326734e-03, -1.363738798701753e-02, 1.410021790593285e-02, -4.875741895609328e-03, -1.166967971880452e+00, -9.220449547434791e-03, 4.702984570010882e-01, -1.071099061220681e+00, -4.351506847490983e-03, 4.247985372364708e-01,  2.521340638618422e+00, 1.506019875064889e-03, -9.946548189552218e-01, 2.478133336417984e+00, -1.293990963216342e-02, -9.544082781961015e-01, -9.417346666023424e-04, 1.018675789114566e-02, -5.843168829888498e-03, -6.238987865862945e-03, 1.193248424609462e-02, -5.188208748983670e-03, -9.958595905994146e-01, -6.238565013814073e-03, 3.983462111298842e-01, -9.744019788797250e-01, -2.336727604701615e-03, 3.840889930985920e-01,  3.946095617801125e+00, 1.913798413551094e-02, -1.595240142229951e+00, 3.501902451986702e+00,
                  -4.325327533143812e-04, -1.377654839068246e+00,  5.822484625814064e-03, 1.894435757299720e-02, -1.515687583362871e-02, 1.018898716603465e-03, 1.722411042002059e-02, -1.290198710561934e-02, -1.559147690757877e+00, -2.004788113470360e-02, 6.418693300174428e-01, -1.374066239928914e+00, -1.274867051514811e-02, 5.563165954828740e-01,  3.241553585901253e+00, 1.923579853766090e-02, -1.311150521899153e+00, 3.026671152613809e+00, -6.708312532983582e-05, -1.190695871694211e+00, -4.086061909046987e-03, 1.308560502915221e-02, -7.188885773193710e-03, -9.444365143046219e-03, 1.390882224070237e-02, -5.941600509326273e-03, -1.256972830362303e+00, -1.530167916613328e-02, 5.162517993370387e-01, -1.166967971880537e+00, -9.220449547435656e-03, 4.702984570011185e-01,  5.405690373066361e+00, 3.577848261310544e-02, -2.226341661782894e+00, 4.668088700483220e+00, 2.200584644149960e-02, -1.896768577058293e+00,  2.053832611679478e-02, 3.147731454685718e-02, -2.833921301377853e-02, 2.237572375199002e-02, 2.429068056038793e-02, -2.318755063607043e-02, -2.182488704917416e+00, -3.415235953397119e-02, 9.096460773804115e-01, -1.887008283694162e+00, -2.398740676697242e-02, 7.741501016202506e-01,  4.390128098814004e+00, 3.865711403512123e-02, -1.812640995873887e+00, 3.946095617801066e+00, 1.913798413550962e-02, -1.595240142229922e+00,  1.014477192558476e-02, 2.083160536712789e-02, -1.770513011015562e-02, 5.822484625811039e-03, 1.894435757299728e-02, -1.515687583362775e-02, -1.743787452599064e+00, -2.746867668993154e-02, 7.275836419926454e-01, -1.559147690757932e+00, -2.004788113470402e-02, 6.418693300174643e-01 )
               , tolerance = 1e-04)

  expect_equal(c(pbc_fit$n_iter),
               c(18 )
               , tolerance = 1e-04)

  expect_equal(c(pbc_fit$Q),
               c( 1.066702748853078e-03, -1.756189151485551e-04, -3.204654134208788e-06, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, -1.756189151485551e-04, 5.990283350348827e-05, -5.388485362053587e-05, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, -3.204654134208788e-06, -5.388485362053587e-05, 1.549215473199694e-04, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00,  0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00, 0.000000000000000e+00 )
               , tolerance = 1e-04)

  # par(mfcol = c(2, 2))
  # plot(pbc_fit, type = "cov", cov_index = 1)
  # plot(pbc_fit, type = "cov", cov_index = 2)
  # plot(pbc_fit, type = "cov", cov_index = 3)
})


#############
# Test ukf for exponential model
test_that("UKF and exp models give previous computed results",{
  suppressMessages(suppressWarnings(result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 2,
    Q_0 = diag(1e-0, 2),
    Q = diag(1e-1, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-3,
                   method = "UKF", beta = 0),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential")))

  # get_expect_equal(result_exp)

  expect_equal(c(result_exp$state_vecs),
               c(-3.28342748952668906, -3.28397076659429832, -2.89030578953190798, -2.81155294011074952, -3.25704806564240812, -3.47457543079171449, -3.74587867657199514, -3.73080234575264225, -3.77466681578041907, -3.98982703868863542, -4.08746850594517497, -4.33080926529420918, -4.55215563357556530, -4.71553744708574740, -4.67914714899443673, -4.87874602595734874,  0.28265332922450492, 0.28238525448289564, 0.47328828426846392, 0.50710120871707054,  0.28911230961609313, 0.18712694556961135, 0.05565547805389662, 0.06816142899238220,  0.04587806286931323, -0.05942794665623935, -0.10815787163139817, -0.23260849268711531, -0.34406450554075640, -0.42601171607008764, -0.41067332294805253, -0.50803106644275120 ))

  expect_equal(c(result_exp$state_vars),
               c(0.07446277995789730, 0.02265983869848025, 0.02265984058508120, 0.03677105607317273, 0.14259255809156413, 0.05412042926574592, 0.05412043563223976, 0.05020414050959000, 0.14654723388685770, 0.05611877419475333, 0.05611878647234942, 0.05064766131792205, 0.14100544571846474, 0.05331559462298802, 0.05331562046439527, 0.04890201215837880, 0.14126473379475551, 0.05393108745462680, 0.05393108510447320, 0.04959872355606050, 0.14935187861922725, 0.05847598300627081, 0.05847598379096140, 0.05298743425285911, 0.15723624340579240, 0.06262577935148173, 0.06262577868931160, 0.05633756395828551, 0.17012338460539309, 0.06903760147255830, 0.06903760216365232, 0.06092772716255020, 0.17203859977485988, 0.06974508880360820, 0.06974509036272705, 0.06266107350222364, 0.17500243126684156, 0.07074252061056749, 0.07074252228937575, 0.06454060788342329, 0.19184909490029572, 0.07880670813089377, 0.07880670859337419, 0.07015978535952895, 0.20174320019214081, 0.08332113906523336, 0.08332113992273907, 0.07404847225334535, 0.22633837861131531, 0.09487450854954566, 0.09487450853616708, 0.08139999610890589, 0.26335757337520393, 0.11236650234204371, 0.11236650239302359, 0.09165673951813536, 0.31853630155935897, 0.13861904961041033, 0.13861904968172917, 0.10618753183899252, 0.38676112930415896, 0.17095342423774312, 0.17095342431183091, 0.12357392306853450 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 4.428422881560595e-02, 1.427013509248181e-02, 1.309084768886078e-02,  2.016021604393051e-02, 7.617631937200361e-02, 2.928665602414839e-02,  2.917500089983366e-02, 2.635843370866330e-02, 7.523073456580354e-02,  2.931682530255176e-02, 2.918302514135051e-02, 2.536681033456802e-02,  7.289463105785529e-02, 2.862600337974701e-02, 2.881325737579473e-02,  2.429290081235159e-02, 7.625279965222365e-02, 3.098044048819633e-02,  3.130388944087124e-02, 2.494795093528204e-02, 8.293749676628964e-02,  3.502818972545375e-02, 3.526033472084709e-02, 2.646737397750439e-02,  9.161681403129168e-02, 3.993485191783534e-02, 4.010912584119038e-02,  2.834161715104842e-02, 9.782047994551474e-02, 4.356931884919672e-02,  4.364451188813123e-02, 2.946012229688780e-02, 9.915354688608299e-02,  4.473258531610143e-02, 4.475170489126440e-02, 2.923069255443473e-02,  1.058179373853447e-01, 4.849241886488918e-02, 4.855869877570417e-02,  3.019457167368734e-02, 1.130668092649270e-01, 5.263233579772218e-02,  5.266818564615972e-02, 3.121416106928711e-02, 1.161138884763650e-01,  5.472064329803576e-02, 5.473694332724083e-02, 3.108292318208252e-02,  1.132815119528566e-01, 5.395792803114002e-02, 5.396390156513786e-02,  2.941023513241123e-02, 8.540216613724394e-02, 4.100083016744957e-02,  4.100326946411201e-02, 2.163067713439666e-02, 2.022711868619363e-316, 2.022694477508630e-316, 1.581010066691989e-320, 2.022262861760423e-316 ))

  expect_equal(c(result_exp$n_iter),
               c(29 ))

  expect_equal(c(result_exp$Q),
               c(0.09380072259340166, 0.04543132661311027, 0.04543132661311027, 0.02306509137512839 ))

  expect_equal(c(result_exp$Q_0),
               c(0.1, 0.0, 0.0, 0.1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("UKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))




  set.seed(44334)
  sims <- test_sim_func_exp(n_series = 1e4, n_vars = 10, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                            intercept_start = -5, sds = c(.1, rep(1, 10)))
  sum(sims$res$event)

  arg_list <- list(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(1, 11),
    Q = diag(1e-2, 11),
    control = list(est_Q_0 = F, n_max = 10^2, eps = 10^-2,
                   method = "UKF", beta = 0),
    max_T = 10,
    id = sims$res$id, order = 1,
    model = "exponential")

  fit <- do.call(ddhazard, arg_list)

  matplot(fit$state_vecs, lty = 2, type = "l", ylim = range(fit$state_vecs, sims$betas))
  matplot(sims$betas, lty = 1, add = T, type = "l")
})


