library(survival)

test_that("The head_neck_cancer must be defined for the ddhazard tests",
          expect_true(exists("head_neck_cancer")))

# Test on data set that is one of Farhmiers papers
result = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1, # Use by month intervals
  n_max = 10^4, eps = 10^-4,
  a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
  est_Q_0 = T,
  max_T = 45,
  id = head_neck_cancer$id, order_ = 1
)

test_that("Testing previous computed values vs. current on head and neck cancer set assuming that the previous is correct", {
  expect_equal(c(result$a_t_d_s),
               c(-3.5084644693000375, -3.5148844600373153, -3.1891314791814929, -2.8181185126716946, -2.5133150253138181, -2.0686431883814391, -2.1337664829927272, -2.5088816216986980, -2.7261252524003838, -2.8656346839715456, -3.0022690651419150, -3.2103909019454631, -3.3296886621454438, -3.3797024676574670, -3.2387762301797576, -3.2832268974011902, -3.4010378429506498, -3.4996364628495664, -3.4640927580381167, -3.5454306632739097, -3.5193437650355053, -3.6429455602328522, -3.8148529400485618, -3.9315760725295390, -3.9912270162929087, -4.1221212755199144, -4.2111505273306804, -4.2593181086540230, -4.3955501412991156, -4.5056360495292482, -4.5891834181979796, -4.6463491829253352, -4.6772452961075963, -4.6818100380470060, -4.6597979866888570, -4.6108005184078964, -4.5342715329240795, -4.4295511232451679, -4.4288880723551687, -4.5320293776581728, -4.6212298063525905, -4.6940739120459574, -4.7499759978712248, -4.7915369057959181, -4.8188789577153992, -4.8320508432930724, 0.4360755600018228, 0.4376620032308990,  0.4489331535887380, 0.4629877155198045, 0.4717967889720516, 0.4892432325019014, 0.4906015100905337, 0.4811672226212869, 0.4812410655726153, 0.4807008058089728,  0.4795022646846021, 0.4752694673136330, 0.4750540102025831, 0.4782488768524199, 0.4871715112202827, 0.4868843094919623, 0.4843562325887174, 0.4835935130835331,  0.4867226287750569, 0.4863614783282632, 0.4891031221907462, 0.4848002061937289, 0.4802281967614200, 0.4772168219924643, 0.4758176353352087, 0.4735558899381061,  0.4724962572592801, 0.4726240459881104, 0.4714467634180154, 0.4710489177360688, 0.4714390992094060, 0.4726106938155138, 0.4745588596923577, 0.4772841101671843,  0.4807925107278950, 0.4850950220887917, 0.4902067111479924, 0.4961460340659207, 0.4977474633246664, 0.4949782740709857, 0.4925889375015259, 0.4906451477362695,  0.4891628332671372, 0.4880589755764653, 0.4873303205106824, 0.4869755787235325 ))

  expect_equal(c(result$V_t_d_s),
               c( 0.0011007577913296656, -0.0001733451115550633, -0.0001733451115550633, 0.0004392322044566420, 0.0682991240249047060, 0.0003834452042018443,  0.0003834452042018442, 0.0029230271218272539, 0.0912395007549733350, -0.0003397914632747466, -0.0003397914632747466, 0.0052119615712443315,  0.0932049749695377378, -0.0016092541197089715, -0.0016092541197089711, 0.0073429567284740965, 0.0849686813506122934, -0.0030571106681653009, -0.0030571106681653005, 0.0093460739808944281, 0.0774928836229536178, -0.0044064881508436658, -0.0044064881508436658, 0.0112576788942480542,  0.0625786071371585012, -0.0058040178177705924, -0.0058040178177705924, 0.0131038581718835520, 0.0663037854506360463, -0.0066152078662832037, -0.0066152078662832037, 0.0149859903532218054, 0.0802636516361565355, -0.0072606054091964422, -0.0072606054091964422, 0.0169064138433351260,  0.0925945303565963995, -0.0077694160284284882, -0.0077694160284284891, 0.0188521666403896025, 0.1028653949187706279, -0.0082893243691400179, -0.0082893243691400196, 0.0208108298970566402, 0.1134521022635953669, -0.0087341231657698665, -0.0087341231657698665, 0.0227878464846351519,  0.1282127482321499812, -0.0091281359070864241, -0.0091281359070864224, 0.0247818173504978020, 0.1412262999503804406, -0.0096021138204995977, -0.0096021138204995960, 0.0267801536095240260, 0.1518039844431364749, -0.0100679733114127437, -0.0100679733114127437, 0.0287860644548110257,  0.1503781552817381462, -0.0107654864975719258, -0.0107654864975719258, 0.0307850681462566306, 0.1529892913432942814, -0.0114268209514253039, -0.0114268209514253039, 0.0328022104304094425, 0.1623989951758836869, -0.0119988254560485837, -0.0119988254560485837, 0.0348470071785677502,  0.1751405465177472420, -0.0124767948762201323, -0.0124767948762201323, 0.0369196593146410082, 0.1826262222670714253, -0.0130763410888457762, -0.0130763410888457762, 0.0390042849193854013, 0.1921213871302026865, -0.0136031573461606395, -0.0136031573461606395, 0.0411148217076838310,  0.1952137792451406062, -0.0142700820537257390, -0.0142700820537257390, 0.0432374522277687856, 0.2045009115946196943, -0.0150037228119862687, -0.0150037228119862670, 0.0453817496599724785, 0.2197992615605408318, -0.0156403530269492337, -0.0156403530269492302, 0.0475580384562985375,  0.2351742387248771660, -0.0163387197002041323, -0.0163387197002041323, 0.0497535112080704153, 0.2471786691448959739, -0.0171983898818672161, -0.0171983898818672196, 0.0519599789846230259, 0.2633406508519972045, -0.0179758501250396573, -0.0179758501250396607, 0.0541928396098181331,  0.2783570585162779554, -0.0187578421049752302, -0.0187578421049752336, 0.0564447233177911220, 0.2898617445280329274, -0.0196256986326030711, -0.0196256986326030711, 0.0587095922537396175, 0.3070089074201384216, -0.0202566671302706752, -0.0202566671302706752, 0.0610078966170546910,  0.3265517822464923947, -0.0207566923998554545, -0.0207566923998554545, 0.0633316746524540397, 0.3468613597848555496, -0.0211777326575118136, -0.0211777326575118136, 0.0656762424587988280, 0.3669330349624608245, -0.0215496836790728778, -0.0215496836790728778, 0.0680384930107222063,  0.3859999570458617635, -0.0218930814893318545, -0.0218930814893318545, 0.0704161786213701735, 0.4033580584084034970, -0.0222249753911356145, -0.0222249753911356145, 0.0728075543038044365, 0.4182756228156945255, -0.0225620115551172298, -0.0225620115551172298, 0.0752111771525787870,  0.4299395711487184468, -0.0229222709068044872, -0.0229222709068044872, 0.0776257813361121429, 0.4374185315654753881, -0.0233265169857653290, -0.0233265169857653290, 0.0800501930267311507, 0.4389396398028437285, -0.0237873509608388274, -0.0237873509608388274, 0.0824839842388029043,  0.4444370473634537966, -0.0241089985969926528, -0.0241089985969926528, 0.0849399776770060483, 0.4705099679725334716, -0.0239711015900734327, -0.0239711015900734327, 0.0874386019174675511, 0.5127677482774826156, -0.0234537793009185619, -0.0234537793009185619, 0.0899729190136854540,  0.5710035270105234817, -0.0225390051857156867, -0.0225390051857156867, 0.0925406272428825755, 0.6422966612793774566, -0.0213827332568293886, -0.0213827332568293886, 0.0951287192064125264, 0.7296350793987446126, -0.0198916154467032036, -0.0198916154467032036, 0.0977389611802057523,  0.8366982297826955906, -0.0179580979280018482, -0.0179580979280018482, 0.1003735699436583140 ))

  expect_equal(c(result$lag_one_cor),
               c( 0.0006319914823851234, -0.0001813450353835426, -0.0002126117899357636, 0.0004231047677557611, 0.0374926594959537965, -0.0005380017294018889, -0.0005485720017780360, 0.0027985731084827336, 0.0481658093802995874, -0.0016000013589881627, -0.0015949751696787691, 0.0050048137282718962,  0.0456878855983472026, -0.0029587363809467785, -0.0029189483751894322, 0.0070703673493283329, 0.0396604087798715019, -0.0043033008270456190, -0.0042589644753056816, 0.0090269214295090917, 0.0312294200116858406, -0.0056445383104769611, -0.0055052058435728288, 0.0109053718415916372,  0.0277604858121243067, -0.0066868592103896726, -0.0065493515470886115, 0.0127664150516888786, 0.0339237983194087267, -0.0074374459108181770, -0.0074140515313897131, 0.0146609784134950454, 0.0440622779829562689, -0.0081876860923845354, -0.0080158162771978795, 0.0165879425442369867,  0.0532613145041970354, -0.0087846810550449832, -0.0085842409359943670, 0.0185356890963747287, 0.0620030758351880484, -0.0093425048092310777, -0.0091025684196418474, 0.0204997891156617623, 0.0728513701255290580, -0.0097823345080032802, -0.0096128728534951753, 0.0224819052110776137,  0.0852163441699832769, -0.0102462632327539986, -0.0101088730406997656, 0.0244754314202132520, 0.0959330788853532263, -0.0107781511795978276, -0.0105860202161019556, 0.0264754322364910526, 0.1002061921916009707, -0.0114127390024465029, -0.0111391949292140822, 0.0284766937737128793,  0.1007636418466745787, -0.0120573912090688583, -0.0118570640836160000, 0.0304836792486671525, 0.1062366995263799574, -0.0126455551196479089, -0.0125325810037256995, 0.0325131894616143557, 0.1164479435890595910, -0.0131968007123752003, -0.0130824399573795571, 0.0345702739070011394,  0.1259739156939710947, -0.0137649784666452300, -0.0136274381705102868, 0.0366477215003125287, 0.1339397670426479281, -0.0143510749271825982, -0.0141996145156178810, 0.0387441154191005901, 0.1399397952275374390, -0.0149739632061277085, -0.0147895226744024933, 0.0408598614778161312,  0.1457693177465160805, -0.0155839512939056103, -0.0155955638120855878, 0.0429925035951635587, 0.1573951226983123508, -0.0162626012661845898, -0.0163227628857992857, 0.0451516935211992362, 0.1720884528462469087, -0.0169267713220890778, -0.0170279042024082637, 0.0473366336214868441,  0.1853207193021612631, -0.0176966192481461081, -0.0178397971217273306, 0.0495369101392598918, 0.1988822844190729910, -0.0185218493681163360, -0.0186795043672042492, 0.0517557651622434362, 0.2140265293846420891, -0.0193324169287155505, -0.0194536391053007109, 0.0539974391987324484,  0.2269743551126637005, -0.0201775348081844191, -0.0202760450098242243, 0.0562552827877792691, 0.2408827346519127055, -0.0209761004349988504, -0.0210013621236798051, 0.0585361402693362204, 0.2587873461391665963, -0.0215840832784766519, -0.0215509137876134238, 0.0608464935722820149,  0.2783108156512931197, -0.0220822328593056443, -0.0219982908028953338, 0.0631800531920647668, 0.2981521380750243311, -0.0225129962129074074, -0.0223819658897505894, 0.0655329263193361600, 0.3174279954979510876, -0.0229027366724126047, -0.0227258619326826256, 0.0679024304099249548,  0.3354014001863034333, -0.0232710946107934427, -0.0230480112171346438, 0.0702865626215162104, 0.3513521643906739600, -0.0236355450370131226, -0.0233647677843556098, 0.0726837231452698296, 0.3645059125021066215, -0.0240139196073090484, -0.0236931428694739724, 0.0750925529047788837,  0.3739890959881940757, -0.0244259932862989082, -0.0240522839920852098, 0.0775118285517998884, 0.3784535347735979438, -0.0249012435710693411, -0.0244462789870596130, 0.0799407418619832999, 0.3819151740934059180, -0.0253026050600785556, -0.0248317275156184590, 0.0823853873046871965,  0.3973498624532323387, -0.0253572058863496402, -0.0249807749061207209, 0.0848621500522364069, 0.4309121681052292541, -0.0250169074096886247, -0.0246995171538831222, 0.0873779395067437042, 0.4804161596009360879, -0.0243022568530614422, -0.0240233709749064703, 0.0899281997898045693,  0.5444877914482062486, -0.0232369005433537522, -0.0230542772574000854, 0.0925054925093105329, 0.6230475261289992739, -0.0218919395921305972, -0.0217917741796725788, 0.0951040211830674886, 0.7194167882990079033, -0.0201652844689610457, -0.0201377013624211842, 0.0977257666720493107 ))

  # expect_equal(c(result$n_iter),
  #              c(274 ))

  expect_equal(c(result$Q),
               c(0.129221898731263357, 0.002475034806031055, 0.002475034806031055, 0.002645631948634509 ))

  expect_equal(c(result$Q_0),
               c( 0.0011007577913296656, -0.0001733451115550633, -0.0001733451115550633, 0.0004392322044566420 ))

  expect_equal(c(result$n_risk),
               c(96, 95, 91, 84, 78, 65, 53, 49, 46, 43, 39, 37, 36, 36, 33, 31, 30, 30, 25, 25, 23, 21, 21, 21, 20, 19, 19, 18, 18, 18, 18, 18, 18, 18, 18, 18, 17, 15, 14, 14, 14, 12, 12, 12, 11 ))

  expect_equal(c(result$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45 ))

  # expect_equal(c(result$hazard_func),
  #              c([[1]]function (eta) {    exp_ = exp(eta)    exp_/(1 + exp_)}<environment: 0x000000001fb07d38> ))
  #
  # expect_equal(c(result$hazard_first_deriv),
  #              c([[1]]function (beta, x_) {    exp_ = exp(beta %*% x_)    x_ * exp_/(exp_ + 1)^2}<environment: 0x000000001fb07d38> ))

  expect_equal(c(result$risk_set),
               c(NA ))

  expect_equal(c(result$order),
               c(1 ))

  expect_equal(c(result$F_),
               c(1, 0, 0, 1 ))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result$a_t_d_s), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result$V_t_d_s)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result$Q_0)), rep(c("(Intercept)", "group1"), 2))
})

result_exp = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1,
  n_max = 10^4, eps = 10^-4,
  a_0 = rep(0, 2), Q_0 = diag(1, 2),
  Q = diag(1e-3, 2),
  est_Q_0 = F,
  max_T = 30,
  id = head_neck_cancer$id, order_ = 1,
  verbose = F,
  model = "exponential"
)

# matplot(result_exp$a_t_d_s, type = "l")
# get_expect_equal(result_exp)

test_that("Result of exponential model on head_neck_data match previous results", {
  expect_equal(c(result_exp$a_t_d_s),
               c(-3.97670917333694840, -3.97674594528922842, -3.67822723844953225, -3.38186160670887448, -3.20803125783379928, -2.81150733914823459, -2.86991583304613229, -3.19339409542700414, -3.33884572499217747, -3.44488663489353897, -3.55468195135890896, -3.74276473988639058, -3.83879589030475188, -3.85491280083719179, -3.69206869970224005, -3.74688315457354149, -3.86422464743509453, -3.94733561401569233, -3.90529955776537419, -3.96708964150362231, -3.92627936981884496, -4.05352095843694382, -4.21056855197516100, -4.31870528617516136, -4.37554856865496156, -4.48030141196976395, -4.54582342572652021, -4.57305289422576866, -4.66140004517541939, -4.72082090785410191, -4.75069382389330297, 0.23643942429448270, 0.23642538963461671, 0.35119909608991445, 0.46549545046933199, 0.53138482409557175,  0.68486304659599784, 0.66299911692218005, 0.53892413086915458, 0.48510875095794093, 0.44552674674974957, 0.40424312760390879,  0.33246258946182772, 0.29654462841347456, 0.29181540205284756, 0.35597679374548952, 0.33497520088953925, 0.28981802576768462,  0.25819314969811624, 0.27468066357009663, 0.25112029063171620, 0.26699776975209677, 0.21721608197843270, 0.15629576896568312,  0.11412921530635921, 0.09164410510332197, 0.05109346037346890, 0.02559506518920458, 0.01479926108810842, -0.01912463326287420, -0.04194359001789783, -0.05341608209319967 ))

  expect_equal(c(result_exp$V_t_d_s),
               c( 0.1832051868721281673, 0.0278848469490704347, 0.0278848469490704381, 0.0803177213322829875, 0.1132034251783800571, -0.0002825347413270007, -0.0002825347413270007, 0.0681138636429205468, 0.1057893643022574104, -0.0037108490430141639, -0.0037108490430141639, 0.0657813363200184242, 0.0933234388646140278, -0.0089983708866558654, -0.0089983708866558654,  0.0628183664969049760, 0.0788715600332714067, -0.0155162728380365406, -0.0155162728380365128, 0.0592778241516741244,  0.0734428605985888855, -0.0165822472363131579, -0.0165822472363131579, 0.0587135297616458440, 0.0591657019120934505, -0.0217911346933305147, -0.0217911346933305217, 0.0563985065119824158, 0.0614045817202078167, -0.0201269492208758713, -0.0201269492208758713, 0.0571887451287438134, 0.0723425094484046460, -0.0145208873097363092, -0.0145208873097363092,  0.0599501350321204399, 0.0803567973399948177, -0.0104885005098428984, -0.0104885005098429001, 0.0620705206328553000,  0.0869387047105238953, -0.0071134417298352650, -0.0071134417298352659, 0.0640036899753111677, 0.0939937589466598167, -0.0034894844498765754, -0.0034894844498765763, 0.0661485628168010653, 0.1056352965671321503, 0.0018561382382013911,  0.0018561382382013894, 0.0690194618275779270, 0.1154879277980833396, 0.0062299728951861078, 0.0062299728951861026,  0.0714630155033750963, 0.1222252055365240092, 0.0092166054186206374, 0.0092166054186206409, 0.0733443351545733369,  0.1171870821646983502, 0.0074167417118372499, 0.0074167417118372429, 0.0733164859929927581, 0.1186200073373010061,  0.0080962739829031592, 0.0080962739829031558, 0.0742920260983656322, 0.1267252242886504343, 0.0113714342440382615,  0.0113714342440382511, 0.0763302459132520761, 0.1368320431509568169, 0.0154106707763921706, 0.0154106707763921637,  0.0787023904830222026, 0.1418229945213846377, 0.0173294366900338045, 0.0173294366900338011, 0.0802302232935526993,  0.1484277775914494280, 0.0199114476530654755, 0.0199114476530654685, 0.0820632817930946612, 0.1488018943776022174,  0.0200040322972981702, 0.0200040322972981771, 0.0829277355347014244, 0.1570037340272072146, 0.0229661973712110210,  0.0229661973712110210, 0.0848786434078876301, 0.1710859655268716084, 0.0282664666087455024, 0.0282664666087455094,  0.0877901216774502752, 0.1865428085371889089, 0.0340275035065738946, 0.0340275035065738946, 0.0908764893254096623,  0.2014834476666247376, 0.0394535520998959832, 0.0394535520998959902, 0.0938003636583288197, 0.2229019052396607470,  0.0473425660283096975, 0.0473425660283097044, 0.0976811265666991113, 0.2487790398587779450, 0.0569349094050815366,  0.0569349094050815435, 0.1022282780020242754, 0.2799374204675383337, 0.0684956253291079536, 0.0684956253291079675,  0.1075214163665750289, 0.3289519028931106037, 0.0869897747611888261, 0.0869897747611888261, 0.1155225124818885507,  0.3996377264490825754, 0.1138172549902054936, 0.1138172549902054936, 0.1267411842245389220 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.1031151556577854234, -0.0025673007890856248, -0.0041177019347565513, 0.0671738953591519139, 0.0729285502330940805, -0.0153665974737224043, -0.0163223793842787457, 0.0611807158610895852, 0.0644065921154819421, -0.0192288355867880623, -0.0200771554947000441, 0.0587459567274195293, 0.0535427330021189529, -0.0239158942554452691, -0.0251883169614478958,  0.0558824984363825716, 0.0464796572600867930, -0.0275860737664426203, -0.0268684891017166583, 0.0542637414978720672,  0.0392122788902791175, -0.0294064481771485198, -0.0293297471017429506, 0.0532084301672932219, 0.0356480065351482064, -0.0305448770356387816, -0.0298416548856658831, 0.0528117325314924682, 0.0391007556490918923, -0.0284712115615889730, -0.0270759696825927688, 0.0541164525517244047, 0.0455860098549121379, -0.0246247696130386419, -0.0236000239726060282,  0.0561089074393790813, 0.0509999785363083741, -0.0216239631152422562, -0.0206527528940453828, 0.0578530091473455632,  0.0562916820073403254, -0.0187677945664524483, -0.0176931041764787911, 0.0596626970982066657, 0.0638551422142593222, -0.0149661074687492766, -0.0139066474561677852, 0.0619031698774247519, 0.0731667066769392804, -0.0105326229049919270, -0.0097298238679709072, 0.0643460593649873014, 0.0805695408224628151, -0.0071133009784132770, -0.0064778750491979904,  0.0663753078027907867, 0.0813318588316555291, -0.0064375392389208665, -0.0060344261003749443, 0.0672889043995953118,  0.0797084297205427755, -0.0069327416786996027, -0.0065228958987601513, 0.0677886978908447263, 0.0839155137757939540, -0.0051944934955948895, -0.0047410661895154194, 0.0692114369860178241, 0.0921739318284499620, -0.0018678257622304888, -0.0014075992625329978, 0.0712902662011879601, 0.0992140159350134720, 0.0009836567781669348, 0.0013068741186968123,  0.0731646605524272076, 0.1045839525483038546, 0.0030432240366696992, 0.0034174257987806232, 0.0747811495072748106,  0.1078806901256837703, 0.0043465972131570517, 0.0046400514000073771, 0.0761011970976562674, 0.1118466302783495819,  0.0058133786026677743, 0.0059801473520385215, 0.0774610865836157098, 0.1222694919469353436, 0.0096261272420231150,  0.0098751951619719461, 0.0797852602660696492, 0.1363267096938496348, 0.0149120552743186169, 0.0151021452356542747,  0.0826785580752974619, 0.1509511601798297353, 0.0203473430664968327, 0.0204124280247277787, 0.0855987685722870567,  0.1683981812721982996, 0.0267338143382507831, 0.0267771885593782767, 0.0888925354534749884, 0.1913172634181187770,  0.0351973298712989283, 0.0352340798926058796, 0.0929984973894393968, 0.2191117948941448679, 0.0455237478712123000,  0.0455043952847125482, 0.0978116210372377975, 0.2579818125849921984, 0.0600511874735620288, 0.0600949580273164030,  0.1042783059265411510, 0.3163625819533421035, 0.0821479346489345230, 0.0821887053999010020, 0.1136704668433825699 ))

  expect_equal(c(result_exp$n_iter),
               c(66 ))

  expect_equal(c(result_exp$Q),
               c(0.09946932732012863, 0.03783300224988726, 0.03783300224988726, 0.01543663831742442 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))
})

test_that("poisson model and logit moels hazzard functions differs", {
  expect_true(result_exp$model != result$model)
  expect_true(toString(body(result_exp$hazard_func)) !=
                toString(body(result$hazard_func)))
  expect_true(toString(body(result_exp$hazard_first_deriv)) !=
                toString(body(result$hazard_first_deriv)))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result_exp$a_t_d_s), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result_exp$V_t_d_s)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result_exp$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result_exp$Q_0)), rep(c("(Intercept)", "group1"), 2))
})


# Change by argument
result_exp = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 2,
  n_max = 10^4, eps = 10^-4,
  a_0 = rep(0, 2), Q_0 = diag(1, 2),
  Q = diag(1e-3, 2),
  est_Q_0 = F,
  max_T = 30,
  id = head_neck_cancer$id, order_ = 1,
  verbose = F,
  model = "exponential"
)

# matplot(result_exp$a_t_d_s, type = "l")
# get_expect_equal(result_exp)

test_that("Result of exponential model on head_neck_data match previous results with altered by argument", {
  expect_equal(c(result_exp$a_t_d_s),
               c(-3.66470254910492965, -3.66474706370252523, -2.76810021608623336, -2.37016905577829462, -2.88527701004363868, -3.09784986345455149, -3.48266257367868359, -3.53409599869474356, -3.50452999032306378, -3.68733386046285716, -3.75440297910365439, -3.92931420996290637, -4.13536817561038994, -4.31353242824072147, -4.29415086207046315, -4.44742781342733640, 0.14460881063442274, 0.14458966333745016,  0.54220314703993744, 0.71686313456859296, 0.48814165025303158, 0.39660025957471889, 0.22674612731683766, 0.20698865962895394,  0.22015367692421495, 0.13937097843449658, 0.10943794134073426, 0.02931587668643268, -0.06355936873028328, -0.14352365432290462, -0.13606103184196280, -0.20391357029043852 ))

  expect_equal(c(result_exp$V_t_d_s),
               c( 0.2239954769849443750, 0.0655923866343257334, 0.0655923866343257472, 0.0856850342803099352, 0.0701094856476841277, -0.0038922715688509135, -0.0038922715688509135, 0.0523721592627481858, 0.0755056468311222084, -0.0019795481071096244, -0.0019795481071096105, 0.0514742546248752875, 0.0459893287640510268, -0.0168002899428832814, -0.0168002899428832814,  0.0428520247345924449, 0.0395383065657095717, -0.0176668807846101159, -0.0176668807846101159, 0.0427380304585478071,  0.0554849050799214386, -0.0083268844417649975, -0.0083268844417650027, 0.0482405628816991311, 0.0685881166264916964, -0.0008915346260135876, -0.0008915346260135910, 0.0530967481749607603, 0.0917314760624167724, 0.0105768571207504984,  0.0105768571207505019, 0.0598970756325017256, 0.1029505276277184328, 0.0162964559289216979, 0.0162964559289216944,  0.0641352931380022306, 0.1037258639501149188, 0.0164485880804922657, 0.0164485880804922657, 0.0656497098810895630,  0.1265921801941821134, 0.0268701800644146269, 0.0268701800644146269, 0.0721116488290027280, 0.1394313143521199172,  0.0328068306908046725, 0.0328068306908046725, 0.0766830420360093551, 0.1583797329998488101, 0.0408462387555405329,  0.0408462387555405260, 0.0820262021138331576, 0.1897619001198406763, 0.0541928541421161369, 0.0541928541421161369,  0.0897223868891949550, 0.2404909896530670887, 0.0760800199433048219, 0.0760800199433048219, 0.1012582172983322176,  0.3106678049553517895, 0.1062117278334599041, 0.1062117278334599041, 0.1163272984336688326 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 0.0581028385172765310, -0.0072444734259627663, -0.0091541950837004671, 0.0507854295613683060, 0.0305719789171202405, -0.0205541704126560032, -0.0217954718525925212, 0.0429534684036514680, 0.0256335909301954809, -0.0232916444899874189, -0.0256021168272291474, 0.0396164859822722010, 0.0217562109295342289, -0.0268049576003472970, -0.0251706803089071125,  0.0380668354484768462, 0.0208436994532727946, -0.0254916865534527692, -0.0231220640448812874, 0.0396078590805537395,  0.0243612892264773936, -0.0218239875294321505, -0.0198641722726530523, 0.0425826594850195056, 0.0314033017870680442, -0.0171719045857336335, -0.0155045036084438571, 0.0462019832669743127, 0.0410358093169969629, -0.0117507577680532344, -0.0104671739924645686, 0.0502204627419419736, 0.0447135283650619969, -0.0094214520125273163, -0.0089886987863954937,  0.0526366994782183420, 0.0519460678887981378, -0.0064314589218757625, -0.0054966721024843051, 0.0557115478144272411,  0.0648237411726153845, -0.0004605667099179742, 0.0004626102810896780, 0.0602421445696742427, 0.0767237353479582607,  0.0050357523477366044, 0.0053979315269180438, 0.0644122809169798000, 0.0966036776555502241, 0.0134711383782364705,  0.0136579634961798840, 0.0698906297153868428, 0.1309471159607265567, 0.0281201853999506271, 0.0282851940496364022,  0.0781842396764870357, 0.1847772952660913237, 0.0513669286489622026, 0.0511865485567550155, 0.0901853413511809893 ))

  expect_equal(c(result_exp$n_iter),
               c(24 ))

  expect_equal(c(result_exp$Q),
               c(0.11112544355142200, 0.04881121798770979, 0.04881121798770979, 0.02253873603135799 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))
})

set.seed(3787)
sims <- test_sim_func_logit(n_series = 5e2, n_vars = 3, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = -.5, re_draw = T, beta_start = 0,
                            intercept_start = -4, sds = c(.1, rep(1, 3)))

test_that("Chaning time scale in EKF does no change results when other parems are changed accoridngly",{
  for(m in c("logit")){
    arg_list <- list(formula = survival::Surv(tstart, tstop, event) ~ . - tstart - tstop - event - id,
                     by = 1,
                     data = sims$res,
                     a_0 = rep(0, ncol(sims$res) + 1 - 4),
                     Q_0 = diag(rep(1e2, ncol(sims$res) + 1 - 4)),
                     Q = diag(rep(1e-3, ncol(sims$res) + 1 - 4)),
                     est_Q_0 = F, method = "EKF",
                     model = m,
                     eps = 1e-2, id = sims$res$id,
                     verbose = F,
                     max_T = 10)

    res <- do.call(ddhazard, arg_list)

    sim_tmp <- sims
    t_mult <- 2.5
    sim_tmp$res$tstart <- sim_tmp$res$tstart * t_mult
    sim_tmp$res$tstop <- sim_tmp$res$tstop * t_mult
    arg_list$data <- sim_tmp$res
    arg_list$by <- t_mult
    arg_list$max_T <- arg_list$max_T * t_mult
    arg_list$Q <- arg_list$Q / t_mult

    res_new_time <- do.call(ddhazard, arg_list)

    expect_equal(res$a_t_d_s, res_new_time$a_t_d_s)
    expect_equal(res$V_t_d_s, res_new_time$V_t_d_s)
    expect_equal(res$Q, res_new_time$Q * t_mult)
  }
})

set.seed(93143)
sims <- test_sim_func_exp(n_series = 1e4, n_vars = 10, t_0 = 0, t_max = 10,
                          x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                          intercept_start = -5, sds = c(.1, rep(1, 10)))
sum(sims$res$event)

tmp_file <- file("exponential.log")
sink(tmp_file)
result_exp = ddhazard(
  formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
  data = sims$res,
  by = (by_ <- 1),
  n_max = 10^4, eps = 10^-2,
  a_0 = rep(0, 11),
  Q_0 = diag(100, 11),
  Q = diag(1e-3, 11),
  est_Q_0 = F,
  max_T = 10,
  id = sims$res$id, order_ = 1,
  verbose = F,
  model = "exponential"
)
sink()
close(tmp_file)

matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
matplot(result_exp$times, result_exp$a_t_d_s, result_exp$a_t_d_s, type = "l", lty = 2, add = T)

# get_expect_equal(result_exp, eps = 1e-2)

test_that("Result of exponential model on simulated data match previous results", {
  expect_equal(c(result_exp$a_t_d_s),
               c(-4.640261978515770380, -4.640244181685317493, -4.550951246033809738, -4.615228015321692467, -4.590296084456985781, -4.484059280027002714, -4.621158014708739437, -4.770110108011726524, -4.834311424748139352, -4.420099623192836447, -4.522825984856091885, 0.108425377301966275, 0.108553768564894737, -0.575213110525437665,  0.791133588987352088, 0.462288338747684102, 0.741225680870037817, 1.662558067376042725, 1.218667704169605681, 0.519893472472603757, 1.520925151024878019,  1.342384482771110887, -0.980898185277488621, -0.980894090869608992, -1.362670601073167065, -1.944672584272375548, -0.896117376001955956, -0.796808397791318068, -1.112935810853991958, -0.841809194442044606, -0.550394733091957744, -0.642641884870657987, -0.618161327923994697, -0.754111489875337604, -0.754086273571152432, -0.788740816057885819, -0.557414640203113376, 0.415777268160807345, 0.321195519610082136, 1.462242493734478455, 0.484126413909661879, -0.193180520026783153, -0.653770384878356481, -0.382722264413435265, 0.153962020212084272, 0.154100508966561939, -0.445278336885723047, 0.006289431863115376, -0.569011083404321716, -2.274386566411771948, -2.093912481188263897, -2.649421466700275118, -2.805926539855151614, -2.278261803211085290, -2.186840569474209683, -0.410262734340380408, -0.410135407085132020, -1.147938793154573700, 0.438469844393669705, 0.988662671321869579, 1.612741718345614306, 1.853865603910920923, 1.765018041612740785,  1.396763562649738777, 2.527741649675111724, 2.916154027111489189, 0.455195153120891371, 0.455367171141842109, -0.344967318592491690, 0.433095849136348132, -0.852287530519399761, -2.126258196909984743, -1.160754897317828549, -2.030656324626341380, -2.659600442346614635, -1.697470983262121091, -2.300769255620437992,  1.213867684476706454, 1.213623963629338443, 2.785707382323734382, 3.081245642247386840, 3.824782794055305857, 6.857293724852953964, 6.642474405426902706,  7.319109734560758085, 7.225612618957277355, 6.277816785319455306, 6.783195750906767962, 1.054885706453845495, 1.055025041955989895, 1.243077587015672059,  2.275031105413058086, 1.092399615624070730, -2.086861446484433280, -2.179930252933363732, -3.375049625818335564, -3.546934354451944049, -3.416849300995075556, -2.345620631488134933, 1.580250865265970139, 1.580214118869211815, 2.679439239107713533, 3.983698599244573479, 3.296552054026672174, 2.813558332508257820,  2.543035350989208077, 2.202313543841131427, 2.042591573468953925, 1.749811115835363751, 3.033328363338057443, 0.466780802824050045, 0.466835108122040765,  0.479034923802600487, 0.173421772118889761, -0.192319568729860002, -2.240500958540326160, -2.053487156521384360, -2.887349112308779997, -2.926128967879956910, -3.318063760955118013, -3.077938737332664765 ))

  expect_equal(c(result_exp$V_t_d_s),
               c( 5.051643757704483e-02, 5.942918204412925e-02, -5.156001273866700e-03, -9.039046395833571e-03, 1.287783444892044e-02, 5.486424938552213e-02, 5.659762502737632e-02, -3.205615131861359e-02, -3.108103566239839e-02, -4.162302336771092e-02, -3.236088454368444e-02, 5.942918204412924e-02, 4.983331468651784e-01, -9.008137877755452e-02,  2.120506433270436e-01, 1.918297805536328e-01, 4.619265525998669e-01, 4.087505911022891e-01, -1.926796862907763e-01, 1.430064315167688e-01, 3.021567386705483e-02, -4.859488523644877e-02, -5.156001273866702e-03, -9.008137877755459e-02, 1.599924543229037e-01, -2.032498368168509e-02, -9.999399849165738e-02, 1.831083901780822e-02, -1.911491639516520e-01, 6.727883245266118e-02, -2.730215578191694e-01, -1.901212783022463e-01, -1.093744898527294e-01, -9.039046395833569e-03, 2.120506433270435e-01, -2.032498368168508e-02, 4.872569964874742e-01, 5.868891877455815e-02, 1.320588874595172e-01, 1.613930314336726e-01, -2.189119659079541e-03, 1.139281430435439e-01,  3.797843177899431e-02, 1.312206765098778e-01, 1.287783444892045e-02, 1.918297805536330e-01, -9.999399849165741e-02, 5.868891877455819e-02, 5.256031913599486e-01,  7.346655306852030e-02, 5.600969695855170e-01, -8.571522907284939e-01, 8.505122243577254e-01, 1.248872156061479e-01, 4.571131587352101e-01, 5.486424938552214e-02,  4.619265525998671e-01, 1.831083901780820e-02, 1.320588874595174e-01, 7.346655306852035e-02, 6.706111410782967e-01, 1.373806540041739e-01, 6.899396581505618e-02, -1.790266718235523e-02, 1.033098872574815e-01, -2.451888148858303e-01, 5.659762502737630e-02, 4.087505911022892e-01, -1.911491639516520e-01, 1.613930314336727e-01,  5.600969695855169e-01, 1.373806540041739e-01, 8.270629543466868e-01, -9.377507506370846e-01, 7.742956954071192e-01, 7.798462435821634e-03, 4.334477031285286e-01, -3.205615131861360e-02, -1.926796862907763e-01, 6.727883245266118e-02, -2.189119659079523e-03, -8.571522907284936e-01, 6.899396581505618e-02, -9.377507506370845e-01,  1.658839028808742e+00, -1.205811441289846e+00, 1.355569492409940e-01, -7.832260180050972e-01, -3.108103566239840e-02, 1.430064315167688e-01, -2.730215578191694e-01,  1.139281430435439e-01, 8.505122243577250e-01, -1.790266718235522e-02, 7.742956954071191e-01, -1.205811441289846e+00, 1.791219024063722e+00, 6.482669714528756e-01,  9.161430586389090e-01, -4.162302336771091e-02, 3.021567386705483e-02, -1.901212783022464e-01, 3.797843177899429e-02, 1.248872156061480e-01, 1.033098872574815e-01,  7.798462435821623e-03, 1.355569492409940e-01, 6.482669714528755e-01, 6.616462992264900e-01, 1.713090406442696e-01, -3.236088454368444e-02, -4.859488523644882e-02, -1.093744898527294e-01, 1.312206765098778e-01, 4.571131587352100e-01, -2.451888148858303e-01, 4.334477031285286e-01, -7.832260180050971e-01, 9.161430586389091e-01,  1.713090406442696e-01, 6.262661878417219e-01, 5.822525050812963e-03, 1.246310392734256e-04, 3.606388993478506e-03, 1.547663872374520e-03, -2.697531270703699e-04,  1.783107030701239e-03, -1.792833087300044e-04, -3.425002153126790e-03, -4.534986540423567e-03, -6.778539205157014e-03, -1.118175050657472e-03, 1.246310392734217e-04,  2.274628606727648e-02, -6.146935036942879e-03, 6.372531160859314e-03, 2.858338845967784e-03, 1.356949244456828e-02, 1.397553767997168e-02, 3.860601179193414e-04, -3.174299960878621e-03, 7.486902561143936e-04, -6.522873910607157e-03, 3.606388993478505e-03, -6.146935036942911e-03, 1.949665288097934e-02, 3.192498307675355e-03,  2.005217360372431e-03, 8.314570322294330e-03, -1.212514724841360e-02, -6.564971373666404e-03, -1.171978531346817e-03, -8.160029039424211e-03, 4.246311732000212e-04,  1.547663872374522e-03, 6.372531160859340e-03, 3.192498307675351e-03, 4.304255881642122e-02, -1.855459920730612e-03, 1.114077001886670e-03, 1.887002934833766e-03,  5.371005550260327e-03, -5.761519528346933e-04, -2.522906462289490e-03, 1.004246855960648e-02, -2.697531270703663e-04, 2.858338845967825e-03, 2.005217360372400e-03, -1.855459920730603e-03, 1.211354974630368e-02, 4.068920825797993e-03, 4.879014135850953e-03, -1.133074159425686e-02, 9.434913399861860e-03, 2.696582713448031e-04,  2.974881360592834e-03, 1.783107030701240e-03, 1.356949244456828e-02, 8.314570322294317e-03, 1.114077001886685e-03, 4.068920825798018e-03, 3.713318718239209e-02, -2.773948233824520e-03, -1.214079247517566e-03, 2.159385155868745e-03, 3.591437932503925e-03, -9.805905988455606e-03, -1.792833087300055e-04, 1.397553767997163e-02, -1.212514724841362e-02, 1.887002934833787e-03, 4.879014135851008e-03, -2.773948233824501e-03, 2.815797730754618e-02, -7.650858473442158e-03, 5.748958590002898e-04, -5.619612109377985e-03, 1.837384944484260e-03, -3.425002153126792e-03, 3.860601179193169e-04, -6.564971373666393e-03, 5.371005550260346e-03, -1.133074159425687e-02, -1.214079247517561e-03, -7.650858473442147e-03, 3.644840114639691e-02, -7.673299756655458e-03, 1.200785461301928e-02, -6.992613489559443e-03, -4.534986540423570e-03, -3.174299960878607e-03, -1.171978531346790e-03, -5.761519528347039e-04, 9.434913399861794e-03, 2.159385155868753e-03, 5.748958590002873e-04, -7.673299756655456e-03,  3.215139953533569e-02, 1.672258178519769e-02, 1.148296007114299e-02, -6.778539205157012e-03, 7.486902561143967e-04, -8.160029039424250e-03, -2.522906462289501e-03,  2.696582713449064e-04, 3.591437932503923e-03, -5.619612109377998e-03, 1.200785461301928e-02, 1.672258178519765e-02, 3.189086932024029e-02, 1.761094447361922e-04, -1.118175050657474e-03, -6.522873910607196e-03, 4.246311732000129e-04, 1.004246855960650e-02, 2.974881360592892e-03, -9.805905988455592e-03, 1.837384944484285e-03, -6.992613489559400e-03, 1.148296007114297e-02, 1.761094447361414e-04, 1.784933147583868e-02, 4.872105816591045e-03, 2.906395641826174e-04, 2.790164871851751e-03,  9.732400830302306e-04, -2.213120568143507e-04, 1.127132506781673e-03, 2.446949939643440e-04, -2.533627019282727e-03, -3.654086950106356e-03, -5.725152631032307e-03, -1.159516396127354e-03, 2.906395641826137e-04, 2.008783663469245e-02, -4.918102761116960e-03, 5.950673778864990e-03, 2.705776707270546e-03, 1.259878804402633e-02,  1.228200767791711e-02, -2.235096188877967e-05, -2.565053094651304e-03, 2.588747683962320e-04, -5.635425611620053e-03, 2.790164871851746e-03, -4.918102761116968e-03,  1.595271051541385e-02, 2.045091505875569e-03, 1.523984241060136e-03, 7.069070983017502e-03, -9.942992170707854e-03, -5.274978115873177e-03, -1.145927631384376e-03, -6.442723182918126e-03, 6.881492445054259e-05, 9.732400830302338e-04, 5.950673778865009e-03, 2.045091505875567e-03, 3.776386497763448e-02, -1.432514576134574e-03,  1.081000803270360e-03, 2.155489100074462e-03, 5.171106912057594e-03, 5.703298590517692e-04, -1.040668981274233e-03, 9.144358570576293e-03, -2.213120568143405e-04,  2.705776707270564e-03, 1.523984241060125e-03, -1.432514576134575e-03, 1.061524448502879e-02, 3.772269727352754e-03, 4.645052464751241e-03, -1.023276088431720e-02,  8.525763252465374e-03, 3.115688355664480e-04, 2.881655429556719e-03, 1.127132506781673e-03, 1.259878804402628e-02, 7.069070983017487e-03, 1.081000803270378e-03,  3.772269727352779e-03, 3.295526619932175e-02, -2.122129744923451e-03, -8.003190066984517e-04, 1.994205191441988e-03, 3.636694769842761e-03,
                  -9.005965659919381e-03,  2.446949939643400e-04, 1.228200767791706e-02, -9.942992170707862e-03, 2.155489100074483e-03, 4.645052464751261e-03, -2.122129744923446e-03, 2.459166606656191e-02, -7.758619680957048e-03, 5.957164487173107e-04, -5.665529677842163e-03, 1.840660300476594e-03, -2.533627019282724e-03, -2.235096188878504e-05, -5.274978115873167e-03,  5.171106912057603e-03, -1.023276088431726e-02, -8.003190066984447e-04, -7.758619680957046e-03, 3.220652337224510e-02, -6.747471913919054e-03, 1.102439781336088e-02, -6.305346494976305e-03, -3.654086950106360e-03, -2.565053094651292e-03, -1.145927631384336e-03, 5.703298590517513e-04, 8.525763252465304e-03, 1.994205191442007e-03,  5.957164487173380e-04, -6.747471913919073e-03, 2.895724216110417e-02, 1.547264423186098e-02, 1.060206651208256e-02, -5.725152631032305e-03, 2.588747683962337e-04, -6.442723182918154e-03, -1.040668981274226e-03, 3.115688355665194e-04, 3.636694769842744e-03, -5.665529677842185e-03, 1.102439781336090e-02, 1.547264423186098e-02,  2.847074377386326e-02, 6.450118949348331e-04, -1.159516396127361e-03, -5.635425611620105e-03, 6.881492445052524e-05, 9.144358570576300e-03, 2.881655429556812e-03, -9.005965659919355e-03, 1.840660300476622e-03, -6.305346494976251e-03, 1.060206651208249e-02, 6.450118949348524e-04, 1.601063999714463e-02, 4.921477762226758e-03,  1.504697197402709e-03, 2.272658088872261e-03, 5.557672731847899e-04, 1.059029083575350e-03, 2.247018804897072e-03, 2.082155981436648e-03, -5.056553738643427e-03, -2.477135408705716e-03, -5.907979783108436e-03, -6.343774632343071e-04, 1.504697197402706e-03, 1.275202548601052e-02, -3.407359967123554e-03, 3.361466177948152e-03,  1.469220551272865e-03, 7.104136279493559e-03, 7.528969026724234e-03, 3.495848022163701e-04, -1.350268012482580e-03, 5.159855535315216e-04, -3.270574791630474e-03,  2.272658088872262e-03, -3.407359967123563e-03, 1.093691675334461e-02, 1.281309549840849e-03, 9.438697031900333e-04, 4.265430823800412e-03, -6.383345507165437e-03, -3.261741301300046e-03, -3.905238616544291e-04, -4.004873490923106e-03, 2.115310779332913e-04, 5.557672731847916e-04, 3.361466177948165e-03, 1.281309549840848e-03,  2.347427957764491e-02, -1.082098734153269e-03, 5.719496298792359e-04, 8.696632488030675e-04, 3.682750117996299e-03, 3.226651863518130e-04, -3.661037939267295e-04,  5.339409494368372e-03, 1.059029083575351e-03, 1.469220551272863e-03, 9.438697031900563e-04, -1.082098734153272e-03, 7.547036229195571e-03, 2.167466591972499e-03,  2.919838051080226e-03, -6.501819754701660e-03, 5.687249519547499e-03, 3.553633348620677e-04, 1.879506181947098e-03, 2.247018804897070e-03, 7.104136279493538e-03,  4.265430823800405e-03, 5.719496298792420e-04, 2.167466591972530e-03, 2.075200517396274e-02, -1.444137367344895e-03, -3.288165694147755e-04, 1.718667016169784e-03,  2.437556596235035e-03, -5.090581015068939e-03, 2.082155981436651e-03, 7.528969026724227e-03, -6.383345507165464e-03, 8.696632488030839e-04, 2.919838051080197e-03, -1.444137367344900e-03, 1.650640471453392e-02, -5.184836886398631e-03, 5.223703320897342e-04, -3.760691611379150e-03, 1.196439088617452e-03, -5.056553738643426e-03,  3.495848022163503e-04, -3.261741301300023e-03, 3.682750117996303e-03, -6.501819754701758e-03, -3.288165694147795e-04, -5.184836886398581e-03, 2.254193979057915e-02, -4.848342718690838e-03, 7.045592005802227e-03, -4.169278438031404e-03, -2.477135408705714e-03, -1.350268012482587e-03, -3.905238616544012e-04, 3.226651863518070e-04,  5.687249519547419e-03, 1.718667016169805e-03, 5.223703320897518e-04, -4.848342718690852e-03, 1.913662710320932e-02, 9.525558277238146e-03, 6.535714145659538e-03, -5.907979783108437e-03, 5.159855535315164e-04, -4.004873490923129e-03, -3.661037939267186e-04, 3.553633348621835e-04, 2.437556596235018e-03, -3.760691611379164e-03,  7.045592005802229e-03, 9.525558277238126e-03, 1.934711488797843e-02, 2.412054209715644e-04, -6.343774632343124e-04, -3.270574791630509e-03, 2.115310779332787e-04,  5.339409494368371e-03, 1.879506181947139e-03, -5.090581015068921e-03, 1.196439088617480e-03, -4.169278438031385e-03, 6.535714145659505e-03, 2.412054209715958e-04,  1.048488211985923e-02, 5.118259522279018e-03, -9.653503203068520e-04, 2.877901125415629e-03, 2.211190299183886e-04, -3.071223808067921e-05, -4.631559330426703e-04,  3.474437685563187e-04, -4.438747972773160e-03, -3.813194538973880e-03, -7.085897333640223e-03, -1.561245855822672e-04, -9.653503203068514e-04, 9.590268124657936e-03, -2.528966230883490e-03, 2.618973565448655e-03, 1.195979678026552e-03, 4.772800108488854e-03, 5.310486661202425e-03, 1.628280791979985e-04, -8.350011737819035e-04,  5.773755905046250e-04, -2.051940387848309e-03, 2.877901125415629e-03, -2.528966230883501e-03, 9.179264571461569e-03, 1.077637270473167e-03, 6.584167294326681e-04,  3.647358781489601e-03, -4.982074926965079e-03, -2.760401042555506e-03, -7.743034130281165e-04, -3.844906402676236e-03, -4.666454723325236e-05, 2.211190299183899e-04,  2.618973565448670e-03, 1.077637270473166e-03, 1.789508196604361e-02, -6.287469990597236e-04, 2.947266321714497e-04, 7.593512114605357e-04, 2.392271369901611e-03, -8.120664658704375e-05, -7.556923645581920e-04, 3.921380220497895e-03, -3.071223808068254e-05, 1.195979678026578e-03, 6.584167294326901e-04, -6.287469990597352e-04,  6.064445052219499e-03, 1.885285911365269e-03, 1.974138743633639e-03, -4.654936815143986e-03, 4.603072677925992e-03, 7.842383005973387e-04, 1.471947318103848e-03, -4.631559330426715e-04, 4.772800108488847e-03, 3.647358781489597e-03, 2.947266321714545e-04, 1.885285911365284e-03, 1.539054509285474e-02, -1.692846963482522e-03, -7.406756927201371e-04, 1.669153067758232e-03, 1.904530595552562e-03, -3.290305090320049e-03, 3.474437685563171e-04, 5.310486661202388e-03, -4.982074926965081e-03,  7.593512114605499e-04, 1.974138743633633e-03, -1.692846963482514e-03, 1.246067215798981e-02, -3.549693811508627e-03, 1.752991055071522e-04, -2.749341830538663e-03,  1.020292173857608e-03, -4.438747972773162e-03, 1.628280791979781e-04, -2.760401042555472e-03, 2.392271369901594e-03, -4.654936815144044e-03, -7.406756927201321e-04, -3.549693811508587e-03, 1.743299323025129e-02, -3.255002966011232e-03, 5.652874439003215e-03, -2.877524927570682e-03, -3.813194538973874e-03, -8.350011737819063e-04, -7.743034130281032e-04, -8.120664658704882e-05, 4.603072677925943e-03, 1.669153067758227e-03, 1.752991055071644e-04, -3.255002966011241e-03, 1.609283584189084e-02,  9.011721863184672e-03, 5.056090111124017e-03, -7.085897333640225e-03, 5.773755905046465e-04, -3.844906402676258e-03, -7.556923645581731e-04, 7.842383005974182e-04,  1.904530595552554e-03, -2.749341830538710e-03, 5.652874439003228e-03, 9.011721863184692e-03, 1.748137395112201e-02, 5.765392947916137e-04, -1.561245855822716e-04, -2.051940387848314e-03, -4.666454723326544e-05, 3.921380220497888e-03, 1.471947318103882e-03, -3.290305090320036e-03, 1.020292173857610e-03, -2.877524927570681e-03,  5.056090111124008e-03, 5.765392947916259e-04, 7.931933966310508e-03, 5.312568534964897e-03, -4.229287882903403e-04, 1.477867426392353e-03, -1.065535756239310e-03,  1.056235982127315e-03, -1.328487393342062e-03, 2.634033772723190e-03, -6.461255418320244e-03, -2.117869966665209e-03,
                  -6.625212849537857e-03, 5.923782029653364e-04, -4.229287882903407e-04, 1.047223455931472e-02, -2.771203552809143e-03, 2.870522498133028e-03, 1.376901843701019e-03, 5.906583316962845e-03, 6.341117890985727e-03, -6.111254490935580e-05, -8.472656254487010e-04, 3.949074461977857e-04, -2.409476224738251e-03, 1.477867426392351e-03, -2.771203552809137e-03, 9.599879894371388e-03,  1.535987800193434e-03, 6.119203749376310e-04, 4.086809137220981e-03, -5.906945103665957e-03, -3.128033359115683e-03, -1.147395847930163e-03, -4.147735462088793e-03, -6.663498066839678e-05, -1.065535756239310e-03, 2.870522498133017e-03, 1.535987800193432e-03, 1.933713582697150e-02, -6.095606137804365e-04, 5.417336935519513e-04,  6.664931690644291e-04, 2.399455063098231e-03, -9.880400108169249e-05, -1.043142021804182e-03, 4.484004862407450e-03, 1.056235982127315e-03, 1.376901843701036e-03,  6.119203749376491e-04, -6.095606137804606e-04, 5.851768984681183e-03, 2.210824850715944e-03, 2.398937228055964e-03, -5.303002179626257e-03, 4.602712809871130e-03,  4.745748470279027e-04, 1.515384628307933e-03, -1.328487393342063e-03, 5.906583316962829e-03, 4.086809137220988e-03, 5.417336935519521e-04, 2.210824850715946e-03,  1.718737423353454e-02, -1.800186719712530e-03, -9.810790016762350e-04, 1.661759355043525e-03, 2.069933713189821e-03, -4.111082427253829e-03, 2.634033772723189e-03,  6.341117890985725e-03, -5.906945103665956e-03, 6.664931690644242e-04, 2.398937228055949e-03, -1.800186719712542e-03, 1.432687983084042e-02, -4.579736308069240e-03,  4.437151774487481e-04, -3.035797991637801e-03, 1.143603633433472e-03, -6.461255418320246e-03, -6.111254490934973e-05, -3.128033359115670e-03, 2.399455063098225e-03, -5.303002179626319e-03, -9.810790016762424e-04, -4.579736308069232e-03, 1.931704521195584e-02, -3.269401041063856e-03, 6.967039447779651e-03, -3.157041805175443e-03, -2.117869966665206e-03, -8.472656254486944e-04, -1.147395847930158e-03, -9.880400108168052e-05, 4.602712809871063e-03, 1.661759355043517e-03, 4.437151774487390e-04, -3.269401041063893e-03, 1.625135219949742e-02, 9.479528913369346e-03, 5.196909642814286e-03, -6.625212849537857e-03, 3.949074461977798e-04, -4.147735462088814e-03, -1.043142021804186e-03, 4.745748470279703e-04, 2.069933713189823e-03, -3.035797991637809e-03, 6.967039447779665e-03, 9.479528913369346e-03, 1.790309942791838e-02,  4.596337092881025e-04, 5.923782029653348e-04, -2.409476224738260e-03, -6.663498066839717e-05, 4.484004862407460e-03, 1.515384628307976e-03, -4.111082427253833e-03,  1.143603633433478e-03, -3.157041805175432e-03, 5.196909642814300e-03, 4.596337092881139e-04, 8.210299469105092e-03, 3.861669174419954e-03, -5.700636249600854e-04,  6.835375164227974e-04, -3.777364738059117e-04, 1.869329420498696e-03, -1.061257872352941e-03, 2.110045159789856e-03, -6.025899342369972e-03, 1.673865238323826e-03, -2.564316068266059e-03, 1.928506432930529e-03, -5.700636249600883e-04, 4.755092981586297e-03, -1.054286429226145e-03, 8.295671944698153e-04, 2.985371905196735e-04,  1.930207968851262e-03, 1.848237730279996e-03, 5.431173058389530e-04, -5.800338208776664e-04, 3.594310121178766e-04, -1.106911738012181e-03, 6.835375164227977e-04, -1.054286429226145e-03, 4.503039476147754e-03, 4.347873289053835e-04, 4.148655515820804e-04, 1.114031156798629e-03, -1.775321583607301e-03, -1.583181523163183e-03, -1.069112881983229e-04, -1.501521696421993e-03, 2.121215433505176e-04, -3.777364738059119e-04, 8.295671944698140e-04, 4.347873289053819e-04, 7.556052902987185e-03, -3.299086597861464e-04, 3.624425618398376e-05, 1.205642101467064e-04, 1.115329823571633e-03, -1.993606708497967e-04, -2.248490167151195e-04, 1.428440438615092e-03,  1.869329420498689e-03, 2.985371905196836e-04, 4.148655515820893e-04, -3.299086597861568e-04, 3.755142228051746e-03, 3.144713101401267e-04, 1.357278177703142e-03, -3.124807287600152e-03, 1.627194042875830e-03, -7.814458837537930e-04, 8.144009288209070e-04, -1.061257872352941e-03, 1.930207968851239e-03, 1.114031156798629e-03,  3.624425618398823e-05, 3.144713101401344e-04, 7.025594185484153e-03, -8.495209532817893e-04, 5.264316695269039e-04, 2.517670625031082e-04, 9.044501367550949e-04, -1.670914319666085e-03, 2.110045159789862e-03, 1.848237730279967e-03, -1.775321583607307e-03, 1.205642101467123e-04, 1.357278177703152e-03, -8.495209532817939e-04,  6.609109744748513e-03, -2.827671437738671e-03, 6.381319407098809e-04, -1.623962481070705e-03, 8.869292959192091e-04, -6.025899342369976e-03, 5.431173058389525e-04, -1.583181523163179e-03, 1.115329823571618e-03, -3.124807287600185e-03, 5.264316695269078e-04, -2.827671437738650e-03, 1.373843392164040e-02, -2.153552244791356e-03,  4.111232562318740e-03, -2.382163601084250e-03, 1.673865238323829e-03, -5.800338208776454e-04, -1.069112881983336e-04, -1.993606708498027e-04, 1.627194042875804e-03,  2.517670625031096e-04, 6.381319407098791e-04, -2.153552244791354e-03, 6.676569317505018e-03, 1.862192572900497e-03, 2.006806848092286e-03, -2.564316068266060e-03,  3.594310121178628e-04, -1.501521696421979e-03, -2.248490167151155e-04, -7.814458837537550e-04, 9.044501367550921e-04, -1.623962481070701e-03, 4.111232562318747e-03,  1.862192572900483e-03, 7.457962938879111e-03, -7.335450493471589e-04, 1.928506432930524e-03, -1.106911738012196e-03, 2.121215433505395e-04, 1.428440438615097e-03,  8.144009288208960e-04, -1.670914319666080e-03, 8.869292959192297e-04, -2.382163601084268e-03, 2.006806848092283e-03, -7.335450493471612e-04, 4.679285274138320e-03,  4.649640295661595e-03, -1.552115224267527e-03, 1.133553455996112e-03, -1.807742792328613e-03, 2.178873878315841e-03, -1.596393368931674e-03, 1.809644330249061e-03, -7.263786252339312e-03, 2.131041839922510e-03, -3.020832643670514e-03, 2.165293694471851e-03, -1.552115224267529e-03, 6.516671880858137e-03, -1.784630176313873e-03,  1.604789061396693e-03, 3.299054383318530e-04, 3.239139872444258e-03, 2.800702379159360e-03, 1.282569676382329e-03, -8.293224094457013e-04, 1.061629307453565e-03, -1.731360986932802e-03, 1.133553455996111e-03, -1.784630176313894e-03, 5.740468295231975e-03, 4.043511094517575e-04, 5.398567546290392e-04, 1.587801360673647e-03, -2.727383630700628e-03, -2.352821230099231e-03, -2.920517717380159e-04, -2.356961252958998e-03, 3.048962335499209e-04, -1.807742792328612e-03, 1.604789061396693e-03,  4.043511094517515e-04, 1.081563696536625e-02, -8.618288373217118e-04, 4.543911193099272e-04, -3.986374088734536e-05, 2.888448765912160e-03, -4.319821533278573e-04,  4.387991150198533e-04, 1.751024387714955e-03, 2.178873878315835e-03, 3.299054383318793e-04, 5.398567546290353e-04, -8.618288373217108e-04, 4.261425486119101e-03,  6.006666560962454e-04, 1.643783339842513e-03, -4.118651197776743e-03, 2.349232398607480e-03, -7.617491826081592e-04, 1.004960822656775e-03, -1.596393368931675e-03,  3.239139872444257e-03, 1.587801360673653e-03, 4.543911193099292e-04, 6.006666560962537e-04, 9.519621260652977e-03, -1.092285831543557e-03, 8.324520794297791e-04,  1.774004844564836e-04, 1.544321880045550e-03, -2.510760251346325e-03, 1.809644330249056e-03, 2.800702379159345e-03, -2.727383630700637e-03, -3.986374088734400e-05,  1.643783339842530e-03, -1.092285831543559e-03, 8.042285605170235e-03, -3.261826071685010e-03,
                  8.893113135177684e-04, -1.524284166644603e-03, 9.219001563670826e-04, -7.263786252339313e-03, 1.282569676382329e-03, -2.352821230099230e-03, 2.888448765912161e-03, -4.118651197776779e-03, 8.324520794297719e-04, -3.261826071685033e-03,  1.676183712855084e-02, -3.013924912892072e-03, 5.421850293495878e-03, -2.930659478593619e-03, 2.131041839922513e-03, -8.293224094457084e-04, -2.920517717380051e-04, -4.319821533278585e-04, 2.349232398607427e-03, 1.774004844564769e-04, 8.893113135177718e-04, -3.013924912892082e-03, 8.451973896083431e-03, 2.787236906876286e-03,  2.728475501393937e-03, -3.020832643670516e-03, 1.061629307453564e-03, -2.356961252959010e-03, 4.387991150198543e-04, -7.617491826081067e-04, 1.544321880045552e-03, -1.524284166644599e-03, 5.421850293495880e-03, 2.787236906876269e-03, 9.250002297810247e-03, -8.031401942002027e-04, 2.165293694471846e-03, -1.731360986932821e-03,  3.048962335499492e-04, 1.751024387714967e-03, 1.004960822656801e-03, -2.510760251346318e-03, 9.219001563671148e-04, -2.930659478593611e-03, 2.728475501393930e-03, -8.031401942001888e-04, 5.422191169729227e-03, 5.109213322953024e-03, -1.151463078717383e-03, 8.357795334169511e-04, -9.442341393633657e-04, 2.793196169707348e-03, -1.412204068289867e-03, 2.611774277233045e-03, -8.034137485914845e-03, 3.554456363139504e-03, -2.462219258324478e-03, 3.043991129076380e-03, -1.151463078717379e-03,  6.247303961607192e-03, -1.569717102461155e-03, 1.188400905437858e-03, 1.541048886046049e-04, 3.055573857213272e-03, 2.553259024296274e-03, 1.170223025334358e-03, -1.211500974576334e-03, 6.470514334925683e-04, -1.853872934019087e-03, 8.357795334169476e-04, -1.569717102461157e-03, 5.415756491101140e-03, 6.222182817594160e-04,  5.491624834811573e-04, 1.322232454256499e-03, -2.447243637425892e-03, -2.180257264621263e-03, -1.578576695957451e-04, -2.065101537821833e-03, 4.217705140370750e-04, -9.442341393633694e-04, 1.188400905437860e-03, 6.222182817594120e-04, 1.041261781808595e-02, -9.091296333563584e-04, 1.125440813551411e-04, -1.606541690906405e-04,  2.543204504755430e-03, -7.105786687118076e-04, -1.951735971078281e-04, 1.708234673241069e-03, 2.793196169707344e-03, 1.541048886046267e-04, 5.491624834811457e-04, -9.091296333563624e-04, 4.745778616925505e-03, 4.055600011958449e-04, 1.987445530406937e-03, -4.834980929259904e-03, 3.134294608009233e-03, -7.244374089259509e-04,  1.556919052986965e-03, -1.412204068289865e-03, 3.055573857213262e-03, 1.322232454256497e-03, 1.125440813551395e-04, 4.055600011958407e-04, 9.165561801472806e-03, -1.006267530479705e-03, 8.989345687439460e-04, 2.765164044477616e-05, 1.478277235275309e-03, -2.522017924609252e-03, 2.611774277233042e-03, 2.553259024296283e-03, -2.447243637425892e-03, -1.606541690906388e-04, 1.987445530406935e-03, -1.006267530479714e-03, 8.295439343536080e-03, -4.071482038323269e-03, 1.598378608235164e-03, -1.676889112042428e-03, 1.420229068799126e-03, -8.034137485914847e-03, 1.170223025334356e-03, -2.180257264621265e-03, 2.543204504755418e-03, -4.834980929259920e-03,  8.989345687439537e-04, -4.071482038323254e-03, 1.832553931637011e-02, -4.498799353482867e-03, 5.092540996481282e-03, -3.985939467966813e-03, 3.554456363139509e-03, -1.211500974576336e-03, -1.578576695957533e-04, -7.105786687118027e-04, 3.134294608009187e-03, 2.765164044477229e-05, 1.598378608235145e-03, -4.498799353482894e-03,  1.001034219571478e-02, 2.564026642794807e-03, 3.658951219416593e-03, -2.462219258324482e-03, 6.470514334925687e-04, -2.065101537821826e-03, -1.951735971078231e-04, -7.244374089259232e-04, 1.478277235275309e-03, -1.676889112042418e-03, 5.092540996481283e-03, 2.564026642794804e-03, 8.762764050696960e-03, -9.796369436983637e-04,  3.043991129076386e-03, -1.853872934019082e-03, 4.217705140370905e-04, 1.708234673241048e-03, 1.556919052986987e-03, -2.522017924609248e-03, 1.420229068799137e-03, -3.985939467966822e-03, 3.658951219416570e-03, -9.796369436983387e-04, 6.168675791707290e-03, 5.584126919821233e-03, -4.171919613142931e-04, 5.123396754911464e-04, -3.588366329609820e-04, 3.116582332017676e-03, -1.104926812780393e-03, 3.526159154665147e-03, -8.441319845948822e-03, 3.786495692929410e-03, -2.594231877813854e-03,  3.204996083493471e-03, -4.171919613142972e-04, 6.638505856917941e-03, -1.686336651446447e-03, 1.099601416835595e-03, 4.272114155710280e-04, 2.858556455852993e-03,  3.199630940829739e-03, 5.509148656961170e-04, -1.020708766807188e-03, 3.972237483859294e-04, -1.748933462231357e-03, 5.123396754911464e-04, -1.686336651446452e-03,  6.154388478366378e-03, 9.260788751906692e-04, 5.172199811718156e-04, 1.829142688782925e-03, -3.061870171766191e-03, -2.001057383643059e-03, -3.031362455346435e-04, -2.112375592498193e-03, 2.728241073083924e-04, -3.588366329609808e-04, 1.099601416835599e-03, 9.260788751906697e-04, 1.146630473086513e-02, -7.411643677153087e-04,  1.268819332367299e-04, -2.833866440900282e-04, 2.043711833404197e-03, -5.452190532217756e-04, -4.459515232235717e-04, 2.193639123746165e-03, 3.116582332017675e-03,  4.272114155710233e-04, 5.172199811718230e-04, -7.411643677153208e-04, 5.232590536359133e-03, 4.664147538121889e-04, 2.338485212230387e-03, -5.064224159416340e-03,  3.255488046791960e-03, -8.532182260500838e-04, 1.576407617877122e-03, -1.104926812780394e-03, 2.858556455852988e-03, 1.829142688782925e-03, 1.268819332367317e-04,  4.664147538121773e-04, 9.640280907073664e-03, -1.132080576871643e-03, 4.902116653157367e-04, 1.655608435946903e-04, 1.265134820347244e-03, -2.439849434778195e-03,  3.526159154665148e-03, 3.199630940829733e-03, -3.061870171766195e-03, -2.833866440900278e-04, 2.338485212230373e-03, -1.132080576871644e-03, 9.840064204784274e-03, -4.596497749045800e-03, 1.741456401452229e-03, -2.098256270929645e-03, 1.481445614162790e-03, -8.441319845948826e-03, 5.509148656961046e-04, -2.001057383643053e-03,  2.043711833404184e-03, -5.064224159416379e-03, 4.902116653157445e-04, -4.596497749045791e-03, 1.922815212806515e-02, -4.304196403256954e-03, 5.441757898734800e-03, -3.881270711218786e-03, 3.786495692929408e-03, -1.020708766807200e-03, -3.031362455346499e-04, -5.452190532217762e-04, 3.255488046791981e-03, 1.655608435946958e-04,  1.741456401452233e-03, -4.304196403256935e-03, 1.064890953416359e-02, 2.859840086634426e-03, 3.833718519567412e-03, -2.594231877813851e-03, 3.972237483859335e-04, -2.112375592498190e-03, -4.459515232235728e-04, -8.532182260500817e-04, 1.265134820347245e-03, -2.098256270929643e-03, 5.441757898734792e-03, 2.859840086634416e-03,  9.639142730611335e-03, -9.009901805742578e-04, 3.204996083493466e-03, -1.748933462231354e-03, 2.728241073084056e-04, 2.193639123746156e-03, 1.576407617877098e-03, -2.439849434778193e-03, 1.481445614162791e-03, -3.881270711218813e-03, 3.833718519567378e-03, -9.009901805742503e-04, 6.708794543873024e-03, 5.454035250624117e-03, -1.826398609921120e-03, 8.069908084101632e-04, 5.819462025059833e-04, 2.731221445819896e-03, -2.729409015299849e-03, 2.387738807465919e-03, -7.856513351521132e-03,  4.056128647631226e-03, -2.331511269040081e-03, 4.108710803939875e-03, -1.826398609921120e-03, 6.961652297793435e-03, -1.583532540561146e-03, 9.674841075521987e-04,  3.407984652460357e-05, 3.216943662682490e-03, 2.226394639670887e-03,
                  1.611392885576079e-03, -1.614604774288523e-03, 9.824000344604861e-04, -2.423360521920690e-03,  8.069908084101632e-04, -1.583532540561146e-03, 6.475802941949705e-03, 9.786547177061016e-04, 7.817192877667927e-04, 1.715109744380819e-03, -2.661318098648682e-03, -2.096712525833981e-03, 7.837073659906280e-05, -2.194438855446230e-03, 4.869904131354429e-04, 5.819462025059833e-04, 9.674841075521987e-04, 9.786547177061016e-04,  1.147740184003195e-02, -4.424931520907098e-04, -1.685038281707539e-04, 3.206335899217800e-04, 7.711861057697617e-04, 8.139998152103503e-05, -7.533728824110891e-04,  2.612417497309602e-03, 2.731221445819896e-03, 3.407984652460357e-05, 7.817192877667927e-04, -4.424931520907098e-04, 5.681545171796901e-03, -1.560273044128338e-04,  1.850867177639613e-03, -4.748824831632508e-03, 3.254489811200930e-03, -7.562511638151034e-04, 1.676247349639475e-03, -2.729409015299849e-03, 3.216943662682490e-03,  1.715109744380819e-03, -1.685038281707539e-04, -1.560273044128338e-04, 1.102966286306352e-02, -1.705983702685375e-03, 1.856492393332201e-03, -6.537735725512784e-04,  1.549802811961654e-03, -3.206581650942137e-03, 2.387738807465919e-03, 2.226394639670887e-03, -2.661318098648682e-03, 3.206335899217800e-04, 1.850867177639613e-03, -1.705983702685375e-03, 8.780164777783282e-03, -3.279418439072957e-03, 1.562215533636633e-03, -1.578290957015797e-03, 1.574779749387401e-03, -7.856513351521132e-03,  1.611392885576079e-03, -2.096712525833981e-03, 7.711861057697617e-04, -4.748824831632508e-03, 1.856492393332201e-03, -3.279418439072957e-03, 1.895013448507316e-02, -4.650140462413877e-03, 4.359797877012365e-03, -4.523698842104695e-03, 4.056128647631226e-03, -1.614604774288523e-03, 7.837073659906280e-05, 8.139998152103503e-05,  3.254489811200930e-03, -6.537735725512784e-04, 1.562215533636633e-03, -4.650140462413877e-03, 1.124727503186497e-02, 2.381201159049536e-03, 4.480314927675713e-03, -2.331511269040081e-03, 9.824000344604861e-04, -2.194438855446230e-03, -7.533728824110891e-04, -7.562511638151034e-04, 1.549802811961654e-03, -1.578290957015797e-03,  4.359797877012365e-03, 2.381201159049536e-03, 9.398687247927057e-03, -1.143177320834924e-03, 4.108710803939875e-03, -2.423360521920690e-03, 4.869904131354429e-04,  2.612417497309602e-03, 1.676247349639475e-03, -3.206581650942137e-03, 1.574779749387401e-03, -4.523698842104695e-03, 4.480314927675713e-03, -1.143177320834924e-03,  7.983022042859198e-03 ))

  expect_equal(c(result_exp$lag_one_cor),
               c( 5.814607258058573e-03, 9.317763821044441e-05, 3.607760201740126e-03, 1.550254107928662e-03, -2.775769888074086e-04, 1.754831222637238e-03, -2.069426191540196e-04, -3.406824614303587e-03, -4.518135876856980e-03, -6.756584243924429e-03, -1.102220373012422e-03, 1.151850219755440e-04, 2.250051928207417e-02, -6.111590286470622e-03,  6.262586254207734e-03, 2.755408318805406e-03, 1.333443304532398e-02, 1.377379119361090e-02, 5.019850344207488e-04, -3.248076316007636e-03, 7.424770227812618e-04, -6.503206758870774e-03, 3.578135251068484e-03, -6.105797568843454e-03, 1.943188989223901e-02, 3.205912650470761e-03, 2.062852152363295e-03, 8.312704155963944e-03, -1.204121550207139e-02, -6.613237968369485e-03, -1.026840737462862e-03, -8.064353232744124e-03, 4.844834622022528e-04, 1.549145950538634e-03, 6.265370091194655e-03,  3.206817868576897e-03, 4.282552560812636e-02, -1.888505366473449e-03, 1.044488857743606e-03, 1.801494161211075e-03, 5.380262460366376e-03, -6.354128847136205e-04, -2.543165637686197e-03, 9.983936096824617e-03, -2.441432061583561e-04, 2.762077847129848e-03, 2.048179851001555e-03, -1.884447040034257e-03, 1.182988783978804e-02,  4.031174565036863e-03, 4.588454711213270e-03, -1.084932217315670e-02, 8.978726476128402e-03, 2.099768497557555e-04, 2.725759558144392e-03, 1.771824179848714e-03,  1.333493078954937e-02, 8.310527558513817e-03, 1.041778802530153e-03, 4.034001914738253e-03, 3.680923673242352e-02, -2.847716048988351e-03, -1.249689443787243e-03,  2.178077086760475e-03, 3.544229868332047e-03, -9.682603610923815e-03, -1.696870574934976e-04, 1.377396548184815e-02, -1.205170614553767e-02, 1.803013968366551e-03,  4.570908351476666e-03, -2.854140470617447e-03, 2.774682571876470e-02, -7.117507060837925e-03, 1.564501344326541e-04, -5.613661287462893e-03, 1.599863230248358e-03, -3.429919234969908e-03, 4.839189965731399e-04, -6.585786287754884e-03, 5.372753520543705e-03, -1.086179396130840e-02, -1.245896080916559e-03, -7.156963444514889e-03,  3.553387751702251e-02, -7.017370290422401e-03, 1.192810739725931e-02, -6.566116087084210e-03, -4.429800897605611e-03, -3.246296476143532e-03, -1.044292652142558e-03, -6.249047191083888e-04, 8.968584793170161e-03, 2.169552008289611e-03, 1.765128960226157e-04, -6.984669015663557e-03, 3.120093007149461e-02, 1.638868826270013e-02,  1.099176458962102e-02, -6.694461989624162e-03, 7.353097043108199e-04, -8.065668161105989e-03, -2.539227880302895e-03, 2.008707803752370e-04, 3.542992630000195e-03, -5.615630644519571e-03, 1.194848607912453e-02, 1.638716452937333e-02, 3.154934136535810e-02, 8.454024677626265e-05, -1.075133333904960e-03, -6.498953627308892e-03,  4.745799415017187e-04, 9.989962460680617e-03, 2.721815069452350e-03, -9.686283827221786e-03, 1.610999459881461e-03, -6.550802420816196e-03, 1.098994290995616e-02,  8.607339052563981e-05, 1.752260187877878e-02, 9.360325710574778e-04, -4.750041457077350e-04, 1.103058196242339e-03, 8.670061890600705e-04, -8.064069976097840e-05,  1.928825878713893e-04, -8.052917208395316e-04, -7.263322350434945e-04, -4.282336826150016e-04, -9.616545915440524e-04, 9.336527939608763e-05, -3.924816828069730e-04,  3.348426521431108e-03, -7.868341703391036e-04, -5.352974594605747e-04, 6.605475126452115e-05, -1.176756272105769e-03, 1.136347837857503e-04, 1.247946538498652e-04, -1.948535631753202e-04, 7.690488499108282e-04, -3.236069633261156e-04, 1.274503514502723e-03, -7.612338115970409e-04, 5.586407069108807e-03, 8.825410260039257e-04,  6.992749448385977e-04, 9.106721979532722e-04, -1.328341962006862e-03, -2.144242219189684e-04, 5.668369963263626e-04, -8.837941979996816e-04, 2.944954003641152e-04,  8.395793477444064e-04, -5.433883774603049e-04, 8.459737269433463e-04, 4.903864058114067e-03, -1.949369259145110e-04, -3.259545376949558e-04, -9.740595944578508e-04, -5.581601641052284e-04, -3.803079108503506e-04, -4.109359969433313e-04, 3.531360370016374e-04, -2.240842467302609e-05, 8.163196800564957e-05, 6.860472452536603e-04, -2.099699801551519e-04, 4.056328670014576e-03, -2.652573475466840e-04, -4.514336749625162e-04, 9.132443756518479e-04, -2.810144565282748e-04, -5.843366444855164e-05, -6.829413002902010e-04, 1.098851914653503e-04, -1.200937979690165e-03, 8.963089213018765e-04, -2.677993985964987e-04, -2.949176574543644e-04, 3.929949919465647e-03, -9.601399483689160e-04, -4.261536781459489e-04, 4.639550736958558e-04, -5.782590583538849e-04, 7.192464538294729e-04, -7.343656652264239e-04, 9.919120489643597e-05, -1.316886712882722e-03, -9.882252629336871e-04, -4.713158797972059e-04, -9.003604232041418e-04, 4.431253132239724e-03, 1.823877602443307e-03, -3.157598459652833e-04, -1.857312360481174e-05, -2.557476798201847e-04, -6.051928012869383e-04, 2.071006554503511e-04, -3.515146158744463e-04, -6.183795070675677e-04, 9.227025388564118e-04, -3.657073559517173e-04, 1.965974176676094e-03, 4.018586295958819e-03, 1.185836824595372e-03, -1.118195592841239e-03, 7.488018569301222e-04, -2.781023583048735e-04, -1.104630534507788e-04, 4.326644143730893e-04, -5.051415867673335e-04, -3.667965938078943e-04, 5.437635435632057e-04, -1.919247458251841e-04, 1.229960777662918e-03,  2.847303555530553e-03, -8.776828927869150e-04, -5.818212115120307e-04, -1.156813138341717e-03, 7.665406351954479e-04, -9.939408398096580e-04, -5.532953860829957e-04, -1.091513651090850e-04, -5.263477743459157e-04, -3.479718693805405e-05, -1.073100760535429e-03, -8.185122590434494e-04, 4.892866119064254e-03, -8.121427119384106e-04, -4.501761925568889e-05, -3.591733144947488e-04, 3.562194490798839e-04, 3.831529467103138e-04, -6.613809712468189e-04, 6.507243986096905e-04, -2.508310959170737e-04,  6.804071878131965e-04, -4.947425432627250e-04, -8.628752293201828e-04, 3.759233750558189e-03, 7.498578083476427e-04, 1.559007708268367e-05, 7.876211230485851e-04,  4.369771166726331e-04, 1.636241674375812e-04, 2.074259708636686e-04, -9.907872085582883e-05, -7.939454237480147e-04, -8.439801641673517e-05, -9.500290790868304e-04, -9.180839743265750e-05, -3.049600209300383e-04, 2.357348362423788e-03, -3.248605641232522e-04, -3.754583047105020e-04, -6.348734930977662e-05, -1.118287412814898e-03, -4.031206711559016e-04, 2.729565914912142e-04, 1.566711383235297e-05, 5.740767767934494e-04, -7.254752427250481e-05, 7.768903016527054e-04, -1.155658500150854e-04,  3.811558430405083e-03, 3.290121017550266e-04, 5.600128021357978e-04, 4.654424723971934e-04, -1.619659863420515e-04, -2.473762043050931e-04, 4.072723034269505e-04, -4.888741511191400e-04, 2.043610658069814e-04, 6.001761486733408e-04, -2.707060916916034e-04, 3.758914772156483e-04, 2.769155542224355e-03, 6.068898374063164e-05, -4.381113664823257e-05, -3.804944706151072e-04, -8.592848619086960e-04, -2.187050732755603e-04, -3.182930489965229e-04, -4.205053736489354e-05, -6.918410918733405e-05, -7.507229512086983e-06, 3.391881827373839e-04, -7.255643525887223e-05, 3.205096166165156e-03, -3.296034697344496e-04, -3.842232221931646e-04, 1.031789904812012e-03, -3.111792556817496e-04, 9.069279673455701e-05, -4.544900172651921e-04, 1.721039113553354e-04, -9.559281478140774e-04, 3.050180522824091e-04, -2.182467678578551e-04, -3.019208913849599e-04, 2.530965859698186e-03, -3.887496635437096e-04, -1.212037522339531e-04, 2.418299148240203e-04, -4.410913223637171e-04,
                  5.868101372081659e-04, -6.012938525983785e-04, -4.194088979468211e-04, -4.280984977704451e-04, -5.250353230851759e-04, -4.839972118668536e-04, -5.352086283842510e-04, 2.698634557035395e-03,  1.722795178247124e-03, -1.183984202079284e-04, 1.722339057089776e-04, -1.901463277702007e-04, -6.154780568277732e-04, -3.588095323724622e-05, 9.207885199190931e-05, -3.367555859848123e-04, 6.585418293908059e-04, -2.234403761671423e-04, 1.034369652138491e-03, 3.281058807363521e-03, 8.231642131556942e-04, -8.897472206750561e-04,  4.887828792160742e-04, -3.262768885914160e-04, -1.337384409963777e-04, 3.715737247290324e-04, -1.335781306585348e-04, -4.311399727124771e-04, 1.417072388426000e-04, -2.866659252420311e-04, 1.146323280004128e-03, 2.029293362054319e-03, -8.168454437402278e-04, -4.964553484115854e-04, -8.497060480789668e-04, 2.308098906199091e-04, -4.017439119938428e-04, -1.353910441657069e-04, -1.667778160581333e-04, -6.383090541829876e-04, -3.062632758760590e-04, -7.693252460738991e-04, -8.016299763134900e-04,  3.859437638465876e-03, -5.143777982123284e-04, 3.189545724523456e-05, 1.673249716229157e-05, 1.529239708354970e-04, -6.147145456433020e-05, -4.589659084742927e-04,  7.512744557922218e-04, -9.006384866937841e-05, 5.678281418195815e-04, -6.379237228792273e-04, -6.197119318518643e-04, 2.853636354719144e-03, 8.098314747361367e-04, -2.865832737031367e-04, 6.133050687856353e-04, 2.685070364114826e-04, -2.325931912765340e-05, -5.121220722230161e-05, -2.880342071111545e-04, -8.194059462571042e-04, -4.343975758142824e-04, -1.058535348267127e-03, 2.732461057121040e-05, -5.720201436058606e-05, 1.782359167902228e-03, 1.042169667249764e-04, -1.976037245693598e-04, -2.612039297939769e-05, -7.906496297817012e-04, -5.882029903943042e-04, -8.805207637804766e-05, -3.350766907316189e-06, 1.170626054297605e-04, 1.682441392654697e-04,  6.265421008718077e-04, -1.665498649931445e-04, 2.857801987286934e-03, 7.938963050744901e-05, 1.594826390049279e-04, -8.657860846611682e-05, 1.952048690123296e-05,  5.565428513288186e-05, 5.557726741382871e-05, -4.326211632240875e-04, 7.601159046927568e-05, 4.472502009349180e-04, -3.827155271328850e-04, 1.860271177619320e-04,  1.429609831788698e-03, 2.649400902443610e-05, -2.250735229864898e-04, -2.632319094888878e-04, -6.220496453842731e-04, -2.056279079311914e-04, -3.174154382773680e-04, -2.811842448304049e-04, 9.658276419927730e-05, -8.353812237699723e-05, 3.108299328649031e-04, 1.847375745180300e-04, 2.541915762433520e-03, -3.242353933669534e-04, -3.689939822889572e-04, 7.252759307022959e-04, -4.481414947912828e-04, -1.182823610029013e-04, -3.025953938332666e-04, 3.031472710605717e-04, -9.271329348094718e-04,  9.895508242723210e-05, -1.319813896064413e-04, -2.896147806800545e-04, 1.560097283408466e-03, -1.195305615627985e-04, -2.231945607418402e-04, -9.633570678608877e-05, -6.997011571859256e-04, 6.363554010253782e-04, -1.876856335784118e-04, -5.324013529792418e-04, 1.627427928881616e-04, -2.423038956083521e-04, -3.278261425176285e-04, -9.961708759467411e-05, 1.778845156672092e-03, 9.126277469631649e-04, -1.169352294008547e-04, 8.687059035678750e-06, -1.007550041419663e-04, -1.016389766625892e-03,  2.405846628724257e-04, -1.170737594121229e-04, -4.899790386781900e-04, 7.598568917096061e-04, 1.645675848677863e-04, 9.816389598140943e-04, 3.084997233620732e-03,  1.001089371382170e-03, -2.012121894339263e-04, 3.853800379537322e-04, -2.195952818588053e-04, 7.820230826395753e-05, 2.741861512399865e-04, -5.786618714803434e-05, -3.397519530580449e-04, 8.471627523453610e-05, -8.025352099069790e-05, 7.338346900716425e-04, 1.542408264072242e-03, -7.419201449891605e-04, -5.671203650703511e-04, -1.013284641410318e-03, 4.504913195105680e-04, -3.993653648510199e-04, -5.821617145794730e-05, 7.306601989691029e-05, -2.420061495671426e-04, 8.975600694933106e-05, -4.600715104220341e-04, -3.914723966179255e-04, 3.574117618475202e-03, -3.881852717918278e-04, 5.266844793893970e-05, 1.492383475545068e-04, 1.085366102880798e-04, -3.499294256640551e-04, -3.452923981666902e-04, 6.441095915649699e-04, -9.364264292309400e-05, 4.641042481202393e-04, -5.957906007929890e-04, -4.028734239860793e-04,  2.113657005784121e-03, 8.761818949059455e-04, -3.071718651588108e-04, 4.950421496287895e-04, 1.317972848700186e-04, 1.156070496243350e-04, -2.274126121432251e-04, -2.943492926424441e-05, -1.216591579814359e-03, -2.134736682771439e-04, -1.162058341411049e-03, 2.079408601971880e-04, -3.375289183877526e-04, 1.614916259412699e-03, -7.585778423168906e-05, -2.040593877819715e-04, -1.149709010607116e-04, -5.620850281565059e-04, -5.547367755175271e-04, 3.410716388068223e-04, 7.230158746556527e-05,  4.324287396646926e-04, 1.050955528255265e-04, 5.266617972668609e-04, -8.289388119846718e-05, 2.366577795934346e-03, 1.095717920957890e-05, 1.764418856712083e-04, -2.724187061781580e-04, 2.041668689394343e-04, -2.112860021897590e-04, 1.143985681699608e-04, -4.880597095036908e-04, 1.833001805675191e-04, 2.560292293604499e-04, -2.685082737985503e-04, 9.036058362665096e-05, 1.113011272890237e-03, 1.928704867603510e-04, -2.377103188437408e-04, -1.511739299350351e-04, -6.200483359351421e-04, -5.513638528624090e-05, -2.137788303043430e-04, -2.398733190038816e-04, -9.277248801052565e-05, -9.386533114927629e-05, 9.025152368677202e-05, 8.954113000503663e-05,  2.095214369650748e-03, -2.744176355169688e-04, -3.248720758289671e-04, 7.525082517268662e-04, -3.208652849530372e-04, 7.014126559702689e-05, -2.267259378864781e-04, -1.610752978089461e-04, -5.953569803583527e-04, -5.667602804605969e-05, -1.483096834241978e-04, -2.320415150611944e-04, 1.399476003262394e-03, -1.241247627185701e-04,  1.931211537882150e-04, 5.834377767040207e-05, -1.215926760333938e-04, 4.759246117108137e-04, -2.638449201800235e-04, -4.096422513103731e-04, -6.173719859843161e-05, -1.675433415761882e-04, -3.526121823688333e-04, -1.891640368354932e-05, 1.527662063315499e-03, 1.029566482642625e-03, -6.679916447790372e-05, 2.884575246499225e-04, -1.654921195227428e-04, -9.682890489571168e-04, 1.691838708952621e-04, -2.285086186248030e-05, -2.766668129054616e-04, 4.713544334280941e-04, 1.812677284750316e-04,  5.728159284862242e-04, 3.198464233913658e-03, 5.255798755952443e-04, 1.362039723198580e-05, 1.830521597603117e-04, -5.292334651365672e-04, 1.865661835284801e-04,  8.262357890142580e-05, -1.650585268630469e-05, -4.577407936429997e-04, 2.581147951757609e-04, -2.542749432866611e-04, 1.120367784616940e-03, 1.237084688506814e-03, -1.591493478061777e-04, -6.923126106035975e-04, -1.099930761358069e-03, 3.743812437392181e-04, -2.906522198873222e-04, 7.064438501012938e-06, -7.322517366097360e-05,  5.185877141141565e-06, -3.457542818849552e-05, 9.658248435145348e-05, -4.651749733144133e-04, 3.366374939091160e-03, -4.342611522106585e-04, 2.192749315231866e-05,  1.529364990781416e-04, 3.731698082064892e-05, -2.778656796665680e-04, -2.320135587034398e-04, 4.364824025412435e-04, -8.420329535602168e-05, 3.667147743927340e-04, -4.992524647621124e-04, -2.992563070573766e-04, 1.805960345102165e-03, 6.774375688376114e-04, -1.754188512202265e-04, 1.200417851140007e-04, 4.525167751821904e-05,  2.425183704289747e-04, -2.115037974973631e-04, 1.671100933282353e-04, -1.203521151356382e-03, 3.290831161132191e-04,
                  -4.433864321374309e-04, 3.054450942340630e-04, -2.012776545499633e-04, 1.246866045907020e-03, 1.157439151626594e-04, -2.351880225599119e-04, -2.120611183072135e-04, -4.859474271700536e-04, -6.168440101702865e-04,  2.494319303857612e-04, -2.007095569651912e-05, 1.500806668653429e-04, 1.072088790089022e-04, 2.473974746021024e-04, 9.390187532117380e-05, 1.523688667003420e-03, -6.541780652599509e-05, 8.188714129332953e-05, -3.766744624615759e-04, 4.169354284139699e-04, 3.625110147118633e-05, 2.940833113521803e-04, 7.140854851439722e-05,  1.497172371544965e-04, 1.121184445791469e-04, -1.931179319074292e-04, -4.817751619211018e-05, 5.433403489662527e-04, 1.494954260150338e-04, -1.010499258604599e-04, -5.280779714191143e-05, -4.283606970429052e-04, 4.039534442476781e-05, -1.004062253812434e-05, -3.277794912601320e-04, 9.070869400225319e-05, -8.827909681481312e-05, -2.102681806510719e-05, 1.151872227719804e-04, 1.822009282942729e-03, -3.033035180867210e-04, -1.077965225875468e-04, 3.737360086526906e-04, -3.596909795583666e-04, -9.242952386778001e-05, -1.080331384053359e-04, -2.668235586289886e-04, -4.883013133532503e-04, -2.998676607457044e-04, -6.420263299811843e-05, -3.786717459343552e-04,  9.590085757056698e-04, -5.130579067171298e-05, 4.371886455640762e-04, -1.124976326093365e-04, -8.035161092372566e-05, 2.787462000764062e-04, -6.419302802143978e-05, -5.390116532581511e-04, 3.131281621852839e-04, -3.292035343258310e-05, -2.551657303141952e-04, 4.882863725393349e-05, 1.128744308534311e-03, 5.417289422918355e-04, -8.727103645334985e-05, 1.583015494709903e-04, -6.452370337166596e-05, -1.242591418876682e-03, 1.946077499727573e-04, 1.064652738510762e-04, -2.617896207735454e-04,  1.144615511152855e-04, 3.136181826230024e-04, 1.810582572604430e-04, 3.707124101902264e-03, -4.155153137020418e-05, -1.356328591068677e-04, -1.571108270242302e-04, -2.546751759057373e-04, 1.084991789786924e-04, 6.899362978558698e-05, -3.994448582808155e-06, -4.479216737827374e-04, 5.845374444286778e-05, -1.765406365162227e-04,  7.359357899066628e-04, 7.857925761234494e-04, -4.053139303283290e-04, -6.124006083038681e-04, -5.788855148173019e-04, 1.641898263123854e-04, 1.643455547691089e-04,  5.003623146136729e-05, -2.495791849982291e-04, -5.779631665170246e-05, -1.236732968619441e-05, 3.178109261505824e-06, -1.180775631908660e-03, 1.765563435277983e-03, -4.730018398435898e-04, 1.046870013149645e-04, 1.465357825626420e-04, 2.426565969609524e-06, -2.893333595599823e-04, -1.001414456909295e-04, 3.027668713207094e-04, -4.937425053469814e-05, 1.940740464786827e-04, -3.725497116594347e-04, -1.106514634347886e-04, 1.636338077243912e-03, 6.797923568739877e-04, -2.644886759891976e-04,  1.491291425917146e-04, -8.774525355594732e-05, 2.521621612336094e-04, -2.760369561900872e-04, 1.665798156520435e-06, -1.370916333712612e-03, 2.400193369098182e-04, -2.519119708791962e-04, 2.615736489606633e-04, -1.493536790313941e-04, 1.147759508162024e-03, 1.035280699803598e-04, -2.223818485425088e-04, -1.231909495662880e-04, -4.346546167690047e-04, -5.148292735008859e-04, 1.856056025260240e-04, 2.616642525368442e-05, 6.829377996673155e-05, 1.207417032789041e-04, 1.304492704489373e-04,  1.045127033311590e-04, 1.279598116557743e-03, -9.879977550848424e-05, -4.066992417869528e-05, -3.877369486859808e-04, 4.108391051201998e-04, 1.053491223231294e-04,  1.103338388093219e-04, 1.925729832874949e-04, 5.325768739088031e-05, 5.847843503289695e-05, -2.215022336908905e-04, -8.427436829178333e-05, 3.631793140867089e-04,  1.296665397650216e-04, -4.321096327915038e-05, 5.066663805590321e-06, -2.977235814931642e-04, 2.134632741916937e-05, 4.909617947148970e-05, -3.024932523949266e-04,  2.519439814461038e-04, -2.095483638174533e-04, -1.017808292158321e-05, 1.875055630070365e-05, 1.754284084420931e-03, -3.229762492345243e-04, -1.513275791365664e-04,  4.245535061671838e-05, -2.163764624455300e-04, -1.190692470740262e-04, -2.092998137954923e-05, -2.429451791861087e-04, -4.232091185309804e-04, -3.771426674721895e-04,  1.555937949533814e-05, -3.504050640831005e-04, 7.710106018529292e-04, 3.315429010987727e-05, 4.476841478527633e-04, -1.333727717563416e-04, -9.325583235261675e-05,  2.215341452163185e-04, 9.284224460590593e-05, -6.384896341787030e-04, 4.702153365685231e-04, 2.520047748224884e-05, -7.612151840861086e-05, 1.173244100519039e-05,  9.107708302700522e-04, 1.802920041167201e-04, -4.719822329306408e-05, 1.059140375284892e-04, -2.672100505259650e-06, -1.382533656160343e-03, 3.562430753254561e-04,  9.687336516547981e-05, -5.780510174176545e-05, 1.583847892517936e-05, 4.556722749287792e-04, 2.776208923631496e-04, 4.038764244224079e-03, -6.876730285096150e-05, -2.116818067580587e-04, -1.213726913686353e-04, 2.364961757416286e-04, -5.927000785005426e-05, 1.452445046524675e-04, -5.170475590233631e-05, -2.836616471985180e-04, -1.994358913029000e-04, -7.923231305970193e-05, -4.282791569896529e-05, 9.981760883069385e-04, -7.966923294504893e-04, -2.699134815794410e-04, -2.594957603517410e-04,  1.923460146573965e-04, 2.215212706994497e-04, 1.359579186554611e-04, -1.692070150305674e-04, -8.231161461311494e-06, 2.096719089184325e-04, -1.888623022676789e-04, -7.801169414255705e-04, 1.144865389022461e-03, -1.832083547848272e-04, 2.649008836130160e-04, 7.147967645493818e-05, 8.082042048380916e-05, -4.520779157084042e-04, -1.970811975873113e-05, 2.413771784979319e-04, -8.884494811868951e-05, -1.425673582964633e-04, -3.280745771137914e-04, -1.877697852755698e-04, 1.562322028126624e-03,  8.845928526825332e-04, -2.686107019008342e-04, 1.836690210053686e-04, -1.421997656430053e-05, 3.917110006716581e-04, -3.023846415331847e-04, 1.318324448777831e-04, -1.712669675217827e-03, 5.201923786146145e-04, -2.574514541970767e-04, 4.410470643766631e-04, -3.646592600712593e-04, 1.266905626323369e-03, 6.544881545505960e-05, -2.351593266695237e-04, -2.771223780184327e-04, -3.886104751894813e-04, -6.166383172082504e-04, 4.603252959269398e-04, -2.684840827360469e-04, 1.309713320577269e-04, -4.995083505090826e-05, 2.337729127275278e-04, 4.155366422251506e-05, 1.349895268369214e-03, -7.482406203205682e-05, 6.404599358297699e-05, -4.135820260994335e-04,  5.026337557942370e-04, -5.747627209575744e-05, 2.667414317420444e-04, 1.551412231256734e-04, 1.870549676378877e-04, -1.505531719284126e-04, -2.063865772005225e-04, -9.997825900635724e-05, 4.709879749731633e-04, -3.679221807694245e-05, 2.130602900161754e-05, -2.408094991359325e-05, 6.547057809671386e-05, -1.308212305122775e-04,  1.550685542215970e-04, -4.940079204066758e-04, 3.292652816348674e-04, -2.287119991548222e-04, 3.306617559865196e-06, 7.194878663774792e-05, 1.862445811500855e-03, -3.819292067377910e-04, -1.362903278393880e-04, -5.899380446381579e-05, -8.639705451033802e-05, -7.211208413042060e-05, 6.516611455201294e-05, -3.418726334719135e-04, -3.919040073527759e-04, -3.876513498319180e-04, -2.528795819696483e-05, -3.716963421908131e-04, 8.600120446286487e-04, -2.269938004558623e-05, 5.631296810283458e-04, -2.866110184719771e-04, 6.371542503520700e-06, 1.768459226017622e-04, 1.734979851333287e-05, -5.296029055797871e-04, 3.930312632685114e-04, 2.552195001755891e-05, -1.336597683189997e-04, -2.843717903264200e-06, 9.680763786988489e-04, 2.668167966781486e-04,
                  -2.143166530109476e-05, 2.100785320105297e-04, -4.345946133447123e-05, -1.698691424180959e-03, 3.171662285902193e-04, 1.887651517091182e-05, -1.563041997192660e-04, -1.484278698500644e-04, 4.726314467933607e-04, 1.331061338525624e-04,  4.637169582860931e-03, -3.778992877576991e-04, -1.547702041510463e-04, -3.354118401589591e-04, 3.499278535117183e-04, -6.780092720380654e-05, 1.254519919764326e-04,  3.368181082821887e-05, -1.542205382302947e-04, -2.280931837360931e-04, -1.941844254437734e-05, -1.979716347092413e-04, 1.209836631584350e-03, -7.600602848324613e-04, -1.964590855647717e-04, -3.699250271353208e-04, 1.825300355238288e-04, 1.666971796688570e-04, 5.858118971170216e-05, -2.017137058476114e-04, 5.792911181729259e-07,  8.472560388437392e-05, -6.585265302991306e-05, -1.035171257873070e-03, 1.122372041081746e-03, -3.479079457892525e-04, 3.967610745534121e-04, 7.382406914824943e-05,  9.384803983152618e-05, -3.793137692296170e-04, 8.156023022633200e-05, 2.252335480783719e-04, 6.137474138179691e-05, -3.587080512427237e-04, -1.072127345704921e-04, -2.272227502843404e-04, 1.705314628990887e-03, 1.021994635856024e-03, -1.837329998483390e-04, 1.509452421857263e-04, 1.339819955885502e-04, 4.634671209225095e-04, -2.599075726458331e-04, 2.461786347703473e-04, -1.929205047330798e-03, 5.934226574460725e-04, -2.835578920787845e-04, 5.563802593128440e-04, -3.076094578127235e-04,  1.297822581000183e-03, 8.866182746168292e-05, -2.913343040546554e-04, -2.823767817535144e-04, -4.845157340134435e-04, -6.654247721450165e-04, 3.666493775088032e-04, -1.792142277152792e-04, 1.540877835213283e-04, 2.969855323926205e-05, 1.805668369395246e-04, 1.768668809718721e-04, 1.407963428404891e-03, -7.950562695623994e-05,  5.807201804236263e-05, -3.310151209828325e-04, 5.004223124363509e-04, 8.021146045102885e-05, 2.233185054020604e-04, 2.604586235733063e-04, 8.284253817250734e-05, -1.464792277901179e-06, -2.687510986611985e-04, -5.481732671775056e-05, 4.924846360643827e-04, 6.711098559004602e-05, -3.328715377732855e-05, -9.894754439247383e-06, -1.747310876150150e-04, -1.173101207415487e-05, 3.393783237085161e-05, -4.419781282620387e-04, 4.912207265645471e-04, -2.020533531230970e-04, 3.607120314759177e-05,  1.670884880873173e-04, 2.138014479108500e-03, -4.391749767182010e-04, -3.322675031384640e-06, -2.344990358561375e-04, 6.273491037868831e-06, -1.480319734066360e-04,  1.991471978423749e-04, -3.400860785521807e-04, -5.232778791141720e-04, -4.209495138553455e-04, -6.908293129865046e-05, -4.714132252474950e-04, 8.873273424328301e-04, -6.934067437962256e-05, 5.079548822809930e-04, -2.907875424655650e-04, -4.918949760862253e-05, 2.581137462107382e-04, 1.706487853102307e-04, -5.752148671241267e-04,  4.861449107782929e-04, -3.458632828903134e-05, -1.028889338749168e-04, 7.085750503258620e-05, 1.153624785635544e-03, 1.541099849395275e-04, 7.972503382547649e-05,  1.365774333188088e-04, 7.209242744377985e-05, -1.908465385159313e-03, 1.620811184610680e-04, 7.093925357784940e-05, -4.279331484896780e-04, -1.625186235076882e-04,  4.161984959833700e-04, 3.589674766836388e-05, 5.185161669511384e-03, -3.753658068706156e-04, -2.122439469294798e-04, -5.148230074225755e-04, 6.129560485646588e-04, -1.268826678447347e-04, 1.944163578860618e-04, 4.878381437796371e-05, 4.797135264352870e-06, -2.149630433732380e-04, 1.979642339432908e-04, -4.296718733158834e-04,  1.547340793946386e-03, -1.002143663013577e-03, -1.487766016790051e-05, -3.260479996415940e-04, 6.683854343290192e-05, 2.257680735288779e-04, 2.348724575668713e-05, -1.452326963773569e-04, -1.656744053365796e-05, 6.628410073626017e-05, -1.325798118937544e-04, -1.013853365927846e-03, 1.144426420525721e-03, -3.644645897383992e-04,  5.771082099330701e-04, 5.293745115385699e-05, 1.109435211404705e-04, -3.069242516673190e-04, 1.652836450977171e-04, 2.486155319086674e-04, 1.734114364542957e-04, -4.806076613342378e-04, 5.807063025873891e-05, -2.883196801984791e-04, 2.059451407052236e-03, 1.156088266912411e-03, -3.225969545337301e-04, 8.311747651933156e-05,  3.461176878366510e-04, 8.905744559458944e-04, -6.541253735990836e-04, 5.885171539652271e-04, -2.768719701838950e-03, 1.339629418070373e-03, -2.726090280784007e-04,  1.189182158381949e-03, -2.008094239036973e-04, 1.529550503042795e-03, 1.947381185224185e-04, -3.174165472081303e-04, -1.995025194961045e-04, -5.856225428010069e-04, -7.045431428006243e-04, 2.252185840806341e-04, -1.243024645119287e-04, 2.073971633301692e-04, -8.515158368231974e-06, 1.853844348962592e-04, 1.123355272034948e-04,  1.664536418239402e-03, 6.047188271958396e-06, 1.234881577517414e-04, -5.018050947660788e-04, 5.686552820859192e-04, 8.499915546393394e-05, 3.083787574695254e-04,  2.434816371916039e-04, 1.605235350052455e-04, 1.914391884978952e-04, -3.145695709257694e-04, -9.274597448419570e-05, 6.161464718069449e-04, 1.821489039466567e-04, -1.154024397950268e-04, -3.799825824806494e-05, -5.041093156169490e-04, -9.124270686259373e-08, 1.543750201798626e-07, -3.673996918147810e-04, 6.183902526102950e-04, -2.566644180863893e-04, 5.581816903946449e-05, 1.708596876407874e-04, 2.840596710627218e-03, -8.038967817936161e-04, 2.647811007824494e-04, -7.875534379888852e-04,  4.195388520358770e-04, -2.577684207671632e-04, 4.892163394772742e-04, -3.411877313453092e-04, -5.603442732102440e-04, -3.603840435149551e-04, -1.040545880828586e-04, -6.784575743512348e-04, 1.224345149754682e-03, -3.162195590208562e-05, 7.013128347266326e-04, -4.419010977714224e-04, -5.730314648264825e-05, 1.663311259372857e-04,  2.974076596280078e-04, -6.978418066593744e-04, 5.376633221618651e-04, 9.040257221686042e-05, 2.690004469005580e-04, -1.013125245431551e-04, 1.675651338986081e-03, -4.045907090317832e-04, 6.792362342494451e-04, 6.626719448863309e-06, 5.242484915484229e-04, -2.084629798919435e-03, 3.147303933415367e-04, 4.069330879381632e-04, -8.589322915366808e-04, -7.084844184498863e-04, 1.046949599870434e-03, -3.698232817044065e-04, 6.865465335009755e-03, -1.423987791303799e-03, -4.951371772897900e-04, -1.356194380903429e-03, 7.013673147797651e-04, -1.962454245500965e-04, 2.100686225792994e-04, 1.954426650971696e-04, 3.219462660114734e-04, -4.701249571737791e-04,  4.613767737709355e-04, -8.850713962190937e-04, 2.390891824357434e-03, -1.127885350772385e-03, 5.008544274754257e-04, -3.637209290090588e-04, 2.037438870978252e-04,  2.832509013778068e-04, -4.148545163908703e-05, -3.284853839288330e-04, 1.505001621692226e-05, -8.328162326902453e-05, 5.071854166804655e-05, -1.429687273818489e-03,  1.427993156693192e-03, -5.812729904456544e-04, 6.461572189657264e-04, -5.630661475561816e-05, 2.084403296569528e-05, -2.602209527762170e-04, 3.609772509748237e-04,  1.863813884207145e-04, 2.789170705592148e-04, -8.601442313248325e-04, 4.770666964479134e-04, -3.067131335005166e-04, 2.812709435467804e-03 ))

  expect_equal(c(result_exp$n_iter),
               c(10 ))

  expect_equal(c(result_exp$Q),
               c( 0.0370580961920671664, 0.0345963467772989058, -0.0003557184334760463, -0.0208168324454928999, 0.0034728619917547172, 0.0392171609854954847, 0.0300830375782771310, -0.0160971850301466664, -0.0301602504289083875, -0.0313569408271612074, -0.0306887717376336105, 0.0345963467772989058, 0.5717289137904224550, -0.1693307816842452573,  0.1700230942018076674, 0.1984778570580676416, 0.4807634726207671849, 0.4967683968863862987, -0.1729192690136070742, 0.1411418327582904808, 0.0647431154501824507, -0.0833618172404605173, -0.0003557184334760463, -0.1693307816842452573, 0.2119168468022215313, 0.0110665821323677090, -0.1197476903495305334, -0.0233701788460050908, -0.2719627039611726138, 0.0652805476141751356, -0.2844799795246099050, -0.2185261259093933539, -0.0776784797041169678, -0.0208168324454928999, 0.1700230942018076674,  0.0110665821323677090, 0.4765092636466874976, 0.0407658588452820755, 0.1205393468337996876, 0.1022944932641292881, 0.0231158195767835681, 0.0904763582763828816,  0.0287624296792186873, 0.1265554179038979599, 0.0034728619917547172, 0.1984778570580676416, -0.1197476903495305334, 0.0407658588452820755, 0.5038786066010781939,  0.0664306817930897797, 0.5556876220446512749, -0.8218431811900460682, 0.8222832367763351913, 0.1401163036735743050, 0.4363674721916170895, 0.0392171609854954847,  0.4807634726207671849, -0.0233701788460050908, 0.1205393468337996876, 0.0664306817930897797, 0.6282295631147973847, 0.1834767901617633812, 0.0723876559097071937, -0.0428994331023014250, 0.0908925221316656956, -0.2507110877408099681, 0.0300830375782771310, 0.4967683968863862987, -0.2719627039611726138, 0.1022944932641292881,  0.5556876220446512749, 0.1834767901617633812, 0.8901515102286001735, -0.8827424844199700527, 0.7550801217027840462, 0.0673884232722641585, 0.3696558491140079505, -0.0160971850301466664, -0.1729192690136070742, 0.0652805476141751356, 0.0231158195767835681, -0.8218431811900460682, 0.0723876559097071937, -0.8827424844199700527,  1.5899404537764301182, -1.1556632288410999543, 0.1154549012226343124, -0.7511067107080282579, -0.0301602504289083875, 0.1411418327582904808, -0.2844799795246099050,  0.0904763582763828816, 0.8222832367763351913, -0.0428994331023014250, 0.7550801217027840462, -1.1556632288410999543, 1.7246374417352665631, 0.6470389725178905538,  0.8830293658618808550, -0.0313569408271612074, 0.0647431154501824507, -0.2185261259093933539, 0.0287624296792186873, 0.1401163036735743050, 0.0908925221316656956,  0.0673884232722641585, 0.1154549012226343124, 0.6470389725178905538, 0.6426668774606243417, 0.1692644303632286906, -0.0306887717376336105, -0.0833618172404605173, -0.0776784797041169678, 0.1265554179038979599, 0.4363674721916170895, -0.2507110877408099681, 0.3696558491140079505, -0.7511067107080282579, 0.8830293658618808550,  0.1692644303632286906, 0.6091531862500282335 ))

  expect_equal(c(result_exp$Q_0),
               c(100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0,   0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0,   0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100 ))

  expect_equal(c(result_exp$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))
})
