if(interactive()){
  library(survival); library(dynamichazard); library(testthat)
  source("./R/test_utils.R")
}

# Test on data set that is one of Farhmiers papers
result = ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 1, # Use by month intervals
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4,
                 save_data = F, save_risk_set = F),
  a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
  max_T = 45,
  id = head_neck_cancer$id, order = 1
)

# plot(result, cov_index = 1)
# get_expect_equal(result, file = "tmp.txt")

expect_equal(c(result$state_vecs),
             c(-3.5025281961134787, -3.5025877576033477, -3.1321088612085983, -2.7757440091832057, -2.4919226130185796, -2.0481629213672718, -2.1192831215763093, -2.5081974639847040, -2.7397385003032992, -2.8845741297267971, -3.0249425773489134, -3.2400528773087220, -3.3649953385374434, -3.4209971757442106, -3.2738906455544505, -3.3169512577607794, -3.4382520761838764, -3.5423227286382666, -3.5025280610662426, -3.5881855240853717, -3.5581765201478746, -3.6816191615343223, -3.8597566904517313, -3.9786676622646073, -4.0361038571766708, -4.1732583956028995, -4.2656563848289011, -4.3141579768727913, -4.4604842005904972, -4.5793523090954995, -4.6702239867590185, -4.7332575267101360, -4.7685792576318100, -4.7761302924183315, -4.7556545004572994, -4.7067217620380086, -4.6287569806218709, -4.5210666088772840, -4.5211246420955638, -4.6290434142170565, -4.7225212272260517, -4.7987715172838055, -4.8571588039855502, -4.9005507089961524, -4.9291008412739341, -4.9428800599987603, 0.4611869044292034, 0.4611973957569191, 0.4644812524045190, 0.4736355394554351,  0.4669827742862612, 0.4837779729722258, 0.4898265943380803, 0.4860728861187437, 0.5052218028384193,  0.5135282631906429, 0.5190721140735243, 0.5202520241841503, 0.5286518809011893, 0.5439737247040330,  0.5619043578043230, 0.5619249621124215, 0.5611736349659849, 0.5660506677350730, 0.5722505331289359,  0.5773467910015616, 0.5834634039203218, 0.5769074684671019, 0.5749777881080025, 0.5734079048915875,  0.5722037907454223, 0.5757739716021596, 0.5797523773232870, 0.5841753632079369, 0.5934274294860569,  0.6031478029556855, 0.6132990871420009, 0.6238518360306121, 0.6347839458711073, 0.6460791936890807,  0.6577259525203066, 0.6697161933542817, 0.6820447299834685, 0.6947086479136694, 0.7009643574480928,  0.7006518516294673, 0.7004158564901843, 0.7002594597824986, 0.7001824345106531, 0.7001175765838670,  0.7000642351810415, 0.7000221623978419 ))

expect_equal(c(result$state_vars),
             c( 0.24966773368218786, -0.04852029000361392, -0.04852029000361389, 0.10685530511125829,  0.16324645041995289, -0.05271757666862437, -0.05271757666862434, 0.09828781852130458,  0.15325430938443149, -0.05162795076841659, -0.05162795076841659, 0.09136058704366490,  0.13495516427714296, -0.04929835651868680, -0.04929835651868683, 0.08496667085337734,  0.11565049223272644, -0.04726320825775959, -0.04726320825775961, 0.07932121905215284,  0.10178753695006632, -0.04274365026883695, -0.04274365026883695, 0.07487249696497597,  0.08289059384724072, -0.03967528470467367, -0.03967528470467367, 0.07163527330767552,  0.08578092764648139, -0.03846953031547166, -0.03846953031547165, 0.07084598469140357,  0.09989891251830449, -0.03828003928875170, -0.03828003928875170, 0.07199997499224448,  0.11295375016727069, -0.03890277688215408, -0.03890277688215407, 0.07418835553444229,  0.12373842571401289, -0.03974565037309754, -0.03974565037309753, 0.07705264985807921,  0.13473520084838175, -0.04057675152505523, -0.04057675152505523, 0.08045959690347994,  0.15058105305824362, -0.04169144974851560, -0.04169144974851560, 0.08433515349608449,  0.16475487689604817, -0.04313298868294341, -0.04313298868294340, 0.08844909148216468,  0.17649960812428095, -0.04469608555201694, -0.04469608555201694, 0.09271710753685869,  0.17457340811056918, -0.04624984779405965, -0.04624984779405965, 0.09698071771152830,  0.17729143834732247, -0.04793202830663135, -0.04793202830663135, 0.10153069332180298,  0.18781431644426710, -0.04988371630787453, -0.04988371630787453, 0.10645602554255014,  0.20226968890371799, -0.05200709477099941, -0.05200709477099941, 0.11169506602767454,  0.21057571962387894, -0.05417688326323991, -0.05417688326323991, 0.11709140194506812,  0.22152250807520027, -0.05647512985785519, -0.05647512985785519, 0.12275524191816919,  0.22514073774398694, -0.05881421064946086, -0.05881421064946086, 0.12856556534008104,  0.23575065936263351, -0.06169553642911084, -0.06169553642911083, 0.13471898476829020,  0.25340692731452963, -0.06480570637453512, -0.06480570637453510, 0.14123036954284510,  0.27107977399326072, -0.06808713214761060, -0.06808713214761059, 0.14798506451979404,  0.28472014812725088, -0.07152287576324623, -0.07152287576324623, 0.15491381998439313,  0.30339422994056781, -0.07518177129671275, -0.07518177129671275, 0.16212017559769024,  0.32068511056675808, -0.07881456491481259, -0.07881456491481259, 0.16951965225692336,  0.33378230195915271, -0.08244341708455906, -0.08244341708455906, 0.17707023560687726,  0.35358556972543320, -0.08605941482097960, -0.08605941482097960, 0.18490296127670985,  0.37617971793236965, -0.08966669605211727, -0.08966669605211727, 0.19295926473176217,  0.39964313796565276, -0.09325935310968274, -0.09325935310968275, 0.20120153675928507,  0.42279983339880933, -0.09682742127231320, -0.09682742127231321, 0.20960319710208880,  0.44474826795908584, -0.10035929363122134, -0.10035929363122136, 0.21814439918955283,  0.46465242556313213, -0.10384280859001971, -0.10384280859001972, 0.22680979489598740,  0.48163515765033976, -0.10726579703353845, -0.10726579703353846, 0.23558722226836393,  0.49471515025978507, -0.11061639909706367, -0.11061639909706368, 0.24446686862305730,  0.50276354516355681, -0.11388328248736546, -0.11388328248736547, 0.25344070457840195,  0.50362840905683237, -0.11694708051804112, -0.11694708051804113, 0.26249616065860049,  0.50886077519654149, -0.12000602290451649, -0.12000602290451649, 0.27177305917769967,  0.53753940894196228, -0.12331671148414861, -0.12331671148414861, 0.28150057273930468,  0.58422478156386226, -0.12675788251307221, -0.12675788251307221, 0.29159871019358652,  0.64854604358809853, -0.13024962589839847, -0.13024962589839847, 0.30202284254748069,  0.72726312575007357, -0.13408461161855237, -0.13408461161855237, 0.31268054143506063,  0.82372145328515756, -0.13821320036111659, -0.13821320036111659, 0.32355970964820718,  0.94204781019899575, -0.14259877676047242, -0.14259877676047242, 0.33465057109659269 ))

expect_equal(c(result$lag_one_cov),
             c( 0.14263116443415219, -0.04574920743260352, -0.05150543127174809, 0.09699079285706530,  0.10452193073617830, -0.04874739256245561, -0.05088688773815839, 0.08928873888007144,  0.09205816511743103, -0.04756288533170949, -0.04850365075455021, 0.08264748691502014,  0.07619687084467806, -0.04535505584257066, -0.04622466673349493, 0.07665184030229086,  0.06287176863202983, -0.04325886709103238, -0.04160716987308177, 0.07163427585559659,  0.04986944205987141, -0.03926405432290643, -0.03806053191486011, 0.06781573294293351,  0.04420678758208781, -0.03685812925848052, -0.03626291638490246, 0.06582468960959215,  0.04965011164211783, -0.03619367549364379, -0.03566682153220575, 0.06600412552478148,  0.05984037617699758, -0.03636192416054163, -0.03603336054933529, 0.06766354299450550,  0.06941035250370327, -0.03719088862092337, -0.03674084832627796, 0.07017664132977827,  0.07843493570034743, -0.03816550473187627, -0.03750684008628748, 0.07329844218824491,  0.08981493623946754, -0.03911819040254304, -0.03855808469632750, 0.07692587692407565,  0.10310658635478691, -0.04033010070998009, -0.03993869643713704, 0.08090961285689185,  0.11484463103360977, -0.04182722190206258, -0.04147133842862829, 0.08509110857921251,  0.11943889701282755, -0.04342857676366355, -0.04299835576581806, 0.08934994645705957,  0.11985243543009538, -0.04503133111582946, -0.04463580013043104, 0.09374691854979829,  0.12588538775084249, -0.04678858788297480, -0.04651894024076669, 0.09847389307447472,  0.13738385412440385, -0.04880681824779191, -0.04858628426379726, 0.10354633878610373,  0.14810467051698023, -0.05097881767359873, -0.05071611232481709, 0.10885655043099464,  0.15713971417898470, -0.05320244372983142, -0.05296561856819847, 0.11437825391674580,  0.16409749051278422, -0.05554564899105975, -0.05526366996309488, 0.12010875527332561,  0.17082169764926447, -0.05798517239621716, -0.05803435922163328, 0.12608210458780958,  0.18419244224951820, -0.06094157095036142, -0.06106650077427613, 0.13240606956799864,  0.20111915566759409, -0.06411857444864097, -0.06428014648816466, 0.13903231308527825,  0.21626339706997472, -0.06746230932018556, -0.06765132467092075, 0.14586836604869613,  0.23182744393716970, -0.07096532642848453, -0.07123809751737308, 0.15292935143336489,  0.24930432312366094, -0.07466552730666579, -0.07483158079442649, 0.16022691389911348,  0.26415101326279677, -0.07833917344388450, -0.07842064208601737, 0.16769729388739543,  0.28012526849294306, -0.08200216252035231, -0.08200453448237387, 0.17538307791434882,  0.30081469440241881, -0.08565137931089720, -0.08558233025367115, 0.18332254453471691,  0.32337781059751103, -0.08928760593720944, -0.08914990301383557, 0.19146736372042583,  0.34628498339489699, -0.09290425309985131, -0.09269742679066141, 0.19978529664717548,  0.36849989976218822, -0.09649155120250313, -0.09621288382965747, 0.20825303230026262,  0.38915143680505826, -0.10003839047880873, -0.09968351196260299, 0.21685290223635492,  0.40737973041049202, -0.10353321248541911, -0.10309647246244749, 0.22557109735345471,  0.42225260062760034, -0.10696449380634662, -0.10643920190335200, 0.23439658806889352,  0.43271270640033899, -0.11032104844718801, -0.10969963395979600, 0.24332041966466161,  0.43712323548021881, -0.11357939358846696, -0.11277225427960132, 0.25233231529368649,  0.44011649003356479, -0.11665841117598591, -0.11581344390893213, 0.26149456293695200,  0.45665574959249472, -0.11976869591380095, -0.11906857542687402, 0.27099088451026349,  0.49359720139669694, -0.12311415858361298, -0.12247186720389780, 0.28089856452764828,  0.54817221315200193, -0.12657419894355940, -0.12594165166472532, 0.29115499561373626,  0.61879172548337624, -0.13011247751412444, -0.12971638317819814, 0.30169208152706284,  0.70537058299019650, -0.13398820658801849, -0.13378869915457109, 0.31245682036970446,  0.81162044555582791, -0.13815236427340125, -0.13812122259985932, 0.32343824571520668 ))

expect_equal(c(result$fixed_effects),
             c(numeric(0) ))

expect_equal(c(result$n_iter),
             c(155 ))

expect_equal(c(result$Q),
             c( 0.142998595679639462, -0.004474914532711241, -0.004474914532711241, 0.011173790883017135 ))

expect_equal(c(result$Q_0),
             c(1, 0, 0, 1 ))

expect_equal(c(result$n_risk),
             c(96, 95, 91, 84, 78, 65, 53, 49, 46, 43, 39, 37, 36, 36, 33, 31, 30, 30, 25, 25, 23, 21, 21, 21, 20, 19, 19, 18, 18, 18, 18, 18, 18, 18, 18, 18, 17, 15, 14, 14, 14, 12, 12, 12, 11 ))

expect_equal(c(result$times),
             c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45 ))

expect_equal(c(result$risk_set),
             c(NULL ))

expect_equal(c(result$data),
             c(NULL ))

expect_equal(c(result$order),
             c(1 ))

expect_equal(c(result$F_),
             c(1, 0, 0, 1 ))

expect_equal(c(result$method),
             c("EKF" ))

expect_equal(c(result$model),
             c("logit" ))

expect_equal(c(result$est_Q_0),
             c(FALSE ))

expect_equal(c(result$LR),
             c(1 ))

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result$Q_0)), rep(c("(Intercept)", "group1"), 2))
})

tmp <- file("tmp.txt")
sink(tmp)
suppressMessages(
  result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 1, Q_0 = diag(.1, 2),
    Q = diag(1e-3, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4,
                   debug = T),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential"))
sink()
close(tmp)

# matplot(result_exp$state_vecs, type = "l")
plot(result_exp, cov_index = 1)
# get_expect_equal(result_exp, file = "tmp.txt")

test_that("Result of exponential model on head_neck_data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.746423060135996685, -3.746504060013073900, -3.411975048951466860, -3.123640371003203242, -2.982809608911737520, -2.590346163235035526, -2.707462197276075067, -3.063090315919674733, -3.210805574368385873, -3.315742889070746102, -3.426247363612953123, -3.615220620358764236, -3.697315516637163402, -3.694960055771935981, -3.514271049590928619, -3.583085023499657851, -3.710830938614790853, -3.795127010362230990, -3.748048132503383201, -3.815987456462097249, -3.777482704888463161, -3.920316568467759666, -4.088637675068001798, -4.201323487740026508, -4.259461256379053040, -4.367477036724612738, -4.433043652875148233, -4.459456746007150585, -4.550360855046704067, -4.610000022861876268, -4.639325243012230260, 0.267804490680041141, 0.267771787453442156, 0.403121813911384685, 0.520049844804208572,  0.576160248484232418, 0.735892530651090726, 0.689094230510559402, 0.545630086365206601, 0.487798497798527519,  0.446442789310776300, 0.402597030242301868, 0.326664433404419530, 0.294377499738915582, 0.296650845900248650,  0.371113979808708139, 0.343329377363240540, 0.291614728358585928, 0.257804270528158685, 0.277126693289556969,  0.249812884521956741, 0.265542761334367383, 0.206999786494018956, 0.138432166714767713, 0.092322841165753983,  0.068242479179494192, 0.024306252492979658, -0.002487643961411226, -0.013462865355197196, -0.050190793123115238, -0.074287656203643360, -0.086136417649086819 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.220295737757598364, 0.030605438335697444, 0.030605438335697410, 0.107887831584073779, 0.145517332013094386, -0.001660812188336636, -0.001660812188336663, 0.093157593036923003, 0.138465436387046198, -0.005483167613022810, -0.005483167613022810, 0.090459598666057905, 0.121190284462693143, -0.013473739641127053, -0.013473739641127053,  0.086110274476198068, 0.101662279453035381, -0.022908096953915380, -0.022908096953915352, 0.081038208697458758,  0.095867522458459364, -0.023885306692934857, -0.023885306692934843, 0.080689754615085069, 0.077456526357003314, -0.030960843306268769, -0.030960843306268776, 0.077602255823180491, 0.082455078200529969, -0.027693058748322806, -0.027693058748322806, 0.079340402366294610, 0.097620413611103074, -0.019611163477797986, -0.019611163477797990,  0.083536337148846770, 0.108527839469235637, -0.013899742692818465, -0.013899742692818469, 0.086642393140734547,  0.117270064414540853, -0.009209497548788718, -0.009209497548788718, 0.089378028472115539, 0.126593308401248106, -0.004213354226871995, -0.004213354226872004, 0.092352613543143031, 0.142056902973380222, 0.003246515045985453,  0.003246515045985445, 0.096393662153779189, 0.154670481364136941, 0.009174882144043255, 0.009174882144043245,  0.099714166376657809, 0.162243181462978447, 0.012759067407502343, 0.012759067407502333, 0.102003897171627778,  0.154263017275540815, 0.009671257575669605, 0.009671257575669601, 0.101468499748081642, 0.156268829056957770,  0.010708150500953185, 0.010708150500953181, 0.102691939758461775, 0.167351999992699452, 0.015510896273943500,  0.015510896273943500, 0.105530910705355946, 0.180549724125395994, 0.021142568352647155, 0.021142568352647155,  0.108735832386015252, 0.186676114925689196, 0.023696715611691128, 0.023696715611691115, 0.110636132361143863,  0.195132553747604187, 0.027239491848385596, 0.027239491848385589, 0.112988513500728624, 0.195802238977011434,  0.027491757655777889, 0.027491757655777889, 0.113976217186229828, 0.207695680825756651, 0.032192216268221538,  0.032192216268221538, 0.116764105693921788, 0.227752670178947458, 0.040306746418476834, 0.040306746418476841,  0.121009914489442844, 0.249896037576859964, 0.049182391963886199, 0.049182391963886199, 0.125552580822571369,  0.271761552831857933, 0.057783298444313118, 0.057783298444313125, 0.129935708438214170, 0.302118813679059628,  0.069780714362332324, 0.069780714362332324, 0.135696484455231470, 0.338266746322974599, 0.084091957207221874,  0.084091957207221874, 0.142395942290244937, 0.380742938825434474, 0.100879963944609241, 0.100879963944609241,  0.150075305372945611, 0.444466596145961845, 0.126328250804517594, 0.126328250804517594, 0.161299161876744979,  0.531999976361760107, 0.161392148387444728, 0.161392148387444728, 0.176418095681750153 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(72 ))

  expect_equal(c(result_exp$Q),
               c(0.11712173734693690, 0.04695251832094549, 0.04695251832094549, 0.01990459209039402 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(0.0877914951989026 ))
})

test_that("exponential model and logit moels hazzard functions differs", {
  expect_true(result_exp$model != result$model)
  expect_true(toString(body(result_exp$hazard_func)) !=
                toString(body(result$hazard_func)))
  expect_true(toString(body(result_exp$hazard_first_deriv)) !=
                toString(body(result$hazard_first_deriv)))
})

test_that("Testing names of output from ddhazard on head and neck cancer dataset", {
  expect_equal(colnames(result_exp$state_vecs), c("(Intercept)", "group1"))
  expect_equal(unlist(dimnames(result_exp$state_vars)), unlist(list(c("(Intercept)", "group1"), c("(Intercept)", "group1"), NULL)))
  expect_equal(unlist(dimnames(result_exp$Q)), rep(c("(Intercept)", "group1"), 2))
  expect_equal(unlist(dimnames(result_exp$Q_0)), rep(c("(Intercept)", "group1"), 2))
})


# Change by argument
suppressMessages(result_exp <- ddhazard(
  formula = survival::Surv(start, stop, event) ~ group,
  data = head_neck_cancer,
  by = 2, Q_0 = diag(1, 2),
  Q = diag(1e-1, 2),
  control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-3),
  max_T = 30,
  id = head_neck_cancer$id, order = 1,
  verbose = F,
  model = "exponential"
))

# matplot(result_exp$state_vecs, type = "l")
# plot(result_exp, cov_index = 1)
# get_expect_equal(result_exp, file = "tmp.txt")

test_that("Result of exponential model on head_neck_data match previous results with altered by argument", {
  expect_equal(c(result_exp$state_vecs),
               c(-3.87037427961885383, -3.87023087984429326, -1.91221037934947025, -2.43862280740296100, -3.22165530139148526, -3.30681140748686797, -3.89651206337075617, -3.63305833903981856, -3.53490169069086635, -3.92811419830653863, -3.83445633104215533, -4.08572279262521310, -4.38977418588174118, -4.59111421278896614, -4.26627051055878859, -4.65585179523574677, 0.25164279033439135, 0.25144509924460229, 1.37673532204583315, 1.01993204104296042,  0.53459101788916963, 0.54030801834951736, 0.19704401242214445, 0.43237882659576832, 0.45550100210285527,  0.22267296417307317, 0.25618524455277258, 0.00618157586681295, -0.22706286691347843, -0.37988354475124742, -0.23811812709966915, -0.45275960647321628 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.441292543450496955, 0.119914593826589019, 0.119914593826589033, 0.293711418856185458, 0.153610075857844225, -0.028908871706440492, -0.028908871706440492, 0.156586679956091435, 0.173792970426504961, 0.004791443767631409,  0.004791443767631437, 0.141115685933586310, 0.055149694875353913, -0.046529344162667019, -0.046529344162667019,  0.067349697349126936, 0.075678008174908079, -0.038645834720671388, -0.038645834720671381, 0.085822125254475176,  0.132443974179516144, -0.014948731361429442, -0.014948731361429435, 0.129403658956841972, 0.155750605430720168, -0.014692267525394792, -0.014692267525394792, 0.157893280988063045, 0.254860141089101100, 0.034077493139793191,  0.034077493139793191, 0.222756109854566703, 0.238890329496455001, 0.004944733239908717, 0.004944733239908720,  0.232124143223547630, 0.226881610397214217, -0.020933213616808371, -0.020933213616808360, 0.247184584339527252,  0.334349783425151426, 0.024953265993933792, 0.024953265993933771, 0.318490259893117411, 0.340131045559659451,  0.003272646957310301, 0.003272646957310294, 0.348947458402341093, 0.415849736184024044, 0.030333279839828829,  0.030333279839828808, 0.421743984834121899, 0.523382410162643530, 0.072540529768555781, 0.072540529768555739,  0.509325662871255580, 0.641622171871534919, 0.114835421711122015, 0.114835421711121988, 0.599146059513987028,  0.618035296626318953, 0.065811216941824985, 0.065811216941824985, 0.632932302407492875 ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(16 ))

  expect_equal(c(result_exp$Q),
               c(0.3409762050461504, 0.1803436136440473, 0.1803436136440473, 0.1426526945307628 ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("EKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(0.1316872427983539 ))
})

# for(s in sample.int(1e6, 100, replace = F)){
# print(s)
# set.seed(s)
set.seed(599479)

sims <- test_sim_func_exp(n_series = 1e3, n_vars = 10, t_0 = 0, t_max = 10,
                          x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                          intercept_start = -5, sds = c(.1, rep(1, 10)))
# tmp_file <- file("exponential.log")
# sink(tmp_file)
suppressMessages(result_exp <- ddhazard(
  formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
  data = sims$res,
  by = (by_ <- 1),
  Q_0 = diag(10, 11),
  Q = diag(1e-2, 11),
  control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^3),
  max_T = 10,
  id = sims$res$id, order = 1,
  verbose = F,
  model = "exponential"))
# sink()
# close(tmp_file)

# matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
# matplot(result_exp$times, result_exp$state_vecs, result_exp$state_vecs, type = "l", lty = 2, add = T)
# get_expect_equal(result_exp, eps = 1e-5, file = "tmp.txt")

test_that("Result of exponential model on simulated data match previous results", {
  expect_equal(c(result_exp$state_vecs),
               c(-5.188203295858222042, -5.192867919169898094, -4.310316958425439715, -4.336320945330846222, -4.064762463526304437, -4.470068713489812495, -4.278183682563193813, -4.738207889373453163, -5.080239744824088355, -4.330098903059813154, -3.512832514783392313, 0.903535714308593918, 0.894331964133800561, 1.816929462718155142, 0.620636215330882868, -1.210916388947183453, -2.124633635549365795, -2.018309280940417949, -2.663985587934378785, -2.388579061828196348, -1.695473603518183658, -0.908981390672407796, -1.764398534960296638, -1.783669340597084485, 0.613675018496285141, -1.259230230844413434, -3.749789731748256916, -5.281844649984472007, -4.760451807749158881, -5.760598422852969414, -4.862687284882237115, -3.721453497357167350, -2.131048877181849210, 0.646734126164619449, 0.645014594742284952,  0.674528187264348711, 0.525849444022213341, 0.419254877067003873, 0.119506867082035007, 0.344312436531998556, -0.151188667141975652, -0.984275580736283739, -0.147218581461528275, 0.643775114143569249, 0.903078090752215124,  0.906729758787989892, 0.869950217759679956, 1.595274505346900407, 2.797467744558432390, 3.253341266223266803,  3.096065389005932644, 3.496517930806801733, 3.662144599252522337, 3.192325862453184726, 2.735585334977329808,  0.678519650708181765, 0.678283654429648220, 0.307016411703131709, 0.022340565125074319, -0.486681248517496334, -0.760715580711739725, -0.664154943419190902, -1.102134793443673821, -1.900241848609568907, -1.240890040051801702, -0.694924949031594075, -0.520770279577914441, -0.521900942890573538, -0.531901667471322948, -0.584528090136232525, -0.547787771140243018, -0.717278086797987546, -0.478133042485134219, -0.786054878228679588, -1.427949733333044646, -0.838069475769509964, -0.265493352688137230, 0.051633853669528731, 0.037845740492234659, 2.924056990572987402,  2.377243559493144698, 2.098266161187867684, 1.786915474205531540, 1.968123287727698845, 2.491452526580773430,  5.761100690828738990, 4.585940059361372612, 3.944717989283841320, 1.113496343379008380, 1.109175268779626355,  1.999820516717627950, 1.860492444907890119, 1.863381980316567210, 1.696891414664366993, 1.769589769007558377,  1.745902104086367590, 2.445779023827046927, 2.361342564113131814, 2.383779024039542449, 1.713304661384221772,  1.717483031231116231, 0.609252124153554675, 0.676695613135207874, 0.634783559424135002, 0.517114549821963809,  0.547429584398183788, -0.011728153257258622, -1.912657666273230195, -0.887684276927991345, -0.007803321122974438, -1.986860410843613423, -1.973053825621926993, -5.027206005632039343, -4.593177841377539039, -4.503053956458455076, -4.187297705728798114, -4.284967037244340027, -4.835946927079818991, -8.222364049774895989, -6.998889221581012343, -6.308863713569206944 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$state_vars),
               c( 0.3564718209647352865, 0.1502042108545438848, 0.3949362494855248595, 0.2124595209322067413, -0.0476819667674404646, 0.1018442896498744504, 0.1609053367419655267, -0.0551357559837619485,  0.0553818409885371565, 0.1688038124507954263, 0.0525114410273263485, 0.1502042108545438848,  0.8663100540189390131, 1.2243281841372029017, 0.1855384361571849883, -0.4604454500014331653,  0.2503434462059512811, 0.0944020402948364534, 0.1617109294087489546, 0.0776916954361121792,  0.0888071993212603689, -0.1143341085457198342, 0.3949362494855247485, 1.2243281841372029017,  2.2197518498388131292, 0.3452033531635448904, -0.6782092839561278952, 0.3280807046148012107,  0.2242126480805420596, 0.5936128917560727913, 0.2212026029497712876, 0.0388679022587088835, -0.5096810431421557874, 0.2124595209322067413, 0.1855384361571850715, 0.3452033531635449459,  0.3066692478863988214, -0.1342364305139721325, 0.1881638378090466635, 0.1847533401768684524, -0.3227674414196349817, -0.0196826386375874331, 0.3038689827745920113, 0.3428542682694438182, -0.0476819667674404438, -0.4604454500014334428, -0.6782092839561280062, -0.1342364305139721325,  0.3831971041731261352, -0.1983124470282424667, -0.0893577393272062814, 0.0735754083882483173,  0.0081059966737519681, -0.1278031294679441432, -0.1368207672945087050, 0.1018442896498744088,  0.2503434462059513921, 0.3280807046148014328, 0.1881638378090466912, -0.1983124470282425222,  0.2648395318915124363, 0.1292535636669398247, -0.3767381053890948017, -0.0608516892457050609,  0.2841805186090277102, 0.4130142849545426764, 0.1609053367419656100, 0.0944020402948365228,  0.2242126480805420874, 0.1847533401768683692, -0.0893577393272062537, 0.1292535636669398247,  0.2069051716891880943, -0.2328161296450839690, -0.0222871352651428378, 0.2155878130752736654,  0.2582611382948359346, -0.0551357559837620109, 0.1617109294087490379, 0.5936128917560725693, -0.3227674414196348707, 0.0735754083882483173, -0.3767381053890944687, -0.2328161296450839690,  1.6980868970208273794, 0.3741475264367888909, -0.8838837043260465709, -1.6803768439410917690,  0.0553818409885371774, 0.0776916954361122347, 0.2212026029497712598, -0.0196826386375874261,  0.0081059966737519508, -0.0608516892457050332, -0.0222871352651428378, 0.3741475264367889464,  0.1742668935710796063, -0.1701766214639477137, -0.3943139678935742021, 0.1688038124507953985,  0.0888071993212603827, 0.0388679022587088488, 0.3038689827745921224, -0.1278031294679440877,  0.2841805186090277102, 0.2155878130752736099, -0.8838837043260469040, -0.1701766214639477137,  0.6422702852407251584, 0.9143797346648711022, 0.0525114410273262791, -0.1143341085457198758, -0.5096810431421558985, 0.3428542682694437627, -0.1368207672945086495, 0.4130142849545427874,  0.2582611382948359346, -1.6803768439410924351, -0.3943139678935742576, 0.9143797346648711022,  1.8316815271254398567, 0.0755229691425798877, 0.0150403026074210494, 0.0638946375928686194,  0.0351240106431329885, -0.0074949398183738331, 0.0161304587455404769, 0.0321454487166744976, -0.0236149149571044485, -0.0005326541614235347, 0.0288320307999519188, 0.0337315221568559587,  0.0150403026074210772, 0.2981174558699241084, 0.3228304959990835332, 0.0344953129534601097, -0.1372271092678233328, 0.0742397421708959060, 0.0063403885773025415, 0.0257094615546330924,  0.0148061443669236445, 0.0227934942289047676, -0.0156411384901818454, 0.0638946375928686056,  0.3228304959990835332, 0.6196144957630375094, 0.0787442000910802686, -0.1973213125090947651,  0.0918764024889000136, 0.0552997613699467011, 0.1333404441914082250, 0.0396603188211801100,  0.0133365015253159927, -0.0964537276866831994, 0.0351240106431329746, 0.0344953129534601305,  0.0787442000910802270, 0.1167558079369673818, -0.0324175248726315673, 0.0455917949012193888,  0.0518455308777304724, -0.0755190431111950611, -0.0029186013783272999, 0.0740225456331340959,  0.0826681140399420644, -0.0074949398183738192, -0.1372271092678234716, -0.1973213125090947095, -0.0324175248726315535, 0.1570409107964362283, -0.0598271800681427837, -0.0246698534529133130,  0.0134623670205698785, 0.0016038981750589776, -0.0262549776604951088, -0.0377437206308154360,  0.0161304587455404561, 0.0742397421708959615, 0.0918764024888999720, 0.0455917949012194026, -0.0598271800681428462, 0.1068986597894454604, 0.0305196659425098875, -0.0876868596859152333, -0.0122322386717625166, 0.0650188680241305939, 0.0981344954545152054, 0.0321454487166745045,  0.0063403885773026056, 0.0552997613699466387, 0.0518455308777304724, -0.0246698534529133269,  0.0305196659425098771, 0.1002929312876404966, -0.0483455202810034387, -0.0073587678894963364,  0.0486543949853659591, 0.0628465635259846528, -0.0236149149571045144, 0.0257094615546331479,  0.1333404441914080862, -0.0755190431111950056, 0.0134623670205699097, -0.0876868596859150529, -0.0483455202810034665, 0.4360614675624030490, 0.0827916630661595376, -0.2075790895970882621, -0.3815261487635674409, -0.0005326541614235208, 0.0148061443669236913, 0.0396603188211800475, -0.0029186013783272999, 0.0016038981750589585, -0.0122322386717624854, -0.0073587678894963347,  0.0827916630661596348, 0.0831112694054743084, -0.0411941736733142522, -0.0879718009141046281,  0.0288320307999518910, 0.0227934942289047607, 0.0133365015253159580, 0.0740225456331341652, -0.0262549776604951088, 0.0650188680241305939, 0.0486543949853659036, -0.2075790895970884287, -0.0411941736733142660, 0.1975923635156064950, 0.2113725903873455714, 0.0337315221568559032, -0.0156411384901818731, -0.0964537276866832965, 0.0826681140399420922, -0.0377437206308153875,  0.0981344954545153719, 0.0628465635259846389, -0.3815261487635673854, -0.0879718009141046836,  0.2113725903873457934, 0.4687297824200610252, 0.0665838676620906927, 0.0240103450712270232,  0.0746656777222383800, 0.0282308130902155091, -0.0051185976596646657, 0.0094948760719356928,  0.0243112416867661482, -0.0026784586780963411, 0.0044776706025215496, 0.0167117216883624770,  0.0074111032529636384, 0.0240103450712270787, 0.2489805992497309828, 0.2792342874294141408,  0.0352925732627961258, -0.1116865708517331829, 0.0616576534203468959, 0.0107238408595546047,  0.0252818072700318856, 0.0155288944648528764, 0.0239352257045015657, -0.0169383416224280631,  0.0746656777222383106, 0.2792342874294141963, 0.5457013104021826155, 0.0710797885264684570, -0.1596615662333365770, 0.0753270916459616163, 0.0471606005163159175, 0.1269335911760236524,  0.0416553978110258405, 0.0117662412202026011, -0.1011621899216662845, 0.0282308130902155230,  0.0352925732627961120, 0.0710797885264684570, 0.0973045213967378420, -0.0258504753440704643,  0.0369075701271407083, 0.0392020325930455410, -0.0629085512103193523, -0.0020002748968701756,  0.0615695376033766062, 0.0653518757391182564, -0.0051185976596646587, -0.1116865708517332523, -0.1596615662333364383, -0.0258504753440704643, 0.1317747947928820107, -0.0496034473063971526, -0.0194817105913085396, 0.0156667791416738936, 0.0025825977493157300, -0.0247686155021507072, -0.0357288773607840962, 0.0094948760719356790, 0.0616576534203469376, 0.0753270916459615747,  0.0369075701271407083, -0.0496034473063971873, 0.0909167520549178931, 0.0242280965298835374, -0.0776568961796967328, -0.0117692317898151471, 0.0562548774313715860,
                  0.0859002947722688481,  0.0243112416867661621, 0.0107238408595546706, 0.0471606005163158967, 0.0392020325930455271, -0.0194817105913085674, 0.0242280965298835235, 0.0804287367937793762, -0.0400308560799835303, -0.0061515315563477509, 0.0389614648486074841, 0.0489123732356284563, -0.0026784586780963706,  0.0252818072700319481, 0.1269335911760236524, -0.0629085512103194078, 0.0156667791416739074, -0.0776568961796966356, -0.0400308560799835789, 0.3943233067047047791, 0.0772406354016890589, -0.1817669108846280968, -0.3466324496471754890, 0.0044776706025215496, 0.0155288944648528937,  0.0416553978110258127, -0.0020002748968701791, 0.0025825977493157109, -0.0117692317898151367, -0.0061515315563477457, 0.0772406354016890728, 0.0745871937166110444, -0.0364307345835694490, -0.0827150111574497526, 0.0167117216883624492, 0.0239352257045015622, 0.0117662412202026220,  0.0615695376033766062, -0.0247686155021507107, 0.0562548774313715652, 0.0389614648486074841, -0.1817669108846281523, -0.0364307345835694629, 0.1692955873293200408, 0.1833135347313854524,  0.0074111032529636106, -0.0169383416224280908, -0.1011621899216662568, 0.0653518757391182564, -0.0357288773607840893, 0.0859002947722689730, 0.0489123732356284563, -0.3466324496471752670, -0.0827150111574497665, 0.1833135347313855079, 0.4246053340460555492, 0.0387760537796417587, -0.0169909441548118760, -0.0108903117950929010, 0.0126151821746198281, 0.0055828161765003933,  0.0055212367982150788, 0.0164488589531234797, -0.0436413042593582767, -0.0111317107817416189,  0.0179372277994738864, 0.0516466798429706386, -0.0169909441548118829, 0.1016353197702104666,  0.0557487799532663392, -0.0025779208616847253, -0.0317791563702843338, 0.0146390304127108940, -0.0107841584214783560, 0.0036688151491958282, 0.0020603573299375543, 0.0005012566281814260, -0.0034079142573841524, -0.0108903117950929062, 0.0557487799532663114, 0.1312436997521687354,  0.0068040207087430877, -0.0395310559406196957, 0.0182932096446945525, 0.0043814103352542684,  0.0119650727182096708, -0.0002520202103322416, 0.0028134915770576243, -0.0015179151982664578,  0.0126151821746198350, -0.0025779208616847340, 0.0068040207087430946, 0.0595230826098082366, -0.0005725541268576887, 0.0103250523360019220, 0.0175939507145214773, -0.0282903096332548232,  0.0004773131897977337, 0.0228984450989259784, 0.0285693089245477039, 0.0055828161765003933, -0.0317791563702844587, -0.0395310559406196055, -0.0005725541268576939, 0.0678419237157850963, -0.0124898786676012584, -0.0020743604155622113, -0.0030020884209542749, -0.0003626007562095371,  0.0015026692516011799, -0.0057701281841637964, 0.0055212367982150632, 0.0146390304127109096,  0.0182932096446945212, 0.0103250523360019462, -0.0124898786676012653, 0.0501054804335923504,  0.0076045511780133881, -0.0183544494140746965, -0.0001569035540571299, 0.0120466860646081062,  0.0215666604177226044, 0.0164488589531234936, -0.0107841584214782953, 0.0043814103352542207,  0.0175939507145214495, -0.0020743604155622338, 0.0076045511780133924, 0.0582271172780115254, -0.0192536594580668373, -0.0034087466249594738, 0.0148771308535675141, 0.0246499686328153812, -0.0436413042593583114, 0.0036688151491958403, 0.0119650727182096864, -0.0282903096332548579, -0.0030020884209542437, -0.0183544494140747451, -0.0192536594580668859, 0.1304588548177526564,  0.0115987641058708339, -0.0502104241362456294, -0.0854887643475530923, -0.0111317107817416328,  0.0020603573299375821, -0.0002520202103322936, 0.0004773131897977380, -0.0003626007562095666, -0.0001569035540571247, -0.0034087466249594538, 0.0115987641058708374, 0.0488695504086170129, -0.0074487659253321872, -0.0145562571281026235, 0.0179372277994738899, 0.0005012566281814308,  0.0028134915770576083, 0.0228984450989259541, 0.0015026692516011803, 0.0120466860646080958,  0.0148771308535675002, -0.0502104241362456571, -0.0074487659253322114, 0.0772272661656021736,  0.0495324927796831349, 0.0516466798429706317, -0.0034079142573841346, -0.0015179151982664700,  0.0285693089245476796, -0.0057701281841637765, 0.0215666604177226842, 0.0246499686328153604, -0.0854887643475529951, -0.0145562571281025854, 0.0495324927796830794, 0.1494750451722671181,  0.0449125881803093333, -0.0030385082500555237, 0.0139286378958670652, 0.0239739645869568724, -0.0045576509389877234, 0.0151656623765085326, 0.0229157926056221817, -0.0495213509964089194, -0.0090577126970655640, 0.0302096181987065206, 0.0597696222430394788, -0.0030385082500555306,  0.1061499393687249521, 0.0829287925900541179, 0.0047357891108694644, -0.0388432401123416302,  0.0171459078343101923, -0.0026658336814929079, 0.0100625218715885874, 0.0044413893099511425,  0.0029441976336309511, -0.0088145215248827888, 0.0139286378958670617, 0.0829287925900541179,  0.1846128284416309606, 0.0205393151016052163, -0.0565037081699213128, 0.0269114816591800414,  0.0153518788845132485, 0.0220704764103038797, 0.0062539912132161847, 0.0083052144992038814, -0.0112908196409780143, 0.0239739645869568654, 0.0047357891108694471, 0.0205393151016052336,  0.0647839367261213162, -0.0050599702561067517, 0.0179240320455897745, 0.0236659665020361384, -0.0402579180197564224, -0.0003044684020162051, 0.0354351789432449590, 0.0417863787628319563, -0.0045576509389877113, -0.0388432401123417620, -0.0565037081699212296, -0.0050599702561067448,  0.0672219051925454364, -0.0138825854884999707, -0.0062348492923361646, -0.0049855027861619196, -0.0016680874050857978, -0.0012941558306047672, -0.0024417686964614506, 0.0151656623765085066,  0.0171459078343101992, 0.0269114816591800067, 0.0179240320455898092, -0.0138825854884999638,  0.0513652380257036412, 0.0140522856235701758, -0.0290250223724292482, -0.0017910230560133004,  0.0227373130637037249, 0.0328229583980094233, 0.0229157926056221956, -0.0026658336814928802,  0.0153518788845132068, 0.0236659665020361107, -0.0062348492923361828, 0.0140522856235701758,  0.0576647292146984930, -0.0287666929366160937, -0.0037828878626689172, 0.0243758281946999007,  0.0344393477392495873, -0.0495213509964089610, 0.0100625218715885700, 0.0220704764103039214, -0.0402579180197564501, -0.0049855027861618832, -0.0290250223724292308, -0.0287666929366161353,  0.1581845565934768549, 0.0184763901823935123, -0.0718232154534486633, -0.1197582357586476076, -0.0090577126970655605, 0.0044413893099511745, 0.0062539912132161483, -0.0003044684020162137, -0.0016680874050858207, -0.0017910230560133082, -0.0037828878626688933, 0.0184763901823935574,  0.0462288017090857761, -0.0100726097387695279, -0.0214583838696109364, 0.0302096181987065240,  0.0029441976336309428, 0.0083052144992038814, 0.0354351789432449660, -0.0012941558306047750,  0.0227373130637037145, 0.0243758281946998764, -0.0718232154534487049, -0.0100726097387695279,  0.0906246749818859498, 0.0730208200767004795, 0.0597696222430394719, -0.0088145215248828044, -0.0112908196409779449, 0.0417863787628319494, -0.0024417686964614020, 0.0328229583980094788,  0.0344393477392496011, -0.1197582357586473162, -0.0214583838696109329, 0.0730208200767005211,  0.1799473863134831986, 0.0357443279952537746, 0.0187838606012037806, 0.0429387234030273734,  0.0176261251563734032, -0.0152229792294686639, 0.0148675101822077667, 0.0154857440867157276, -0.0214966430470702255, -0.0039883535192434287,
                  0.0167431246471781807, 0.0337369367591755787,  0.0187838606012037737, 0.0778269706904730074, 0.0639727861054083802, 0.0121053309485097474, -0.0209035442074435550, 0.0131764627558757525, 0.0032907472068902498, 0.0069057127808981791,  0.0076793272659196488, 0.0058762489017053672, -0.0084163615552328847, 0.0429387234030273734,  0.0639727861054083802, 0.1722244061171773755, 0.0293641126190522968, -0.0395127891929698549,  0.0264900947059089724, 0.0197471666578530360, 0.0185794862660447618, 0.0111964928886216994,  0.0110525994641521991, -0.0110945105152440472, 0.0176261251563733859, 0.0121053309485097300,  0.0293641126190522864, 0.0539825174130073582, -0.0080821076069339526, 0.0144164251877730402,  0.0162099762684597866, -0.0199932020225936438, 0.0016952407749798119, 0.0225998085838039972,  0.0228788705903524084, -0.0152229792294686569, -0.0209035442074436487, -0.0395127891929697647, -0.0080821076069339179, 0.0527449124104252473, -0.0100701985237535221, -0.0082638667666436356, -0.0004251798846757322, -0.0020504191531696115, -0.0031356275968381113, -0.0044641679468201863,  0.0148675101822077407, 0.0131764627558757993, 0.0264900947059089342, 0.0144164251877730264, -0.0100701985237535048, 0.0434876165023446865, 0.0110795395513434980, -0.0138034733974985030,  0.0003691350455453791, 0.0140917377927293752, 0.0174727983491972869, 0.0154857440867157258,  0.0032907472068902602, 0.0197471666578530151, 0.0162099762684597797, -0.0082638667666436391,  0.0110795395513434893, 0.0475514107479612716, -0.0131897259083799331, -0.0021450981864993427,  0.0137072788441822725, 0.0189682050066888562, -0.0214966430470702741, 0.0069057127808981955,  0.0185794862660447341, -0.0199932020225936577, -0.0004251798846757217, -0.0138034733974984319, -0.0131897259083799366, 0.1022591302306897487, 0.0145265441095187731, -0.0376552774647530009, -0.0696458432188979959, -0.0039883535192434304, 0.0076793272659196887, 0.0111964928886216473,  0.0016952407749798127, -0.0020504191531696301, 0.0003691350455453856, -0.0021450981864993236,  0.0145265441095187818, 0.0431195361999233417, -0.0065732146495725207, -0.0177284828576516028,  0.0167431246471781876, 0.0058762489017053941, 0.0110525994641521956, 0.0225998085838039764, -0.0031356275968381004, 0.0140917377927293752, 0.0137072788441822760, -0.0376552774647530564, -0.0065732146495724843, 0.0650572070005597108, 0.0404232744589142975, 0.0337369367591755370, -0.0084163615552328985, -0.0110945105152440177, 0.0228788705903524223, -0.0044641679468201950,  0.0174727983491973909, 0.0189682050066888423, -0.0696458432188979126, -0.0177284828576515924,  0.0404232744589142906, 0.1274342391849143941, 0.0497400297125233926, 0.0382984275745206701,  0.0801492865809485533, 0.0284247973040912816, -0.0271750958208217541, 0.0229845952308154293,  0.0243625131936422747, -0.0231204015153166839, -0.0021464265410875228, 0.0253945806924136090,  0.0356007329299677516, 0.0382984275745206770, 0.0971274741667843416, 0.1048669943089465678,  0.0261777500289367172, -0.0352139561689320674, 0.0234990129122488664, 0.0158696582501341964, -0.0012096087523571224, 0.0072264499781316792, 0.0214663120851960772, 0.0054235132468679744,  0.0801492865809485810, 0.1048669943089464984, 0.2522832155567822920, 0.0549290399534205290, -0.0664555906246877964, 0.0452552697796260311, 0.0414235253253083038, 0.0106586294503339084,  0.0134554620125994298, 0.0350856437250726752, 0.0052294218705090552, 0.0284247973040912850,  0.0261777500289367103, 0.0549290399534205220, 0.0602558703421073177, -0.0175984463566082432,  0.0212140046791610901, 0.0239267039890196792, -0.0249378870779304006, 0.0012275705119672714,  0.0317326753476671469, 0.0291254991919986800, -0.0271750958208217541, -0.0352139561689321159, -0.0664555906246877548, -0.0175984463566082154, 0.0620988573207224975, -0.0174458529282456865, -0.0166724704574235973, 0.0067889854847903172, -0.0010808825310675151, -0.0151257042295398648, -0.0152582267720093694, 0.0229845952308154119, 0.0234990129122488664, 0.0452552697796260381,  0.0212140046791610797, -0.0174458529282456691, 0.0485393530482083127, 0.0177422974484859018, -0.0214509139884192339, -0.0010710819191225996, 0.0241022236121148752, 0.0269471201462424051,  0.0243625131936422677, 0.0158696582501342276, 0.0414235253253082691, 0.0239267039890196688, -0.0166724704574236077, 0.0177422974484858949, 0.0531406847836403892, -0.0199050104736150021, -0.0023105808603491175, 0.0228326972498529707, 0.0261889344272682109, -0.0231204015153166909, -0.0012096087523571311, 0.0106586294503338806, -0.0249378870779303624, 0.0067889854847903146, -0.0214509139884192131, -0.0199050104736149917, 0.1167504717061011443, 0.0182128523560799449, -0.0522358404560015130, -0.0844543233631050438, -0.0021464265410875271, 0.0072264499781316991,  0.0134554620125994125, 0.0012275705119672818, -0.0010808825310675029, -0.0010710819191226278, -0.0023105808603491131, 0.0182128523560799623, 0.0426833910607821027, -0.0092556409354034100, -0.0212507168754150939, 0.0253945806924135882, 0.0214663120851960737, 0.0350856437250726474,  0.0317326753476671330, -0.0151257042295398700, 0.0241022236121149168, 0.0228326972498529637, -0.0522358404560016101, -0.0092556409354034412, 0.0789966867983174503, 0.0559683730612211827,  0.0356007329299677239, 0.0054235132468679345, 0.0052294218705089997, 0.0291254991919987251, -0.0152582267720093902, 0.0269471201462425231, 0.0261889344272682179, -0.0844543233631051271, -0.0212507168754151286, 0.0559683730612212937, 0.1399643616555109049, 0.0451437418893641043,  0.0326318397410594457, 0.0684000498721793887, 0.0240896939469048450, -0.0227255911547396584,  0.0192546239499636548, 0.0200906714261645733, -0.0223369042272443599, -0.0020985296160529769,  0.0230229495833586678, 0.0332510946699020732, 0.0326318397410594457, 0.0934571242913634082,  0.0942065945909704994, 0.0235071725473032164, -0.0311809299044993639, 0.0188066002376489627,  0.0108028774040850716, -0.0054980982823094968, 0.0077626645285846698, 0.0195400123518532851,  0.0050494496084822101, 0.0684000498721793887, 0.0942065945909704994, 0.2252920638151445498,  0.0482242200516460051, -0.0566107946466561443, 0.0355564125993234961, 0.0312206625408393730,  0.0065742515754418467, 0.0142639800920347712, 0.0313604283975427722, 0.0014717104168424557,  0.0240896939469048554, 0.0235071725473032095, 0.0482242200516459982, 0.0558814428730744286, -0.0149192001132770809, 0.0176230906710198067, 0.0199495695635317737, -0.0203706454557164747,  0.0023709225709005123, 0.0268207443729898652, 0.0233438325469937993, -0.0227255911547396688, -0.0311809299044993639, -0.0566107946466561304, -0.0149192001132770532, 0.0588219393797917017, -0.0132503780415975086, -0.0125795553955866512, 0.0084007337752726036, -0.0016386826503587593, -0.0118970067326525236, -0.0137484822995656078, 0.0192546239499636548, 0.0188066002376489801,  0.0355564125993235308, 0.0176230906710198171, -0.0132503780415974878, 0.0447464136289789302,  0.0137044632099095794, -0.0208691518866550609, -0.0003351876550806579, 0.0197249898334622698,  0.0244653511684393629, 0.0200906714261645768, 0.0108028774040850768, 0.0312206625408393730,  0.0199495695635317737, -0.0125795553955866390, 0.0137044632099095707, 0.0495453973227227909, -0.0163513275789484436,
                  -0.0013668044862034541, 0.0185377409173931584, 0.0214656466387778341, -0.0223369042272443669, -0.0054980982823095350, 0.0065742515754418389, -0.0203706454557164539,  0.0084007337752725845, -0.0208691518866549811, -0.0163513275789484262, 0.1130425580251438189,  0.0159314171185934370, -0.0439592640494345932, -0.0808675176050524525, -0.0020985296160529916,  0.0077626645285846707, 0.0142639800920347521, 0.0023709225709005349, -0.0016386826503587467, -0.0003351876550806853, -0.0013668044862034578, 0.0159314171185934821, 0.0417977343078681993, -0.0062325499870330477, -0.0190691896297905707, 0.0230229495833586678, 0.0195400123518532885,  0.0313604283975427861, 0.0268207443729898722, -0.0118970067326525254, 0.0197249898334623079,  0.0185377409173931515, -0.0439592640494346001, -0.0062325499870331223, 0.0704678776215234143,  0.0463790794522256980, 0.0332510946699020732, 0.0050494496084821632, 0.0014717104168424592,  0.0233438325469938063, -0.0137484822995655852, 0.0244653511684394115, 0.0214656466387778272, -0.0808675176050523969, -0.0190691896297905845, 0.0463790794522257258, 0.1360065608489532951,  0.0546304576605902772, 0.0375990972669060647, 0.0773890196976368822, 0.0275921328714588097, -0.0231151790698990028, 0.0211968910349300023, 0.0219537288345612105, -0.0217424950019131577,  0.0003252094864008436, 0.0246105712160570242, 0.0313300336885899006, 0.0375990972669060577,  0.0991648097254292094, 0.1052716628417586786, 0.0200130654324451353, -0.0297937235232060942,  0.0177773428938630094, 0.0115756097306406267, 0.0137342462633987718, 0.0134734891898095187,  0.0095512012060260977, -0.0117226070704510941, 0.0773890196976368822, 0.1052716628417587202,  0.2493899491700051207, 0.0434510043161501006, -0.0563113301401353059, 0.0334255564219990628,  0.0326705047814391109, 0.0434169425367603445, 0.0257554174328705407, 0.0132122321292613594, -0.0311583171679900954, 0.0275921328714588202, 0.0200130654324451318, 0.0434510043161501075,  0.0558350738692290557, -0.0103828514857253942, 0.0159568382130105026, 0.0190939871428896027, -0.0156906283260182210, 0.0041908609297218596, 0.0244197030172092107, 0.0169980081066557764, -0.0231151790698990098, -0.0297937235232060595, -0.0563113301401352989, -0.0103828514857253855,  0.0566762732768699290, -0.0103466628234912157, -0.0107463874032897293, -0.0061710017887048876, -0.0049964889027750989, -0.0028722597681187880, -0.0007669299453107984, 0.0211968910349300023,  0.0177773428938629886, 0.0334255564219990767, 0.0159568382130105130, -0.0103466628234912001,  0.0452857216521891995, 0.0121307342114292810, -0.0170487487125394362, 0.0004488318131049318,  0.0173737932728488809, 0.0205568527461882401, 0.0219537288345612001, 0.0115756097306406215,  0.0326705047814391109, 0.0190939871428896027, -0.0107463874032897172, 0.0121307342114292775,  0.0493688396915473587, -0.0086172114503176508, 0.0007923897701246776, 0.0149617999056284728,  0.0126993571324633247, -0.0217424950019131612, 0.0137342462633987389, 0.0434169425367603862, -0.0156906283260181967, -0.0061710017887049171, -0.0170487487125393980, -0.0086172114503176300,  0.1282277581213895068, 0.0214068131916759601, -0.0476940878659793746, -0.0878079432145598693,  0.0003252094864008388, 0.0134734891898095101, 0.0257554174328705372, 0.0041908609297218770, -0.0049964889027750755, 0.0004488318131049150, 0.0007923897701246703, 0.0214068131916759843,  0.0453304576095742429, -0.0078075588518525391, -0.0234959873372279048, 0.0246105712160570242,  0.0095512012060260942, 0.0132122321292613802, 0.0244197030172092037, -0.0028722597681187928,  0.0173737932728488982, 0.0149617999056284728, -0.0476940878659793815, -0.0078075588518525599,  0.0720955628644402019, 0.0465315145341253927, 0.0313300336885898936, -0.0117226070704511080, -0.0311583171679900364, 0.0169980081066557764, -0.0007669299453108066, 0.0205568527461882436,  0.0126993571324633178, -0.0878079432145599248, -0.0234959873372279221, 0.0465315145341253927,  0.1396375397445625832, 0.0569367895939884711, 0.0174689402170341290, 0.0382330446149549141,  0.0266378206169947500, -0.0163347273436484225, 0.0224945577728042564, 0.0229520719665545943, -0.0589409742542580176, -0.0099898633893295875, 0.0385909340507015475, 0.0689923382417200054,  0.0174689402170341047, 0.0784903820779159628, 0.0544139600311685095, 0.0064385969297837391, -0.0234419321500171467, 0.0139889956667383734, 0.0019371868565814740, -0.0052275423520415903, -0.0014446138870840462, 0.0100526238561383010, 0.0090274770376521773, 0.0382330446149549349,  0.0544139600311685442, 0.1377988393366177122, 0.0197283417538101045, -0.0401280234301886335,  0.0268183675121233638, 0.0152863241943317751, -0.0060241844226272068, -0.0039067615469152005,  0.0199479984756369307, 0.0206774990194668919, 0.0266378206169947396, 0.0064385969297837365,  0.0197283417538100837, 0.0540927516688727780, -0.0063650788609105049, 0.0136027444098753975,  0.0181984493772286045, -0.0296294849898162023, -0.0014484438038021054, 0.0270160628777588070,  0.0315795256012037576, -0.0163347273436484156, -0.0234419321500171397, -0.0401280234301886335, -0.0063650788609105067, 0.0595474596330574368, -0.0103764752947543143, -0.0079486495078420361,  0.0029892748058380370, 0.0024417626361938429, -0.0043657208720186708, -0.0125312859611460999,  0.0224945577728042495, 0.0139889956667383613, 0.0268183675121233568, 0.0136027444098753801, -0.0103764752947543143, 0.0461707196087741065, 0.0114242775934772535, -0.0201469165562363495, -0.0025436526835248890, 0.0169198340694329506, 0.0252379897436075043, 0.0229520719665545839,  0.0019371868565814865, 0.0152863241943317681, 0.0181984493772286079, -0.0079486495078420431,  0.0114242775934772639, 0.0521509134780148015, -0.0217992590011559413, -0.0034348966761655495,  0.0190429109707159726, 0.0268472586397622663, -0.0589409742542580245, -0.0052275423520416198, -0.0060241844226271947, -0.0296294849898162335, 0.0029892748058380613, -0.0201469165562363356, -0.0217992590011559170, 0.1241984013668689657, 0.0129999632958218963, -0.0514718072573056434, -0.0833352641681031625, -0.0099898633893295910, -0.0014446138870840692, -0.0039067615469151936, -0.0014484438038020902, 0.0024417626361938520, -0.0025436526835248929, -0.0034348966761655504,  0.0129999632958219067, 0.0434664114016911352, -0.0078747661449358498, -0.0163822882492316163,  0.0385909340507015267, 0.0100526238561382958, 0.0199479984756369237, 0.0270160628777587758, -0.0043657208720186778, 0.0169198340694329541, 0.0190429109707159760, -0.0514718072573055949, -0.0078747661449358637, 0.0766323868334336522, 0.0520212793196010923, 0.0689923382417200193,  0.0090274770376521929, 0.0206774990194668676, 0.0315795256012037714, -0.0125312859611460790,  0.0252379897436075182, 0.0268472586397622767, -0.0833352641681032041, -0.0163822882492315990,  0.0520212793196011269, 0.1434278137140076737, 0.0562909939056830122, 0.0196663590513499464,  0.0365332437981971750, 0.0271506882958320352, -0.0168763304829981087, 0.0231124162849584043,  0.0222997108781906629, -0.0583612412946969417, -0.0101530861598573847, 0.0379354565877788596,  0.0707553843576516073, 0.0196663590513499464, 0.1017112119894928168, 0.0795687975430821592,  0.0081953837428163298, -0.0269527730858873070, 0.0175866617942643244, -0.0010941151318956980,
                  0.0065521472484384811, 0.0043731579532861565, 0.0044012358779850014, -0.0101689829586428786,  0.0365332437981971750, 0.0795687975430821592, 0.1872142996140080951, 0.0245391939852342700, -0.0482650899122376645, 0.0283976147986434342, 0.0149623116031402173, 0.0237915888172961498,  0.0047596095615986536, 0.0073906541210240709, -0.0155599710364917546, 0.0271506882958320352,  0.0081953837428163298, 0.0245391939852342700, 0.0658047495978103109, -0.0084975032496015391,  0.0178350797448629701, 0.0245144205406488472, -0.0310658881851061559, 0.0003205423296087423,  0.0314003366563680442, 0.0340264235320264855, -0.0168763304829981087, -0.0269527730858873070, -0.0482650899122376645, -0.0084975032496015391, 0.0671370355301118271, -0.0133459334092883870, -0.0097719986686769303, -0.0004388986167159171, 0.0004188327584560874, -0.0015451742021388309, -0.0071619184719495799, 0.0231124162849584043, 0.0175866617942643244, 0.0283976147986434342,  0.0178350797448629701, -0.0133459334092883870, 0.0568120985881462592, 0.0145558338959935109, -0.0286358621712550845, -0.0028228286439883994, 0.0220799505755982506, 0.0332377340302991986,  0.0222997108781906629, -0.0010941151318956980, 0.0149623116031402173, 0.0245144205406488472, -0.0097719986686769303, 0.0145558338959935109, 0.0638420634464143266, -0.0269300306168051735, -0.0044865282866332181, 0.0236656127244495654, 0.0347592340953502485, -0.0583612412946969417,  0.0065521472484384811, 0.0237915888172961498, -0.0310658881851061559, -0.0004388986167159171, -0.0286358621712550845, -0.0269300306168051735, 0.1578884480830564097, 0.0178936816312022691, -0.0658708421953520251, -0.1135061588811079880, -0.0101530861598573847, 0.0043731579532861565,  0.0047596095615986536, 0.0003205423296087423, 0.0004188327584560874, -0.0028228286439883994, -0.0044865282866332181, 0.0178936816312022691, 0.0501116442373916934, -0.0095945293396901155, -0.0215225790245768822, 0.0379354565877788596, 0.0044012358779850014, 0.0073906541210240709,  0.0314003366563680442, -0.0015451742021388309, 0.0220799505755982506, 0.0236656127244495654, -0.0658708421953520251, -0.0095945293396901155, 0.0912626318996398456, 0.0665733520328917194,  0.0707553843576516073, -0.0101689829586428786, -0.0155599710364917546, 0.0340264235320264855, -0.0071619184719495799, 0.0332377340302991986, 0.0347592340953502485, -0.1135061588811079880, -0.0215225790245768822, 0.0665733520328917194, 0.1822712216538368291 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$n_iter),
               c(12 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$Q),
               c( 0.358020556865647044, 0.259277173053352517, 0.561431827494945024, 0.262678695715435395, -0.111608800820350337,  0.148313568851910438, 0.188390145679481924, -0.059464114894498564, 0.069090794969369901, 0.212797394618069624,  0.053432596110293065, 0.259277173053352517, 1.022218180634146822, 1.663235846535923157, 0.251973417735177507, -0.561194077846880246, 0.280168380200381928, 0.133206617639874125, 0.377351007992750731, 0.152108349530929471,  0.059406211648745461, -0.326753089205042757, 0.561431827494945024, 1.663235846535923157, 2.943349440062594358,  0.414909400161958875, -0.854700683215706691, 0.366496970214028162, 0.233543050172938638, 1.053958669454810870,  0.380261325410562567, -0.078231365026017019, -0.994465343013327563, 0.262678695715435395, 0.251973417735177507,  0.414909400161958875, 0.322843318749494568, -0.187692172879099617, 0.259446100470225538, 0.227966751856685718, -0.507652701336491541, -0.056671890881222847, 0.429488120284109209, 0.537496705144619336, -0.111608800820350337, -0.561194077846880246, -0.854700683215706691, -0.187692172879099617, 0.368451462304787480, -0.230173203879265209, -0.112506030994800776, 0.069178516825374320, -0.009813727189810207, -0.175727919508135905, -0.122728178504065116,  0.148313568851910438, 0.280168380200381928, 0.366496970214028162, 0.259446100470225538, -0.230173203879265209,  0.272970722846386515, 0.179112344318567457, -0.556693576898948495, -0.095571959045730417, 0.412149609311622811,  0.601087569471188798, 0.188390145679481924, 0.133206617639874125, 0.233543050172938638, 0.227966751856685718, -0.112506030994800776, 0.179112344318567457, 0.176676662245769028, -0.391759689168048486, -0.049062060866470310,  0.316700214402321656, 0.414341619870716993, -0.059464114894498564, 0.377351007992750731, 1.053958669454810870, -0.507652701336491541, 0.069178516825374320, -0.556693576898948495, -0.391759689168048486, 2.558747603178308516,  0.589878032665847152, -1.368983686466504146, -2.644646444659957574, 0.069090794969369901, 0.152108349530929471,  0.380261325410562567, -0.056671890881222847, -0.009813727189810207, -0.095571959045730417, -0.049062060866470310,  0.589878032665847152, 0.164899055594413479, -0.273921949705384915, -0.614841324051712657, 0.212797394618069624,  0.059406211648745461, -0.078231365026017019, 0.429488120284109209, -0.175727919508135905, 0.412149609311622811,  0.316700214402321656, -1.368983686466504146, -0.273921949705384915, 0.861064444866115664, 1.427900335394751696,  0.053432596110293065, -0.326753089205042757, -0.994465343013327563, 0.537496705144619336, -0.122728178504065116,  0.601087569471188798, 0.414341619870716993, -2.644646444659957574, -0.614841324051712657, 1.427900335394751696,  2.761453393666073008 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$method),
               c("EKF" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$model),
               c("exponential" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$LR),
               c(0.05852766346593507 )
               , tolerance = 1e-05)
})

test_that("Unmacthed control variable throw error",
          expect_error({
            result = ddhazard(
              formula = survival::Surv(start, stop, event) ~ group,
              data = head_neck_cancer,
              by = 1, # Use by month intervals
              a_0 = rep(0, 2), Q_0 = diag(1, 2), # Initial value
              max_T = 45,
              id = head_neck_cancer$id, order = 1,
              control = list("None_existing_parem" = 1)
            )}, regexp = "These control parameters are not recognized"))

test_that("Using alternated inverse covariance matrix in EKF with exponential model yields previously computed values", {
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(10, 11),
    Q = diag(1e-2, 11),
    control = list(est_Q_0 = F, eps = 10^-2, n_max = 10^3,
                   EKF_inv_Cov_method = "not org"),
    max_T = 10,
    id = sims$res$id, order = 1,
    verbose = F,
    model = "exponential"))

  # get_expect_equal(result_exp, eps = 1e-5, file = "tmp.txt")
  # matplot(seq_len(nrow(sims$betas)) - 1, sims$betas, type = "l", lty = 1)
  # matplot(result_exp$times, result_exp$state_vecs, result_exp$state_vecs, type = "l", lty = 2, add = T)

  expect_equal(c(result_exp$state_vecs),
               c(-5.37491499453456711, -5.37838561956256189, -4.82120214005348124, -4.57774126114250723, -4.37250249850003758, -4.36263736954901749, -4.37576778478690009, -4.30796374816606686, -3.96478025282279178, -4.05884163933298581, -4.06139385848421863, 0.62136248372161029, 0.62493458521790513, 0.74299025525156615, -0.39825497767733964, -1.45633073143722536, -2.22559221312591493, -2.06822623767243163, -2.23007683229433917, -1.61701543132215342, -1.53649477936356083, -1.05616071482902862, -1.97749961606802049, -1.97881595587375569, -0.57669067545861985, -2.44822473362939075, -4.13040023170904291, -5.51716864433489995, -4.95402996774829329, -4.95447727752580747, -2.85942847533379929, -3.08189629183477276, -2.23547613479184593, 1.00606836485592921, 1.00849103278899666,  0.75210260342984592, 0.52387510804844872, 0.31800579639583876, 0.19955092367601179, 0.18928931604373625,  0.08735798545854222, -0.04791068228869577, 0.08318004669572661, 0.20389970557152162, 1.54727598954221035,  1.54470660503176260, 1.63482883510482080, 2.28203085502065584, 2.87229618106439766, 3.24987579696851236,  3.13222630689859072, 3.22218833251401549, 2.98440816190581604, 2.93712750847187554, 2.71757049535431960,  0.59058706612362832, 0.59567850250647014, -0.17273648191381219, -0.35954944340969364, -0.54176236481989193, -0.56444649712038220, -0.68368263961922482, -0.86762310541703425, -1.45613685779407054, -1.22641122282940129, -1.16940644097553026, -0.28072525083253491, -0.27944565496356610, -0.45802462223737783, -0.52684459252313376, -0.58014174739532576, -0.59861885567120932, -0.60309878583613863, -0.64693742798975917, -0.78143413541395512, -0.71396365104266191, -0.67560957514061215, 0.79000280334054462, 0.77728444342701419, 3.37211417702639249,  2.74282635801478003, 2.22770624639737225, 1.47810731419400221, 2.09981672313806778, 2.50088432044739539,  5.10103955217750560, 4.44271150512847957, 4.76700198785209395, 1.60243169246471040, 1.60044167530069581,  2.06637056127744057, 1.91842821228627214, 1.79095011951254390, 1.62022624217503308, 1.71565560527511840,  1.75045295235447540, 2.22247147093365394, 2.14085607244094867, 2.23424197427617077, 1.95984215314049925,  1.96869661532479379, 0.44792822962526402, 0.47222385663508121, 0.46641360407964061, 0.67810386562519609,  0.34856655477029530, 0.04460437790988175, -1.34395601438959700, -0.90551110507820032, -0.89425338157076428, -3.37953113305516251, -3.36866884948570311, -5.63146480649819470, -5.10169842348046476, -4.65192237475799164, -3.97254029809158205, -4.47722333050160959, -4.80247779250813167, -7.04845819725316147, -6.51649582508983016, -6.83522567448175256 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$state_vars),
               c( 1.685901075026752e-01, -1.070897760618673e-01, -3.096885226292929e-02, -5.372608171222829e-02,  7.979358310940199e-02, -1.052626824792337e-01, -2.397106648280096e-02, 1.908216832079230e-01,  2.386001664806245e-02, -1.658557147727988e-01, -1.468423540042886e-01, -1.070897760618673e-01,  7.844097705192272e-01, 1.004684839983574e+00, 1.454836518920367e-01, -3.522779569953190e-01,  1.342475149889229e-01, 4.431982326283665e-02, 2.578848485834337e-01, 8.484287847779956e-02,  5.123261640441776e-02, -2.393766247234175e-01, -3.096885226292926e-02, 1.004684839983574e+00,  2.072643731309848e+00, 1.456268288764662e-01, -5.232919952498224e-01, -1.288318797103063e-02,  2.849564824246953e-02, 1.144318904519704e+00, 2.424522842144922e-01, -3.713408427398605e-01, -9.812517375898829e-01, -5.372608171222829e-02, 1.454836518920368e-01, 1.456268288764662e-01,  1.696992320892381e-01, -7.849290648742006e-02, 8.819559813567263e-02, 3.403672747253363e-02, -1.157008258792878e-01, -9.250868836579741e-04, 1.292320715287860e-01, 8.881982438425001e-02,  7.979358310940206e-02, -3.522779569953190e-01, -5.232919952498225e-01, -7.849290648742011e-02,  3.338812234088540e-01, -8.747723842289300e-02, -3.369571099278635e-02, -9.589811561618734e-02, -3.258675345141932e-02, -4.186074846865413e-02, 7.603913700119790e-02, -1.052626824792337e-01,  1.342475149889228e-01, -1.288318797103061e-02, 8.819559813567263e-02, -8.747723842289302e-02,  2.788929347846167e-01, 4.741320576347153e-02, -4.006223724554726e-01, -5.218634728136070e-02,  2.894526357013904e-01, 3.367817704749629e-01, -2.397106648280097e-02, 4.431982326283664e-02,  2.849564824246955e-02, 3.403672747253363e-02, -3.369571099278632e-02, 4.741320576347154e-02,  1.282843499377613e-01, -8.260102188306576e-02, -9.543496908737308e-03, 6.956442930851590e-02,  7.280182634376008e-02, 1.908216832079231e-01, 2.578848485834336e-01, 1.144318904519704e+00, -1.157008258792878e-01, -9.589811561618722e-02, -4.006223724554724e-01, -8.260102188306576e-02,  1.734724108756547e+00, 2.721705015041420e-01, -8.914575824320063e-01, -1.356060016365836e+00,  2.386001664806244e-02, 8.484287847779946e-02, 2.424522842144921e-01, -9.250868836579561e-04, -3.258675345141933e-02, -5.218634728136073e-02, -9.543496908737287e-03, 2.721705015041420e-01,  1.804548238238315e-01, -1.403476694854059e-01, -2.403608596725863e-01, -1.658557147727988e-01,  5.123261640441755e-02, -3.713408427398603e-01, 1.292320715287860e-01, -4.186074846865408e-02,  2.894526357013904e-01, 6.956442930851583e-02, -8.914575824320066e-01, -1.403476694854061e-01,  6.889558392869706e-01, 7.433871846784467e-01, -1.468423540042886e-01, -2.393766247234175e-01, -9.812517375898828e-01, 8.881982438425011e-02, 7.603913700119806e-02, 3.367817704749629e-01,  7.280182634376009e-02, -1.356060016365836e+00, -2.403608596725864e-01, 7.433871846784467e-01,  1.338017294545901e+00, 9.690191945344850e-02, -4.583123740922494e-02, -1.197520394034390e-02, -2.227966864888903e-02, 2.915855870452427e-02, -3.912628012313843e-02, -6.213425953422821e-03,  4.816484172684374e-02, -2.299851312471235e-03, -6.212556731535446e-02, -1.842055221818883e-02, -4.583123740922494e-02, 4.884720350876424e-01, 5.562224096845618e-01, 8.290904954469970e-02, -1.926799792939866e-01, 7.532561596918545e-02, 2.467855815757088e-02, 1.406489148755807e-01,  5.316591543148933e-02, 3.278973877083900e-02, -1.372109692602434e-01, -1.197520394034385e-02,  5.562224096845619e-01, 1.177910946603299e+00, 8.936926289144657e-02, -2.911353779129118e-01,  1.333786887269189e-02, 2.339787232337603e-02, 5.806833259255153e-01, 1.285992259075608e-01, -1.718886475684160e-01, -4.975560630409994e-01, -2.227966864888903e-02, 8.290904954469971e-02,  8.936926289144657e-02, 1.363828192564465e-01, -3.998394548603386e-02, 4.708594890171072e-02,  2.120949780300203e-02, -5.245136767415751e-02, 6.122526644713147e-03, 6.923641129295180e-02,  3.587375607215007e-02, 2.915855870452433e-02, -1.926799792939866e-01, -2.911353779129119e-01, -3.998394548603391e-02, 2.316694853185419e-01, -4.209180433459969e-02, -1.922177441513148e-02, -6.873461472828646e-02, -2.352230969743023e-02, -1.058191004755765e-02, 5.566160955777328e-02, -3.912628012313839e-02, 7.532561596918548e-02, 1.333786887269192e-02, 4.708594890171075e-02, -4.209180433459969e-02, 1.832110838077972e-01, 2.485341741553613e-02, -1.798736353376979e-01, -1.648966357896878e-02, 1.374896099958066e-01, 1.473114258235336e-01, -6.213425953422821e-03,  2.467855815757085e-02, 2.339787232337606e-02, 2.120949780300203e-02, -1.922177441513144e-02,  2.485341741553614e-02, 1.141690676359568e-01, -3.325728867430938e-02, -2.014409109851747e-03,  3.234186448445747e-02, 3.023600737220884e-02, 4.816484172684385e-02, 1.406489148755807e-01,  5.806833259255155e-01, -5.245136767415751e-02, -6.873461472828629e-02, -1.798736353376978e-01, -3.325728867430940e-02, 8.915465251937515e-01, 1.228825757620731e-01, -4.216772385746402e-01, -6.387994758423348e-01, -2.299851312471235e-03, 5.316591543148928e-02, 1.285992259075606e-01,  6.122526644713161e-03, -2.352230969743023e-02, -1.648966357896882e-02, -2.014409109851734e-03,  1.228825757620733e-01, 1.444988371628115e-01, -6.056937951377378e-02, -1.104460499655087e-01, -6.212556731535451e-02, 3.278973877083875e-02, -1.718886475684158e-01, 6.923641129295181e-02, -1.058191004755758e-02, 1.374896099958066e-01, 3.234186448445742e-02, -4.216772385746405e-01, -6.056937951377389e-02, 3.884985073741318e-01, 3.420715684605565e-01, -1.842055221818895e-02, -1.372109692602435e-01, -4.975560630409992e-01, 3.587375607215014e-02, 5.566160955777343e-02,  1.473114258235335e-01, 3.023600737220887e-02, -6.387994758423348e-01, -1.104460499655087e-01,  3.420715684605564e-01, 7.116123272812724e-01, 9.023915367818508e-02, -3.627129709324349e-02,  1.225627587149147e-02, -2.164602391429679e-02, 2.377927469567089e-02, -4.256382299351980e-02, -5.922028084789380e-03, 7.053633038050786e-02, 1.550170418629843e-03, -7.225709209592024e-02, -3.788513649099234e-02, -3.627129709324346e-02, 3.966556874784861e-01, 4.358737548053662e-01,  6.135203923759994e-02, -1.521016092070644e-01, 5.512144172985689e-02, 1.755976322015259e-02,  1.201531154952952e-01, 4.245084210753531e-02, 1.787280746620745e-02, -1.115251741142906e-01,  1.225627587149136e-02, 4.358737548053662e-01, 9.885958991508905e-01, 5.793445928355281e-02, -2.272481061190689e-01, -1.431986657399739e-02, 1.090844522922277e-02, 5.445180364466223e-01,  1.141707504729593e-01, -1.897862434214138e-01, -4.594447077059274e-01, -2.164602391429675e-02,  6.135203923759991e-02, 5.793445928355276e-02, 1.217249961540223e-01, -3.085990481192290e-02,  4.124578449173176e-02, 1.762342083761274e-02, -5.712334476181165e-02, 2.156825717184761e-03,  6.270857902186716e-02, 4.316544391657860e-02, 2.377927469567086e-02, -1.521016092070644e-01, -2.272481061190688e-01, -3.085990481192292e-02, 2.041417032902351e-01, -3.545622333885899e-02, -1.602522051677136e-02, -4.716870873103646e-02, -1.690285756858569e-02, -1.151829084878083e-02,  3.444863127307192e-02, -4.256382299351974e-02, 5.512144172985694e-02, -1.431986657399729e-02,  4.124578449173175e-02, -3.545622333885903e-02, 1.724531985880584e-01, 2.313013108162026e-02, -1.867286893709721e-01, -2.059335679168446e-02, 1.339056038457407e-01,
                  1.573236310566851e-01, -5.922028084789387e-03, 1.755976322015257e-02, 1.090844522922281e-02, 1.762342083761276e-02, -1.602522051677133e-02, 2.313013108162026e-02, 1.057752300046884e-01, -3.658124308890400e-02, -3.603183420223838e-03, 3.067618730227845e-02, 3.406021259133293e-02, 7.053633038050787e-02,  1.201531154952951e-01, 5.445180364466226e-01, -5.712334476181161e-02, -4.716870873103633e-02, -1.867286893709721e-01, -3.658124308890400e-02, 8.799881838100678e-01, 1.231666294547683e-01, -4.215880030201155e-01, -6.404771223220270e-01, 1.550170418629787e-03, 4.245084210753527e-02,  1.141707504729592e-01, 2.156825717184768e-03, -1.690285756858569e-02, -2.059335679168448e-02, -3.603183420223824e-03, 1.231666294547684e-01, 1.363927983270632e-01, -6.392595378476607e-02, -1.104754818040109e-01, -7.225709209592021e-02, 1.787280746620733e-02, -1.897862434214136e-01,  6.270857902186716e-02, -1.151829084878078e-02, 1.339056038457407e-01, 3.067618730227840e-02, -4.215880030201155e-01, -6.392595378476618e-02, 3.718312051175547e-01, 3.488305590648131e-01, -3.788513649099234e-02, -1.115251741142907e-01, -4.594447077059273e-01, 4.316544391657862e-02,  3.444863127307207e-02, 1.573236310566850e-01, 3.406021259133293e-02, -6.404771223220271e-01, -1.104754818040109e-01, 3.488305590648130e-01, 7.088176969835316e-01, 6.284488190864063e-02, -4.346028066257978e-02, -4.958521587454019e-02, -1.040683384812420e-02, 1.872177048541566e-02, -9.019771005222558e-03, 3.106493988726602e-03, -3.748224015312074e-02, -1.745692827497511e-02, -8.576658440203722e-03, 5.663422223084877e-02, -4.346028066257979e-02, 2.405019095789133e-01,  1.705147996569965e-01, 3.474526591672408e-02, -7.446057853758492e-02, 4.375803620898468e-02,  1.002440046387483e-02, -6.592179911688135e-03, 1.048618405571969e-02, 4.540803556443695e-02, -1.719696151469621e-03, -4.958521587454018e-02, 1.705147996569965e-01, 3.710682336946131e-01,  3.989723568079527e-02, -9.799265081611760e-02, 4.938867595039753e-02, 1.516599867996928e-02,  5.422721159423164e-02, 1.441396534424246e-02, 1.880462571912284e-02, -4.277513412958124e-02, -1.040683384812419e-02, 3.474526591672408e-02, 3.989723568079528e-02, 1.011380148144388e-01, -1.468922507563955e-02, 1.918772635357807e-02, 9.966117621068213e-03, -1.869954580901882e-02,  5.575769582164039e-03, 2.839228677223379e-02, 1.193448138348496e-02, 1.872177048541564e-02, -7.446057853758495e-02, -9.799265081611752e-02, -1.468922507563956e-02, 1.530007479406484e-01, -2.209687106619714e-02, -9.740210220810064e-03, -1.396711552442746e-03, -4.624433402535402e-03, -1.477867059695759e-02, -3.043595451545849e-03, -9.019771005222534e-03, 4.375803620898472e-02,  4.938867595039752e-02, 1.918772635357805e-02, -2.209687106619715e-02, 1.118326712704898e-01,  9.541422291274779e-03, -3.028979395094942e-02, 4.292569311585663e-03, 3.440739120073311e-02,  2.555311218089385e-02, 3.106493988726595e-03, 1.002440046387481e-02, 1.516599867996929e-02,  9.966117621068216e-03, -9.740210220810040e-03, 9.541422291274793e-03, 9.481053471821954e-02, -3.994526852966994e-03, 1.158084838159136e-03, 7.237569230068040e-03, 6.410162920769173e-03, -3.748224015312071e-02, -6.592179911688135e-03, 5.422721159423174e-02, -1.869954580901879e-02, -1.396711552442659e-03, -3.028979395094949e-02, -3.994526852967011e-03, 2.444365821399023e-01,  9.980804857206392e-03, -7.882738572197349e-02, -1.089826582324918e-01, -1.745692827497512e-02,  1.048618405571964e-02, 1.441396534424245e-02, 5.575769582164028e-03, -4.624433402535398e-03,  4.292569311585649e-03, 1.158084838159136e-03, 9.980804857206441e-03, 1.079119015534790e-01, -5.636172487602529e-03, -1.371757942220821e-02, -8.576658440203749e-03, 4.540803556443693e-02,  1.880462571912284e-02, 2.839228677223379e-02, -1.477867059695756e-02, 3.440739120073318e-02,  7.237569230068023e-03, -7.882738572197338e-02, -5.636172487602594e-03, 1.620470079363034e-01,  6.104037893981269e-02, 5.663422223084880e-02, -1.719696151469680e-03, -4.277513412958113e-02,  1.193448138348496e-02, -3.043595451545748e-03, 2.555311218089375e-02, 6.410162920769184e-03, -1.089826582324918e-01, -1.371757942220823e-02, 6.104037893981271e-02, 2.508068100394863e-01,  5.086478825882694e-02, -1.437615545880939e-02, -2.300326692847278e-03, -3.402063458148292e-03, -1.355300819270551e-03, -2.650444763573521e-03, 4.802191089902208e-03, -2.248100905697147e-02, -1.274300321540488e-02, -6.662852050356001e-03, 4.637303845994811e-02, -1.437615545880937e-02,  2.179132558964162e-01, 1.911219202326146e-01, 2.315223807540719e-02, -6.341066793286605e-02,  1.323690172605644e-02, 4.695216570335713e-03, 6.453367453362580e-02, 2.198951782082502e-02, -2.505580585372902e-03, -6.484186112220791e-02, -2.300326692847278e-03, 1.911219202326146e-01,  4.785778550893807e-01, 2.974558234305861e-02, -1.072680432057470e-01, 4.605460132691624e-03,  6.010646987408712e-03, 2.017892847998093e-01, 4.440215610707591e-02, -6.311074842739788e-02, -1.746780893009750e-01, -3.402063458148287e-03, 2.315223807540718e-02, 2.974558234305861e-02,  8.998143079995224e-02, -7.472001767747184e-03, 1.132490382732963e-02, 7.347065234801266e-03, -7.776784980322526e-03, 5.562693458021429e-03, 1.657333550942141e-02, 2.795572771253824e-03, -1.355300819270554e-03, -6.341066793286611e-02, -1.072680432057469e-01, -7.472001767747191e-03,  1.383886926517321e-01, -3.085409099260106e-03, -6.157014220843624e-03, -4.306739831373707e-02, -1.172325667837122e-02, 1.328208793887380e-02, 3.601985130228216e-02, -2.650444763573508e-03,  1.323690172605649e-02, 4.605460132691579e-03, 1.132490382732961e-02, -3.085409099260125e-03,  9.943086604647350e-02, 7.978485045359135e-03, -3.889665989638745e-02, -7.458248967881047e-04,  2.905738108601006e-02, 3.276727276149460e-02, 4.802191089902208e-03, 4.695216570335704e-03,  6.010646987408715e-03, 7.347065234801269e-03, -6.157014220843610e-03, 7.978485045359158e-03,  8.875188793680472e-02, -5.568004041340193e-03, 6.626579863793294e-05, 5.413304955916355e-03,  7.610054710372859e-03, -2.248100905697147e-02, 6.453367453362577e-02, 2.017892847998093e-01, -7.776784980322507e-03, -4.306739831373698e-02, -3.889665989638755e-02, -5.568004041340205e-03,  3.289457901727370e-01, 3.534010174370142e-02, -1.062979114837182e-01, -1.893127178943667e-01, -1.274300321540488e-02, 2.198951782082497e-02, 4.440215610707596e-02, 5.562693458021416e-03, -1.172325667837121e-02, -7.458248967881324e-04, 6.626579863793641e-05, 3.534010174370143e-02,  1.077708996114889e-01, -1.656136220223262e-02, -3.547394264640374e-02, -6.662852050356036e-03, -2.505580585372895e-03, -6.311074842739786e-02, 1.657333550942144e-02, 1.328208793887381e-02,  2.905738108601014e-02, 5.413304955916333e-03, -1.062979114837180e-01, -1.656136220223271e-02,  1.542737672233780e-01, 8.628986298142829e-02, 4.637303845994808e-02, -6.484186112220805e-02, -1.746780893009749e-01, 2.795572771253831e-03, 3.601985130228229e-02, 3.276727276149451e-02,  7.610054710372866e-03, -1.893127178943668e-01, -3.547394264640375e-02, 8.628986298142824e-02,  3.147064343337095e-01, 4.547779196864692e-02, 1.008266630767820e-02, 3.430682683042556e-02, -1.753194380871332e-03, -1.413315169959449e-02, -3.034244790183944e-04, 4.990270864346584e-03, -6.763366060044931e-03, -8.176754725460141e-03,
                  -9.241884399160041e-03, 3.363821885462505e-02,  1.008266630767823e-02, 1.615801216705255e-01, 1.350043159073474e-01, 1.535438840490314e-02, -3.413659614083737e-02, 9.068910806383302e-04, 6.056229108982805e-04, 6.011762951755725e-02,  2.088425950846293e-02, -1.658058183748023e-02, -6.226931101169472e-02, 3.430682683042557e-02,  1.350043159073473e-01, 4.060505321096562e-01, 2.121913357079791e-02, -7.149838104549260e-02, -6.113897216784643e-04, -7.953409310319185e-05, 1.735944579102276e-01, 4.319283759732996e-02, -6.928639389670876e-02, -1.539625133293840e-01, -1.753194380871329e-03, 1.535438840490315e-02,  2.121913357079792e-02, 8.439711159640470e-02, -4.878160582752701e-03, 1.032191049777292e-02,  6.416482973251969e-03, -9.784356223219125e-03, 3.669010345864823e-03, 1.486193931994331e-02,  5.468462072421288e-03, -1.413315169959450e-02, -3.413659614083745e-02, -7.149838104549254e-02, -4.878160582752686e-03, 1.177218932807444e-01, 1.624248150614111e-03, -4.589659409489755e-03, -3.173609833274622e-02, -9.593052818820651e-03, 1.492968040637786e-02, 2.808372028647985e-02, -3.034244790184051e-04, 9.068910806383874e-04, -6.113897216785246e-04, 1.032191049777292e-02,  1.624248150614073e-03, 8.853179343434250e-02, 7.425303384412418e-03, -2.562296775818041e-02, -9.410177329120563e-04, 1.941983137371869e-02, 2.205306561910651e-02, 4.990270864346580e-03,  6.056229108982771e-04, -7.953409310318318e-05, 6.416482973251975e-03, -4.589659409489749e-03,  7.425303384412442e-03, 8.398860358180357e-02, -7.041010423633897e-03, -8.345532045147038e-04,  4.664613948771211e-03, 9.005798961866547e-03, -6.763366060044997e-03, 6.011762951755722e-02,  1.735944579102276e-01, -9.784356223219083e-03, -3.173609833274617e-02, -2.562296775818041e-02, -7.041010423633910e-03, 2.738012449789924e-01, 3.383416088765002e-02, -8.371868408126254e-02, -1.495632056543593e-01, -8.176754725460127e-03, 2.088425950846289e-02, 4.319283759733000e-02,  3.669010345864808e-03, -9.593052818820644e-03, -9.410177329120840e-04, -8.345532045146969e-04,  3.383416088765005e-02, 1.037917092406473e-01, -1.738067226977359e-02, -3.450485968126255e-02, -9.241884399160072e-03, -1.658058183748016e-02, -6.928639389670885e-02, 1.486193931994335e-02,  1.492968040637783e-02, 1.941983137371879e-02, 4.664613948771202e-03, -8.371868408126248e-02, -1.738067226977365e-02, 1.345174673820434e-01, 6.947301898952658e-02, 3.363821885462501e-02, -6.226931101169479e-02, -1.539625133293839e-01, 5.468462072421321e-03, 2.808372028647993e-02,  2.205306561910647e-02, 9.005798961866547e-03, -1.495632056543594e-01, -3.450485968126253e-02,  6.947301898952660e-02, 2.777012374046995e-01, 4.555956729160522e-02, 1.895516400118608e-02,  5.625934866396406e-02, -8.359636590631841e-04, -1.850716469985116e-02, -2.677672111993481e-03,  3.124564529103667e-03, 9.596264067002980e-03, -4.227041442935562e-03, -2.040626586407272e-02,  1.622127748024907e-02, 1.895516400118608e-02, 1.435005881927894e-01, 1.030703323640214e-01,  1.416503964085328e-02, -2.902687735647931e-02, 2.280916333912313e-03, 4.036146214537135e-03,  3.060947587792805e-02, 1.376394848307518e-02, 7.346530022958511e-04, -2.652147826348760e-02,  5.625934866396401e-02, 1.030703323640215e-01, 3.460855235853132e-01, 1.752589272433902e-02, -5.703630335593512e-02, -3.780313743740447e-03, 2.832821316110391e-04, 1.336906062198319e-01,  3.508896676297782e-02, -5.530141816413602e-02, -1.055353576257707e-01, -8.359636590631841e-04,  1.416503964085328e-02, 1.752589272433899e-02, 7.965672420824056e-02, -5.512003281350856e-03,  1.024742560699880e-02, 7.099713691077669e-03, -1.222264854374552e-02, 1.854908617283320e-03,  1.770399374774033e-02, 1.080905629168226e-02, -1.850716469985115e-02, -2.902687735647933e-02, -5.703630335593502e-02, -5.512003281350854e-03, 1.135415153108286e-01, -4.058637205292916e-04, -7.039364635175938e-03, -1.466566191778554e-02, -5.702924146615891e-03, 2.278717171180726e-03,  7.964353471919068e-03, -2.677672111993487e-03, 2.280916333912326e-03, -3.780313743740552e-03,  1.024742560699881e-02, -4.058637205293025e-04, 8.907819859838474e-02, 9.992192171770756e-03, -3.339917844852685e-02, -3.720662008459879e-03, 2.946710101315868e-02, 3.217198703133761e-02,  3.124564529103663e-03, 4.036146214537126e-03, 2.832821316110425e-04, 7.099713691077673e-03, -7.039364635175928e-03, 9.992192171770782e-03, 8.214797817783824e-02, -1.269797686137365e-02, -1.881580881368437e-03, 9.795884131100340e-03, 1.481628588139815e-02, 9.596264067002966e-03,  3.060947587792800e-02, 1.336906062198318e-01, -1.222264854374551e-02, -1.466566191778548e-02, -3.339917844852684e-02, -1.269797686137367e-02, 2.526697437317296e-01, 3.197409267414156e-02, -9.302650347809790e-02, -1.329605048044912e-01, -4.227041442935566e-03, 1.376394848307516e-02,  3.508896676297786e-02, 1.854908617283311e-03, -5.702924146615884e-03, -3.720662008459883e-03, -1.881580881368434e-03, 3.197409267414155e-02, 1.003534760077043e-01, -2.050035681792485e-02, -3.220588466903609e-02, -2.040626586407273e-02, 7.346530022958511e-04, -5.530141816413624e-02,  1.770399374774036e-02, 2.278717171180728e-03, 2.946710101315875e-02, 9.795884131100328e-03, -9.302650347809775e-02, -2.050035681792493e-02, 1.496654217393636e-01, 8.071425368086978e-02,  1.622127748024903e-02, -2.652147826348766e-02, -1.055353576257707e-01, 1.080905629168229e-02,  7.964353471919114e-03, 3.217198703133761e-02, 1.481628588139813e-02, -1.329605048044910e-01, -3.220588466903610e-02, 8.071425368086980e-02, 2.590781816684786e-01, 4.621980915850431e-02,  1.482727833806387e-02, 4.530908100310799e-02, -8.092742277761092e-04, -1.591098653765263e-02, -2.139184153848446e-04, 3.783199673691402e-03, 8.252270523331773e-04, -7.097376465901008e-03, -1.220070347636039e-02, 2.498781313144967e-02, 1.482727833806386e-02, 1.538794491986182e-01,  1.218753556400776e-01, 1.840513954506590e-02, -3.529482893916241e-02, -1.954498736526196e-03,  3.837000259261433e-03, 3.445675980933324e-02, 1.791835336934562e-02, -1.960896883188242e-03, -3.845568482906991e-02, 4.530908100310799e-02, 1.218753556400776e-01, 3.698321980489345e-01,  2.711411178725595e-02, -6.566231446541480e-02, -9.465209821436069e-03, -4.821153388783958e-05,  1.406965319289329e-01, 4.016228669210127e-02, -5.143408209274919e-02, -1.253401083782470e-01, -8.092742277761135e-04, 1.840513954506590e-02, 2.711411178725592e-02, 7.772864582615793e-02, -8.692401982816180e-03, 8.040515627902997e-03, 6.278563459027012e-03, -4.767636590945057e-03,  4.102454008032377e-03, 1.184022724709655e-02, 3.087659701359145e-03, -1.591098653765261e-02, -3.529482893916244e-02, -6.566231446541473e-02, -8.692401982816175e-03, 1.159796159796281e-01,  1.156784846848341e-03, -6.886306741842667e-03, -1.365554939783357e-02, -7.784230153185946e-03,  2.525784821832889e-03, 1.232176553662346e-02, -2.139184153848489e-04, -1.954498736526197e-03, -9.465209821436109e-03, 8.040515627902999e-03, 1.156784846848338e-03, 8.618507411006718e-02,  8.613363637181482e-03, -3.751704240595290e-02, -2.921438717550642e-03, 2.430097085319246e-02,  3.423456489071743e-02, 3.783199673691401e-03, 3.837000259261422e-03, -4.821153388784218e-05,  6.278563459027013e-03, -6.886306741842654e-03, 8.613363637181501e-03, 8.019279682170360e-02, -1.109945282748732e-02,
                  -9.106909087092559e-04, 7.148070785490689e-03, 1.297698943133808e-02,  8.252270523331478e-04, 3.445675980933320e-02, 1.406965319289328e-01, -4.767636590945053e-03, -1.365554939783354e-02, -3.751704240595294e-02, -1.109945282748733e-02, 2.646312968589406e-01,  3.167106791070420e-02, -8.252682202562503e-02, -1.474172338412466e-01, -7.097376465901009e-03,  1.791835336934561e-02, 4.016228669210130e-02, 4.102454008032367e-03, -7.784230153185941e-03, -2.921438717550653e-03, -9.106909087092567e-04, 3.167106791070422e-02, 9.890238353083725e-02, -1.622899605738831e-02, -3.282722209073995e-02, -1.220070347636044e-02, -1.960896883188254e-03, -5.143408209274930e-02, 1.184022724709657e-02, 2.525784821832905e-03, 2.430097085319250e-02,  7.148070785490679e-03, -8.252682202562490e-02, -1.622899605738836e-02, 1.300012714900114e-01,  7.152555659065553e-02, 2.498781313144967e-02, -3.845568482906998e-02, -1.253401083782470e-01,  3.087659701359153e-03, 1.232176553662351e-02, 3.423456489071742e-02, 1.297698943133807e-02, -1.474172338412465e-01, -3.282722209073995e-02, 7.152555659065553e-02, 2.742651577415615e-01,  4.824086150194780e-02, 1.851135177309875e-02, 4.919445282763738e-02, 2.026343608529330e-03, -1.931904551997846e-02, 9.567961972648418e-04, 5.586295194090445e-03, -6.021924335562422e-03, -6.508053299023071e-03, -8.460044324054087e-03, 2.958283058369288e-02, 1.851135177309876e-02,  1.530211774429552e-01, 1.306503444528651e-01, 8.565386817628735e-03, -3.294697107164529e-02, -6.983941246038889e-03, 4.541889871427866e-03, 6.651219774041864e-02, 2.240812507035436e-02, -2.168119876121058e-02, -5.841534261623262e-02, 4.919445282763746e-02, 1.306503444528650e-01,  4.009968270422022e-01, 1.546755692650689e-02, -6.987140501986530e-02, -1.712986944456319e-02,  5.208914493073358e-03, 2.031835751339987e-01, 5.286393340247356e-02, -8.726529675140678e-02, -1.630731587972041e-01, 2.026343608529316e-03, 8.565386817628732e-03, 1.546755692650689e-02,  7.221806174111212e-02, -2.956625824138957e-03, 3.964969155321290e-03, 4.455517277886846e-03,  1.962730076385800e-03, 4.143781052237766e-03, 5.156052977788983e-03, -1.968318796819364e-03, -1.931904551997846e-02, -3.294697107164530e-02, -6.987140501986536e-02, -2.956625824138952e-03,  1.128862842732083e-01, 5.834439526125107e-03, -6.122318664896888e-03, -3.676804281683675e-02, -1.114271849306042e-02, 1.674509039579066e-02, 2.803535965627334e-02, 9.567961972648431e-04, -6.983941246038875e-03, -1.712986944456315e-02, 3.964969155321289e-03, 5.834439526125094e-03,  8.503433081649769e-02, 5.123921436402184e-03, -3.532575850175484e-02, -4.945370927768528e-03,  2.195756829848736e-02, 3.209350408514255e-02, 5.586295194090444e-03, 4.541889871427857e-03,  5.208914493073378e-03, 4.455517277886845e-03, -6.122318664896884e-03, 5.123921436402191e-03,  7.861785808925978e-02, 1.250641839785160e-03, 1.037969409675231e-03, 1.075848447909490e-04,  2.221353785030102e-03, -6.021924335562440e-03, 6.651219774041860e-02, 2.031835751339988e-01,  1.962730076385770e-03, -3.676804281683670e-02, -3.532575850175487e-02, 1.250641839785148e-03,  3.018194082508843e-01, 4.454252039582007e-02, -9.613563827741606e-02, -1.662603645558211e-01, -6.508053299023061e-03, 2.240812507035436e-02, 5.286393340247352e-02, 4.143781052237760e-03, -1.114271849306042e-02, -4.945370927768534e-03, 1.037969409675228e-03, 4.454252039582009e-02,  1.021864924449853e-01, -2.303064630620258e-02, -4.158291262103771e-02, -8.460044324054143e-03, -2.168119876121056e-02, -8.726529675140686e-02, 5.156052977788996e-03, 1.674509039579065e-02,  2.195756829848743e-02, 1.075848447909603e-04, -9.613563827741592e-02, -2.303064630620261e-02,  1.329392602904001e-01, 7.843700158703966e-02, 2.958283058369286e-02, -5.841534261623266e-02, -1.630731587972040e-01, -1.968318796819375e-03, 2.803535965627342e-02, 3.209350408514251e-02,  2.221353785030089e-03, -1.662603645558212e-01, -4.158291262103771e-02, 7.843700158703966e-02,  2.826946749206500e-01, 4.789743388848910e-02, 5.022361246522075e-03, 1.002153436320021e-02,  1.896346533360564e-03, -1.167979305628103e-02, 8.662379429434760e-03, 6.755834045531347e-03, -4.712910721179382e-02, -1.186670925647884e-02, 1.119597955684073e-02, 6.217453923458157e-02,  5.022361246522074e-03, 1.252461819913556e-01, 5.394796664055224e-02, 2.924148894385824e-03, -2.318123705364925e-02, 4.465297406100079e-03, 1.152224878720113e-03, 1.119811620759379e-02, -1.385770710675961e-03, 6.424621582570348e-03, -7.063313736800847e-03, 1.002153436320020e-02,  5.394796664055224e-02, 1.888337340835190e-01, 6.253609192063760e-03, -3.879795959386224e-02,  1.826141536829474e-02, -1.481109092385058e-03, 3.926398236740268e-02, -6.572198877471333e-04, -3.916254756103621e-03, -1.811865972202656e-02, 1.896346533360559e-03, 2.924148894385825e-03,  6.253609192063748e-03, 7.228921745774934e-02, -2.369583853768190e-03, 3.963246012894412e-03,  4.470110205076099e-03, -3.310945969490978e-03, 8.647105508165584e-04, 7.028574018687697e-03,  3.672071127273125e-03, -1.167979305628102e-02, -2.318123705364922e-02, -3.879795959386224e-02, -2.369583853768181e-03, 1.118096326996528e-01, -8.031503324605132e-04, -4.679042572868520e-03, -1.163819758968773e-02, 2.163601608566522e-04, 2.394741759387394e-03, 4.084560925757518e-03,  8.662379429434748e-03, 4.465297406100088e-03, 1.826141536829472e-02, 3.963246012894410e-03, -8.031503324605182e-04, 7.898339683533412e-02, 4.967396671384395e-03, -2.368286320066361e-03, -3.670949812920956e-04, 5.151914855139515e-03, 6.023060896646894e-03, 6.755834045531347e-03,  1.152224878720107e-03, -1.481109092385054e-03, 4.470110205076097e-03, -4.679042572868515e-03,  4.967396671384395e-03, 7.993244064723898e-02, -2.747843064232616e-03, 1.324774852304459e-04,  1.756451867057228e-03, 6.240875724027183e-03, -4.712910721179387e-02, 1.119811620759383e-02,  3.926398236740260e-02, -3.310945969490991e-03, -1.163819758968774e-02, -2.368286320066373e-03, -2.747843064232614e-03, 1.691990765058825e-01, 9.166053045845233e-03, -2.546094851573300e-02, -5.159184401030641e-02, -1.186670925647884e-02, -1.385770710675954e-03, -6.572198877471298e-04,  8.647105508165591e-04, 2.163601608566520e-04, -3.670949812921032e-04, 1.324774852304433e-04,  9.166053045845226e-03, 9.443400999348293e-02, -8.022481546586855e-03, -1.125211627477077e-02,  1.119597955684071e-02, 6.424621582570346e-03, -3.916254756103677e-03, 7.028574018687696e-03,  2.394741759387396e-03, 5.151914855139505e-03, 1.756451867057228e-03, -2.546094851573290e-02, -8.022481546586859e-03, 9.811468965818401e-02, 2.015830417931792e-02, 6.217453923458156e-02, -7.063313736800851e-03, -1.811865972202653e-02, 3.672071127273115e-03, 4.084560925757545e-03,  6.023060896646880e-03, 6.240875724027184e-03, -5.159184401030636e-02, -1.125211627477078e-02,  2.015830417931798e-02, 1.905564600888125e-01, 5.713600911939040e-02, 6.499161351604606e-03,  7.766394940110624e-03, 2.527731240385220e-03, -9.012890218966738e-03, 6.949656297538765e-03,  4.568708128856097e-03, -5.141992501894355e-02, -1.309942974773104e-02, 1.489128606970862e-02,  6.662603721662934e-02, 6.499161351604606e-03, 1.866439453909846e-01, 1.572469160149176e-01,  1.353826946481763e-02, -4.687675981588776e-02, 8.221092535367087e-03, 1.704094247595567e-03,
                  6.833467601482637e-02, 1.615934319476086e-02, -1.254415311765016e-02, -6.685420825447476e-02,  7.766394940110624e-03, 1.572469160149176e-01, 4.044522987248722e-01, 2.355332599094641e-02, -8.540714793134269e-02, 1.087058676536043e-02, -3.995860137763657e-03, 1.753795359445343e-01,  3.115307825075266e-02, -5.630696997460040e-02, -1.480108776599309e-01, 2.527731240385220e-03,  1.353826946481763e-02, 2.355332599094641e-02, 8.184537458138239e-02, -6.972965822049454e-03,  7.965705586882893e-03, 7.664576608709173e-03, 1.922270386483471e-03, 4.994564783320641e-03,  8.807249106040631e-03, -4.302802473614574e-03, -9.012890218966738e-03, -4.687675981588776e-02, -8.540714793134269e-02, -6.972965822049454e-03, 1.297660941933373e-01, -3.107382441678720e-03, -5.527035493541979e-03, -3.874422984693320e-02, -7.598436974156865e-03, 1.364945434483522e-02,  3.155904166994288e-02, 6.949656297538765e-03, 8.221092535367087e-03, 1.087058676536043e-02,  7.965705586882893e-03, -3.107382441678720e-03, 9.556422962750245e-02, 9.230571400805677e-03, -2.398497881085540e-02, -7.320558538295129e-04, 1.921534319331807e-02, 2.115345512787638e-02,  4.568708128856097e-03, 1.704094247595567e-03, -3.995860137763657e-03, 7.664576608709173e-03, -5.527035493541979e-03, 9.230571400805677e-03, 8.762922892534317e-02, -1.214975389414722e-02, -7.001404409247565e-04, 8.134689705863144e-03, 1.353791849066216e-02, -5.141992501894355e-02,  6.833467601482637e-02, 1.753795359445343e-01, 1.922270386483471e-03, -3.874422984693320e-02, -2.398497881085540e-02, -1.214975389414722e-02, 2.817380276981974e-01, 2.473262779188702e-02, -7.430124439442239e-02, -1.416035686230538e-01, -1.309942974773104e-02, 1.615934319476086e-02,  3.115307825075266e-02, 4.994564783320641e-03, -7.598436974156865e-03, -7.320558538295129e-04, -7.001404409247565e-04, 2.473262779188702e-02, 1.034931635755103e-01, -1.206142626025931e-02, -2.546537027357219e-02, 1.489128606970862e-02, -1.254415311765016e-02, -5.630696997460040e-02,  8.807249106040631e-03, 1.364945434483522e-02, 1.921534319331807e-02, 8.134689705863144e-03, -7.430124439442239e-02, -1.206142626025931e-02, 1.294249924096733e-01, 5.700429717908129e-02,  6.662603721662934e-02, -6.685420825447476e-02, -1.480108776599309e-01, -4.302802473614574e-03,  3.155904166994288e-02, 2.115345512787638e-02, 1.353791849066216e-02, -1.416035686230538e-01, -2.546537027357219e-02, 5.700429717908129e-02, 2.747854767565665e-01 )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$method),
               c("EKF" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$model),
               c("exponential" )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE )
               , tolerance = 1e-05)

  expect_equal(c(result_exp$LR),
               c(0.0877914951989026 )
               , tolerance = 1e-05)
})

#############
# Test ukf for exponential model
test_that("UKF and exp models give previous computed results with exponential estimation method",{
  suppressMessages(result_exp <- ddhazard(
    formula = survival::Surv(start, stop, event) ~ group,
    data = head_neck_cancer,
    by = 1,
    Q_0 = diag(1, 2),
    Q = diag(1e-1, 2),
    control = list(est_Q_0 = F, n_max = 10^4, eps = 10^-4,
                   method = "UKF", beta = 0, alpha = 1, save_risk_set = F,
                   save_data = F),
    max_T = 30,
    id = head_neck_cancer$id, order = 1,
    verbose = F,
    model = "exponential"))

  # plot(result_exp, cov_index = 1)
  # get_expect_equal(result_exp, file = "tmp.txt")

  expect_equal(c(result_exp$state_vecs),
               c(-3.69824910038536681, -3.69826065307419105, -3.26859707903190611, -2.95268233222984611, -2.77543499709954977, -2.30794811268055700, -2.42439356837259012, -2.81149408862572647, -2.96604835642004883, -3.07858919668809561, -3.20063414968332038, -3.41926978204197374, -3.52994455186449541, -3.55641905123767721, -3.37491862878595850, -3.44499480899945176, -3.58227233617389818, -3.68103585148111367, -3.63065354518771377, -3.71200873204608328, -3.67032845288164422, -3.81395837158664808, -3.99381412724516816, -4.11150917245706715, -4.16695822942270855, -4.28767616986713485, -4.36004225410994461, -4.38670995220066917, -4.49278911604918907, -4.56290234223730184, -4.59769109320577751, 0.11807985586911025, 0.11808530336174596, 0.27632089931661302, 0.39441596880613600,  0.44475387808013933, 0.62553592624579213, 0.58700138241384914, 0.44698311793234968, 0.41573489470184921,  0.38651047757107021, 0.35020473931936630, 0.27393947697249116, 0.24291147143516253, 0.24814219767729603,  0.32890209135425325, 0.30181476068198732, 0.24962479163596751, 0.21627433894170778, 0.23651753893562372,  0.20830070281157384, 0.22414450177235412, 0.16171554778759148, 0.09051806014666031, 0.04117246851472023,  0.01374834998307983, -0.03268537836081864, -0.06211552824670100, -0.07542661687135926, -0.11279018769181048, -0.13746377408854771, -0.14969203785384111 ))

  expect_equal(c(result_exp$state_vars),
               c( 0.2564700426806703071, 0.0193186468689041067, 0.0193186468689036800, 0.1460679280286585335,  0.1728246489568892597, -0.0103853264130547573, -0.0103853264130552569, 0.1245967614459552730,  0.1636068616711931767, -0.0111959308819632730, -0.0111959308819639114, 0.1157155704057426515,  0.1365216670876577831, -0.0195022107404757561, -0.0195022107404763667, 0.1040987073854811595,  0.1088375823506339268, -0.0295253088367425226, -0.0295253088367430361, 0.0922122755274398243,  0.0999342564870863564, -0.0282906762882705470, -0.0282906762882710328, 0.0878067097506801952,  0.0761398448221971558, -0.0355081971451097628, -0.0355081971451101652, 0.0807934996775148823,  0.0812534168716248228, -0.0315515210821908920, -0.0315515210821913500, 0.0824053001504273380,  0.0979061630803494398, -0.0233180542765690779, -0.0233180542765695636, 0.0887772943842919937,  0.1091170148401460760, -0.0190664945155813240, -0.0190664945155818374, 0.0944788549118243948,  0.1182914827457968998, -0.0162006846878412492, -0.0162006846878417522, 0.1005302060185183921,  0.1282544104358352977, -0.0131465079714294733, -0.0131465079714299625, 0.1075358609811898902,  0.1460849851380808251, -0.0071849005684081965, -0.0071849005684086944, 0.1164908309144385978,  0.1610515286206129770, -0.0029014446928423386, -0.0029014446928428174, 0.1250620445695320437,  0.1714332977747100861, -0.0009241896977249184, -0.0009241896977254145, 0.1328601799079411339,  0.1633019047119910749, -0.0065095597550550131, -0.0065095597550555214, 0.1376802972770761468,  0.1665792881782757751, -0.0079532327386078842, -0.0079532327386084081, 0.1446630721132587949,  0.1800091224566259807, -0.0054513004701847341, -0.0054513004701852476, 0.1539260354743817172,  0.1959445847411625530, -0.0021116460115749511, -0.0021116460115754680, 0.1640443628399728127,  0.2029690571334170079, -0.0024857963115429149, -0.0024857963115434596, 0.1729761367209960432,  0.2137256119087934947, -0.0015423366061816310, -0.0015423366061821930, 0.1828936731151880046,  0.2146132972968490260, -0.0045835080219415875, -0.0045835080219421738, 0.1915432375761303707,  0.2282835894504103291, -0.0030645417715430660, -0.0030645417715436454, 0.2025428104461669543,  0.2509516423207453495, 0.0020564607669640231, 0.0020564607669634610, 0.2156260536991032595,  0.2749757908163666942, 0.0075651377915518583, 0.0075651377915513171, 0.2292765668001862933,  0.2973751834460302002, 0.0121401558254466482, 0.0121401558254461209, 0.2428204459950295269,  0.3300729581246119038, 0.0201865451705297780, 0.0201865451705292437, 0.2579818829645606493,  0.3688951390670381913, 0.0302760385673999377, 0.0302760385673994034, 0.2741578304716998926,  0.4144867036031239516, 0.0424556108013083577, 0.0424556108013077957, 0.2912416011837608565,  0.4868508931419497920, 0.0640569472414180274, 0.0640569472414174584, 0.3120384092986653313,  0.5895922959581253453, 0.0961793387860182258, 0.0961793387860176568, 0.3368047533002774263 ))

  expect_equal(c(result_exp$lag_one_cov),
               c(NULL ))

  expect_equal(c(result_exp$fixed_effects),
               c(numeric(0) ))

  expect_equal(c(result_exp$n_iter),
               c(92 ))

  expect_equal(c(result_exp$Q),
               c(0.14161964589735906, 0.04550611673022104, 0.04550611673022104, 0.02948981054928508 ))

  expect_equal(c(result_exp$Q_0),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$n_risk),
               c(96, 95, 91, 84, 78, 65, 53, 49, 46, 43, 39, 37, 36, 36, 33, 31, 30, 30, 25, 25, 23, 21, 21, 21, 20, 19, 19, 18, 18, 18 ))

  expect_equal(c(result_exp$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30 ))

  expect_equal(c(result_exp$risk_set),
               c(NULL ))

  expect_equal(c(result_exp$data),
               c(NULL ))

  expect_equal(c(result_exp$order),
               c(1 ))

  expect_equal(c(result_exp$F_),
               c(1, 0, 0, 1 ))

  expect_equal(c(result_exp$method),
               c("UKF" ))

  expect_equal(c(result_exp$model),
               c("exponential" ))

  expect_equal(c(result_exp$est_Q_0),
               c(FALSE ))

  expect_equal(c(result_exp$LR),
               c(1 ))




  set.seed(44334)
  sims <- test_sim_func_exp(n_series = 1e3, n_vars = 10, t_0 = 0, t_max = 10,
                            x_range = 1, x_mean = 0, re_draw = T, beta_start = 0,
                            intercept_start = -5, sds = c(.1, rep(1, 10)))
  # sum(sims$res$event)

  arg_list <- list(
    formula = survival::Surv(tstart, tstop, event) ~ . - id - tstart - tstop - event,
    data = sims$res,
    by = (by_ <- 1),
    Q_0 = diag(1, 11),
    Q = diag(1e-2, 11),
    control = list(est_Q_0 = F, n_max = 10^2, eps = 10^-2,
                   method = "UKF", beta = 0, save_risk_set = F,
                   save_data = F, alpha = 1),
    max_T = 10,
    id = sims$res$id, order = 1,
    model = "exponential")

  suppressWarnings(suppressMessages(fit <- do.call(ddhazard, arg_list)))

  matplot(fit$state_vecs, lty = 2, type = "l", ylim = range(fit$state_vecs, sims$betas))
  matplot(sims$betas, lty = 1, add = T, type = "l")
  # get_expect_equal(fit, eps = 1e-6, file = "tmp.txt")

  expect_equal(c(fit$state_vecs),
               c(-6.302164838084285847, -6.328387637706514468, -6.157029716573553912, -5.830199259756337682, -5.376843887696017177, -5.118497963768541936, -4.915648193430080859, -4.939935943736210255, -4.958895042773755257, -5.263003692236379649, -5.084068116366466938, 1.297076492251453939,  1.343545924957546323, 1.403598104125204804, 1.492157589432839604, 1.453580755348834241,  1.650296941939056516, 1.630660215537665714, 1.926816684592018047, 2.485143736786881608,  2.551082979984252930, 2.933984206899721503, 2.291351552960183557, 2.322018677464630976,  2.541799190005712195, 2.953020172196513915, 3.354203038466178288, 3.879904355145725070,  4.096576929046659821, 4.397960149187327694, 4.987518919771504855, 4.789465729023971718,  5.438269017019917939, -0.774337130267023332, -0.617925777248898078, -0.658161189688855286, -0.787952215542344625, -1.385208044071841949, -1.106273262900760779, -1.355689508162659873, -0.618043213695807725, 0.848068686101303926, 1.397540599672838724, 2.305450129036683560, -1.276859889971118101, -1.177620997369469791, -1.389850096052450912, -1.833572871831836926, -2.634304520872052358, -2.842353204299562286, -3.233899250026807337, -2.939446557668547566, -2.268679944300413975, -1.659453716721148275, -1.373395153928361756, 0.639311871686462196,  0.766343589194278696, 0.699927598999546152, 0.512780712861029997, -0.032593310505455775,  0.126176461675282570, -0.129038299486466057, 0.358650198477258542, 1.445128781794596806,  1.976794150513310200, 2.826790776254141768, -0.558038572378460551, -0.469416526418691971, -0.457333589063296964, -0.472329242140386962, -0.730690905515632538, -0.517937081856297166, -0.656132058843581945, -0.252124210082837252, 0.615055519051409094, 0.889180060709573894,  1.512639888209353467, -2.035314403605639644, -2.045706108293933401, -2.219386784518810440, -2.540548106561824504, -2.887979329417463159, -3.245138479255762487, -3.428071286465324441, -3.603343338369811910, -3.944020587228585839, -3.754592990167882505, -4.144356764881120370, -0.479738429255918197, -0.582215001861727255, -0.652400860918357695, -0.744863728925815316, -0.577524138260046893, -0.962898559539139276, -0.880555621211479900, -1.381746530581684063, -2.441075183313149211, -2.700166239989193695, -3.564179872277458472, 0.452180434784276053,  0.520983846202695555, 0.550809339839399614, 0.579652315593894407, 0.413013928502752092,  0.600486993394115709, 0.494942553672175378, 0.844409669547299124, 1.566990038801299168,  1.738776846423786493, 2.250113795468797750, -0.111054092006533600, -0.057096688825303554,  0.001755177022300658, 0.095134497347212243, 0.070622338558689268, 0.331924773520487493,  0.331671616160064742, 0.608434883645827540, 1.185773067601221920, 1.283322821634955702,  1.835721527664128327 )
               , tolerance = 1e-06)

  expect_equal(c(fit$state_vars),
               c( 1.472115833550215e-01, 1.505760475716545e-02, 1.013563282384531e-01, -4.517584163394598e-02, -1.111645070040310e-01, -3.815553214460138e-02, -1.245429268980717e-03, -7.688743386254020e-02, -2.839844614670469e-02, 6.105050211549480e-03, 3.124588892287238e-02, 1.505760475716469e-02,  1.322430010778387e-01, 5.597745233824656e-02, 7.644976721587193e-02, 1.590298039048380e-03,  3.544232977923787e-02, 4.387487643946047e-02, -4.277609747922718e-02, -5.915158826920890e-02,  4.444195014189882e-02, 3.173507523755507e-02, 1.013563282384493e-01, 5.597745233824585e-02,  2.935906538279910e-01, 4.795614136546019e-02, -9.707853423010521e-02, 1.218218563522449e-02,  4.347763305004107e-02, -1.151827065309550e-01, -9.039392502098526e-02, 4.459614530475789e-02,  6.601431723756243e-02, -4.517584163394751e-02, 7.644976721587222e-02, 4.795614136546044e-02,  3.313227974344526e-01, 1.282034309870118e-01, 1.529741989342588e-01, 1.203626815947360e-01, -1.680066071178211e-02, -1.355229046928074e-01, 9.333239166415551e-02, 6.597600472622661e-02, -1.111645070040304e-01, 1.590298039048210e-03, -9.707853423010510e-02, 1.282034309870116e-01,  3.148570074781610e-01, 1.274323776059956e-01, 5.752930685226863e-02, 8.324911517769734e-02, -3.264184682620733e-02, 3.593624458268284e-02, 4.281936407614224e-03, -3.815553214459885e-02,  3.544232977923861e-02, 1.218218563522457e-02, 1.529741989342589e-01, 1.274323776059952e-01,  2.793929456799362e-01, 9.439968970672709e-02, 6.630519280118877e-03, -1.090372161571453e-01,  6.952334898124457e-02, 6.804152518238106e-02, -1.245429268981416e-03, 4.387487643946043e-02,  4.347763305004036e-02, 1.203626815947362e-01, 5.752930685226923e-02, 9.439968970672737e-02,  1.875516976092533e-01, -2.354291991954453e-02, -8.999096627144346e-02, 6.126890751540936e-02,  4.984913178398881e-02, -7.688743386253588e-02, -4.277609747922695e-02, -1.151827065309536e-01, -1.680066071178287e-02, 8.324911517769877e-02, 6.630519280119292e-03, -2.354291991954533e-02,  2.235570172997681e-01, 5.551473177690689e-02, -2.783528074090737e-02, -4.719569371807025e-02, -2.839844614670388e-02, -5.915158826920824e-02, -9.039392502098482e-02, -1.355229046928073e-01, -3.264184682620733e-02, -1.090372161571452e-01, -8.999096627144341e-02, 5.551473177690704e-02,  2.378700388612210e-01, -7.313120762354777e-02, -7.336664727595341e-02, 6.105050211550026e-03,  4.444195014189890e-02, 4.459614530475767e-02, 9.333239166415577e-02, 3.593624458268276e-02,  6.952334898124402e-02, 6.126890751541025e-02, -2.783528074090728e-02, -7.313120762354743e-02,  1.693244144492548e-01, 3.411654852845031e-02, 3.124588892287256e-02, 3.173507523755524e-02,  6.601431723756278e-02, 6.597600472622667e-02, 4.281936407614454e-03, 6.804152518238092e-02,  4.984913178398895e-02, -4.719569371806934e-02, -7.336664727595316e-02, 3.411654852845034e-02,  1.633107098808984e-01, 1.242801772367029e-01, 8.879528026008665e-03, 8.575644214055125e-02, -4.994860110127915e-02, -1.080345491432658e-01, -4.714531422398757e-02, -8.445866246994034e-03, -6.698709735909592e-02, -1.590417659879059e-02, -1.280308483451374e-03, 2.274269318640200e-02,  8.879528026006979e-03, 1.381862838521560e-01, 6.874767520494159e-02, 1.165247648478649e-01,  2.699905730535607e-02, 7.305501293478187e-02, 7.023423191473216e-02, -4.859404842648869e-02, -9.041261961368738e-02, 6.380211270066705e-02, 5.014060294915067e-02, 8.575644214054504e-02,  6.874767520494096e-02, 2.965641817444696e-01, 8.950493651502719e-02, -7.205565410270073e-02,  4.500353483355531e-02, 6.911967040832209e-02, -1.198916745608890e-01, -1.182601255212389e-01,  6.363533645357582e-02, 8.166841821957135e-02, -4.994860110128251e-02, 1.165247648478652e-01,  8.950493651502638e-02, 4.332950490055754e-01, 1.950140812543256e-01, 2.552516284651314e-01,  1.940038188400578e-01, -3.759590473094671e-02, -2.235508060953134e-01, 1.512130545405984e-01,  1.170012326927742e-01, -1.080345491432644e-01, 2.699905730535591e-02, -7.205565410270112e-02,  1.950140812543247e-01, 3.499447917608310e-01, 1.884172426075074e-01, 1.008877335923316e-01,  7.145995445297670e-02, -8.524641334011321e-02, 7.086874166696647e-02, 3.381001940611084e-02, -4.714531422398559e-02, 7.305501293478280e-02, 4.500353483355535e-02, 2.552516284651314e-01,  1.884172426075069e-01, 3.576170543680186e-01, 1.584577151598390e-01, -9.545498916357299e-03, -1.834771461214230e-01, 1.207685380500744e-01, 1.088905621627904e-01, -8.445866246996227e-03,  7.023423191473195e-02, 6.911967040832048e-02, 1.940038188400580e-01, 1.008877335923328e-01,  1.584577151598393e-01, 2.281928136803016e-01, -3.638509055698280e-02, -1.457289273579238e-01,  9.792911508952215e-02, 8.165685801727407e-02, -6.698709735908960e-02, -4.859404842648838e-02, -1.198916745608872e-01, -3.759590473094818e-02, 7.145995445297758e-02, -9.545498916356860e-03, -3.638509055698418e-02, 2.198771939007030e-01, 6.952718013788677e-02, -3.687857584747906e-02, -5.552823648450727e-02, -1.590417659878788e-02, -9.041261961368659e-02, -1.182601255212379e-01, -2.235508060953132e-01, -8.524641334011349e-02, -1.834771461214226e-01, -1.457289273579239e-01,  6.952718013788667e-02, 2.959833948258731e-01, -1.168053002327258e-01, -1.096984465443804e-01, -1.280308483451804e-03, 6.380211270066709e-02, 6.363533645357534e-02, 1.512130545405986e-01,  7.086874166696647e-02, 1.207685380500737e-01, 9.792911508952316e-02, -3.687857584747890e-02, -1.168053002327255e-01, 1.905717124814498e-01, 5.922357690085914e-02, 2.274269318640099e-02,  5.014060294915081e-02, 8.166841821957144e-02, 1.170012326927745e-01, 3.381001940611124e-02,  1.088905621627901e-01, 8.165685801727440e-02, -5.552823648450632e-02, -1.096984465443802e-01,  5.922357690085917e-02, 1.767093090087491e-01, 1.001740223412022e-01, 3.814988645278117e-03,  6.799114033751140e-02, -4.771610539710239e-02, -9.618896786064207e-02, -4.868184907811995e-02, -1.159138303283657e-02, -5.441900797909595e-02, -7.483469037843256e-03, -5.442881420166530e-03,  1.583615920316889e-02, 3.814988645276421e-03, 1.318525179776694e-01, 6.693758044591754e-02,  1.215155888878205e-01, 3.458163075020231e-02, 8.186266666375897e-02, 7.428332151139150e-02, -4.641812721848376e-02, -9.545467560099608e-02, 6.614275075807433e-02, 5.288379552592729e-02,  6.799114033750510e-02, 6.693758044591683e-02, 2.776199522731805e-01, 9.541216814312455e-02, -5.836597355711220e-02, 5.031248619235770e-02, 7.131579539442470e-02, -1.105784883388540e-01, -1.171944381470598e-01, 6.466999426370629e-02, 7.904425581036033e-02, -4.771610539710572e-02,  1.215155888878207e-01, 9.541216814312393e-02, 4.301037166037883e-01, 2.005293951796855e-01,  2.689941772525632e-01, 2.015822676723294e-01, -4.097884253152582e-02, -2.352976230466269e-01,  1.587087565584569e-01, 1.237328289307549e-01, -9.618896786064074e-02, 3.458163075020219e-02, -5.836597355711257e-02, 2.005293951796847e-01, 3.417400988405563e-01, 1.965716941038935e-01,  1.073179427508383e-01, 6.233122105036309e-02, -9.682969703116254e-02, 7.777260111720025e-02,  4.088767500783676e-02, -4.868184907811804e-02, 8.186266666375999e-02, 5.031248619235791e-02,  2.689941772525633e-01, 1.965716941038930e-01, 3.621276000626279e-01, 1.677806802980802e-01, -1.292476474662188e-02, -1.950795553743062e-01, 1.302922816606034e-01,
                  1.136140475103987e-01, -1.159138303283881e-02, 7.428332151139122e-02, 7.131579539442311e-02, 2.015822676723295e-01,  1.073179427508396e-01, 1.677806802980805e-01, 2.277378795570751e-01, -3.734483661890378e-02, -1.534784730961041e-01, 1.030046037476567e-01, 8.549665744832280e-02, -5.441900797908959e-02, -4.641812721848339e-02, -1.105784883388523e-01, -4.097884253152716e-02, 6.233122105036398e-02, -1.292476474662129e-02, -3.734483661890516e-02, 2.069717424139242e-01, 6.829685919892389e-02, -3.675093248831663e-02, -5.386256387842300e-02, -7.483469037840525e-03, -9.545467560099520e-02, -1.171944381470589e-01, -2.352976230466264e-01, -9.682969703116266e-02, -1.950795553743055e-01, -1.534784730961041e-01, 6.829685919892385e-02, 2.984070717793752e-01, -1.239109551867970e-01, -1.130584150613666e-01, -5.442881420167019e-03, 6.614275075807437e-02, 6.466999426370584e-02,  1.587087565584571e-01, 7.777260111720032e-02, 1.302922816606026e-01, 1.030046037476577e-01, -3.675093248831648e-02, -1.239109551867967e-01, 1.879861822788054e-01, 6.291731646947610e-02,  1.583615920316787e-02, 5.288379552592742e-02, 7.904425581036051e-02, 1.237328289307550e-01,  4.088767500783707e-02, 1.136140475103983e-01, 8.549665744832310e-02, -5.386256387842209e-02, -1.130584150613665e-01, 6.291731646947613e-02, 1.707419965292343e-01, 7.998771548071254e-02, -1.105963118035368e-03, 5.035513292335190e-02, -4.392489245864087e-02, -8.180973758067761e-02, -4.733728060443156e-02, -1.297876880111938e-02, -4.084632053201736e-02, -9.658157639346812e-04, -8.334794214031063e-03, 1.044629543519333e-02, -1.105963118037144e-03, 1.146631298564110e-01,  5.170991379301459e-02, 1.010174988160142e-01, 3.158451061675854e-02, 6.980360037337525e-02,  6.173096687642341e-02, -3.616125041739931e-02, -7.914476827046467e-02, 5.484264729168661e-02,  4.368308323468825e-02, 5.035513292334537e-02, 5.170991379301389e-02, 2.393724456011123e-01,  7.443107255141064e-02, -5.061038287974246e-02, 3.528094696041571e-02, 5.592404709763779e-02, -8.787848757155065e-02, -9.194716641051315e-02, 5.072550806404145e-02, 6.281944601299458e-02, -4.392489245864422e-02, 1.010174988160144e-01, 7.443107255141010e-02, 3.642737557517939e-01,  1.730023734941163e-01, 2.284418114286818e-01, 1.677614838798943e-01, -3.007453464643144e-02, -1.956526865460322e-01, 1.327792856019161e-01, 1.018295980737775e-01, -8.180973758067636e-02,  3.158451061675838e-02, -5.061038287974300e-02, 1.730023734941156e-01, 3.089888646116117e-01,  1.743502415460600e-01, 9.255180037035765e-02, 5.366491272637139e-02, -8.440152250279687e-02,  6.837794959873920e-02, 3.486306093392898e-02, -4.733728060442989e-02, 6.980360037337635e-02,  3.528094696041582e-02, 2.284418114286823e-01, 1.743502415460597e-01, 3.200035028300728e-01,  1.420357111831073e-01, -6.132342887621000e-03, -1.638889222145079e-01, 1.118252786080058e-01,  9.469349994134946e-02, -1.297876880112170e-02, 6.173096687642315e-02, 5.592404709763626e-02,  1.677614838798945e-01, 9.255180037035900e-02, 1.420357111831076e-01, 2.005811710949646e-01, -2.870257883637316e-02, -1.279099321831229e-01, 8.641743134888380e-02, 7.086289954514496e-02, -4.084632053201095e-02, -3.616125041739901e-02, -8.787848757154910e-02, -3.007453464643271e-02,  5.366491272637226e-02, -6.132342887620480e-03, -2.870257883637456e-02, 1.846015759274138e-01,  5.309373074749958e-02, -2.819560652300563e-02, -4.419180578141794e-02, -9.658157639318606e-04, -7.914476827046377e-02, -9.194716641051226e-02, -1.956526865460317e-01, -8.440152250279691e-02, -1.638889222145071e-01, -1.279099321831228e-01, 5.309373074749950e-02, 2.588803862237476e-01, -1.038923749218421e-01, -9.302320997419383e-02, -8.334794214031641e-03, 5.484264729168664e-02,  5.072550806404093e-02, 1.327792856019163e-01, 6.837794959873929e-02, 1.118252786080049e-01,  8.641743134888480e-02, -2.819560652300545e-02, -1.038923749218418e-01, 1.679600959583386e-01,  5.153386141093014e-02, 1.044629543519232e-02, 4.368308323468845e-02, 6.281944601299495e-02,  1.018295980737776e-01, 3.486306093392919e-02, 9.469349994134899e-02, 7.086289954514526e-02, -4.419180578141706e-02, -9.302320997419372e-02, 5.153386141093019e-02, 1.519298196896339e-01,  6.699480793637386e-02, -4.240748143485025e-03, 3.834825998818691e-02, -4.121352949877784e-02, -7.081901916006558e-02, -4.417813973740918e-02, -1.324786061655314e-02, -3.103227302805252e-02,  2.537018067163378e-03, -1.057267630779977e-02, 7.966902451334419e-03, -4.240748143486885e-03,  9.791019572299736e-02, 3.799803674672161e-02, 8.037069113206113e-02, 2.726340939063815e-02,  5.739016704727994e-02, 4.931874862436778e-02, -2.713049875578558e-02, -6.296491631339596e-02,  4.313462375956431e-02, 3.516554650725962e-02, 3.834825998818025e-02, 3.799803674672093e-02,  2.056723156715211e-01, 5.420051391666508e-02, -4.398069594852706e-02, 2.299088481181306e-02,  4.232639417500744e-02, -6.778000755418354e-02, -6.935292482333866e-02, 3.703298744827678e-02,  4.956835903245765e-02, -4.121352949878120e-02, 8.037069113206152e-02, 5.420051391666478e-02,  3.030837751552358e-01, 1.459175036077556e-01, 1.875689281394039e-01, 1.352639237875221e-01, -2.023082401686595e-02, -1.562235950774963e-01, 1.068101003563935e-01, 8.050494502310016e-02, -7.081901916006449e-02, 2.726340939063802e-02, -4.398069594852771e-02, 1.459175036077551e-01,  2.749967549573509e-01, 1.479906628207392e-01, 7.646738271124408e-02, 4.487462647597787e-02, -6.955749484221821e-02, 5.816778180150422e-02, 2.699959882716298e-02, -4.417813973740767e-02,  5.739016704728121e-02, 2.299088481181320e-02, 1.875689281394047e-01, 1.479906628207391e-01,  2.746617966937261e-01, 1.156246897544579e-01, -2.126339172088328e-03, -1.317451558431942e-01,  9.239058143711099e-02, 7.597351523703819e-02, -1.324786061655545e-02, 4.931874862436758e-02,  4.232639417500603e-02, 1.352639237875221e-01, 7.646738271124540e-02, 1.156246897544582e-01,  1.741198865802944e-01, -2.164283494282986e-02, -1.025870113011432e-01, 6.955905308158752e-02,  5.695500170291308e-02, -3.103227302804617e-02, -2.713049875578540e-02, -6.778000755418223e-02, -2.023082401686710e-02, 4.487462647597874e-02, -2.126339172087818e-03, -2.164283494283121e-02,  1.640120254074152e-01, 4.010795991875432e-02, -2.010771214794643e-02, -3.674950038454199e-02,  2.537018067166337e-03, -6.296491631339531e-02, -6.935292482333796e-02, -1.562235950774961e-01, -6.955749484221842e-02, -1.317451558431936e-01, -1.025870113011432e-01, 4.010795991875418e-02,  2.196322852551152e-01, -8.306202247826965e-02, -7.409496995300312e-02, -1.057267630780034e-02,  4.313462375956446e-02, 3.703298744827635e-02, 1.068101003563935e-01, 5.816778180150422e-02,  9.239058143711003e-02, 6.955905308158837e-02, -2.010771214794626e-02, -8.306202247826919e-02,  1.472776281120140e-01, 4.012652467595914e-02, 7.966902451333510e-03, 3.516554650725989e-02,  4.956835903245824e-02, 8.050494502310007e-02, 2.699959882716297e-02, 7.597351523703752e-02,  5.695500170291335e-02, -3.674950038454119e-02, -7.409496995300294e-02, 4.012652467595915e-02,  1.347489976525345e-01, 5.417002384267313e-02, -3.927291212878568e-03, 2.788805196112698e-02, -2.876794547203091e-02, -5.123811417336147e-02, -3.163407974200722e-02, -8.265405503035603e-03, -2.049141840498598e-02, -7.318629543449627e-04,
                  -9.133389930321921e-03, 8.583221697384229e-03, -3.927291212880556e-03, 8.293680680915280e-02, 2.721985467037254e-02, 5.918952759821115e-02,  2.090488374599128e-02, 4.376177832276094e-02, 3.591655596905971e-02, -1.971234391911566e-02, -4.706013792946991e-02, 3.135046800450789e-02, 2.640746470364383e-02, 2.788805196112039e-02,  2.721985467037216e-02, 1.732838072022203e-01, 3.938250050031132e-02, -3.106508283364515e-02,  1.571537034721314e-02, 3.025777691016381e-02, -4.602817003119891e-02, -4.976537191310149e-02,  2.452457843744817e-02, 3.673686114115952e-02, -2.876794547203437e-02, 5.918952759821176e-02,  3.938250050031085e-02, 2.294868439918051e-01, 1.035661001009127e-01, 1.320319109918419e-01,  9.343316625890660e-02, -1.502204091333240e-02, -1.091359592639344e-01, 7.590020892217768e-02,  5.453826808260289e-02, -5.123811417336085e-02, 2.090488374599114e-02, -3.106508283364629e-02,  1.035661001009125e-01, 2.219570390316974e-01, 1.054927690319860e-01, 5.177729230901001e-02,  2.915552398953824e-02, -4.712144648343818e-02, 4.332542983784406e-02, 1.587733795465347e-02, -3.163407974200631e-02, 4.376177832276226e-02, 1.571537034721262e-02, 1.320319109918429e-01,  1.054927690319862e-01, 2.145004396895539e-01, 7.954948584381900e-02, -2.782381382935363e-03, -9.145707922943190e-02, 6.754316094381069e-02, 5.266338046372938e-02, -8.265405503037861e-03,  3.591655596905965e-02, 3.025777691016234e-02, 9.343316625890644e-02, 5.177729230901113e-02,  7.954948584381905e-02, 1.411859854775934e-01, -1.597778517234588e-02, -7.113681951692195e-02,  4.865972675411553e-02, 3.917545444346116e-02, -2.049141840498001e-02, -1.971234391911561e-02, -4.602817003119793e-02, -1.502204091333327e-02, 2.915552398953928e-02, -2.782381382934946e-03, -1.597778517234707e-02, 1.409390538695096e-01, 2.892830313105178e-02, -1.277782011870926e-02, -2.922689096315124e-02, -7.318629543416898e-04, -4.706013792946952e-02, -4.976537191310043e-02, -1.091359592639346e-01, -4.712144648343881e-02, -9.145707922943175e-02, -7.113681951692215e-02,  2.892830313105146e-02, 1.760799391629751e-01, -5.881402378553070e-02, -5.186424402089738e-02, -9.133389930322418e-03, 3.135046800450812e-02, 2.452457843744762e-02, 7.590020892217759e-02,  4.332542983784379e-02, 6.754316094380948e-02, 4.865972675411628e-02, -1.277782011870919e-02, -5.881402378552991e-02, 1.246806648964187e-01, 2.628158878383252e-02, 8.583221697383417e-03,  2.640746470364419e-02, 3.673686114116012e-02, 5.453826808260262e-02, 1.587733795465330e-02,  5.266338046372852e-02, 3.917545444346138e-02, -2.922689096315047e-02, -5.186424402089713e-02,  2.628158878383254e-02, 1.154380135192625e-01, 4.758779778248708e-02, -6.492124153872698e-03,  1.674388974274655e-02, -3.056175377875786e-02, -4.318045158467746e-02, -3.206062895775978e-02, -1.224443053421699e-02, -1.128506617475611e-02, 7.625620458977625e-03, -1.331093335113002e-02,  3.358597033872801e-03, -6.492124153874837e-03, 6.922151857915504e-02, 1.640495176371161e-02,  4.349220835315386e-02, 1.948837986839263e-02, 3.390732950269180e-02, 2.581218480874219e-02, -1.195751983971302e-02, -3.390092908426443e-02, 2.158624167681578e-02, 1.880548597660679e-02,  1.674388974273969e-02, 1.640495176371128e-02, 1.425431748679787e-01, 2.613350376062185e-02, -1.748463871334165e-02, 7.297140697874158e-03, 1.808806914236251e-02, -2.482986130131562e-02, -2.764623139865414e-02, 1.217742285339716e-02, 2.260553046174564e-02, -3.056175377876211e-02,  4.349220835315442e-02, 2.613350376062062e-02, 1.933171042011346e-01, 9.067626230304887e-02,  1.058197912567479e-01, 7.351712698007387e-02, -7.689342690287196e-03, -8.615398713324456e-02,  5.886185564590665e-02, 4.042256227610662e-02, -4.318045158467749e-02, 1.948837986839223e-02, -1.748463871334369e-02, 9.067626230304787e-02, 1.950328536913567e-01, 8.975003421839349e-02,  4.586925491154576e-02, 1.614019529910192e-02, -4.739153685346549e-02, 4.030600693629226e-02,  1.612607704686022e-02, -3.206062895775943e-02, 3.390732950269280e-02, 7.297140697872946e-03,  1.058197912567484e-01, 8.975003421839392e-02, 1.809251939137032e-01, 6.133757286447084e-02,  3.288946975908017e-04, -7.082424196197616e-02, 5.375143251065509e-02, 3.894446311074162e-02, -1.224443053421952e-02, 2.581218480874201e-02, 1.808806914236081e-02, 7.351712698007359e-02,  4.586925491154709e-02, 6.133757286447111e-02, 1.219694396429672e-01, -8.252200264256569e-03, -5.335179258681960e-02, 3.607524011058991e-02, 2.795175333072839e-02, -1.128506617475044e-02, -1.195751983971314e-02, -2.482986130131526e-02, -7.689342690288456e-03, 1.614019529910289e-02,  3.288946975909205e-04, -8.252200264257967e-03, 1.197709474057058e-01, 1.370234144041739e-02, -4.393045290772606e-03, -1.961278067122586e-02, 7.625620458981536e-03, -3.390092908426391e-02, -2.764623139865258e-02, -8.615398713324519e-02, -4.739153685346700e-02, -7.082424196197666e-02, -5.335179258681995e-02, 1.370234144041649e-02, 1.466197607207137e-01, -4.307739456532714e-02, -3.563552503706313e-02, -1.331093335113091e-02, 2.158624167681593e-02, 1.217742285339622e-02,  5.886185564590660e-02, 4.030600693629248e-02, 5.375143251065417e-02, 3.607524011059073e-02, -4.393045290772196e-03, -4.307739456532619e-02, 1.082147606375205e-01, 1.639732399343544e-02,  3.358597033871715e-03, 1.880548597660715e-02, 2.260553046174605e-02, 4.042256227610654e-02,  1.612607704686041e-02, 3.894446311074103e-02, 2.795175333072867e-02, -1.961278067122479e-02, -3.563552503706287e-02, 1.639732399343554e-02, 9.960638803340871e-02, 3.977425049555824e-02, -4.909057589603233e-03, 6.391778000700803e-03, -1.986923666609029e-02, -2.445841043059895e-02, -2.477599322743951e-02, -6.090043436549321e-03, -1.613741692881915e-03, 8.951379900081827e-03, -8.838443555214305e-03, 1.115518497580701e-03, -4.909057589606048e-03, 5.847030478377167e-02,  1.156166415794443e-02, 2.958688269913927e-02, 1.462805380360611e-02, 2.537638588548212e-02,  1.757853077235914e-02, -7.733605629961161e-03, -2.328531934344724e-02, 1.506633391540303e-02,  1.256503862657442e-02, 6.391778000692484e-03, 1.156166415794486e-02, 1.203439533476015e-01,  2.966860115637317e-02, 4.731055921462330e-03, 1.016597584628590e-02, 1.848189529855856e-02, -6.361906397010295e-03, -1.576162369607499e-02, 1.211941982180137e-02, 1.355961236710742e-02, -1.986923666609532e-02, 2.958688269913961e-02, 2.966860115636988e-02, 1.589129547815845e-01,  6.240082372441887e-02, 8.264676072988650e-02, 5.248632252152769e-02, -1.034134958469471e-02, -6.841189265200644e-02, 4.471886863766095e-02, 3.027121875485470e-02, -2.445841043059896e-02,  1.462805380360485e-02, 4.731055921458069e-03, 6.240082372441637e-02, 1.491625488475658e-01,  6.692696293625459e-02, 2.861143812620504e-02, -3.202682932655979e-03, -4.357652617343546e-02,  2.949559295765090e-02, 1.579771220288643e-02, -2.477599322744000e-02, 2.537638588548282e-02,  1.016597584628261e-02, 8.264676072988719e-02, 6.692696293625651e-02, 1.561935597556875e-01,  4.378505004389942e-02, -2.263136250546267e-03, -5.614598699481562e-02, 4.286097236392435e-02,  2.976379479225734e-02, -6.090043436552247e-03, 1.757853077235901e-02, 1.848189529855601e-02,  5.248632252152771e-02, 2.861143812620724e-02, 4.378505004389998e-02, 1.040001054202313e-01, -8.437334190688921e-03,
                  -3.931798032998447e-02, 2.622127370733591e-02, 1.946927858262600e-02, -1.613741692874662e-03, -7.733605629961804e-03, -6.361906397009572e-03, -1.034134958469796e-02, -3.202682932657297e-03, -2.263136250548115e-03, -8.437334190691119e-03, 1.008364421908920e-01,  3.570909645764215e-03, -3.822087704644134e-03, -1.222150238177909e-02, 8.951379900087280e-03, -2.328531934344697e-02, -1.576162369607189e-02, -6.841189265200850e-02, -4.357652617343949e-02, -5.614598699481748e-02, -3.931798032998526e-02, 3.570909645762028e-03, 1.245648275118904e-01, -3.320038332788527e-02, -2.268856024455601e-02, -8.838443555216000e-03, 1.506633391540318e-02,  1.211941982179930e-02, 4.471886863766122e-02, 2.949559295765234e-02, 4.286097236392383e-02,  2.622127370733670e-02, -3.822087704642782e-03, -3.320038332788400e-02, 9.758132381537296e-02,  1.021780530058713e-02, 1.115518497578848e-03, 1.256503862657504e-02, 1.355961236710729e-02,  3.027121875485548e-02, 1.579771220288793e-02, 2.976379479225758e-02, 1.946927858262660e-02, -1.222150238177760e-02, -2.268856024455604e-02, 1.021780530058757e-02, 8.724804543062786e-02,  4.044018366314665e-02, -5.689552126582370e-03, 5.440150707093649e-03, -2.450328189712127e-02, -2.523036969228924e-02, -2.717609666589516e-02, -8.598272353540819e-03, -1.517759553404959e-03,  1.093024071569312e-02, -9.690108233345165e-03, -4.317473418875283e-04, -5.689552126585694e-03,  5.539602722403036e-02, 1.120440687941134e-02, 2.631880620075897e-02, 1.507804780506138e-02,  2.528476740249782e-02, 1.645842414302576e-02, -6.911453952826215e-03, -2.144183814133039e-02,  1.423144426143258e-02, 1.178603370617119e-02, 5.440150707084574e-03, 1.120440687941228e-02,  1.208265167857902e-01, 2.639556673129664e-02, 6.591046612323981e-03, 1.053338633007584e-02,  1.716009574351871e-02, -5.498077241965382e-03, -1.395454293241317e-02, 1.265486040061293e-02,  1.280647555091343e-02, -2.450328189712760e-02, 2.631880620075929e-02, 2.639556673129167e-02,  1.593071555664564e-01, 6.690716021048176e-02, 8.621359951607477e-02, 5.227488302962335e-02, -5.370286699121561e-03, -6.459547064936140e-02, 4.458582159356417e-02, 2.883971634951408e-02, -2.523036969228942e-02, 1.507804780505971e-02, 6.591046612318647e-03, 6.690716021047793e-02,  1.499015849300264e-01, 7.050628305100884e-02, 3.123766932152011e-02, -2.643722897895997e-03, -4.534519387287599e-02, 3.088100682465920e-02, 1.764117236920030e-02, -2.717609666589649e-02,  2.528476740249835e-02, 1.053338633007126e-02, 8.621359951607506e-02, 7.050628305101155e-02,  1.597492026296118e-01, 4.526077047718395e-02, -2.343877443867527e-05, -5.571081463214422e-02,  4.491301053992927e-02, 3.046955816476678e-02, -8.598272353544345e-03, 1.645842414302565e-02,  1.716009574351541e-02, 5.227488302962348e-02, 3.123766932152294e-02, 4.526077047718466e-02,  1.023433826481544e-01, -5.643450618231930e-03, -3.666151437030531e-02, 2.593679633625204e-02,  1.814063310191527e-02, -1.517759553397141e-03, -6.911453952827265e-03, -5.498077241964710e-03, -5.370286699126122e-03, -2.643722897898068e-03, -2.343877444147598e-05, -5.643450618234696e-03,  9.946725247261870e-02, 4.792317768498294e-04, -2.877107751804652e-03, -1.059347657127324e-02,  1.093024071569951e-02, -2.144183814133036e-02, -1.395454293240935e-02, -6.459547064936426e-02, -4.534519387288108e-02, -5.571081463214677e-02, -3.666151437030647e-02, 4.792317768470365e-04,  1.195414651291624e-01, -3.229631871568714e-02, -2.048672324593053e-02, -9.690108233347611e-03,  1.423144426143276e-02, 1.265486040060998e-02, 4.458582159356465e-02, 3.088100682466144e-02,  4.491301053992905e-02, 2.593679633625287e-02, -2.877107751802683e-03, -3.229631871568561e-02,  9.706464600886777e-02, 9.815147392345710e-03, -4.317473418899058e-04, 1.178603370617198e-02,  1.280647555091297e-02, 2.883971634951544e-02, 1.764117236920239e-02, 3.046955816476749e-02,  1.814063310191608e-02, -1.059347657127146e-02, -2.048672324593069e-02, 9.815147392346377e-03,  8.520943100420385e-02, 3.634045025100885e-02, -1.178813722826543e-02, -6.683526863904252e-03, -3.745104287970345e-02, -2.589920566404661e-02, -3.218423027928215e-02, -1.801112412801525e-02,  3.850023680698847e-03, 2.024528282034300e-02, -1.665244262679769e-02, -8.363118901739186e-03, -1.178813722826826e-02, 5.959051059382906e-02, 7.728760894931106e-03, 3.201619911387250e-02,  1.925258363548799e-02, 2.886664549570586e-02, 1.911233893620285e-02, -4.571255353099650e-03, -2.427509031317588e-02, 1.562964533647443e-02, 1.311908155713002e-02, -6.683526863912765e-03,  7.728760894931699e-03, 1.053130508580014e-01, 1.259970344313776e-02, 5.455631068531181e-03,  1.784419728724104e-03, 5.760374988938270e-03, 4.284260646994435e-03, -1.089931228224288e-03,  3.212343842670401e-03, 3.712409970428355e-03, -3.745104287970822e-02, 3.201619911387377e-02,  1.259970344313504e-02, 1.672377786248719e-01, 7.005228000526977e-02, 8.069190743717175e-02,  5.329985720071687e-02, 6.715009213763543e-03, -5.935757636695461e-02, 4.184359621700907e-02,  2.958598989282707e-02, -2.589920566404597e-02, 1.925258363548731e-02, 5.455631068527584e-03,  7.005228000526752e-02, 1.497825248994555e-01, 6.371342242347673e-02, 3.399563245349113e-02,  2.031617354091217e-03, -4.241965388781680e-02, 3.047231982060728e-02, 2.089901846649677e-02, -3.218423027928213e-02, 2.886664549570732e-02, 1.784419728721532e-03, 8.069190743717222e-02,  6.371342242347816e-02, 1.496911343226779e-01, 4.091065058946334e-02, 7.205501581034091e-03, -4.674228647967334e-02, 3.919870834226507e-02, 2.980682113692752e-02, -1.801112412801783e-02,  1.911233893620315e-02, 5.760374988936138e-03, 5.329985720071656e-02, 3.399563245349280e-02,  4.091065058946358e-02, 1.022912814062091e-01, 3.581544379907033e-03, -3.078352403757503e-02,  2.232598496936555e-02, 1.652542518945529e-02, 3.850023680706245e-03, -4.571255353100516e-03,  4.284260646994961e-03, 6.715009213760309e-03, 2.031617354090299e-03, 7.205501581032511e-03,  3.581544379904962e-03, 9.700957333520446e-02, -8.055501164305878e-03, 3.907860322815444e-03, -4.220045553518213e-03, 2.024528282034801e-02, -2.427509031317638e-02, -1.089931228222084e-03, -5.935757636695650e-02, -4.241965388781989e-02, -4.674228647967481e-02, -3.078352403757599e-02, -8.055501164307675e-03, 1.123928035561087e-01, -2.623134347244407e-02, -1.703365244050742e-02, -1.665244262679938e-02, 1.562964533647498e-02, 3.212343842668429e-03, 4.184359621700921e-02,  3.047231982060854e-02, 3.919870834226447e-02, 2.232598496936642e-02, 3.907860322816867e-03, -2.623134347244271e-02, 9.440879869584590e-02, 7.210768955000320e-03, -8.363118901740775e-03,  1.311908155713108e-02, 3.712409970428793e-03, 2.958598989282767e-02, 2.089901846649767e-02,  2.980682113692747e-02, 1.652542518945586e-02, -4.220045553516951e-03, -1.703365244050742e-02,  7.210768955000790e-03, 8.537342017967189e-02, 5.265156577506615e-02, -1.622468826570300e-02, -7.555483532873247e-04, -7.290085032143888e-02, -5.504976487171415e-02, -5.859826632937053e-02, -3.682744727466791e-02, -4.081505702246774e-03, 3.649428377657594e-02, -2.924117055848663e-02, -1.364289807445782e-02, -1.622468826570725e-02, 7.248845184394802e-02, 1.112055442237606e-02,  5.404216212842611e-02, 3.308588942890928e-02, 4.504989859880149e-02, 3.009034858093224e-02,
                  -8.955287591315156e-03, -3.753556906049446e-02, 2.436727821851602e-02, 2.058469058121068e-02, -7.555483532980523e-04, 1.112055442237760e-02, 1.174920293767681e-01, -3.210595427285717e-03, -1.044216593649468e-02, -1.058729789168172e-02, -5.091378699113025e-03, -5.819091026080025e-03,  5.482110514464289e-03, -4.264847635113339e-03, 4.477609868600935e-03, -7.290085032144718e-02,  5.404216212842627e-02, -3.210595427292323e-03, 2.686765814866989e-01, 1.514577121399375e-01,  1.562043646151672e-01, 9.974360561710788e-02, 1.811014742540021e-02, -1.042917809461671e-01,  7.234720546481371e-02, 5.095963031418288e-02, -5.504976487171456e-02, 3.308588942890683e-02, -1.044216593650161e-02, 1.514577121399317e-01, 2.282832899485158e-01, 1.318511561044592e-01,  7.756089094998719e-02, 1.779564211147663e-02, -8.180267906798827e-02, 5.901453474055762e-02,  3.774763524963830e-02, -5.859826632937327e-02, 4.504989859880182e-02, -1.058729789168772e-02,  1.562043646151668e-01, 1.318511561044632e-01, 2.223637243201100e-01, 7.939432648296235e-02,  1.679692156549394e-02, -8.598616855438329e-02, 6.402704413747604e-02, 4.962637997719521e-02, -3.682744727467268e-02, 3.009034858093207e-02, -5.091378699117188e-03, 9.974360561710810e-02,  7.756089094999122e-02, 7.939432648296352e-02, 1.300839236355415e-01, 1.078240779123019e-02, -5.202668792073883e-02, 3.639888622054821e-02, 2.686947705729717e-02, -4.081505702238003e-03, -8.955287591316821e-03, -5.819091026079859e-03, 1.811014742539399e-02, 1.779564211147348e-02,  1.679692156548979e-02, 1.078240779122648e-02, 1.138346685574581e-01, -1.007422517797102e-02,  7.365777938744072e-03, -6.504717017871989e-03, 3.649428377658401e-02, -3.753556906049474e-02,  5.482110514468702e-03, -1.042917809461707e-01, -8.180267906799493e-02, -8.598616855438673e-02, -5.202668792074039e-02, -1.007422517797471e-02, 1.410591101874901e-01, -3.962216634944751e-02, -3.019410288445679e-02, -2.924117055849023e-02, 2.436727821851629e-02, -4.264847635116947e-03,  7.234720546481466e-02, 5.901453474056106e-02, 6.402704413747648e-02, 3.639888622054929e-02,  7.365777938746820e-03, -3.962216634944593e-02, 1.092616863661102e-01, 1.346258926595950e-02, -1.364289807446105e-02, 2.058469058121176e-02, 4.477609868600407e-03, 5.095963031418471e-02,  3.774763524964120e-02, 4.962637997719649e-02, 2.686947705729825e-02, -6.504717017869852e-03, -3.019410288445709e-02, 1.346258926596031e-02, 9.936208309319197e-02 )
               , tolerance = 1e-06)

  expect_equal(c(fit$lag_one_cov),
               c(NULL )
               , tolerance = 1e-06)

  expect_equal(c(fit$fixed_effects),
               c(numeric(0) )
               , tolerance = 1e-06)

  expect_equal(c(fit$n_iter),
               c(11 )
               , tolerance = 1e-06)

  expect_equal(c(fit$Q),
               c( 0.119575869140911700, 0.013611204229399529, 0.125869148698204592, -0.083631709631014600, -0.164870525902215903, -0.080868498754861462, -0.025869203419010250, -0.099572819992982967, -0.007352826453151875, -0.009590682270304084, 0.022060511094574985, 0.013611204229399529,  0.107798796318125473, 0.127704468554047934, 0.247675582070318479, 0.092560805438537203,  0.186596476732013905, 0.150363685325693358, -0.076612552790585708, -0.193351353994069441,  0.125953190325715947, 0.110494056548745986, 0.125869148698204592, 0.127704468554047934,  0.281257285316639405, 0.207179583180008675, -0.053405825088173653, 0.141206026016875430,  0.149292543582566439, -0.186398337304777784, -0.233856287790401712, 0.134749602811064018,  0.152195834201775654, -0.083631709631014600, 0.247675582070318479, 0.207179583180008675,  0.759341178122163285, 0.428092504590541878, 0.596098627266000380, 0.432117472180436502, -0.096174962071602643, -0.514276100106143330, 0.344863964944465029, 0.277423776089542551, -0.164870525902215903, 0.092560805438537203, -0.053405825088173653, 0.428092504590541878,  0.393613059655022579, 0.368011517906261409, 0.225545368104618782, 0.073241286889005663, -0.224511145733541750, 0.166904610267078979, 0.101930253207195176, -0.080868498754861462,  0.186596476732013905, 0.141206026016875430, 0.596098627266000380, 0.368011517906261409,  0.503748791794937034, 0.345410283099346460, -0.056858429988516555, -0.407291255953391440,  0.271667416489525304, 0.220427461925745333, -0.025869203419010250, 0.150363685325693358,  0.149292543582566439, 0.432117472180436502, 0.225545368104618782, 0.345410283099346460,  0.263438620086883013, -0.077200037531123464, -0.311814004043719284, 0.206049579314468684,  0.172388533664153548, -0.099572819992982967, -0.076612552790585708, -0.186398337304777784, -0.096174962071602643, 0.073241286889005663, -0.056858429988516555, -0.077200037531123464,  0.139662368986257751, 0.132926631796574601, -0.073765801112096602, -0.090397475057201110, -0.007352826453151875, -0.193351353994069441, -0.233856287790401712, -0.514276100106143330, -0.224511145733541750, -0.407291255953391440, -0.311814004043719284, 0.132926631796574601,  0.404050706880229982, -0.254522321448895306, -0.225894529801197230, -0.009590682270304084,  0.125953190325715947, 0.134749602811064018, 0.344863964944465029, 0.166904610267078979,  0.271667416489525304, 0.206049579314468684, -0.073765801112096602, -0.254522321448895306,  0.176739044659575129, 0.141826462756243721, 0.022060511094574985, 0.110494056548745986,  0.152195834201775654, 0.277423776089542551, 0.101930253207195176, 0.220427461925745333,  0.172388533664153548, -0.090397475057201110, -0.225894529801197230, 0.141826462756243721,  0.140848157446718442 )
               , tolerance = 1e-06)

  expect_equal(c(fit$Q_0),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$n_risk),
               c(2027, 1978, 1915, 1980, 1912, 1863, 1802, 1661, 1621, 1535 )
               , tolerance = 1e-06)

  expect_equal(c(fit$times),
               c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 )
               , tolerance = 1e-06)

  expect_equal(c(fit$risk_set),
               c(NULL )
               , tolerance = 1e-06)

  expect_equal(c(fit$data),
               c(NULL )
               , tolerance = 1e-06)

  expect_equal(c(fit$order),
               c(1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$F_),
               c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 )
               , tolerance = 1e-06)

  expect_equal(c(fit$method),
               c("UKF" )
               , tolerance = 1e-06)

  expect_equal(c(fit$model),
               c("exponential" )
               , tolerance = 1e-06)

  expect_equal(c(fit$est_Q_0),
               c(FALSE )
               , tolerance = 1e-06)

  expect_equal(c(fit$LR),
               c(1 )
               , tolerance = 1e-06)
})


